<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: TemplateConvolveAPGenerator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TemplateConvolveAPGenerator Class Reference</h1><!-- doxytag: class="TemplateConvolveAPGenerator" --><!-- doxytag: inherits="TVAnalysedPulseGenerator" -->
<p><code>#include &lt;<a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for TemplateConvolveAPGenerator:</div>
<div class="dynsection">
 <div class="center">
  <img src="classTemplateConvolveAPGenerator.gif" usemap="#TemplateConvolveAPGenerator_map" alt=""/>
  <map id="TemplateConvolveAPGenerator_map" name="TemplateConvolveAPGenerator_map">
<area href="classTVAnalysedPulseGenerator.html" alt="TVAnalysedPulseGenerator" shape="rect" coords="0,0,190,24"/>
</map>
 </div>
</div>

<p><a href="classTemplateConvolveAPGenerator-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a0cf4b971fea70f8be09c90ae4633568b">TemplateConvolveAPGenerator</a> (<a class="el" href="classTAPGeneratorOptions.html">TAPGeneratorOptions</a> *opts)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#abfab62864eb8bf696c4255f297aaac33">~TemplateConvolveAPGenerator</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#ac19a5a546024821b51b80e652cc99aa9">ProcessPulses</a> (const <a class="el" href="definitions_8h.html#a3c0940832f8741b0c226a24e3dbd62a8">PulseIslandList</a> &amp;, <a class="el" href="definitions_8h.html#a84eeb2f0ab9f7a76f210530739f1bd1d">AnalysedPulseList</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is called on each vector of pulses from a MIDAS event.  <a href="#ac19a5a546024821b51b80e652cc99aa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a21415504937f75ebd87fe7dfe35d6590">MayDivideTPIs</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a52fbd858d4ea72d672d8ef6a91b1310f">SetPulseList</a> (<a class="el" href="definitions_8h.html#a3c0940832f8741b0c226a24e3dbd62a8">PulseIslandList</a> *list)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename TypeOfTAP &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">TypeOfTAP *&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#afc3b7aa35f52b3c404490a0ca782c487">MakeNewTAP</a> (int parent_index) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The suggested method for constructing a new TAP.  <a href="#afc3b7aa35f52b3c404490a0ca782c487"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTAnalysedPulse.html">TAnalysedPulse</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#ad9f1c91a23cff31d6d5eead48e5bfe76">MakeNewTAP</a> (int parent_index) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#ab435ccf776a3bf0dd6d2177d0ec09908">Debug</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIDs_1_1channel.html">IDs::channel</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#abcdca2e1f6ccc74bef4c11a31ff8622c">GetBank</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classIDs_1_1source.html">IDs::source</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a1287e301f1b02e8b9821a8eeda30e484">GetSource</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the source id for this generator being used on the current channel.  <a href="#a1287e301f1b02e8b9821a8eeda30e484"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a8be922ba315c3d9a8e0e2df1f1e6dc49">CalibratePulses</a> (<a class="el" href="definitions_8h.html#a84eeb2f0ab9f7a76f210530739f1bd1d">AnalysedPulseList</a> &amp;theAnalysedPulses) const </td></tr>
<tr><td colspan="2"><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a2a218897c76b5f7637ffaea374aa8d87">TapType</a> ()</td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a96d9ffc0889d659fb376ae93bb17ca76">SetChannel</a> (const std::string &amp;det)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the channel for this generator. Should NOT be called by user code.  <a href="#a96d9ffc0889d659fb376ae93bb17ca76"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#abe4fee0fefc2b30512f271c9a867f4d2">PassesIntegralRatio</a> (const <a class="el" href="classTPulseIsland.html">TPulseIsland</a> *pulse, double &amp;integral, double &amp;ratio) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a9ab6f6e29ddd79ffae6298e3afebe632">CalibrateTime</a> (double clockTime, const <a class="el" href="classTPulseIsland.html">TPulseIsland</a> *tpi) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert time from clock time within the TPI to real time.  <a href="#a9ab6f6e29ddd79ffae6298e3afebe632"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTTemplate.html">TTemplate</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTemplateConvolver.html">TemplateConvolver</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a89a88ffa21ff57d3ce55702408b2566c">fIntegralMax</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#acdb6a35bf9fbfab0a212a0b7d0e3e9c6">fIntegralMin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a6e8a5868d1d163f6ba7b02f0505f2652">fIntegralRatioMax</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a60b3f6dbc9715918ad199ce95ca01256">fIntegralRatioMin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a81e37796b0d9d9cffd46ee423dd7d376">fTemplateAmp</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#abb0e5f86e7240eb335bc7aa2edffa583">fTemplatePed</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#ae473032cc73c22f814f85656a936c070">fTemplateTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a14bba092e78ccc105a36a92c247a0983">fPedestal</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#af515daf74195dfc4c53f0b68311ab9c0">fTicksPerNs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a8caef28a3ea424d812a44e01a643166a">fMuScTimeOffset</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a8fe99241e41e2e7246d6cf14c72dbda0">fExpectPileUp</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structAlgorithm_1_1IntegralRatio.html">Algorithm::IntegralRatio</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a></td></tr>
<tr><td colspan="2"><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classTemplateArchive.html">TemplateArchive</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateConvolveAPGenerator.html#acbe19bf5c437e2b1e3e4ac6a69c0a272">fTemplateArchive</a> = NULL</td></tr>
<tr><td colspan="2"><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTVAnalysedPulseGenerator.html#a32411abab614529fa147b2ce1736199e">MakeAnalysedPulses</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00015">15</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0cf4b971fea70f8be09c90ae4633568b"></a><!-- doxytag: member="TemplateConvolveAPGenerator::TemplateConvolveAPGenerator" ref="a0cf4b971fea70f8be09c90ae4633568b" args="(TAPGeneratorOptions *opts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TemplateConvolveAPGenerator::TemplateConvolveAPGenerator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTAPGeneratorOptions.html">TAPGeneratorOptions</a> *&nbsp;</td>
          <td class="paramname"> <em>opts</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">16</a> of file <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html">TemplateConvolveAPGenerator.cpp</a>.</p>

<p>References <a class="el" href="TemplateConvolver_8cpp_source.html#l00121">TemplateConvolver::CharacteriseTemplate()</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00038">fConvolver</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00040">fIntegralMax</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00040">fIntegralMin</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00047">fIntegralRatio</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00041">fIntegralRatioMax</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00041">fIntegralRatioMin</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00037">fTemplate</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00036">fTemplateArchive</a>, <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00081">TVAnalysedPulseGenerator::GetChannel()</a>, <a class="el" href="ModulesOptions_8cpp_source.html#l00057">modules::options::GetDouble()</a>, <a class="el" href="ModulesOptions_8h_source.html#l00243">modules::options::GetFlag()</a>, <a class="el" href="TTemplate_8h_source.html#l00047">TTemplate::GetHisto()</a>, <a class="el" href="ModulesOptions_8cpp_source.html#l00050">modules::options::GetInt()</a>, <a class="el" href="SetupRecord_8h_source.html#l00080">SetupRecord::GetPolarity()</a>, <a class="el" href="EventNavigator_8h_source.html#l00066">EventNavigator::GetSetupRecord()</a>, <a class="el" href="ModulesOptions_8cpp_source.html#l00067">modules::options::GetString()</a>, <a class="el" href="TemplateArchive_8cpp_source.html#l00029">TemplateArchive::GetTemplate()</a>, <a class="el" href="EventNavigator_8cpp_source.html#l00050">EventNavigator::Instance()</a>, <a class="el" href="TTemplate_8cpp_source.html#l00152">TTemplate::NormaliseToSumSquares()</a>, and <a class="el" href="TTemplate_8cpp_source.html#l00164">TTemplate::RebinToOriginalSampling()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00016"></a>00016                                                                                  :
<a name="l00017"></a>00017    <a class="code" href="classTVAnalysedPulseGenerator.html#a5a325342073385877a496219778acde4">TVAnalysedPulseGenerator</a>(<span class="stringliteral">&quot;TemplateConvolve&quot;</span>,opts),
<a name="l00018"></a>00018     <a class="code" href="classTemplateConvolveAPGenerator.html#a14bba092e78ccc105a36a92c247a0983">fPedestal</a>(<a class="code" href="classEventNavigator.html#ad4099e1d7bb809c73abced326a4a09f8">EventNavigator::Instance</a>().GetSetupRecord().GetPedestal(<a class="code" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a>())),
<a name="l00019"></a>00019     <a class="code" href="classTemplateConvolveAPGenerator.html#af515daf74195dfc4c53f0b68311ab9c0">fTicksPerNs</a>(<a class="code" href="classEventNavigator.html#ad4099e1d7bb809c73abced326a4a09f8">EventNavigator::Instance</a>().GetSetupRecord().GetTickLength(<a class="code" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a>())),
<a name="l00020"></a>00020     <span class="comment">//fMuScTimeOffset(SetupNavigator::Instance()-&gt;GetCoarseTimeOffset(GetSource())),</span>
<a name="l00021"></a>00021     <a class="code" href="classTemplateConvolveAPGenerator.html#a8caef28a3ea424d812a44e01a643166a">fMuScTimeOffset</a>(0.),
<a name="l00022"></a>00022     <a class="code" href="classTemplateConvolveAPGenerator.html#a8fe99241e41e2e7246d6cf14c72dbda0">fExpectPileUp</a>(<span class="keyword">false</span>), <a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>(NULL)
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024    <span class="comment">// get the templates from the archive</span>
<a name="l00025"></a>00025    <span class="keywordflow">if</span>(!<a class="code" href="classTemplateConvolveAPGenerator.html#acbe19bf5c437e2b1e3e4ac6a69c0a272">fTemplateArchive</a>){
<a name="l00026"></a>00026      <a class="code" href="classTemplateConvolveAPGenerator.html#acbe19bf5c437e2b1e3e4ac6a69c0a272">fTemplateArchive</a>=<span class="keyword">new</span> <a class="code" href="classTemplateArchive.html" title="Utility class that manages reading and writing template histograms to a ROOT file...">TemplateArchive</a>(opts-&gt;<a class="code" href="classmodules_1_1options.html#a5abd8fca2bf95e3d0d753d49089c08aa" title="Get the named option as a string.">GetString</a>(<span class="stringliteral">&quot;template_archive&quot;</span>).c_str(),<span class="stringliteral">&quot;READ&quot;</span>);
<a name="l00027"></a>00027    }
<a name="l00028"></a>00028    <a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>=<a class="code" href="classTemplateConvolveAPGenerator.html#acbe19bf5c437e2b1e3e4ac6a69c0a272">fTemplateArchive</a>-&gt;<a class="code" href="classTemplateArchive.html#adfb4e824865057516deb37a316fc238b" title="Gets the template histogram of the given name and returns it.">GetTemplate</a>(<a class="code" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a>());
<a name="l00029"></a>00029    <a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>-&gt;<a class="code" href="classTTemplate.html#a5bc56dbf79e79883172f1cebe7d895e1">RebinToOriginalSampling</a>();
<a name="l00030"></a>00030    <a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>-&gt;<a class="code" href="classTTemplate.html#adfd0f9451fd7a31cd3f1e78adb0629e6">NormaliseToSumSquares</a>();
<a name="l00031"></a>00031 
<a name="l00032"></a>00032    <span class="keywordtype">int</span> fit_peak= opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;n_quad_fit&quot;</span>,5);
<a name="l00033"></a>00033    <span class="keywordtype">int</span> left= opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;left&quot;</span>,20);
<a name="l00034"></a>00034    <span class="keywordtype">int</span> right= opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;right&quot;</span>,120);
<a name="l00035"></a>00035    <a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>=<span class="keyword">new</span> <a class="code" href="classTemplateConvolver.html">TemplateConvolver</a>(<a class="code" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a>(), <a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>, fit_peak, left, right);
<a name="l00036"></a>00036    TH1* tpl=(TH1*)<a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>-&gt;<a class="code" href="classTTemplate.html#a4c7173497805f59239f92e5d3860e4e7">GetHisto</a>()-&gt;Clone(<span class="stringliteral">&quot;Template&quot;</span>);
<a name="l00037"></a>00037    tpl-&gt;SetDirectory(gDirectory);
<a name="l00038"></a>00038    <a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#a4a7d21227a2c8fbf52b50da03158877d">CharacteriseTemplate</a>();
<a name="l00039"></a>00039 
<a name="l00040"></a>00040    <span class="comment">// prepare the integral ratio cuts</span>
<a name="l00041"></a>00041    <span class="keywordflow">if</span>(opts-&gt;<a class="code" href="classmodules_1_1options.html#afd85b5a7cd2ac4dbe59d5b07d83397d6" title="Check if a flag option has been set.">GetFlag</a>(<span class="stringliteral">&quot;use_IR_cut&quot;</span>)){
<a name="l00042"></a>00042       <a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>=<span class="keyword">new</span> <a class="code" href="structAlgorithm_1_1IntegralRatio.html">Algorithm::IntegralRatio</a>(
<a name="l00043"></a>00043                       opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;start_integral&quot;</span>,10),
<a name="l00044"></a>00044                       opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;start_tail&quot;</span>,60),
<a name="l00045"></a>00045                       opts-&gt;<a class="code" href="classmodules_1_1options.html#a2077430d97f034189c3f775ceefb8191" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;stop_integral&quot;</span>,0),
<a name="l00046"></a>00046                       <a class="code" href="classEventNavigator.html#ad4099e1d7bb809c73abced326a4a09f8">EventNavigator::Instance</a>().<a class="code" href="classEventNavigator.html#a3cd69cd236b48644dca763e0541c8926">GetSetupRecord</a>().<a class="code" href="classSetupRecord.html#aeda2e007eac78a0a0f46eb6c36efd242" title="The polarity of the channel.">GetPolarity</a>(<a class="code" href="classTVAnalysedPulseGenerator.html#a87aeb155c4b4394fafe6b35992105faf">GetChannel</a>()));
<a name="l00047"></a>00047       <a class="code" href="classTemplateConvolveAPGenerator.html#a89a88ffa21ff57d3ce55702408b2566c">fIntegralMax</a>=opts-&gt;<a class="code" href="classmodules_1_1options.html#ae5dc83034f14668946edafd54a7d3131" title="Get the named option as a double.">GetDouble</a>(<span class="stringliteral">&quot;max_integral&quot;</span>);
<a name="l00048"></a>00048       <a class="code" href="classTemplateConvolveAPGenerator.html#acdb6a35bf9fbfab0a212a0b7d0e3e9c6">fIntegralMin</a>=opts-&gt;<a class="code" href="classmodules_1_1options.html#ae5dc83034f14668946edafd54a7d3131" title="Get the named option as a double.">GetDouble</a>(<span class="stringliteral">&quot;min_integral&quot;</span>);
<a name="l00049"></a>00049       <a class="code" href="classTemplateConvolveAPGenerator.html#a6e8a5868d1d163f6ba7b02f0505f2652">fIntegralRatioMax</a>=opts-&gt;<a class="code" href="classmodules_1_1options.html#ae5dc83034f14668946edafd54a7d3131" title="Get the named option as a double.">GetDouble</a>(<span class="stringliteral">&quot;max_ratio&quot;</span>);
<a name="l00050"></a>00050       <a class="code" href="classTemplateConvolveAPGenerator.html#a60b3f6dbc9715918ad199ce95ca01256">fIntegralRatioMin</a>=opts-&gt;<a class="code" href="classmodules_1_1options.html#ae5dc83034f14668946edafd54a7d3131" title="Get the named option as a double.">GetDouble</a>(<span class="stringliteral">&quot;min_ratio&quot;</span>);
<a name="l00051"></a>00051   }
<a name="l00052"></a>00052 }

</pre></div></p>

</div>
</div>
<a class="anchor" id="abfab62864eb8bf696c4255f297aaac33"></a><!-- doxytag: member="TemplateConvolveAPGenerator::~TemplateConvolveAPGenerator" ref="abfab62864eb8bf696c4255f297aaac33" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual TemplateConvolveAPGenerator::~TemplateConvolveAPGenerator </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00019">19</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00019"></a>00019 {};
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8be922ba315c3d9a8e0e2df1f1e6dc49"></a><!-- doxytag: member="TemplateConvolveAPGenerator::CalibratePulses" ref="a8be922ba315c3d9a8e0e2df1f1e6dc49" args="(AnalysedPulseList &amp;theAnalysedPulses) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TVAnalysedPulseGenerator::CalibratePulses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="definitions_8h.html#a84eeb2f0ab9f7a76f210530739f1bd1d">AnalysedPulseList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>theAnalysedPulses</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8cpp_source.html#l00023">23</a> of file <a class="el" href="TVAnalysedPulseGenerator_8cpp_source.html">TVAnalysedPulseGenerator.cpp</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00133">TVAnalysedPulseGenerator::fAdcToEnergyGain</a>, <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00133">TVAnalysedPulseGenerator::fAdcToEnergyOffset</a>, and <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00131">TVAnalysedPulseGenerator::fCanCalibrate</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00023"></a>00023                                                                                        {
<a name="l00024"></a>00024    <span class="keywordflow">if</span>(<a class="code" href="classTVAnalysedPulseGenerator.html#afa5b4981b9e329192a84365ab2392ca7" title="Flag if we have calibration constants for this generator.">fCanCalibrate</a>){
<a name="l00025"></a>00025       <span class="keywordflow">for</span>(<a class="code" href="namespacemodules.html#a5ce57c86284eadc5b573cfab0949bfdb">AnalysedPulseList::iterator</a> i_tap=theAnalysedPulses.begin(); i_tap != theAnalysedPulses.end(); ++i_tap){
<a name="l00026"></a>00026          <span class="keyword">const</span> <span class="keywordtype">double</span> amplitude=(*i_tap)-&gt;GetAmplitude();
<a name="l00027"></a>00027          (*i_tap)-&gt;SetEnergy(<a class="code" href="classTVAnalysedPulseGenerator.html#ac2f0483e036268d6a4a0c400f0510559" title="Cache the calibration constants so we don&amp;#39;t need to look up in the setup navigator...">fAdcToEnergyGain</a> * amplitude + <a class="code" href="classTVAnalysedPulseGenerator.html#a6ce4265f3d94453b6b48d5c5e94b2da0">fAdcToEnergyOffset</a>);
<a name="l00028"></a>00028       }
<a name="l00029"></a>00029    }
<a name="l00030"></a>00030 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ab6f6e29ddd79ffae6298e3afebe632"></a><!-- doxytag: member="TemplateConvolveAPGenerator::CalibrateTime" ref="a9ab6f6e29ddd79ffae6298e3afebe632" args="(double clockTime, const TPulseIsland *tpi) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TemplateConvolveAPGenerator::CalibrateTime </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>clockTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTPulseIsland.html">TPulseIsland</a> *&nbsp;</td>
          <td class="paramname"> <em>tpi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert time from clock time within the TPI to real time. </p>

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00139">139</a> of file <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html">TemplateConvolveAPGenerator.cpp</a>.</p>

<p>References <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00044">fMuScTimeOffset</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00044">fTicksPerNs</a>, and <a class="el" href="TPulseIsland_8h_source.html#l00062">TPulseIsland::GetTimeStamp()</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00139"></a>00139                                                                                                {
<a name="l00140"></a>00140   <span class="keywordflow">return</span> (clockTime + (<span class="keywordtype">double</span>)tpi-&gt;<a class="code" href="classTPulseIsland.html#af77ffa4ff59644151fed060663690bcf">GetTimeStamp</a>()) * <a class="code" href="classTemplateConvolveAPGenerator.html#af515daf74195dfc4c53f0b68311ab9c0">fTicksPerNs</a> - <a class="code" href="classTemplateConvolveAPGenerator.html#a8caef28a3ea424d812a44e01a643166a">fMuScTimeOffset</a>;
<a name="l00141"></a>00141 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab435ccf776a3bf0dd6d2177d0ec09908"></a><!-- doxytag: member="TemplateConvolveAPGenerator::Debug" ref="ab435ccf776a3bf0dd6d2177d0ec09908" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TVAnalysedPulseGenerator::Debug </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00077">77</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00125">TVAnalysedPulseGenerator::fDebug</a>.</p>

<p>Referenced by <a class="el" href="GaussFitAPGenerator_8cpp_source.html#l00074">GaussFitAPGenerator::FitPulse()</a>, <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>, and <a class="el" href="IntegralRatioAPGenerator_8cpp_source.html#l00035">IntegralRatioAPGenerator::ProcessPulses()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00077"></a>00077 {<span class="keywordflow">return</span> <a class="code" href="classTVAnalysedPulseGenerator.html#a1892af1970a49cef5366930bf764dc7d" title="Debug flagged set from modules file. Used, for example, in deciding whether or not...">fDebug</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="abcdca2e1f6ccc74bef4c11a31ff8622c"></a><!-- doxytag: member="TemplateConvolveAPGenerator::GetBank" ref="abcdca2e1f6ccc74bef4c11a31ff8622c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string TVAnalysedPulseGenerator::GetBank </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A convenience method for analysis to get the channel ID of the channel being analysed </p>

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00085">85</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00121">TVAnalysedPulseGenerator::fBankName</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00085"></a>00085 {<span class="keywordflow">return</span> <a class="code" href="classTVAnalysedPulseGenerator.html#a95086001e5c86eb2c992372c39c96b52" title="The bankname in the MIDAS file used by this channel.">fBankName</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="a87aeb155c4b4394fafe6b35992105faf"></a><!-- doxytag: member="TemplateConvolveAPGenerator::GetChannel" ref="a87aeb155c4b4394fafe6b35992105faf" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIDs_1_1channel.html">IDs::channel</a> TVAnalysedPulseGenerator::GetChannel </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A convenience method for analysis to get the channel ID of the channel being analysed </p>

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00081">81</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="IdSource_8h_source.html#l00090">IDs::source::Channel()</a>, and <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00111">TVAnalysedPulseGenerator::fSource</a>.</p>

<p>Referenced by <a class="el" href="FirstCompleteAPGenerator_8cpp_source.html#l00085">FirstCompleteAPGenerator::DrawPulse()</a>, <a class="el" href="FirstCompleteAPGenerator_8cpp_source.html#l00015">FirstCompleteAPGenerator::FirstCompleteAPGenerator()</a>, <a class="el" href="IntegralRatioAPGenerator_8cpp_source.html#l00035">IntegralRatioAPGenerator::ProcessPulses()</a>, <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>, <a class="el" href="TemplateFitAPGenerator_8cpp_source.html#l00016">TemplateFitAPGenerator::TemplateFitAPGenerator()</a>, and <a class="el" href="TVAnalysedPulseGenerator_8cpp_source.html#l00005">TVAnalysedPulseGenerator::TVAnalysedPulseGenerator()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081 {<span class="keywordflow">return</span> <a class="code" href="classTVAnalysedPulseGenerator.html#a11fa0f36e3fe2db1aca5c963132e5a69" title="The source identifying the generator and detector being processed.">fSource</a>.<a class="code" href="classIDs_1_1source.html#a5cc6b4375e7d2c6dc171a5fca8da94f7" title="Get a reference to the channel ID in this source.">Channel</a>();};
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1287e301f1b02e8b9821a8eeda30e484"></a><!-- doxytag: member="TemplateConvolveAPGenerator::GetSource" ref="a1287e301f1b02e8b9821a8eeda30e484" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classIDs_1_1source.html">IDs::source</a>&amp; TVAnalysedPulseGenerator::GetSource </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the source id for this generator being used on the current channel. </p>
<p>Useful for a generator to know the full source much like in the above GetChannel method, but this could also be useful for checking that this generator is the one that made a given TAP in later analysis by comparing this value to that stored in the TAP itself. </p>

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00094">94</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00111">TVAnalysedPulseGenerator::fSource</a>.</p>

<p>Referenced by <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00137">TVAnalysedPulseGenerator::MakeNewTAP()</a>, and <a class="el" href="IntegralRatioAPGenerator_8cpp_source.html#l00035">IntegralRatioAPGenerator::ProcessPulses()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00094"></a>00094 {<span class="keywordflow">return</span> <a class="code" href="classTVAnalysedPulseGenerator.html#a11fa0f36e3fe2db1aca5c963132e5a69" title="The source identifying the generator and detector being processed.">fSource</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad9f1c91a23cff31d6d5eead48e5bfe76"></a><!-- doxytag: member="TemplateConvolveAPGenerator::MakeNewTAP" ref="ad9f1c91a23cff31d6d5eead48e5bfe76" args="(int parent_index) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTAnalysedPulse.html">TAnalysedPulse</a>* TVAnalysedPulseGenerator::MakeNewTAP </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>parent_index</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00073">73</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00073"></a>00073                                                          {
<a name="l00074"></a>00074             <span class="keywordflow">return</span> MakeNewTAP&lt;TAnalysedPulse&gt;(parent_index);
<a name="l00075"></a>00075         }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afc3b7aa35f52b3c404490a0ca782c487"></a><!-- doxytag: member="TemplateConvolveAPGenerator::MakeNewTAP" ref="afc3b7aa35f52b3c404490a0ca782c487" args="(int parent_index) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TypeOfTAP &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">TypeOfTAP * TVAnalysedPulseGenerator::MakeNewTAP </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>parent_index</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The suggested method for constructing a new TAP. </p>
<p>In the process of constructing TAP, information that isn't immediately obvious how to get needs to be passed to TAP. This method returns a pointer to a TAP construced for you, and all you need to pass it is the TPulseIslandID.</p>
<p>In the case where a generator wants to add extra information to the standard TAP information, we expect people to derive from <a class="el" href="classTAnalysedPulse.html" title="A TAnalysedPulse (TAP) is the product of the second level of analysis in the framework...">TAnalysedPulse</a>. If your generator is one of these, then use the template argument to produce the type of TAP you desire. Note that this forces the constructor of the specialised TAP to be the same as for <a class="el" href="classTAnalysedPulse.html" title="A TAnalysedPulse (TAP) is the product of the second level of analysis in the framework...">TAnalysedPulse</a> itself.</p>
<p>For example, for to make a specialied analysed pulse called TSpecialAnalysedPulse (original, huh?) you would do: </p>
<div class="fragment"><pre class="fragment"> TSpecialAnalysedPulse* tsap=MakeNewTAP&lt;TSpecialAnalysedPulse&gt;(parent_index);
</pre></div><dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parent_index</em>&nbsp;</td><td>The TPulseIslandID of the TPI being used to make the new TAP. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Template Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in]</em>&nbsp;</td><td>TypeOfTAP The type of specialisation of <a class="el" href="classTAnalysedPulse.html" title="A TAnalysedPulse (TAP) is the product of the second level of analysis in the framework...">TAnalysedPulse</a> that you want to create. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00137">137</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00128">TVAnalysedPulseGenerator::fPulseList</a>, and <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00094">TVAnalysedPulseGenerator::GetSource()</a>.</p>

<p>Referenced by <a class="el" href="FirstCompleteAPGenerator_8cpp_source.html#l00065">FirstCompleteAPGenerator::AnalyseOneTpi()</a>, <a class="el" href="SimpIntAPGenerator_8cpp_source.html#l00017">SimpIntAPGenerator::ProcessPulses()</a>, <a class="el" href="MaxBinAPGenerator_8cpp_source.html#l00031">MaxBinAPGenerator::ProcessPulses()</a>, <a class="el" href="CFTimeMBAmpAPGenerator_8cpp_source.html#l00030">CFTimeMBAmpAPGenerator::ProcessPulses()</a>, and <a class="el" href="CFTimeAPGenerator_8cpp_source.html#l00031">CFTimeAPGenerator::ProcessPulses()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00137"></a>00137                                                                            {
<a name="l00138"></a>00138     TypeOfTAP* pulse=NULL;
<a name="l00139"></a>00139     <a class="code" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a>* parent = <a class="code" href="classTVAnalysedPulseGenerator.html#a8babd0263da73f145432f8865d918fe9" title="The vector of TPIs being processed.">fPulseList</a>-&gt;at(parent_index);
<a name="l00140"></a>00140     pulse=<span class="keyword">new</span> TypeOfTAP(<a class="code" href="classTVAnalysedPulseGenerator.html#a1287e301f1b02e8b9821a8eeda30e484" title="Get the source id for this generator being used on the current channel.">GetSource</a>(),parent_index,parent);
<a name="l00141"></a>00141     <span class="keywordflow">return</span> pulse;
<a name="l00142"></a>00142 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a21415504937f75ebd87fe7dfe35d6590"></a><!-- doxytag: member="TemplateConvolveAPGenerator::MayDivideTPIs" ref="a21415504937f75ebd87fe7dfe35d6590" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool TemplateConvolveAPGenerator::MayDivideTPIs </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Document this </dd></dl>

<p>Implements <a class="el" href="classTVAnalysedPulseGenerator.html#a44b71be7412768b797f268de1551e9b7">TVAnalysedPulseGenerator</a>.</p>

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00024">24</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00024"></a>00024 {<span class="keywordflow">return</span> <span class="keyword">true</span>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="abe4fee0fefc2b30512f271c9a867f4d2"></a><!-- doxytag: member="TemplateConvolveAPGenerator::PassesIntegralRatio" ref="abe4fee0fefc2b30512f271c9a867f4d2" args="(const TPulseIsland *pulse, double &amp;integral, double &amp;ratio) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TemplateConvolveAPGenerator::PassesIntegralRatio </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTPulseIsland.html">TPulseIsland</a> *&nbsp;</td>
          <td class="paramname"> <em>pulse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>integral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>ratio</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00122">122</a> of file <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html">TemplateConvolveAPGenerator.cpp</a>.</p>

<p>References <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00047">fIntegralRatio</a>, <a class="el" href="TAPAlgorithms_8h_source.html#l00093">Algorithm::IntegralRatio::GetRatio()</a>, <a class="el" href="TAPAlgorithms_8h_source.html#l00094">Algorithm::IntegralRatio::GetTotal()</a>, and <a class="el" href="TAPAlgorithms_8cpp_source.html#l00086">Algorithm::IntegralRatio::SetPedestalToMinimum()</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00122"></a>00122                                                                                                                     {
<a name="l00123"></a>00123    <span class="keywordflow">if</span>(!<a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00124"></a>00124    <span class="keywordflow">try</span>{
<a name="l00125"></a>00125      <a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>-&gt;<a class="code" href="structAlgorithm_1_1IntegralRatio.html#a9813d43050fb0de752f05d310e6401c5">SetPedestalToMinimum</a>(pulse);
<a name="l00126"></a>00126      (*fIntegralRatio)(pulse);
<a name="l00127"></a>00127    }<span class="keywordflow">catch</span>(std::out_of_range&amp; e){
<a name="l00128"></a>00128      <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00129"></a>00129    }
<a name="l00130"></a>00130    integral=<a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>-&gt;<a class="code" href="structAlgorithm_1_1IntegralRatio.html#af3648d5626cf023cdbdb90a6b35a3f8c">GetTotal</a>();
<a name="l00131"></a>00131    ratio=<a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>-&gt;<a class="code" href="structAlgorithm_1_1IntegralRatio.html#a8b568d96aa03cd45747934f231c9a3de">GetRatio</a>();
<a name="l00132"></a>00132    <span class="keywordflow">if</span>( fIntegralMax &lt; integral || fIntegralMin &gt; integral
<a name="l00133"></a>00133        || fIntegralRatioMax &lt; ratio || fIntegralRatioMin &gt; ratio) {
<a name="l00134"></a>00134        <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00135"></a>00135    }
<a name="l00136"></a>00136    <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00137"></a>00137 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac19a5a546024821b51b80e652cc99aa9"></a><!-- doxytag: member="TemplateConvolveAPGenerator::ProcessPulses" ref="ac19a5a546024821b51b80e652cc99aa9" args="(const PulseIslandList &amp;, AnalysedPulseList &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TemplateConvolveAPGenerator::ProcessPulses </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="definitions_8h.html#a3c0940832f8741b0c226a24e3dbd62a8">PulseIslandList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="definitions_8h.html#a84eeb2f0ab9f7a76f210530739f1bd1d">AnalysedPulseList</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>apl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This method is called on each vector of pulses from a MIDAS event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pil</em>&nbsp;</td><td>The vector of TPIs to produce TAPs from. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>apl</em>&nbsp;</td><td>The vector of TAPs to append the new TAPs to. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classTVAnalysedPulseGenerator.html#a1099fae9972c00150ef6687e067e5a10">TVAnalysedPulseGenerator</a>.</p>

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">54</a> of file <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html">TemplateConvolveAPGenerator.cpp</a>.</p>

<p>References <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00139">CalibrateTime()</a>, <a class="el" href="TemplateConvolver_8cpp_source.html#l00034">TemplateConvolver::Convolve()</a>, <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00077">TVAnalysedPulseGenerator::Debug()</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00038">fConvolver</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00045">fExpectPileUp</a>, <a class="el" href="TemplateConvolver_8cpp_source.html#l00059">TemplateConvolver::FindPeaks()</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00047">fIntegralRatio</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00043">fPedestal</a>, <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00037">fTemplate</a>, <a class="el" href="TemplateConvolver_8h_source.html#l00055">TemplateConvolver::GetAmplitudeScale()</a>, <a class="el" href="TemplateConvolver_8h_source.html#l00050">TemplateConvolver::GetEnergyConvolution()</a>, <a class="el" href="TemplateConvolver_8h_source.html#l00052">TemplateConvolver::GetPeaks()</a>, <a class="el" href="TemplateConvolver_8h_source.html#l00051">TemplateConvolver::GetTimeConvolution()</a>, <a class="el" href="TemplateConvolver_8h_source.html#l00053">TemplateConvolver::GetTimeShift()</a>, <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00122">PassesIntegralRatio()</a>, <a class="el" href="TAnalysedPulse_8h_source.html#l00120">TAnalysedPulse::SetAmplitude()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00059">TTemplateConvolveAnalysedPulse::SetAmplitudeScale()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00062">TTemplateConvolveAnalysedPulse::SetEnergyConvolve()</a>, <a class="el" href="TAnalysedPulse_8h_source.html#l00122">TAnalysedPulse::SetIntegral()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00060">TTemplateConvolveAnalysedPulse::SetIntegralRatio()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00056">TTemplateConvolveAnalysedPulse::SetNPeaks()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00057">TTemplateConvolveAnalysedPulse::SetPeakRank()</a>, <a class="el" href="TAnalysedPulse_8h_source.html#l00124">TAnalysedPulse::SetPedestal()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00061">TTemplateConvolveAnalysedPulse::SetQuadraticFit()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00064">TTemplateConvolveAnalysedPulse::SetTemplate()</a>, <a class="el" href="TAnalysedPulse_8h_source.html#l00121">TAnalysedPulse::SetTime()</a>, <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00063">TTemplateConvolveAnalysedPulse::SetTimeConvolve()</a>, and <a class="el" href="TTemplateConvolveAnalysedPulse_8h_source.html#l00058">TTemplateConvolveAnalysedPulse::SetTimeOffset()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00056"></a>00056                                     {
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="comment">// Loop over all the TPIs given to us</span>
<a name="l00059"></a>00059   <span class="keywordtype">double</span> integral, ratio;
<a name="l00060"></a>00060   <a class="code" href="classTTemplateConvolveAnalysedPulse.html">TTemplateConvolveAnalysedPulse</a>* tap;
<a name="l00061"></a>00061   <span class="keywordflow">for</span> (<a class="code" href="namespacemodules.html#aecc7811d5380ed9d9e903c9b71a396aa">PulseIslandList::const_iterator</a> tpi=pulseList.begin();
<a name="l00062"></a>00062        tpi!=pulseList.end(); tpi++){
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <span class="comment">// Check integral ratio if we&apos;re supposed to</span>
<a name="l00065"></a>00065     <span class="keywordflow">if</span>(<a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a> &amp;&amp; !<a class="code" href="classTemplateConvolveAPGenerator.html#abe4fee0fefc2b30512f271c9a867f4d2">PassesIntegralRatio</a>(*tpi, integral,ratio)){
<a name="l00066"></a>00066        <span class="keywordflow">continue</span>;
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068     <a class="code" href="structAlgorithm_1_1Pedestal__iterator.html">Algorithm::TpiMinusPedestal_iterator</a> waveform((*tpi)-&gt;GetSamples().begin(),<a class="code" href="classTemplateConvolveAPGenerator.html#a14bba092e78ccc105a36a92c247a0983">fPedestal</a>);
<a name="l00069"></a>00069     <a class="code" href="structAlgorithm_1_1Pedestal__iterator.html">Algorithm::TpiMinusPedestal_iterator</a> end((*tpi)-&gt;GetSamples().end());
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <span class="comment">// convolve with the template</span>
<a name="l00072"></a>00072     <span class="keywordtype">int</span> n_peaks=<a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#a0f486f0559582c400bcb0343d109547a">Convolve</a>(waveform,end );
<a name="l00073"></a>00073     <span class="keywordflow">if</span>(n_peaks&lt;0) {
<a name="l00074"></a>00074       <span class="keywordflow">if</span>(<a class="code" href="classTVAnalysedPulseGenerator.html#ab435ccf776a3bf0dd6d2177d0ec09908">Debug</a>())cout&lt;&lt;<span class="stringliteral">&quot;Waveform too small to analyze&quot;</span>&lt;&lt;endl;
<a name="l00075"></a>00075       <span class="keywordflow">continue</span>;
<a name="l00076"></a>00076     }
<a name="l00077"></a>00077     n_peaks= <a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#ad1a51e4cb07b44be0f949e13f9d4d2c2">FindPeaks</a>(<a class="code" href="classTemplateConvolveAPGenerator.html#a8fe99241e41e2e7246d6cf14c72dbda0">fExpectPileUp</a> , waveform);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <span class="keyword">const</span> <a class="code" href="classTemplateConvolver.html#a0825111cf4a6bf4cb3755b36c1e100e8">TemplateConvolver::PeaksVector</a>&amp; peaks=<a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#a4c680507b3cb7c076c2891125401abd7">GetPeaks</a>();
<a name="l00080"></a>00080     <span class="keywordtype">int</span> count=0;
<a name="l00081"></a>00081     <span class="keywordflow">for</span>(<a class="code" href="namespacemodules.html#aecc7811d5380ed9d9e903c9b71a396aa">TemplateConvolver::PeaksVector::const_iterator</a> i_tap=peaks.begin();
<a name="l00082"></a>00082           i_tap!=peaks.end(); ++i_tap){
<a name="l00083"></a>00083     <span class="comment">//for(int i_peak=0; i_peak&lt;3 || fConvolver-&gt;GetPeaks().size()==0 ; ++i_peak){</span>
<a name="l00084"></a>00084     <span class="comment">//   // get the first pulse to be found</span>
<a name="l00085"></a>00085     <span class="comment">//   const TemplateConvolver::FoundPeaks&amp; i_tap=*fConvolver-&gt;GetPeaks().begin();</span>
<a name="l00086"></a>00086     
<a name="l00087"></a>00087        <span class="comment">// Make a new TAP to store the data.  This method makes a TAP and sets the parent TPI info.  It needs</span>
<a name="l00088"></a>00088        <span class="comment">// the index of the parent TPI in the container as an argument</span>
<a name="l00089"></a>00089        tap = MakeNewTAP&lt;TTemplateConvolveAnalysedPulse&gt;(tpi-pulseList.begin());
<a name="l00090"></a>00090        <span class="keywordflow">if</span>(<a class="code" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">fIntegralRatio</a>){
<a name="l00091"></a>00091          tap-&gt;<a class="code" href="classTAnalysedPulse.html#a344fa582147a1071867aa5447adba82e">SetIntegral</a>(integral);
<a name="l00092"></a>00092          tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#a4f6ba3051396c1a0fbd2a23d4df1260d">SetIntegralRatio</a>(ratio);
<a name="l00093"></a>00093        }
<a name="l00094"></a>00094        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#ab54faf7a527fe4b6dd06581b33131ad7">SetNPeaks</a>(n_peaks);
<a name="l00095"></a>00095        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#ac93d966ca7253ee163560fa7bd6fbc7b">SetPeakRank</a>(count);
<a name="l00096"></a>00096        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#adc2470f7291d34f118175c27d50fbce8">SetEnergyConvolve</a>(<a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#a58e602488e829e349056054b59966382">GetEnergyConvolution</a>());
<a name="l00097"></a>00097        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#a75a7376513b3f5fa60c5381a5dd0acdf">SetTimeConvolve</a>(<a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#ab56c7920ace67c2924ec47068fa523ee">GetTimeConvolution</a>());
<a name="l00098"></a>00098        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#a4256921fa4a7604ca147a4ab37d9b19a">SetTimeOffset</a>(i_tap-&gt;time);
<a name="l00099"></a>00099        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#afd71957b541580b34fa8f708f0cf1308">SetAmplitudeScale</a>(i_tap-&gt;amplitude);
<a name="l00100"></a>00100        tap-&gt;<a class="code" href="classTAnalysedPulse.html#a742835f893719699c939dee49e9cf68a">SetAmplitude</a>(i_tap-&gt;amplitude*<a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#ab90d4c168318759b408ac6bd458919b4">GetAmplitudeScale</a>());
<a name="l00101"></a>00101        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#a6fe9e83edc990ebe106921607464e7a5">SetQuadraticFit</a>(i_tap-&gt;quad,i_tap-&gt;linear, i_tap-&gt;constant);
<a name="l00102"></a>00102        tap-&gt;<a class="code" href="classTTemplateConvolveAnalysedPulse.html#a335a776534bae41dd6dc9fc353c769dc">SetTemplate</a>(<a class="code" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">fTemplate</a>);
<a name="l00103"></a>00103        tap-&gt;<a class="code" href="classTAnalysedPulse.html#af148b41573263082e7b453418af173c3">SetPedestal</a>(<a class="code" href="classTemplateConvolveAPGenerator.html#a14bba092e78ccc105a36a92c247a0983">fPedestal</a>);
<a name="l00104"></a>00104        <span class="keywordtype">double</span> time= <a class="code" href="classTemplateConvolveAPGenerator.html#a9ab6f6e29ddd79ffae6298e3afebe632" title="Convert time from clock time within the TPI to real time.">CalibrateTime</a>(i_tap-&gt;time + <a class="code" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">fConvolver</a>-&gt;<a class="code" href="classTemplateConvolver.html#aa5702c80c759394897e6e88279a9ef0e">GetTimeShift</a>() +0.5, *tpi);
<a name="l00105"></a>00105        tap-&gt;<a class="code" href="classTAnalysedPulse.html#a7924392fb4dda29840ee2e569e8919fd">SetTime</a>(time);
<a name="l00106"></a>00106        <span class="comment">//DEBUG_VALUE(i_tap-&gt;amplitude, i_tap-&gt;time, i_tap-&gt;pedestal);</span>
<a name="l00107"></a>00107 
<a name="l00108"></a>00108        <span class="comment">// Finally add the new TAP to the output list</span>
<a name="l00109"></a>00109        analysedList.push_back(tap);
<a name="l00110"></a>00110 
<a name="l00112"></a>00112        <span class="comment">//waveform.AddHistogram(fConvolver-&gt;GetTemplateACF(), i_tap.amplitude, -i_tap.time+fConvolver-&gt;GetLeftSafety());</span>
<a name="l00113"></a>00113        <span class="comment">//n_peaks= fConvolver-&gt;Convolve(waveform,end );</span>
<a name="l00114"></a>00114        <span class="comment">//if(n_peaks==0) break;</span>
<a name="l00115"></a>00115        count++;
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117   }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119   <span class="keywordflow">return</span> 0;
<a name="l00120"></a>00120 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a96d9ffc0889d659fb376ae93bb17ca76"></a><!-- doxytag: member="TemplateConvolveAPGenerator::SetChannel" ref="a96d9ffc0889d659fb376ae93bb17ca76" args="(const std::string &amp;det)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void TVAnalysedPulseGenerator::SetChannel </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>det</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the channel for this generator. Should NOT be called by user code. </p>
<p>Called by <a class="el" href="classMakeAnalysedPulses.html">MakeAnalysedPulses</a> to tell this generator what channel it is looking at. </p>

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00108">108</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="IdSource_8h_source.html#l00090">IDs::source::Channel()</a>, <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00121">TVAnalysedPulseGenerator::fBankName</a>, <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00111">TVAnalysedPulseGenerator::fSource</a>, <a class="el" href="SetupNavigator_8cpp_source.html#l00063">SetupNavigator::GetBank()</a>, and <a class="el" href="SetupNavigator_8h_source.html#l00105">SetupNavigator::Instance()</a>.</p>

<p>Referenced by <a class="el" href="TVAnalysedPulseGenerator_8cpp_source.html#l00005">TVAnalysedPulseGenerator::TVAnalysedPulseGenerator()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00108"></a>00108                                                      {
<a name="l00109"></a>00109            <a class="code" href="classTVAnalysedPulseGenerator.html#a11fa0f36e3fe2db1aca5c963132e5a69" title="The source identifying the generator and detector being processed.">fSource</a>.<a class="code" href="classIDs_1_1source.html#a5cc6b4375e7d2c6dc171a5fca8da94f7" title="Get a reference to the channel ID in this source.">Channel</a>()=det;
<a name="l00110"></a>00110            <a class="code" href="classTVAnalysedPulseGenerator.html#a95086001e5c86eb2c992372c39c96b52" title="The bankname in the MIDAS file used by this channel.">fBankName</a>= <a class="code" href="classSetupNavigator.html#acc09765c4d2ca0e1205977075bd7eb49">SetupNavigator::Instance</a>()-&gt;<a class="code" href="classSetupNavigator.html#a52a414db348d8963a712c90e4ece561a">GetBank</a>(det);
<a name="l00111"></a>00111          };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a52fbd858d4ea72d672d8ef6a91b1310f"></a><!-- doxytag: member="TemplateConvolveAPGenerator::SetPulseList" ref="a52fbd858d4ea72d672d8ef6a91b1310f" args="(PulseIslandList *list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TVAnalysedPulseGenerator::SetPulseList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="definitions_8h.html#a3c0940832f8741b0c226a24e3dbd62a8">PulseIslandList</a> *&nbsp;</td>
          <td class="paramname"> <em>list</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00044">44</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

<p>References <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00128">TVAnalysedPulseGenerator::fPulseList</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00044"></a>00044 {<a class="code" href="classTVAnalysedPulseGenerator.html#a8babd0263da73f145432f8865d918fe9" title="The vector of TPIs being processed.">fPulseList</a>=<a class="code" href="namespacemodules.html#ad4b4c82a2af83370510aa8b5006283f3">list</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2a218897c76b5f7637ffaea374aa8d87"></a><!-- doxytag: member="TemplateConvolveAPGenerator::TapType" ref="a2a218897c76b5f7637ffaea374aa8d87" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static const char* TemplateConvolveAPGenerator::TapType </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classTVAnalysedPulseGenerator.html#a63fc78543a84775eeeac6d293c09bb09">TVAnalysedPulseGenerator</a>.</p>

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00026">26</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00026"></a>00026                                 {
<a name="l00027"></a>00027        <span class="keywordflow">return</span> TTemplateConvolveAnalysedPulse::Class()-&gt;GetName();
<a name="l00028"></a>00028    }
</pre></div></p>

</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a32411abab614529fa147b2ce1736199e"></a><!-- doxytag: member="TemplateConvolveAPGenerator::MakeAnalysedPulses" ref="a32411abab614529fa147b2ce1736199e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classMakeAnalysedPulses.html">MakeAnalysedPulses</a><code> [friend, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TVAnalysedPulseGenerator_8h_source.html#l00101">101</a> of file <a class="el" href="TVAnalysedPulseGenerator_8h_source.html">TVAnalysedPulseGenerator.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa2fe10f694aa10869fd348464b4aa037"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fConvolver" ref="aa2fe10f694aa10869fd348464b4aa037" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTemplateConvolver.html">TemplateConvolver</a>* <a class="el" href="classTemplateConvolveAPGenerator.html#aa2fe10f694aa10869fd348464b4aa037">TemplateConvolveAPGenerator::fConvolver</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00038">38</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>, and <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a8fe99241e41e2e7246d6cf14c72dbda0"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fExpectPileUp" ref="a8fe99241e41e2e7246d6cf14c72dbda0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classTemplateConvolveAPGenerator.html#a8fe99241e41e2e7246d6cf14c72dbda0">TemplateConvolveAPGenerator::fExpectPileUp</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00045">45</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>.</p>

</div>
</div>
<a class="anchor" id="a89a88ffa21ff57d3ce55702408b2566c"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fIntegralMax" ref="a89a88ffa21ff57d3ce55702408b2566c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a89a88ffa21ff57d3ce55702408b2566c">TemplateConvolveAPGenerator::fIntegralMax</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00040">40</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="acdb6a35bf9fbfab0a212a0b7d0e3e9c6"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fIntegralMin" ref="acdb6a35bf9fbfab0a212a0b7d0e3e9c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#acdb6a35bf9fbfab0a212a0b7d0e3e9c6">TemplateConvolveAPGenerator::fIntegralMin</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00040">40</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a48db340a03ac9696410e71890ea63c83"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fIntegralRatio" ref="a48db340a03ac9696410e71890ea63c83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAlgorithm_1_1IntegralRatio.html">Algorithm::IntegralRatio</a>* <a class="el" href="classTemplateConvolveAPGenerator.html#a48db340a03ac9696410e71890ea63c83">TemplateConvolveAPGenerator::fIntegralRatio</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00047">47</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00122">PassesIntegralRatio()</a>, <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>, and <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a6e8a5868d1d163f6ba7b02f0505f2652"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fIntegralRatioMax" ref="a6e8a5868d1d163f6ba7b02f0505f2652" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a6e8a5868d1d163f6ba7b02f0505f2652">TemplateConvolveAPGenerator::fIntegralRatioMax</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00041">41</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a60b3f6dbc9715918ad199ce95ca01256"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fIntegralRatioMin" ref="a60b3f6dbc9715918ad199ce95ca01256" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a60b3f6dbc9715918ad199ce95ca01256">TemplateConvolveAPGenerator::fIntegralRatioMin</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00041">41</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a8caef28a3ea424d812a44e01a643166a"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fMuScTimeOffset" ref="a8caef28a3ea424d812a44e01a643166a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a8caef28a3ea424d812a44e01a643166a">TemplateConvolveAPGenerator::fMuScTimeOffset</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00044">44</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00139">CalibrateTime()</a>.</p>

</div>
</div>
<a class="anchor" id="a14bba092e78ccc105a36a92c247a0983"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fPedestal" ref="a14bba092e78ccc105a36a92c247a0983" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a14bba092e78ccc105a36a92c247a0983">TemplateConvolveAPGenerator::fPedestal</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00043">43</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>.</p>

</div>
</div>
<a class="anchor" id="a73692b772f28ab03dcc7ac894dc90e4c"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTemplate" ref="a73692b772f28ab03dcc7ac894dc90e4c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTTemplate.html">TTemplate</a>* <a class="el" href="classTemplateConvolveAPGenerator.html#a73692b772f28ab03dcc7ac894dc90e4c">TemplateConvolveAPGenerator::fTemplate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00037">37</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00054">ProcessPulses()</a>, and <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="a81e37796b0d9d9cffd46ee423dd7d376"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTemplateAmp" ref="a81e37796b0d9d9cffd46ee423dd7d376" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#a81e37796b0d9d9cffd46ee423dd7d376">TemplateConvolveAPGenerator::fTemplateAmp</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00042">42</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

</div>
</div>
<a class="anchor" id="acbe19bf5c437e2b1e3e4ac6a69c0a272"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTemplateArchive" ref="acbe19bf5c437e2b1e3e4ac6a69c0a272" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTemplateArchive.html">TemplateArchive</a> * <a class="el" href="classTemplateConvolveAPGenerator.html#acbe19bf5c437e2b1e3e4ac6a69c0a272">TemplateConvolveAPGenerator::fTemplateArchive</a> = NULL<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00036">36</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00016">TemplateConvolveAPGenerator()</a>.</p>

</div>
</div>
<a class="anchor" id="abb0e5f86e7240eb335bc7aa2edffa583"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTemplatePed" ref="abb0e5f86e7240eb335bc7aa2edffa583" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#abb0e5f86e7240eb335bc7aa2edffa583">TemplateConvolveAPGenerator::fTemplatePed</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00042">42</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae473032cc73c22f814f85656a936c070"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTemplateTime" ref="ae473032cc73c22f814f85656a936c070" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#ae473032cc73c22f814f85656a936c070">TemplateConvolveAPGenerator::fTemplateTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00042">42</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

</div>
</div>
<a class="anchor" id="af515daf74195dfc4c53f0b68311ab9c0"></a><!-- doxytag: member="TemplateConvolveAPGenerator::fTicksPerNs" ref="af515daf74195dfc4c53f0b68311ab9c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classTemplateConvolveAPGenerator.html#af515daf74195dfc4c53f0b68311ab9c0">TemplateConvolveAPGenerator::fTicksPerNs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="TemplateConvolveAPGenerator_8h_source.html#l00044">44</a> of file <a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html#l00139">CalibrateTime()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>rootana/src/TAP_generators/<a class="el" href="TemplateConvolveAPGenerator_8h_source.html">TemplateConvolveAPGenerator.h</a></li>
<li>rootana/src/TAP_generators/<a class="el" href="TemplateConvolveAPGenerator_8cpp_source.html">TemplateConvolveAPGenerator.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 29 Jun 2015 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
