<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: midas/mscb/embedded/subm_300.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/mscb/embedded/subm_300.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="mscb_8h_source.html">mscb.h</a>&quot;</code><br/>

<p><a href="subm__300_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a>&nbsp;&nbsp;&nbsp;<a class="el" href="c8051F320_8h.html#a064e921a8b02f66fd1e90b6b36298773">P1</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a7dfd9b79bc5a37d7df40207afbc5431f">setup</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a6eb4ef98b98e79010079f1c0097741b3">serial_int</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#ab9d72c9680784fd5448a14266dde697e">check_lpt</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#aa8cf6d5c3a4cd2dc89b00e0640047c71">check_rs485</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a58c8b2ad0ea491a6642e5e1cbd358c89">yield</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667">main</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a525c7d69d4a55d502b0d18c0603ebf29">LPT_BUSY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 7</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 6</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a14bbef42fa7709683afd9dd99e8228ac">LPT_BIT9</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char xdata *<a class="el" href="odbedit_8c.html#a8c6d6f90e1d6932f65c6f43d2f9d49a7">data</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char xdata *<a class="el" href="odbedit_8c.html#a8c6d6f90e1d6932f65c6f43d2f9d49a7">data</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMSCB__INFO__VAR.html">MSCB_INFO_VAR</a> code&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#a900ff3a8ccab65692c28b012e3824819">variables</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSYS__INFO.html">SYS_INFO</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="subm__300_8c.html#abf06fefcfd184511a38e909e5a4111c0">sys_info</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a6af65dc12cf6bc85ad69e35c8e2ac021"></a><!-- doxytag: member="subm_300.c::LPT_DATA" ref="a6af65dc12cf6bc85ad69e35c8e2ac021" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LPT_DATA&nbsp;&nbsp;&nbsp;<a class="el" href="c8051F320_8h.html#a064e921a8b02f66fd1e90b6b36298773">P1</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00065">65</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab9d72c9680784fd5448a14266dde697e"></a><!-- doxytag: member="subm_300.c::check_lpt" ref="ab9d72c9680784fd5448a14266dde697e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_lpt </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00181">181</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="mscbutil_8c_source.html#l00788">led_blink()</a>, <a class="el" href="mscb_8c_source.html#l00322">LPT_BIT9</a>, <a class="el" href="mscb_8c_source.html#l00325">LPT_BUSY</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, <a class="el" href="subm__300_8c_source.html#l00067">LPT_NSTROBE</a>, <a class="el" href="embedded_2mscb_8h_source.html#l00285">SBUF0</a>, <a class="el" href="c8051F020_8h_source.html#l00156">TB80</a>, <a class="el" href="subm__300_8c_source.html#l00081">ti_shadow</a>, <a class="el" href="CAET_8h_source.html#l00002">time</a>, and <a class="el" href="mscbutil_8c_source.html#l00862">watchdog_refresh()</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00313">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00182"></a>00182 {
<a name="l00183"></a>00183    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte;
<a name="l00184"></a>00184    bit bit9;
<a name="l00185"></a>00185    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> t;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187    <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> == 1)
<a name="l00188"></a>00188       <span class="keywordflow">return</span>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190    <a class="code" href="embedded_2mscb_8h.html#a431cf0a502f2a232e27f81080a890585">led_blink</a>(0, 1, 50);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192    <span class="comment">/* receive new data */</span>
<a name="l00193"></a>00193    byte = <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a>;
<a name="l00194"></a>00194    bit9 = <a class="code" href="mscb_8c.html#aafc451f66099eadd66b93da2201893b8">LPT_BIT9</a>;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196    <span class="comment">/* signal busy to PC */</span>
<a name="l00197"></a>00197    <a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> = 1;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199    <span class="comment">/* send byte to serial port, flash LED */</span>
<a name="l00200"></a>00200    RS485_ENABLE = 1;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202    <a class="code" href="c8051F020_8h.html#a3390e7814720434f61dc6b7db592639c">TB80</a> = bit9;
<a name="l00203"></a>00203    <a class="code" href="embedded_2mscb_8h.html#a194a6d4c7e8cb3cf91b24b51708fc4fe">SBUF0</a> = byte;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205    <span class="keywordflow">while</span> (!<a class="code" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a>);          <span class="comment">/* wait until interrupt routine acknowledged send */</span>
<a name="l00206"></a>00206 
<a name="l00207"></a>00207    RS485_ENABLE = 0;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209    <a class="code" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a> = 0;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211    t = <a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>();
<a name="l00212"></a>00212    <span class="keywordflow">while</span> (<a class="code" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> == 0) {   <span class="comment">/* wait for strobe to be removed */</span>
<a name="l00213"></a>00213       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();       <span class="comment">/* can take very long (if PC gets context switch) */</span>
<a name="l00214"></a>00214       <span class="keywordflow">if</span> (<a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>() - t &gt; 100)
<a name="l00215"></a>00215          <span class="keywordflow">break</span>;
<a name="l00216"></a>00216    }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218    <span class="comment">/* remove busy */</span>
<a name="l00219"></a>00219    <a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> = 0;
<a name="l00220"></a>00220 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8cf6d5c3a4cd2dc89b00e0640047c71"></a><!-- doxytag: member="subm_300.c::check_rs485" ref="aa8cf6d5c3a4cd2dc89b00e0640047c71" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_rs485 </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00224">224</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="mscbutil_8c_source.html#l00788">led_blink()</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, <a class="el" href="subm__300_8c_source.html#l00070">LPT_NACK</a>, <a class="el" href="subm__300_8c_source.html#l00069">LPT_NDATAREADY</a>, <a class="el" href="subm__300_8c_source.html#l00067">LPT_NSTROBE</a>, <a class="el" href="c8051F020_8h_source.html#l00050">P1MDOUT</a>, <a class="el" href="subm__300_8c_source.html#l00078">rbuf_rp</a>, <a class="el" href="subm__300_8c_source.html#l00079">rbuf_wp</a>, <a class="el" href="CAET_8h_source.html#l00002">time</a>, and <a class="el" href="mscbutil_8c_source.html#l00862">watchdog_refresh()</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00313">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00225"></a>00225 {
<a name="l00226"></a>00226    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> byte;
<a name="l00227"></a>00227    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> t;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229    <span class="comment">/* return if no data in buffer */</span>
<a name="l00230"></a>00230    <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> == <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a>)
<a name="l00231"></a>00231       <span class="keywordflow">return</span>;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233    <span class="comment">/* abort if PC strobe is active to avoid data collision */</span>
<a name="l00234"></a>00234    <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> == 0)
<a name="l00235"></a>00235       <span class="keywordflow">return</span>;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237    <a class="code" href="embedded_2mscb_8h.html#a431cf0a502f2a232e27f81080a890585">led_blink</a>(1, 1, 50);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239    <span class="comment">/* get received byte */</span>
<a name="l00240"></a>00240    byte = *<a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a>;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242    <span class="comment">/* increment read pointer with wrap around at 1024 bytes */</span>
<a name="l00243"></a>00243    <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a> = <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a> + 1;
<a name="l00244"></a>00244    <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a> == 0x400)
<a name="l00245"></a>00245       <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a> = 0;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247    <span class="comment">/* signal new data to PC */</span>
<a name="l00248"></a>00248    <a class="code" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = 0;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250    <span class="comment">/* wait for PC switched to input with 1s timeout */</span>
<a name="l00251"></a>00251    t = <a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>();
<a name="l00252"></a>00252    <span class="keywordflow">while</span> (<a class="code" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> == 1) {
<a name="l00253"></a>00253       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00254"></a>00254       <span class="keywordflow">if</span> (<a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>() - t &gt; 100)
<a name="l00255"></a>00255          <span class="keywordflow">break</span>;
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258    <span class="comment">/* switch port to push-pull */</span>
<a name="l00259"></a>00259    <a class="code" href="c8051F020_8h.html#af84b3723b32d7bec0c5e383450deb42a">P1MDOUT</a> = 0xFF;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261    <span class="comment">/* output data to PC */</span>
<a name="l00262"></a>00262    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = byte;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264    <span class="comment">/* remove data ready */</span>
<a name="l00265"></a>00265    <a class="code" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = 1;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267    <span class="comment">/* wait until PC has data read with 1s timeout */</span>
<a name="l00268"></a>00268    t = <a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>();
<a name="l00269"></a>00269    <span class="keywordflow">while</span> (<a class="code" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> == 0) {
<a name="l00270"></a>00270       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00271"></a>00271       <span class="keywordflow">if</span> (<a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>() - t &gt; 100)
<a name="l00272"></a>00272          <span class="keywordflow">break</span>;
<a name="l00273"></a>00273    }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275    <span class="comment">/* switch port to open-drain */</span>
<a name="l00276"></a>00276    <a class="code" href="c8051F020_8h.html#af84b3723b32d7bec0c5e383450deb42a">P1MDOUT</a> = 0x00;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278    <span class="comment">/* prepare port for input */</span>
<a name="l00279"></a>00279    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = 0xFF;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281    <span class="comment">/* cause PC switch port to output */</span>
<a name="l00282"></a>00282    <a class="code" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = 0;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    <span class="comment">/* wait for PC switched to output */</span>
<a name="l00285"></a>00285    <span class="keywordflow">while</span> (<a class="code" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> == 1)
<a name="l00286"></a>00286       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00287"></a>00287 
<a name="l00288"></a>00288    <span class="comment">/* reset data ready */</span>
<a name="l00289"></a>00289    <a class="code" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = 1;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291    <span class="comment">/* wait for end of cycle with 1s timeout */</span>
<a name="l00292"></a>00292    t = <a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>();
<a name="l00293"></a>00293    <span class="keywordflow">while</span> (<a class="code" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> == 0) {
<a name="l00294"></a>00294       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00295"></a>00295       <span class="keywordflow">if</span> (<a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>() - t &gt; 100)
<a name="l00296"></a>00296          <span class="keywordflow">break</span>;
<a name="l00297"></a>00297    }
<a name="l00298"></a>00298 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6288eba0f8e8ad3ab1544ad731eb7667"></a><!-- doxytag: member="subm_300.c::main" ref="a6288eba0f8e8ad3ab1544ad731eb7667" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00313">313</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="subm__300_8c_source.html#l00181">check_lpt()</a>, <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, <a class="el" href="mscb_8c_source.html#l00325">LPT_BUSY</a>, <a class="el" href="mscbmain_8c_source.html#l00263">setup()</a>, <a class="el" href="embedded_2mscb_8h_source.html#l00286">TI0</a>, <a class="el" href="subm__300_8c_source.html#l00081">ti_shadow</a>, and <a class="el" href="mscbutil_8c_source.html#l00862">watchdog_refresh()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00314"></a>00314 {
<a name="l00315"></a>00315    <a class="code" href="mscbmain_8c.html#a7dfd9b79bc5a37d7df40207afbc5431f">setup</a>();
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    <a class="code" href="embedded_2mscb_8h.html#a7344b3875ef40c3cd59eafcfd541418b">TI0</a> = 0;
<a name="l00318"></a>00318    <a class="code" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a> = 0;
<a name="l00319"></a>00319    RS485_ENABLE = 0;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321    <a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> = 0;                <span class="comment">/* indicate ready to receive LPT data */</span>
<a name="l00322"></a>00322 
<a name="l00323"></a>00323    <span class="keywordflow">do</span> {
<a name="l00324"></a>00324       <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00325"></a>00325 
<a name="l00326"></a>00326       <span class="comment">/* check if data from PC */</span>
<a name="l00327"></a>00327       <a class="code" href="subm__300_8c.html#ab9d72c9680784fd5448a14266dde697e">check_lpt</a>();
<a name="l00328"></a>00328 
<a name="l00329"></a>00329       <span class="comment">/* check if data frm RS485 */</span>
<a name="l00330"></a>00330       <a class="code" href="subm__300_8c.html#aa8cf6d5c3a4cd2dc89b00e0640047c71">check_rs485</a>();
<a name="l00331"></a>00331 
<a name="l00332"></a>00332    } <span class="keywordflow">while</span> (1);                 <span class="comment">/* repeat forever */</span>
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6eb4ef98b98e79010079f1c0097741b3"></a><!-- doxytag: member="subm_300.c::serial_int" ref="a6eb4ef98b98e79010079f1c0097741b3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_int </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00153">153</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="subm__300_8c_source.html#l00078">rbuf_rp</a>, <a class="el" href="subm__300_8c_source.html#l00079">rbuf_wp</a>, <a class="el" href="embedded_2mscb_8h_source.html#l00287">RI0</a>, <a class="el" href="embedded_2mscb_8h_source.html#l00285">SBUF0</a>, <a class="el" href="embedded_2mscb_8h_source.html#l00286">TI0</a>, and <a class="el" href="subm__300_8c_source.html#l00081">ti_shadow</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00154"></a>00154 {
<a name="l00155"></a>00155    <span class="keywordflow">if</span> (<a class="code" href="embedded_2mscb_8h.html#a7344b3875ef40c3cd59eafcfd541418b">TI0</a>) {
<a name="l00156"></a>00156       <span class="comment">/* signal transmitted character */</span>
<a name="l00157"></a>00157       <a class="code" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a> = 1;
<a name="l00158"></a>00158       <a class="code" href="embedded_2mscb_8h.html#a7344b3875ef40c3cd59eafcfd541418b">TI0</a> = 0;
<a name="l00159"></a>00159    }
<a name="l00160"></a>00160    <span class="keywordflow">if</span> (<a class="code" href="embedded_2mscb_8h.html#a71cd7e9e2cf7b78014d3ec96ce3f9b4b">RI0</a>) {
<a name="l00161"></a>00161       <span class="comment">/* check for buffer overflow */</span>
<a name="l00162"></a>00162       <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> + 1 == <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a>) {
<a name="l00163"></a>00163          <a class="code" href="embedded_2mscb_8h.html#a71cd7e9e2cf7b78014d3ec96ce3f9b4b">RI0</a> = 0;
<a name="l00164"></a>00164          <span class="keywordflow">return</span>;
<a name="l00165"></a>00165       }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167       <span class="comment">/* store character in read buffer */</span>
<a name="l00168"></a>00168       *<a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> = <a class="code" href="embedded_2mscb_8h.html#a194a6d4c7e8cb3cf91b24b51708fc4fe">SBUF0</a>;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170       <span class="comment">/* increment write pointer with wrap around at 1024 bytes */</span>
<a name="l00171"></a>00171       <a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a>++;
<a name="l00172"></a>00172       <span class="keywordflow">if</span> (<a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> == 0x400)
<a name="l00173"></a>00173          <a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> = 0;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175       <a class="code" href="embedded_2mscb_8h.html#a71cd7e9e2cf7b78014d3ec96ce3f9b4b">RI0</a> = 0;
<a name="l00176"></a>00176    }
<a name="l00177"></a>00177 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7dfd9b79bc5a37d7df40207afbc5431f"></a><!-- doxytag: member="subm_300.c::setup" ref="a7dfd9b79bc5a37d7df40207afbc5431f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00093">93</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="embedded_2mscb_8h_source.html#l00370">BD_115200</a>, <a class="el" href="mscbutil_8c_source.html#l00788">led_blink()</a>, <a class="el" href="mscbutil_8c_source.html#l00769">led_mode()</a>, <a class="el" href="mscb_8c_source.html#l00322">LPT_BIT9</a>, <a class="el" href="mscb_8c_source.html#l00325">LPT_BUSY</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, <a class="el" href="subm__300_8c_source.html#l00070">LPT_NACK</a>, <a class="el" href="subm__300_8c_source.html#l00069">LPT_NDATAREADY</a>, <a class="el" href="subm__300_8c_source.html#l00067">LPT_NSTROBE</a>, <a class="el" href="c8051F000_8h_source.html#l00051">OSCICN</a>, <a class="el" href="c8051F000_8h_source.html#l00050">OSCXCN</a>, <a class="el" href="c8051F020_8h_source.html#l00049">P0MDOUT</a>, <a class="el" href="c8051F020_8h_source.html#l00050">P1MDOUT</a>, <a class="el" href="c8051F020_8h_source.html#l00051">P2MDOUT</a>, <a class="el" href="c8051F020_8h_source.html#l00052">P3MDOUT</a>, <a class="el" href="subm__300_8c_source.html#l00078">rbuf_rp</a>, <a class="el" href="subm__300_8c_source.html#l00079">rbuf_wp</a>, <a class="el" href="c8051F000_8h_source.html#l00105">RSTSRC</a>, <a class="el" href="mscbutil_8c_source.html#l00676">sysclock_init()</a>, <a class="el" href="mscbutil_8c_source.html#l00517">uart_init()</a>, <a class="el" href="c8051F000_8h_source.html#l00116">WDTCN</a>, <a class="el" href="c8051F000_8h_source.html#l00093">XBR0</a>, <a class="el" href="c8051F000_8h_source.html#l00094">XBR1</a>, and <a class="el" href="c8051F000_8h_source.html#l00095">XBR2</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00094"></a>00094 {
<a name="l00095"></a>00095    <a class="code" href="c8051F000_8h.html#ad03d8219a901c22c5c916b6736dea9aa">XBR0</a> = 0x04;                 <span class="comment">// Enable RX/TX</span>
<a name="l00096"></a>00096    <a class="code" href="c8051F000_8h.html#acd5b13dad19bfcca0b747e7715bbe82b">XBR1</a> = 0x00;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098    <a class="code" href="c8051F020_8h.html#a6608f51dd6960523e066aff4616cd407">P2MDOUT</a> = 0x00;              <span class="comment">// P2: LPT</span>
<a name="l00099"></a>00099    <a class="code" href="c8051F020_8h.html#a6608f51dd6960523e066aff4616cd407">P2MDOUT</a> = 0x00;              <span class="comment">// P2: LPT</span>
<a name="l00100"></a>00100    <a class="code" href="c8051F020_8h.html#a6608f51dd6960523e066aff4616cd407">P2MDOUT</a> = 0x00;              <span class="comment">// P2: LPT</span>
<a name="l00101"></a>00101    <a class="code" href="c8051F020_8h.html#a6608f51dd6960523e066aff4616cd407">P2MDOUT</a> = 0x00;              <span class="comment">// P2: LPT</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103    <a class="code" href="c8051F000_8h.html#a1495846c85ab78415cd56eb2c0a93400">XBR2</a> = 0x40;                 <span class="comment">// Enable crossbar</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105    <span class="comment">/* Port configuration (1 = Push Pull Output) */</span>
<a name="l00106"></a>00106    <a class="code" href="c8051F020_8h.html#accb05907491efc1db79da3297f412ebf">P0MDOUT</a> = 0x01;              <span class="comment">// P0.1: TX = Push Pull</span>
<a name="l00107"></a>00107    <a class="code" href="c8051F020_8h.html#af84b3723b32d7bec0c5e383450deb42a">P1MDOUT</a> = 0x00;              <span class="comment">// P1: LPT</span>
<a name="l00108"></a>00108    <a class="code" href="c8051F020_8h.html#a6608f51dd6960523e066aff4616cd407">P2MDOUT</a> = 0x00;              <span class="comment">// P2: LPT</span>
<a name="l00109"></a>00109    <a class="code" href="c8051F020_8h.html#a26d4ad9fbc51d95e0445dc3741ebb21a">P3MDOUT</a> = 0xE0;              <span class="comment">// P3.5,6,7: Optocouplers</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111    <span class="comment">/* Select external quartz oscillator */</span>
<a name="l00112"></a>00112    <a class="code" href="c8051F000_8h.html#a5e8025e81902590e27b65324534f9dbc">OSCXCN</a> = 0x66;               <span class="comment">// Crystal mode, Power Factor 22E6</span>
<a name="l00113"></a>00113    <a class="code" href="c8051F000_8h.html#a9783f36cd67fdbcbf7c12152343dcd37">OSCICN</a> = 0x08;               <span class="comment">// CLKSL=1 (external)</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    <span class="comment">/* enable watchdog */</span>
<a name="l00116"></a>00116    <a class="code" href="c8051F000_8h.html#a2eb7f8e96149deeec0f227384694807b">WDTCN</a> = 0x07;                <span class="comment">// 95 msec</span>
<a name="l00117"></a>00117    <a class="code" href="c8051F000_8h.html#a2eb7f8e96149deeec0f227384694807b">WDTCN</a> = 0xA5;                <span class="comment">// start watchdog</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119    <span class="comment">/* enable missing clock reset */</span>
<a name="l00120"></a>00120    <a class="code" href="c8051F000_8h.html#a9783f36cd67fdbcbf7c12152343dcd37">OSCICN</a> |= 0x80;              <span class="comment">// MSCLKE = 1</span>
<a name="l00121"></a>00121 
<a name="l00122"></a>00122    <span class="comment">/* enable reset pin and watchdog reset */</span>
<a name="l00123"></a>00123    <a class="code" href="c8051F000_8h.html#af35967bca631ac4037a98d322d18abfb">RSTSRC</a> = 0x09;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125    <span class="comment">/* start system clock */</span>
<a name="l00126"></a>00126    <a class="code" href="embedded_2mscb_8h.html#ac3da29ea117a42298b0958a53dd33aab">sysclock_init</a>();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128    <span class="comment">/* initialize UART0 */</span>
<a name="l00129"></a>00129    <a class="code" href="embedded_2mscb_8h.html#aee20e81ba44db51d21a17d4640f5eae9">uart_init</a>(0, <a class="code" href="embedded_2mscb_8h.html#a28becf037368de8eb96bdf1f073651dd">BD_115200</a>);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131    <span class="comment">/* clear all dynamic memory */</span>
<a name="l00132"></a>00132    <a class="code" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a> = 0;
<a name="l00133"></a>00133    <a class="code" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a> = 0;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135    <span class="comment">/* set input ports to one */</span>
<a name="l00136"></a>00136    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = 0xFF;
<a name="l00137"></a>00137    <a class="code" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> = 1;
<a name="l00138"></a>00138    <a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> = 1;
<a name="l00139"></a>00139    <a class="code" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> = 1;
<a name="l00140"></a>00140    <a class="code" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = 1;
<a name="l00141"></a>00141    <a class="code" href="mscb_8c.html#aafc451f66099eadd66b93da2201893b8">LPT_BIT9</a> = 1;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143    <span class="comment">/* Blink LEDs */</span>
<a name="l00144"></a>00144    <a class="code" href="embedded_2mscb_8h.html#a431cf0a502f2a232e27f81080a890585">led_blink</a>(0, 2, 150);
<a name="l00145"></a>00145    <a class="code" href="embedded_2mscb_8h.html#a431cf0a502f2a232e27f81080a890585">led_blink</a>(1, 2, 150);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147    <span class="comment">/* invert second LED */</span>
<a name="l00148"></a>00148    <a class="code" href="embedded_2mscb_8h.html#af87085aa8c2a51c2ef253721e4a192ca">led_mode</a>(2, 1);
<a name="l00149"></a>00149 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4ae5ad65c961268051560516eeff623f"></a><!-- doxytag: member="subm_300.c::watchdog_refresh" ref="a4ae5ad65c961268051560516eeff623f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void watchdog_refresh </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mscbutil_8c_source.html#l00862">862</a> of file <a class="el" href="mscbutil_8c_source.html">mscbutil.c</a>.</p>

<p>References <a class="el" href="c8051F000_8h_source.html#l00115">PCA0CPH4</a>, and <a class="el" href="c8051F000_8h_source.html#l00116">WDTCN</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00865"></a>00865          : <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>
<a name="l00866"></a>00866 
<a name="l00867"></a>00867   Purpose: Refresh watchdog, has to be called regularly, otherwise
<a name="l00868"></a>00868            the watchdog issues a reset
<a name="l00869"></a>00869 
<a name="l00870"></a>00870 \********************************************************************/
<a name="l00871"></a>00871 {
<a name="l00872"></a>00872 <span class="preprocessor">#ifdef USE_WATCHDOG</span>
<a name="l00873"></a>00873 <span class="preprocessor"></span>
<a name="l00874"></a>00874 <span class="preprocessor">#ifdef CPU_ADUC812</span>
<a name="l00875"></a>00875 <span class="preprocessor"></span>   WDR1 = 1;
<a name="l00876"></a>00876    WDR2 = 1;
<a name="l00877"></a>00877 <span class="preprocessor">#endif</span>
<a name="l00878"></a>00878 <span class="preprocessor"></span>
<a name="l00879"></a>00879 <span class="preprocessor">#ifdef CPU_CYGNAL</span>
<a name="l00880"></a>00880 <span class="preprocessor"></span>
<a name="l00881"></a>00881 <span class="preprocessor">#if defined(CPU_C8051F310) || defined(CPU_C8051F320)</span>
<a name="l00882"></a>00882 <span class="preprocessor"></span>   <a class="code" href="c8051F000_8h.html#af7a9d79f2b6afa076f984a1f0b2b93b9">PCA0CPH4</a> = 0x00;
<a name="l00883"></a>00883 <span class="preprocessor">#else</span>
<a name="l00884"></a>00884 <span class="preprocessor"></span>   <a class="code" href="c8051F000_8h.html#a2eb7f8e96149deeec0f227384694807b">WDTCN</a> = 0xA5;
<a name="l00885"></a>00885 <span class="preprocessor">#endif</span>
<a name="l00886"></a>00886 <span class="preprocessor"></span>
<a name="l00887"></a>00887 <span class="preprocessor">#endif</span>
<a name="l00888"></a>00888 <span class="preprocessor"></span>
<a name="l00889"></a>00889 <span class="preprocessor">#endif</span>
<a name="l00890"></a>00890 <span class="preprocessor"></span>}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a58c8b2ad0ea491a6642e5e1cbd358c89"></a><!-- doxytag: member="subm_300.c::yield" ref="a58c8b2ad0ea491a6642e5e1cbd358c89" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00302">302</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>References <a class="el" href="mscbutil_8c_source.html#l00862">watchdog_refresh()</a>.</p>

<p>Referenced by <a class="el" href="hvr__200_8c_source.html#l00498">adc_read()</a>, <a class="el" href="scs__800_8c_source.html#l00189">cap_read()</a>, <a class="el" href="mscbutil_8c_source.html#l00902">delay_ms()</a>, <a class="el" href="scs__310_8c_source.html#l00294">enter()</a>, <a class="el" href="scs__300_8c_source.html#l00185">gets_wait()</a>, <a class="el" href="mscbmain_8c_source.html#l01447">main()</a>, <a class="el" href="hvr__300_8c_source.html#l00397">read_current()</a>, <a class="el" href="hvr__300_8c_source.html#l00355">read_hv()</a>, <a class="el" href="hvr__300_8c_source.html#l00563">read_temperature()</a>, <a class="el" href="scs__310_8c_source.html#l00221">send_byte()</a>, and <a class="el" href="scs__300_8c_source.html#l00214">user_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00303"></a>00303 {
<a name="l00304"></a>00304    <a class="code" href="embedded_2mscb_8h.html#a4ae5ad65c961268051560516eeff623f">watchdog_refresh</a>();
<a name="l00305"></a>00305 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a14bbef42fa7709683afd9dd99e8228ac"></a><!-- doxytag: member="subm_300.c::LPT_BIT9" ref="a14bbef42fa7709683afd9dd99e8228ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#a14bbef42fa7709683afd9dd99e8228ac">LPT_BIT9</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00071">71</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a525c7d69d4a55d502b0d18c0603ebf29"></a><!-- doxytag: member="subm_300.c::LPT_BUSY" ref="a525c7d69d4a55d502b0d18c0603ebf29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#a525c7d69d4a55d502b0d18c0603ebf29">LPT_BUSY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00068">68</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1a77b8006a70c5e63c00e2597c930646"></a><!-- doxytag: member="subm_300.c::LPT_NACK" ref="a1a77b8006a70c5e63c00e2597c930646" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#a1a77b8006a70c5e63c00e2597c930646">LPT_NACK</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00070">70</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, and <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>.</p>

</div>
</div>
<a class="anchor" id="abc13a655a72180787f321dc91e6949a0"></a><!-- doxytag: member="subm_300.c::LPT_NDATAREADY" ref="abc13a655a72180787f321dc91e6949a0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#abc13a655a72180787f321dc91e6949a0">LPT_NDATAREADY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 6</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00069">69</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, and <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a626cacddf329d7b0306026f9c6690a60"></a><!-- doxytag: member="subm_300.c::LPT_NSTROBE" ref="a626cacddf329d7b0306026f9c6690a60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#a626cacddf329d7b0306026f9c6690a60">LPT_NSTROBE</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00067">67</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00181">check_lpt()</a>, <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, and <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2893d293848ee68eb63cd8269c9f6d6"></a><!-- doxytag: member="subm_300.c::rbuf_rp" ref="ab2893d293848ee68eb63cd8269c9f6d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char xdata* <a class="el" href="odbedit_8c.html#a8c6d6f90e1d6932f65c6f43d2f9d49a7">data</a> <a class="el" href="subm__300_8c.html#ab2893d293848ee68eb63cd8269c9f6d6">rbuf_rp</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00078">78</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, <a class="el" href="subm__300_8c_source.html#l00153">serial_int()</a>, and <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>.</p>

</div>
</div>
<a class="anchor" id="a48ebfdb26b0285a03a433244bb9b9f57"></a><!-- doxytag: member="subm_300.c::rbuf_wp" ref="a48ebfdb26b0285a03a433244bb9b9f57" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char xdata* <a class="el" href="odbedit_8c.html#a8c6d6f90e1d6932f65c6f43d2f9d49a7">data</a> <a class="el" href="subm__300_8c.html#a48ebfdb26b0285a03a433244bb9b9f57">rbuf_wp</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00079">79</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, <a class="el" href="subm__300_8c_source.html#l00153">serial_int()</a>, and <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>.</p>

</div>
</div>
<a class="anchor" id="abf06fefcfd184511a38e909e5a4111c0"></a><!-- doxytag: member="subm_300.c::sys_info" ref="abf06fefcfd184511a38e909e5a4111c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSYS__INFO.html">SYS_INFO</a> <a class="el" href="subm__300_8c.html#abf06fefcfd184511a38e909e5a4111c0">sys_info</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00089">89</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac1d112f074f95fe401f20a86156dc6fd"></a><!-- doxytag: member="subm_300.c::ti_shadow" ref="ac1d112f074f95fe401f20a86156dc6fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bit <a class="el" href="subm__300_8c.html#ac1d112f074f95fe401f20a86156dc6fd">ti_shadow</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00081">81</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00181">check_lpt()</a>, <a class="el" href="subm__300_8c_source.html#l00313">main()</a>, and <a class="el" href="subm__300_8c_source.html#l00153">serial_int()</a>.</p>

</div>
</div>
<a class="anchor" id="a900ff3a8ccab65692c28b012e3824819"></a><!-- doxytag: member="subm_300.c::variables" ref="a900ff3a8ccab65692c28b012e3824819" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMSCB__INFO__VAR.html">MSCB_INFO_VAR</a> code <a class="el" href="subm__300_8c.html#a900ff3a8ccab65692c28b012e3824819">variables</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   0
}
</pre></div>
<p>Definition at line <a class="el" href="subm__300_8c_source.html#l00085">85</a> of file <a class="el" href="subm__300_8c_source.html">subm_300.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
