<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: PlotPedestalAndNoise Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&nbsp;Structure&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PlotPedestalAndNoise Class Reference<br/>
<small>
[<a class="el" href="group__rootana__modules.html">Modules</a>]</small>
</h1><!-- doxytag: class="PlotPedestalAndNoise" --><!-- doxytag: inherits="BaseModule" -->
<p>Plots the pedestal and noise of each <a class="el" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a> and writes these to an SQLite database.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PlotPedestalAndNoise:</div>
<div class="dynsection">
 <div class="center">
  <img src="classPlotPedestalAndNoise.gif" usemap="#PlotPedestalAndNoise_map" alt=""/>
  <map id="PlotPedestalAndNoise_map" name="PlotPedestalAndNoise_map">
<area href="classBaseModule.html" alt="BaseModule" shape="rect" coords="0,0,136,24"/>
</map>
 </div>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#a8eb8620a3435eb54bbec2bbcfe5eb6c9">PlotPedestalAndNoise</a> (<a class="el" href="classmodules_1_1options.html">modules::options</a> *opts)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The constructor.  <a href="#a8eb8620a3435eb54bbec2bbcfe5eb6c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#a54cb67b99bbc00be082ac484a2438738">~PlotPedestalAndNoise</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Empty destructor.  <a href="#a54cb67b99bbc00be082ac484a2438738"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#a23d25cb188ccdf4f0130aff109313f46">ProcessGenericEntry</a> (<a class="el" href="classTGlobalData.html">TGlobalData</a> *<a class="el" href="group__MV1724ProcessRaw.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a>, <a class="el" href="classTSetupData.html">TSetupData</a> *<a class="el" href="group__MV1724ProcessRaw.html#gaad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#aab50673c8ec954675da2664677abfab1">SetAlias</a> (const std::string &amp;alias)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#ac3e4f013f5465813c9cfa2179788cbf3">GetAlias</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#af30c91fa2a3388325dd20b322de517ca">GetName</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of this module as given to the constructor of the base class.  <a href="#af30c91fa2a3388325dd20b322de517ca"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#ac6227c641b46487b3deb287fd3ea2408">Debug</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TDirectory *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#ae753140da9952cb8caea03082294ce5b">GetDirectory</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the TDirectory for this module.  <a href="#ae753140da9952cb8caea03082294ce5b"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TDirectory *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBaseModule.html#aa00f24e65a18c1d08149965da0fa1a22">dir</a></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#abb43984692ed4dabcca6c1a3a9cb7288">ProcessEntry</a> (<a class="el" href="classTGlobalData.html">TGlobalData</a> *<a class="el" href="group__MV1724ProcessRaw.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a>, <a class="el" href="classTSetupData.html">TSetupData</a> *<a class="el" href="group__MV1724ProcessRaw.html#gaad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">In every event, we loop over all the detectors and all the TPulseIslands and calculate the RMS and mean of the first fNSamples samples in the digitised pulse (i.e. the noise and the pedestal respectively).  <a href="#abb43984692ed4dabcca6c1a3a9cb7288"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#a1524e50b2f06d0c4280bd7ad78b7bf6a">BeforeFirstEntry</a> (<a class="el" href="classTGlobalData.html">TGlobalData</a> *<a class="el" href="group__MV1724ProcessRaw.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a>, <a class="el" href="classTSetupData.html">TSetupData</a> *setup)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Nothing is done before each run.  <a href="#a1524e50b2f06d0c4280bd7ad78b7bf6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#a681a9d8bff4fb872ad7307ac6e016502">AfterLastEntry</a> (<a class="el" href="classTGlobalData.html">TGlobalData</a> *<a class="el" href="group__MV1724ProcessRaw.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a>, <a class="el" href="classTSetupData.html">TSetupData</a> *setup)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">After each run, we write the mean and RMS of the first fNSamples to an SQLite database.  <a href="#a681a9d8bff4fb872ad7307ac6e016502"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, TH2D * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7">fPedestalVsNoiseHistograms</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The map that we store the pedestal vs. noise histograms for each channel.  <a href="#afede8ca47bf517f53b213ec0a2a904e7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#ab173e9f07de6f2bf95fbc04c8c707092">fNSamples</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The number of samples we will look at in the <a class="el" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a> to calculate the mean and RMS (opt = "n_samples", default = 5).  <a href="#ab173e9f07de6f2bf95fbc04c8c707092"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPlotPedestalAndNoise.html#adb4d9a74ba9d1cae7ed1ce32d7281a2b">fExportSQL</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A bool to decide whether we export the pedestal and noise to the SQLite database (opt = "export_sql", default = false).  <a href="#adb4d9a74ba9d1cae7ed1ce32d7281a2b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Plots the pedestal and noise of each <a class="el" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a> and writes these to an SQLite database. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Andrew Edmonds</dd></dl>
<p>This module loops over <a class="el" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a> and plots the mean and RMS of the first n_samples into a 2D histogram. At the end of the run, it writes the mean values of each axis to an SQLite database along with the channel and bank names. This SQLite database can then be used by <a class="el" href="classPulseCandidateFinder.html" title="Utility class to find pulse candidates on a TPulseIsland.">PulseCandidateFinder</a> to set parameter values based on a certain number of sigma. </p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00025">25</a> of file <a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8eb8620a3435eb54bbec2bbcfe5eb6c9"></a><!-- doxytag: member="PlotPedestalAndNoise::PlotPedestalAndNoise" ref="a8eb8620a3435eb54bbec2bbcfe5eb6c9" args="(modules::options *opts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PlotPedestalAndNoise::PlotPedestalAndNoise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmodules_1_1options.html">modules::options</a> *&nbsp;</td>
          <td class="paramname"> <em>opts</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The constructor. </p>
<p>The constructor looks in the opts for "n_samples" and sets the fNSamples variable (default = 5).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>opts</em>&nbsp;</td><td>Describe the options this module takes. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00021">21</a> of file <a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a>.</p>

<p>References <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00080">fExportSQL</a>, <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00075">fNSamples</a>, <a class="el" href="ModulesOptions_8cpp_source.html#l00039">modules::options::GetBool()</a>, and <a class="el" href="ModulesOptions_8cpp_source.html#l00024">modules::options::GetInt()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00021"></a>00021                                                               :
<a name="l00022"></a>00022    <a class="code" href="classBaseModule.html#a828d4e27c72536894e03b3cf330ba8c6" title="Constructor of a module class. Provides several virtual methods that should be overloaded...">BaseModule</a>(<span class="stringliteral">&quot;PlotPedestalAndNoise&quot;</span>,opts){
<a name="l00023"></a>00023 
<a name="l00024"></a>00024   <span class="comment">// Do something with opts here.  Has the user specified any</span>
<a name="l00025"></a>00025   <span class="comment">// particular configuration that you want to know?</span>
<a name="l00026"></a>00026   <span class="comment">// For example, perhaps this module wants an axis range:</span>
<a name="l00027"></a>00027   <a class="code" href="classPlotPedestalAndNoise.html#ab173e9f07de6f2bf95fbc04c8c707092" title="The number of samples we will look at in the TPulseIsland to calculate the mean and...">fNSamples</a> = opts-&gt;<a class="code" href="classmodules_1_1options.html#a10bf87912c8bae11780be19d5ac7bfab" title="Get the named option as an int.">GetInt</a>(<span class="stringliteral">&quot;n_samples&quot;</span>, 5);
<a name="l00028"></a>00028   <a class="code" href="classPlotPedestalAndNoise.html#adb4d9a74ba9d1cae7ed1ce32d7281a2b" title="A bool to decide whether we export the pedestal and noise to the SQLite database...">fExportSQL</a> = opts-&gt;<a class="code" href="classmodules_1_1options.html#ae1e1d18085161597bde39d8649b3fb8f" title="Get the named option as a bool.">GetBool</a>(<span class="stringliteral">&quot;export_sql&quot;</span>, <span class="keyword">false</span>);
<a name="l00029"></a>00029 }

</pre></div></p>

</div>
</div>
<a class="anchor" id="a54cb67b99bbc00be082ac484a2438738"></a><!-- doxytag: member="PlotPedestalAndNoise::~PlotPedestalAndNoise" ref="a54cb67b99bbc00be082ac484a2438738" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PlotPedestalAndNoise::~PlotPedestalAndNoise </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Empty destructor. </p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00031">31</a> of file <a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00031"></a>00031                                            {
<a name="l00032"></a>00032 }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a681a9d8bff4fb872ad7307ac6e016502"></a><!-- doxytag: member="PlotPedestalAndNoise::AfterLastEntry" ref="a681a9d8bff4fb872ad7307ac6e016502" args="(TGlobalData *gData, TSetupData *setup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PlotPedestalAndNoise::AfterLastEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTGlobalData.html">TGlobalData</a> *&nbsp;</td>
          <td class="paramname"> <em>gData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTSetupData.html">TSetupData</a> *&nbsp;</td>
          <td class="paramname"> <em>setup</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>After each run, we write the mean and RMS of the first fNSamples to an SQLite database. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>gData</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a3d5448acee19f58a84e121683ff9f232">BaseModule::AfterLastEntry</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>setup</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a3d5448acee19f58a84e121683ff9f232">BaseModule::AfterLastEntry</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Non-zero to indicate a problem. </dd></dl>

<p>Reimplemented from <a class="el" href="classBaseModule.html#a3d5448acee19f58a84e121683ff9f232">BaseModule</a>.</p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00116">116</a> of file <a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00059">BaseModule::Debug()</a>, <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00080">fExportSQL</a>, <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00070">fPedestalVsNoiseHistograms</a>, <a class="el" href="classTSetupData.html#a796c2a3e638560318393713b4858a76e">TSetupData::GetBankName()</a>, <a class="el" href="SetupNavigator_8h_source.html#l00014">SetupNavigator::GetRunNumber()</a>, and <a class="el" href="SetupNavigator_8h_source.html#l00021">SetupNavigator::Instance()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00116"></a>00116                                                                             {
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="comment">// Print extra info if we&apos;re debugging this module:</span>
<a name="l00119"></a>00119   <span class="keywordflow">if</span>(<a class="code" href="classBaseModule.html#ac6227c641b46487b3deb287fd3ea2408">Debug</a>()){
<a name="l00120"></a>00120      cout&lt;&lt;<span class="stringliteral">&quot;-----PlotPedestalAndNoise::AfterLastEntry(): I&apos;m debugging!&quot;</span>&lt;&lt;endl;
<a name="l00121"></a>00121   }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   <span class="keywordflow">if</span> (<a class="code" href="classPlotPedestalAndNoise.html#adb4d9a74ba9d1cae7ed1ce32d7281a2b" title="A bool to decide whether we export the pedestal and noise to the SQLite database...">fExportSQL</a>) {
<a name="l00124"></a>00124     <span class="comment">// Get the SQLite database file</span>
<a name="l00125"></a>00125     TSQLiteServer* server = <span class="keyword">new</span> TSQLiteServer(<span class="stringliteral">&quot;sqlite://pedestals-and-noises.sqlite&quot;</span>);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     std::stringstream query; 
<a name="l00128"></a>00128     std::string tablename = <span class="stringliteral">&quot;pedestals_and_noises&quot;</span>;
<a name="l00129"></a>00129     <span class="keywordflow">if</span> (server) {
<a name="l00130"></a>00130       <span class="comment">// Create the pedestals_and_noises table if it doesn&apos;t already exist</span>
<a name="l00131"></a>00131       query &lt;&lt; <span class="stringliteral">&quot;CREATE TABLE IF NOT EXISTS &quot;</span> &lt;&lt; tablename &lt;&lt; <span class="stringliteral">&quot; (run INT, channel STRING, bank STRING, pedestal FLOAT, noise FLOAT)&quot;</span>;
<a name="l00132"></a>00132       server-&gt;Exec(query.str().c_str());
<a name="l00133"></a>00133       query.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">// clear the stringstream after use</span>
<a name="l00134"></a>00134 
<a name="l00135"></a>00135       <span class="keywordtype">int</span> run_number = <a class="code" href="classSetupNavigator.html#acc09765c4d2ca0e1205977075bd7eb49">SetupNavigator::Instance</a>()-&gt;<a class="code" href="classSetupNavigator.html#a9ad1169767b17122924214f48776e56f">GetRunNumber</a>();
<a name="l00136"></a>00136       
<a name="l00137"></a>00137       <span class="comment">// Now loop through the histograms and record the run_numberm channel, bank and mean and RMS of first fNSamples to the SQLite table</span>
<a name="l00138"></a>00138       <span class="keywordflow">for</span> (<a class="code" href="namespacemodules.html#a5ce57c86284eadc5b573cfab0949bfdb">std::map&lt;std::string, TH2D*&gt;::iterator</a> histIter = <a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>.begin(); histIter != <a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>.end(); ++histIter) {
<a name="l00139"></a>00139         std::string detname = histIter-&gt;first;
<a name="l00140"></a>00140         std::string bankname = setup-&gt;<a class="code" href="classTSetupData.html#a796c2a3e638560318393713b4858a76e">GetBankName</a>(detname);
<a name="l00141"></a>00141         TH2D* pedestal_vs_noise_histogram = histIter-&gt;second;
<a name="l00142"></a>00142       
<a name="l00143"></a>00143         <span class="keywordtype">double</span> pedestal = pedestal_vs_noise_histogram-&gt;GetMean(1);
<a name="l00144"></a>00144         <span class="keywordtype">double</span> noise = pedestal_vs_noise_histogram-&gt;GetMean(2);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146         <span class="comment">// See if this row already exists (result will equal 1 if it does)</span>
<a name="l00147"></a>00147         query &lt;&lt; <span class="stringliteral">&quot;SELECT COUNT(*) FROM &quot;</span> &lt;&lt; tablename &lt;&lt; <span class="stringliteral">&quot; WHERE channel=\&apos;&quot;</span> &lt;&lt; detname &lt;&lt; <span class="stringliteral">&quot;\&apos;&quot;</span>;
<a name="l00148"></a>00148         TSQLiteResult* result = (TSQLiteResult*) server-&gt;Query(query.str().c_str());  <span class="comment">// get the result of this query</span>
<a name="l00149"></a>00149         TSQLiteRow* row = (TSQLiteRow*) result-&gt;Next(); <span class="comment">// get the first row</span>
<a name="l00150"></a>00150         query.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">// clear the stringstream after use</span>
<a name="l00151"></a>00151       
<a name="l00152"></a>00152         std::string n_table_entries = row-&gt;GetField(0);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         <span class="keywordflow">if</span> (n_table_entries == <span class="stringliteral">&quot;0&quot;</span>) {
<a name="l00155"></a>00155           <span class="comment">// insert a new set of values</span>
<a name="l00156"></a>00156           query &lt;&lt; <span class="stringliteral">&quot;INSERT INTO &quot;</span> &lt;&lt; tablename &lt;&lt; <span class="stringliteral">&quot; VALUES (&quot;</span> &lt;&lt; run_number &lt;&lt; <span class="stringliteral">&quot;, \&quot;&quot;</span> &lt;&lt; detname &lt;&lt; <span class="stringliteral">&quot;\&quot;, \&quot;&quot;</span> &lt;&lt; bankname &lt;&lt; <span class="stringliteral">&quot;\&quot;, &quot;</span> &lt;&lt; pedestal &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; noise &lt;&lt; <span class="stringliteral">&quot;);&quot;</span>; <span class="comment">// insert the values</span>
<a name="l00157"></a>00157           server-&gt;Exec(query.str().c_str());
<a name="l00158"></a>00158           query.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">// clear the stringstream after use</span>
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_table_entries == <span class="stringliteral">&quot;1&quot;</span>) {
<a name="l00161"></a>00161           <span class="comment">// just update the values that are already there</span>
<a name="l00162"></a>00162           query &lt;&lt; <span class="stringliteral">&quot;UPDATE &quot;</span> &lt;&lt; tablename &lt;&lt; <span class="stringliteral">&quot; SET run=&quot;</span> &lt;&lt; run_number &lt;&lt; <span class="stringliteral">&quot;, bank=\&apos;&quot;</span> &lt;&lt; bankname &lt;&lt; <span class="stringliteral">&quot;\&apos;, pedestal=&quot;</span> &lt;&lt; pedestal &lt;&lt; <span class="stringliteral">&quot;, noise=&quot;</span> &lt;&lt; noise &lt;&lt; <span class="stringliteral">&quot; WHERE channel=\&apos;&quot;</span> &lt;&lt; detname &lt;&lt; <span class="stringliteral">&quot;\&apos;;&quot;</span>;
<a name="l00163"></a>00163           server-&gt;Exec(query.str().c_str());
<a name="l00164"></a>00164           query.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">// clear the stringstream after use</span>
<a name="l00165"></a>00165         }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <span class="comment">// Need to delete the TSQLiteResult and TSQLiteRow like the ROOT documentation says so</span>
<a name="l00168"></a>00168         <span class="keyword">delete</span> result;
<a name="l00169"></a>00169         <span class="keyword">delete</span> row;
<a name="l00170"></a>00170       }
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     <span class="keywordflow">else</span> {
<a name="l00173"></a>00173       std::cout &lt;&lt; <span class="stringliteral">&quot;Error: Couldn&apos;t connect to SQLite database&quot;</span> &lt;&lt; std::endl;
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175   }
<a name="l00176"></a>00176   
<a name="l00177"></a>00177   <span class="keywordflow">return</span> 0;
<a name="l00178"></a>00178 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1524e50b2f06d0c4280bd7ad78b7bf6a"></a><!-- doxytag: member="PlotPedestalAndNoise::BeforeFirstEntry" ref="a1524e50b2f06d0c4280bd7ad78b7bf6a" args="(TGlobalData *gData, TSetupData *setup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PlotPedestalAndNoise::BeforeFirstEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTGlobalData.html">TGlobalData</a> *&nbsp;</td>
          <td class="paramname"> <em>gData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTSetupData.html">TSetupData</a> *&nbsp;</td>
          <td class="paramname"> <em>setup</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Nothing is done before each run. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>gData</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a5b1253266e0bd9fff017581107c0e3ac">BaseModule::BeforeFirstEntry</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>setup</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a5b1253266e0bd9fff017581107c0e3ac">BaseModule::BeforeFirstEntry</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Non-zero to indicate a problem. </dd></dl>

<p>Reimplemented from <a class="el" href="classBaseModule.html#a5b1253266e0bd9fff017581107c0e3ac">BaseModule</a>.</p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00037">37</a> of file <a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00059">BaseModule::Debug()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00037"></a>00037                                                                               {
<a name="l00038"></a>00038   <span class="comment">// Print extra info if we&apos;re debugging this module:</span>
<a name="l00039"></a>00039   <span class="keywordflow">if</span>(<a class="code" href="classBaseModule.html#ac6227c641b46487b3deb287fd3ea2408">Debug</a>()){
<a name="l00040"></a>00040      cout&lt;&lt;<span class="stringliteral">&quot;-----PlotPedestalAndNoise::BeforeFirstEntry(): I&apos;m debugging!&quot;</span>&lt;&lt;endl;
<a name="l00041"></a>00041   }
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <span class="keywordflow">return</span> 0;
<a name="l00044"></a>00044 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac6227c641b46487b3deb287fd3ea2408"></a><!-- doxytag: member="PlotPedestalAndNoise::Debug" ref="ac6227c641b46487b3deb287fd3ea2408" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BaseModule::Debug </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check whether this module was asked to print extra debug information </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true if 'debug' was given in the <a class="el" href="namespacemodules.html">modules</a> file, false if not </dd></dl>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00059">59</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00076">BaseModule::fDebug</a>.</p>

<p>Referenced by <a class="el" href="MakeAnalysedPulses_8cpp_source.html#l00167">MakeAnalysedPulses::AddGenerator()</a>, <a class="el" href="ExportPulse_8h_source.html#l00139">ExportPulse::AddToExportList()</a>, <a class="el" href="TemplateCreator_8cpp_source.html#l00109">TemplateCreator::AfterLastEntry()</a>, <a class="el" href="PulseCandidateFinder__InvestigateParameters_8cpp_source.html#l00097">PulseCandidateFinder_InvestigateParameters::AfterLastEntry()</a>, <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00116">AfterLastEntry()</a>, <a class="el" href="IslandLength_8cpp_source.html#l00087">IslandLength::AfterLastEntry()</a>, <a class="el" href="MakeMuonEvents_8cpp_source.html#l00034">MakeMuonEvents::BeforeFirstEntry()</a>, <a class="el" href="TemplateCreator_8cpp_source.html#l00030">TemplateCreator::BeforeFirstEntry()</a>, <a class="el" href="PulseCandidateFinder__InvestigateParameters_8cpp_source.html#l00027">PulseCandidateFinder_InvestigateParameters::BeforeFirstEntry()</a>, <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00037">BeforeFirstEntry()</a>, <a class="el" href="IslandLength_8cpp_source.html#l00033">IslandLength::BeforeFirstEntry()</a>, <a class="el" href="PulseViewer_8cpp_source.html#l00212">PulseViewer::ConsiderDrawing()</a>, <a class="el" href="MakeAnalysedPulses_8cpp_source.html#l00020">MakeAnalysedPulses::MakeAnalysedPulses()</a>, <a class="el" href="MakeDetectorPulses_8cpp_source.html#l00114">MakeDetectorPulses::MakeGenerator()</a>, <a class="el" href="ExportPulse_8cpp_source.html#l00206">ExportPulse::PlotTPI()</a>, <a class="el" href="PulseCandidateFinder__InvestigateParameters_8cpp_source.html#l00038">PulseCandidateFinder_InvestigateParameters::ProcessEntry()</a>, <a class="el" href="MakeAnalysedPulses_8cpp_source.html#l00092">MakeAnalysedPulses::ProcessEntry()</a>, and <a class="el" href="PulseViewer_8cpp_source.html#l00137">PulseViewer::ProcessEntry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00059"></a>00059 {<span class="keywordflow">return</span> <a class="code" href="classBaseModule.html#adb0c35fcbccea0bc732476b59c5b64ca">fDebug</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac3e4f013f5465813c9cfa2179788cbf3"></a><!-- doxytag: member="PlotPedestalAndNoise::GetAlias" ref="ac3e4f013f5465813c9cfa2179788cbf3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string BaseModule::GetAlias </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns a string for the alias of this module. May be empty if no alias was given in the <a class="el" href="namespacemodules.html">modules</a> file. </p>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00051">51</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00079">BaseModule::fAlias</a>.</p>

<p>Referenced by <a class="el" href="BaseModule_8cpp_source.html#l00007">BaseModule::BaseModule()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00051"></a>00051 {<span class="keywordflow">return</span> <a class="code" href="classBaseModule.html#ae19cdbdf544a783be4cdd4505ae31fb9">fAlias</a>;};
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae753140da9952cb8caea03082294ce5b"></a><!-- doxytag: member="PlotPedestalAndNoise::GetDirectory" ref="ae753140da9952cb8caea03082294ce5b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TDirectory* BaseModule::GetDirectory </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the TDirectory for this module. </p>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00062">62</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00078">BaseModule::fDirectory</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00062"></a>00062 {<span class="keywordflow">return</span> <a class="code" href="classBaseModule.html#a836fa9d2af26eb8a0041e0478c8fa9f0">fDirectory</a>;}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af30c91fa2a3388325dd20b322de517ca"></a><!-- doxytag: member="PlotPedestalAndNoise::GetName" ref="af30c91fa2a3388325dd20b322de517ca" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* BaseModule::GetName </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of this module as given to the constructor of the base class. </p>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00054">54</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00077">BaseModule::fName</a>.</p>

<p>Referenced by <a class="el" href="PlotTime_8cpp_source.html#l00037">PlotTime::ProcessEntry()</a>, and <a class="el" href="PlotAmplitude_8cpp_source.html#l00037">PlotAmplitude::ProcessEntry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00054"></a>00054 {<span class="keywordflow">return</span> <a class="code" href="classBaseModule.html#a743cac6481efcd5dea914e1d28813dfe">fName</a>.c_str();};
</pre></div></p>

</div>
</div>
<a class="anchor" id="abb43984692ed4dabcca6c1a3a9cb7288"></a><!-- doxytag: member="PlotPedestalAndNoise::ProcessEntry" ref="abb43984692ed4dabcca6c1a3a9cb7288" args="(TGlobalData *gData, TSetupData *gSetup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PlotPedestalAndNoise::ProcessEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTGlobalData.html">TGlobalData</a> *&nbsp;</td>
          <td class="paramname"> <em>gData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTSetupData.html">TSetupData</a> *&nbsp;</td>
          <td class="paramname"> <em>gSetup</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>In every event, we loop over all the detectors and all the TPulseIslands and calculate the RMS and mean of the first fNSamples samples in the digitised pulse (i.e. the noise and the pedestal respectively). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>gData</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a77027581152c1ecd1b320b8cd36f1114" title="The big kahuna. Overload this in the derived class and it will be called for each...">BaseModule::ProcessEntry</a> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>gSetup</em>&nbsp;</td><td>See <a class="el" href="classBaseModule.html#a77027581152c1ecd1b320b8cd36f1114" title="The big kahuna. Overload this in the derived class and it will be called for each...">BaseModule::ProcessEntry</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Non-zero to indicate a problem. </dd></dl>

<p>Reimplemented from <a class="el" href="classBaseModule.html#a77027581152c1ecd1b320b8cd36f1114">BaseModule</a>.</p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00048">48</a> of file <a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a>.</p>

<p>References <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00075">fNSamples</a>, <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00070">fPedestalVsNoiseHistograms</a>, <a class="el" href="TGlobalData_8h_source.html#l00037">TGlobalData::fPulseIslandToChannelMap</a>, <a class="el" href="TSetupData_8h_source.html#l00058">TSetupData::GetDetectorName()</a>, <a class="el" href="TSetupData_8h_source.html#l00075">TSetupData::GetNBits()</a>, and <a class="el" href="analyzer_8cpp_source.html#l00085">TSetupData::Instance()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00048"></a>00048                                                                           {
<a name="l00049"></a>00049 
<a name="l00050"></a>00050   <span class="comment">// Prepare a few variables</span>
<a name="l00051"></a>00051   std::string bankname, detname;
<a name="l00052"></a>00052   <a class="code" href="definitions_8h.html#a3c0940832f8741b0c226a24e3dbd62a8">PulseIslandList</a> thePulseIslands;
<a name="l00053"></a>00053   <a class="code" href="namespacemodules.html#aecc7811d5380ed9d9e903c9b71a396aa">StringPulseIslandMap::const_iterator</a> it;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="comment">// Loop over each detector</span>
<a name="l00056"></a>00056   <span class="keywordflow">for</span>(it = gData-&gt;<a class="code" href="classTGlobalData.html#af871aca81ed72f5b05f063cfb471d9e8" title="Map of bank names to vectors of TPIs.">fPulseIslandToChannelMap</a>.begin(); it != gData-&gt;<a class="code" href="classTGlobalData.html#af871aca81ed72f5b05f063cfb471d9e8" title="Map of bank names to vectors of TPIs.">fPulseIslandToChannelMap</a>.end(); ++it){
<a name="l00057"></a>00057     
<a name="l00058"></a>00058     <span class="comment">// Get the bank and detector names for this detector</span>
<a name="l00059"></a>00059     bankname = it-&gt;first;
<a name="l00060"></a>00060     detname = setup-&gt;GetDetectorName(bankname);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062     <span class="comment">// Get the TPIs</span>
<a name="l00063"></a>00063     thePulseIslands = it-&gt;second;
<a name="l00064"></a>00064     <span class="keywordflow">if</span> (thePulseIslands.size() == 0) <span class="keywordflow">continue</span>; <span class="comment">// no pulses here..</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="comment">// Create the histogram that will store all the average RMS noises from each event</span>
<a name="l00067"></a>00067     <span class="keywordflow">if</span> (<a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>.find(detname) == <a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>.end()) {
<a name="l00068"></a>00068       <span class="keywordtype">int</span> n_bits = <a class="code" href="group__alcapana__main.html#ga96d8c48f8693f69adda6aac005d17589" title="(Quasi-)Singleton interface">TSetupData::Instance</a>()-&gt;<a class="code" href="classTSetupData.html#a40acabc9f8cf502c53ca88b8461bb64a">GetNBits</a>(bankname);
<a name="l00069"></a>00069       <span class="keywordtype">int</span> x_min = 0;
<a name="l00070"></a>00070       <span class="keywordtype">int</span> x_max = std::pow(2, n_bits);
<a name="l00071"></a>00071       <span class="keywordtype">int</span> n_bins_x = (x_max - x_min)/10;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073       <span class="keywordtype">int</span> y_min = 0;
<a name="l00074"></a>00074       <span class="keywordtype">int</span> y_max = 200;
<a name="l00075"></a>00075       <span class="keywordtype">int</span> n_bins_y = (y_max - y_min)*10;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077       std::string histname = <span class="stringliteral">&quot;fPedestalVsNoiseHistogram_&quot;</span> + detname;
<a name="l00078"></a>00078       std::stringstream histtitle;
<a name="l00079"></a>00079       histtitle &lt;&lt; <span class="stringliteral">&quot;Plot of the Pedestal vs Noise (mean and RMS of first &quot;</span> &lt;&lt; <a class="code" href="classPlotPedestalAndNoise.html#ab173e9f07de6f2bf95fbc04c8c707092" title="The number of samples we will look at in the TPulseIsland to calculate the mean and...">fNSamples</a> &lt;&lt; <span class="stringliteral">&quot; samples) in &quot;</span> &lt;&lt; detname;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081       TH2D* histogram = <span class="keyword">new</span> TH2D(histname.c_str(), histtitle.str().c_str(), n_bins_x,x_min,x_max, n_bins_y,y_min,y_max);
<a name="l00082"></a>00082       histogram-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Pedestal [ADC]&quot;</span>);
<a name="l00083"></a>00083       histogram-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Noise [ADC]&quot;</span>);
<a name="l00084"></a>00084       <a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>[detname] = histogram;
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     TH2D* pedestal_vs_noise_histogram = <a class="code" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7" title="The map that we store the pedestal vs. noise histograms for each channel.">fPedestalVsNoiseHistograms</a>[detname];
<a name="l00088"></a>00088 
<a name="l00089"></a>00089     <span class="comment">// Loop through all the pulses</span>
<a name="l00090"></a>00090     <span class="keywordflow">for</span> (<a class="code" href="namespacemodules.html#a5ce57c86284eadc5b573cfab0949bfdb">PulseIslandList::iterator</a> pulseIter = thePulseIslands.begin(); pulseIter != thePulseIslands.end(); ++pulseIter) {
<a name="l00091"></a>00091 
<a name="l00092"></a>00092       <span class="keyword">const</span> std::vector&lt;int&gt;&amp; theSamples = (*pulseIter)-&gt;GetSamples();
<a name="l00093"></a>00093 
<a name="l00094"></a>00094       <span class="keywordtype">double</span> sum = 0;
<a name="l00095"></a>00095       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSample = 0; iSample &lt; <a class="code" href="classPlotPedestalAndNoise.html#ab173e9f07de6f2bf95fbc04c8c707092" title="The number of samples we will look at in the TPulseIsland to calculate the mean and...">fNSamples</a>; ++iSample) {
<a name="l00096"></a>00096         sum += theSamples.at(iSample);
<a name="l00097"></a>00097       }
<a name="l00098"></a>00098       <span class="keywordtype">double</span> mean = sum / fNSamples;
<a name="l00099"></a>00099       
<a name="l00100"></a>00100       <span class="keywordtype">double</span> sum_of_deviations_squared = 0;
<a name="l00101"></a>00101       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iSample = 0; iSample &lt; fNSamples; ++iSample) {
<a name="l00102"></a>00102         sum_of_deviations_squared += (theSamples.at(iSample) - mean)*(theSamples.at(iSample) - mean);
<a name="l00103"></a>00103       }
<a name="l00104"></a>00104       <span class="keywordtype">double</span> RMS = std::sqrt(sum_of_deviations_squared);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106       pedestal_vs_noise_histogram-&gt;Fill(mean, RMS);
<a name="l00107"></a>00107     } <span class="comment">// end loop through pulses</span>
<a name="l00108"></a>00108   } <span class="comment">// end loop through detectors</span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="keywordflow">return</span> 0;
<a name="l00111"></a>00111 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a23d25cb188ccdf4f0130aff109313f46"></a><!-- doxytag: member="PlotPedestalAndNoise::ProcessGenericEntry" ref="a23d25cb188ccdf4f0130aff109313f46" args="(TGlobalData *gData, TSetupData *gSetup)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BaseModule::ProcessGenericEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTGlobalData.html">TGlobalData</a> *&nbsp;</td>
          <td class="paramname"> <em>gData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTSetupData.html">TSetupData</a> *&nbsp;</td>
          <td class="paramname"> <em>gSetup</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Method called by the main event loop for each entry in the input root tree. Does some simple work, then hooks into the derived class through ProcessEntry. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on sucess and non-zero if a problem occurred </dd></dl>

<p>Definition at line <a class="el" href="BaseModule_8cpp_source.html#l00049">49</a> of file <a class="el" href="BaseModule_8cpp_source.html">BaseModule.cpp</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00078">BaseModule::fDirectory</a>, and <a class="el" href="BaseModule_8cpp_source.html#l00044">BaseModule::ProcessEntry()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00049"></a>00049                                                                          {
<a name="l00050"></a>00050   <span class="comment">// This is called by our main routine and would allow later to split into different </span>
<a name="l00051"></a>00051   <span class="comment">// process routines if we have more than one Tree and hence different tpyes of data input.</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053   <span class="keywordflow">if</span>(<a class="code" href="classBaseModule.html#a836fa9d2af26eb8a0041e0478c8fa9f0">fDirectory</a>) <a class="code" href="classBaseModule.html#a836fa9d2af26eb8a0041e0478c8fa9f0">fDirectory</a>-&gt;cd();
<a name="l00054"></a>00054   <span class="keywordtype">int</span> ret = <a class="code" href="classBaseModule.html#a77027581152c1ecd1b320b8cd36f1114" title="The big kahuna. Overload this in the derived class and it will be called for each...">ProcessEntry</a>(gData, gSetup);
<a name="l00055"></a>00055   gDirectory-&gt;cd(<span class="stringliteral">&quot;/&quot;</span>);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057   <span class="keywordflow">return</span> ret;
<a name="l00058"></a>00058 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aab50673c8ec954675da2664677abfab1"></a><!-- doxytag: member="PlotPedestalAndNoise::SetAlias" ref="aab50673c8ec954675da2664677abfab1" args="(const std::string &amp;alias)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BaseModule::SetAlias </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>alias</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the alias for this module, which should be provided in the <a class="el" href="namespacemodules.html">modules</a> file </p>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00047">47</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>References <a class="el" href="BaseModule_8h_source.html#l00079">BaseModule::fAlias</a>.</p>

<p>Referenced by <a class="el" href="BaseModule_8cpp_source.html#l00007">BaseModule::BaseModule()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00047"></a>00047 {<a class="code" href="classBaseModule.html#ae19cdbdf544a783be4cdd4505ae31fb9">fAlias</a>=alias;};
</pre></div></p>

</div>
</div>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="aa00f24e65a18c1d08149965da0fa1a22"></a><!-- doxytag: member="PlotPedestalAndNoise::dir" ref="aa00f24e65a18c1d08149965da0fa1a22" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TDirectory* <a class="el" href="classBaseModule.html#aa00f24e65a18c1d08149965da0fa1a22">BaseModule::dir</a><code> [protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Many <a class="el" href="namespacemodules.html">modules</a> use 'dir' still which was the old protected pointer to the <a class="el" href="namespacemodules.html">modules</a> directory. To prevent things being broken so soon, we keep this pointer available, but be warned that it will be removed shortly... </p>

<p>Definition at line <a class="el" href="BaseModule_8h_source.html#l00085">85</a> of file <a class="el" href="BaseModule_8h_source.html">BaseModule.h</a>.</p>

<p>Referenced by <a class="el" href="BaseModule_8cpp_source.html#l00007">BaseModule::BaseModule()</a>, <a class="el" href="ExportPulse_8cpp_source.html#l00036">ExportPulse::ExportPulse()</a>, <a class="el" href="MakeMuonEvents_8cpp_source.html#l00023">MakeMuonEvents::MakeMuonEvents()</a>, <a class="el" href="PlotAmplitude_8cpp_source.html#l00025">PlotAmplitude::PlotAmplitude()</a>, <a class="el" href="PlotAmpVsTDiff_8cpp_source.html#l00025">PlotAmpVsTDiff::PlotAmpVsTDiff()</a>, and <a class="el" href="PlotTime_8cpp_source.html#l00025">PlotTime::PlotTime()</a>.</p>

</div>
</div>
<a class="anchor" id="adb4d9a74ba9d1cae7ed1ce32d7281a2b"></a><!-- doxytag: member="PlotPedestalAndNoise::fExportSQL" ref="adb4d9a74ba9d1cae7ed1ce32d7281a2b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPlotPedestalAndNoise.html#adb4d9a74ba9d1cae7ed1ce32d7281a2b">PlotPedestalAndNoise::fExportSQL</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A bool to decide whether we export the pedestal and noise to the SQLite database (opt = "export_sql", default = false). </p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00080">80</a> of file <a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a>.</p>

<p>Referenced by <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00116">AfterLastEntry()</a>, and <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00021">PlotPedestalAndNoise()</a>.</p>

</div>
</div>
<a class="anchor" id="ab173e9f07de6f2bf95fbc04c8c707092"></a><!-- doxytag: member="PlotPedestalAndNoise::fNSamples" ref="ab173e9f07de6f2bf95fbc04c8c707092" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPlotPedestalAndNoise.html#ab173e9f07de6f2bf95fbc04c8c707092">PlotPedestalAndNoise::fNSamples</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The number of samples we will look at in the <a class="el" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a> to calculate the mean and RMS (opt = "n_samples", default = 5). </p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00075">75</a> of file <a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a>.</p>

<p>Referenced by <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00021">PlotPedestalAndNoise()</a>, and <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00048">ProcessEntry()</a>.</p>

</div>
</div>
<a class="anchor" id="afede8ca47bf517f53b213ec0a2a904e7"></a><!-- doxytag: member="PlotPedestalAndNoise::fPedestalVsNoiseHistograms" ref="afede8ca47bf517f53b213ec0a2a904e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, TH2D*&gt; <a class="el" href="classPlotPedestalAndNoise.html#afede8ca47bf517f53b213ec0a2a904e7">PlotPedestalAndNoise::fPedestalVsNoiseHistograms</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The map that we store the pedestal vs. noise histograms for each channel. </p>

<p>Definition at line <a class="el" href="PlotPedestalAndNoise_8h_source.html#l00070">70</a> of file <a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a>.</p>

<p>Referenced by <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00116">AfterLastEntry()</a>, and <a class="el" href="PlotPedestalAndNoise_8cpp_source.html#l00048">ProcessEntry()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>rootana/src/plotters/<a class="el" href="PlotPedestalAndNoise_8h_source.html">PlotPedestalAndNoise.h</a></li>
<li>rootana/src/plotters/<a class="el" href="PlotPedestalAndNoise_8cpp_source.html">PlotPedestalAndNoise.cpp</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 8 Jul 2014 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
