<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: functions::QuadraticFit Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacefunctions.html">functions</a>::<a class="el" href="classfunctions_1_1QuadraticFit.html">QuadraticFit</a>
  </div>
</div>
<div class="contents">
<h1>functions::QuadraticFit Class Reference</h1><!-- doxytag: class="functions::QuadraticFit" -->
<p>Functor(-ish) class to calculate fit of a quadratic to N data-points.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>&gt;</code></p>

<p><a href="classfunctions_1_1QuadraticFit-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#a0c90cda27139d5fbb84d4b4116b3bf30">QuadraticFit</a> (int length)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">constructor Taking the number of samples that will be fit to when using this instance  <a href="#a0c90cda27139d5fbb84d4b4116b3bf30"></a><br/></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename InputIterator &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#a2177c8f6c77541daed481e3a6291ae03">Fit</a> (InputIterator i_in, double &amp;a, double &amp;b, double &amp;c)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fit a given set of samples.  <a href="#a2177c8f6c77541daed481e3a6291ae03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#a6a82340864de9d91c5dfb075540bb061">GetSize</a> () const </td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">fDet</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Functor(-ish) class to calculate fit of a quadratic to N data-points. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Ben Krikler</dd></dl>
<p>Assumes that the x values are spaced evenly and centred at 0 so that the sum over odd powers of x is 0. Uses a formula derived from least squares regression </p>

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00014">14</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0c90cda27139d5fbb84d4b4116b3bf30"></a><!-- doxytag: member="functions::QuadraticFit::QuadraticFit" ref="a0c90cda27139d5fbb84d4b4116b3bf30" args="(int length)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">functions::QuadraticFit::QuadraticFit </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>length</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor Taking the number of samples that will be fit to when using this instance </p>

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00018">18</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>References <a class="el" href="QuadraticFit_8h_source.html#l00056">fDet</a>, <a class="el" href="QuadraticFit_8h_source.html#l00055">fN</a>, <a class="el" href="QuadraticFit_8h_source.html#l00056">fX2</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00056">fX4</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00018"></a>00018                           :<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>(length+(length+1)%2),<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>(0),<a class="code" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a>(0){
<a name="l00019"></a>00019    <span class="keywordtype">int</span> range=(<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>-1)/2;
<a name="l00020"></a>00020    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> x= -range; x &lt;= range; ++x){
<a name="l00021"></a>00021      <a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>+=x*x;
<a name="l00022"></a>00022      <a class="code" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a>+=x*x*x*x;
<a name="l00023"></a>00023    }
<a name="l00024"></a>00024    <a class="code" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">fDet</a>=<a class="code" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a> - <a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>;
<a name="l00025"></a>00025   }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2177c8f6c77541daed481e3a6291ae03"></a><!-- doxytag: member="functions::QuadraticFit::Fit" ref="a2177c8f6c77541daed481e3a6291ae03" args="(InputIterator i_in, double &amp;a, double &amp;b, double &amp;c)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename InputIterator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void functions::QuadraticFit::Fit </td>
          <td>(</td>
          <td class="paramtype">InputIterator&nbsp;</td>
          <td class="paramname"> <em>i_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>c</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fit a given set of samples. </p>
<p>The input iterator should be the first sample to fit. Since we assume the central sample is the origin, (which simplifies the maths considerably), the initial iterator should be set back N/2 samples from the centre of the fit, where N is the number of samples to fit. For example, to fit a peak at X using 6 samples, the input iterator should point to X-3. </p>

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00034">34</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>References <a class="el" href="QuadraticFit_8h_source.html#l00056">fDet</a>, <a class="el" href="QuadraticFit_8h_source.html#l00055">fN</a>, <a class="el" href="QuadraticFit_8h_source.html#l00056">fX2</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00056">fX4</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolver_8cpp_source.html#l00108">TemplateConvolver::FitPeak()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00034"></a>00034                                                                {
<a name="l00035"></a>00035    <span class="keywordtype">double</span> Sy=0, Sxy=0, Sx2y=0, y=0;
<a name="l00036"></a>00036    <span class="keywordtype">int</span> range=(<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>-1)/2;
<a name="l00037"></a>00037    <span class="keywordflow">for</span>(<span class="keywordtype">double</span> x= -range; x &lt;= range; ++x){
<a name="l00038"></a>00038      y=*i_in;
<a name="l00039"></a>00039      Sy+=y;
<a name="l00040"></a>00040      Sxy+=x*y;
<a name="l00041"></a>00041      Sx2y+=x*x*y;
<a name="l00042"></a>00042      <span class="comment">//DEBUG_VALUE(x, y,Sy, Sxy, Sx2y);</span>
<a name="l00043"></a>00043      ++i_in;
<a name="l00044"></a>00044    }
<a name="l00045"></a>00045    <span class="keywordtype">double</span> Da=Sx2y*<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>  - Sy  *<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">fX2</a>;
<a name="l00046"></a>00046    <span class="keywordtype">double</span> Db=Sxy *<a class="code" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a>*<a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>  - Sxy *fX2*fX2;
<a name="l00047"></a>00047    <span class="keywordtype">double</span> Dc=Sy  *<a class="code" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">fX4</a>*fX2 - Sx2y*fX2*fX2;
<a name="l00048"></a>00048    a=Da/<a class="code" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">fDet</a>;
<a name="l00049"></a>00049    b=Db/<a class="code" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">fDet</a>;
<a name="l00050"></a>00050    c=Dc/<a class="code" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">fDet</a>;
<a name="l00051"></a>00051   }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6a82340864de9d91c5dfb075540bb061"></a><!-- doxytag: member="functions::QuadraticFit::GetSize" ref="a6a82340864de9d91c5dfb075540bb061" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int functions::QuadraticFit::GetSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00053">53</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>References <a class="el" href="QuadraticFit_8h_source.html#l00055">fN</a>.</p>

<p>Referenced by <a class="el" href="TemplateConvolver_8cpp_source.html#l00108">TemplateConvolver::FitPeak()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00053"></a>00053 {<span class="keywordflow">return</span> <a class="code" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">fN</a>;}
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ad0991cc1550a77139bdc5ef4f06c83ba"></a><!-- doxytag: member="functions::QuadraticFit::fDet" ref="ad0991cc1550a77139bdc5ef4f06c83ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classfunctions_1_1QuadraticFit.html#ad0991cc1550a77139bdc5ef4f06c83ba">functions::QuadraticFit::fDet</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00056">56</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>Referenced by <a class="el" href="QuadraticFit_8h_source.html#l00034">Fit()</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00018">QuadraticFit()</a>.</p>

</div>
</div>
<a class="anchor" id="a55d77c5a63331a6b44f4fff714d8e83b"></a><!-- doxytag: member="functions::QuadraticFit::fN" ref="a55d77c5a63331a6b44f4fff714d8e83b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classfunctions_1_1QuadraticFit.html#a55d77c5a63331a6b44f4fff714d8e83b">functions::QuadraticFit::fN</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00055">55</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>Referenced by <a class="el" href="QuadraticFit_8h_source.html#l00034">Fit()</a>, <a class="el" href="QuadraticFit_8h_source.html#l00053">GetSize()</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00018">QuadraticFit()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ae6c14cad3365008b3eda8822bc2988"></a><!-- doxytag: member="functions::QuadraticFit::fX2" ref="a7ae6c14cad3365008b3eda8822bc2988" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classfunctions_1_1QuadraticFit.html#a7ae6c14cad3365008b3eda8822bc2988">functions::QuadraticFit::fX2</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00056">56</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>Referenced by <a class="el" href="QuadraticFit_8h_source.html#l00034">Fit()</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00018">QuadraticFit()</a>.</p>

</div>
</div>
<a class="anchor" id="af002190246706b66d0c34860e68cd94b"></a><!-- doxytag: member="functions::QuadraticFit::fX4" ref="af002190246706b66d0c34860e68cd94b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classfunctions_1_1QuadraticFit.html#af002190246706b66d0c34860e68cd94b">functions::QuadraticFit::fX4</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="QuadraticFit_8h_source.html#l00056">56</a> of file <a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a>.</p>

<p>Referenced by <a class="el" href="QuadraticFit_8h_source.html#l00034">Fit()</a>, and <a class="el" href="QuadraticFit_8h_source.html#l00018">QuadraticFit()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>rootana/src/TAP_generators/template_fitting/<a class="el" href="QuadraticFit_8h_source.html">QuadraticFit.h</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 15 May 2015 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
