<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: MCAENPulseIslandSortAndStitch</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>MCAENPulseIslandSortAndStitch<br/>
<small>
[<a class="el" href="group__process__raw.html">Raw Data Process</a>]</small>
</h1>
<p>Sort and stitches the TPIs.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static INT&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gab51f783b1f05e8ea11a7dea1c03575d2">module_event_sort_and_stitch</a> (EVENT_HEADER *pheader, void *pevent)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method sorts pulses in time and then stitches them together.  <a href="#gab51f783b1f05e8ea11a7dea1c03575d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static INT&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga82b003850d05363fe91927bce9f9333b">module_init_sort_and_stitch</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga5af1e0906ed291493a73213c09917e43">pulse_islands_t_comp</a> (<a class="el" href="classTPulseIsland.html">TPulseIsland</a> *a, <a class="el" href="classTPulseIsland.html">TPulseIsland</a> *b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ordering of pulse islands in time base on timestamp.  <a href="#ga5af1e0906ed291493a73213c09917e43"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gae49c79d95ba90643cc64554f51eb035a">pulse_islands_stitch</a> (std::vector&lt; <a class="el" href="classTPulseIsland.html">TPulseIsland</a> * &gt; &amp;pulses, unsigned int nSamples)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stitch islands together if second of two that are time ordered is less than expected.  <a href="#gae49c79d95ba90643cc64554f51eb035a"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">HNDLE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTGlobalData.html">TGlobalData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Object to hold data used and produced by <a class="el" href="namespacemodules.html">modules</a> throughout alcapana stage of analysis.  <a href="#ga69cb952a194ddefc6004dd96e70ccd62"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTSetupData.html">TSetupData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gaad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hardware information about digitizers and detectors to be used during alcapana stage of analysis.  <a href="#gaad8aa5d5fe566b2f8f6ca3000b09f0e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622">nUHSamples</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB).  <a href="#gac9c72af944c78546212b4c3a982d6622"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gad6375b0e0c1d53e9559ccba38903e91d">nBUSamples</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of samples we expect a BU CAEN pulse to be no shorter than (from ODB).  <a href="#gad6375b0e0c1d53e9559ccba38903e91d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga8aded88d4bba9664128c7bc8ca03e839">nUHPreSamples</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of samples saved before a trigger on UH CAEN (from ODB).  <a href="#ga8aded88d4bba9664128c7bc8ca03e839"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gaa50980c1e30bec1c1b7bddd93e2c5d83">nBUPreSamples</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of samples saved before a trigger on BU CAEN (from ODB).  <a href="#gaa50980c1e30bec1c1b7bddd93e2c5d83"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">ANA_MODULE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga9026287244a3602a9e4d6559c071ac89">MCAENPulseIslandSortAndStitch_module</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Sort and stitches the TPIs. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>John R Quirk</dd></dl>
<p>First sorts pulses based on time stamp (which is the timing that should be used). Then, if of two consecutive pulses the second is shorter than expected, stitch it to the first. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gab51f783b1f05e8ea11a7dea1c03575d2"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::module_event_sort_and_stitch" ref="gab51f783b1f05e8ea11a7dea1c03575d2" args="(EVENT_HEADER *pheader, void *pevent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT module_event_sort_and_stitch </td>
          <td>(</td>
          <td class="paramtype">EVENT_HEADER *&nbsp;</td>
          <td class="paramname"> <em>pheader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pevent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This method sorts pulses in time and then stitches them together. </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00111">111</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>References <a class="el" href="TGlobalData_8h_source.html#l00037">TGlobalData::fPulseIslandToChannelMap</a>, <a class="el" href="TSetupData_8h_source.html#l00113">TSetupData::IsBostonCAEN()</a>, <a class="el" href="TSetupData_8h_source.html#l00112">TSetupData::IsHoustonCAEN()</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00052">nBUSamples</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00048">nUHSamples</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00162">pulse_islands_stitch()</a>, and <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00140">pulse_islands_t_comp()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00112"></a>00112 {
<a name="l00113"></a>00113   <span class="comment">// Some typedefs</span>
<a name="l00114"></a>00114   <span class="keyword">typedef</span> std::map&lt;std::string, std::vector&lt;TPulseIsland*&gt; &gt; <a class="code" href="namespaceAlCap.html#a5ce0de646755e93f9915669e61b638ef">TStringPulseIslandMap</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116   <span class="comment">// Fetch a reference to the gData structure that stores a map</span>
<a name="l00117"></a>00117   <span class="comment">// of (bank_name, vector&lt;TPulseIsland*&gt;) pairs</span>
<a name="l00118"></a>00118   TStringPulseIslandMap&amp; pulse_islands_map = <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#ga69cb952a194ddefc6004dd96e70ccd62" title="Object to hold data used and produced by modules throughout alcapana stage of analysis...">gData</a>-&gt;<a class="code" href="classTGlobalData.html#af871aca81ed72f5b05f063cfb471d9e8" title="Map of bank names to vectors of TPIs.">fPulseIslandToChannelMap</a>;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keywordflow">for</span> (std::map&lt;std::string, std::vector&lt;TPulseIsland*&gt; &gt;::<a class="code" href="namespacemodules.html#a5ce57c86284eadc5b573cfab0949bfdb">iterator</a> it=pulse_islands_map.begin(); it!=pulse_islands_map.end(); ++it)
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nSamples = 0;
<a name="l00123"></a>00123       <span class="keywordflow">if</span> (<a class="code" href="classTSetupData.html#a6cafc21cbe5511aa19020a775171da00">TSetupData::IsBostonCAEN</a>(it-&gt;first))
<a name="l00124"></a>00124         nSamples = <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gad6375b0e0c1d53e9559ccba38903e91d" title="Number of samples we expect a BU CAEN pulse to be no shorter than (from ODB).">nBUSamples</a>;
<a name="l00125"></a>00125       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classTSetupData.html#ad8a66aaef59ea6a41aa2f049c3fb0907">TSetupData::IsHoustonCAEN</a>(it-&gt;first))
<a name="l00126"></a>00126         nSamples = <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622" title="Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB).">nUHSamples</a>;
<a name="l00127"></a>00127       <span class="keywordflow">if</span> (nSamples != 0) {
<a name="l00128"></a>00128         std::vector&lt;TPulseIsland*&gt; &amp;v = it-&gt;second;
<a name="l00129"></a>00129         std::sort(v.begin(), v.end(), <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#ga5af1e0906ed291493a73213c09917e43" title="Ordering of pulse islands in time base on timestamp.">pulse_islands_t_comp</a>);
<a name="l00130"></a>00130         <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gae49c79d95ba90643cc64554f51eb035a" title="Stitch islands together if second of two that are time ordered is less than expected...">pulse_islands_stitch</a>(v, nSamples);
<a name="l00131"></a>00131       }
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="keywordflow">return</span> SUCCESS;
<a name="l00135"></a>00135 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga82b003850d05363fe91927bce9f9333b"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::module_init_sort_and_stitch" ref="ga82b003850d05363fe91927bce9f9333b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT module_init_sort_and_stitch </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">80</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>References <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00060">nBUPreSamples</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00052">nBUSamples</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00056">nUHPreSamples</a>, and <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00048">nUHSamples</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00080"></a>00080                                   {
<a name="l00081"></a>00081 
<a name="l00082"></a>00082    <span class="comment">/*** Get necessary data from ODB ***/</span>
<a name="l00083"></a>00083   <span class="keywordtype">char</span> key[80];
<a name="l00084"></a>00084   <span class="keywordtype">int</span> size;
<a name="l00085"></a>00085   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> post_trigger_percentage;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   sprintf(key, <span class="stringliteral">&quot;/Equipment/Crate 4/Settings/CAEN0/waveform length&quot;</span>);
<a name="l00088"></a>00088   size = <span class="keyword">sizeof</span>(<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622" title="Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB).">nUHSamples</a>);
<a name="l00089"></a>00089   db_get_value(<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, key, &amp;<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622" title="Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB).">nUHSamples</a>, &amp;size, TID_DWORD, 1);
<a name="l00090"></a>00090   post_trigger_percentage = 80; <span class="comment">// This is hardcoded in the frontend</span>
<a name="l00091"></a>00091   <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#ga8aded88d4bba9664128c7bc8ca03e839" title="Number of samples saved before a trigger on UH CAEN (from ODB).">nUHPreSamples</a> = (int) (0.01 * ((100 - post_trigger_percentage) * <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622" title="Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB).">nUHSamples</a>));
<a name="l00092"></a>00092   
<a name="l00093"></a>00093   <span class="keywordflow">return</span> SUCCESS;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   sprintf(key, <span class="stringliteral">&quot;/Equipment/Crate 5/Settings/CAEN/waveform length&quot;</span>);
<a name="l00096"></a>00096   size = <span class="keyword">sizeof</span>(<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gad6375b0e0c1d53e9559ccba38903e91d" title="Number of samples we expect a BU CAEN pulse to be no shorter than (from ODB).">nBUSamples</a>);
<a name="l00097"></a>00097   db_get_value(<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, key, &amp;<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gad6375b0e0c1d53e9559ccba38903e91d" title="Number of samples we expect a BU CAEN pulse to be no shorter than (from ODB).">nBUSamples</a>, &amp;size, TID_DWORD, 1);
<a name="l00098"></a>00098   sprintf(key, <span class="stringliteral">&quot;/Equipment/Crate 5/Settings/CAEN/post_trigger_size&quot;</span>);
<a name="l00099"></a>00099   size = <span class="keyword">sizeof</span>(post_trigger_percentage);
<a name="l00100"></a>00100   db_get_value(<a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, key, &amp;post_trigger_percentage, &amp;size, TID_BYTE, 1);
<a name="l00101"></a>00101   <span class="comment">//nBUPreSamples = (int) (0.01 * ((100 - post_trigger_percentage) * nBUSamples));</span>
<a name="l00102"></a>00102   <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gaa50980c1e30bec1c1b7bddd93e2c5d83" title="Number of samples saved before a trigger on BU CAEN (from ODB).">nBUPreSamples</a> = 20; <span class="comment">// From the Golden Data, it looks like there are 20 presamples.</span>
<a name="l00103"></a>00103                     <span class="comment">// The frontend does not seem to correctly load post_trigger_size</span>
<a name="l00104"></a>00104                     <span class="comment">// onto the CAEN.</span>
<a name="l00105"></a>00105   
<a name="l00106"></a>00106   <span class="keywordflow">return</span> SUCCESS;
<a name="l00107"></a>00107 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="gae49c79d95ba90643cc64554f51eb035a"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::pulse_islands_stitch" ref="gae49c79d95ba90643cc64554f51eb035a" args="(std::vector&lt; TPulseIsland * &gt; &amp;pulses, unsigned int nSamples)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pulse_islands_stitch </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classTPulseIsland.html">TPulseIsland</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>pulses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>nSamples</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Stitch islands together if second of two that are time ordered is less than expected. </p>
<p>If a pulse form the CAEN is less than expected, where what's expected is set in the ODB before a run, that <em>usually</em> means that this second pulse was cause by trigger pile-up of the first, and should be stitched onto the end.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pulses</em>&nbsp;</td><td>Vector of TPIs contained time-sorted CANE pulses to stitch if necessary </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nSamples</em>&nbsp;</td><td>Number of samples we expect a pulse to be no shorter than; if shorter than this, a pulse is stitched to the end of the preceding pulse.</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Instead stitch together if the timestamps line up appropriately. </dd></dl>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00162">162</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>References <a class="el" href="TPulseIsland_8h_source.html#l00063">TPulseIsland::GetBankName()</a>, <a class="el" href="TPulseIsland_8h_source.html#l00061">TPulseIsland::GetSamples()</a>, and <a class="el" href="TPulseIsland_8h_source.html#l00062">TPulseIsland::GetTimeStamp()</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00111">module_event_sort_and_stitch()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00162"></a>00162                                                                                    {
<a name="l00163"></a>00163   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nPulses = pulses.size();
<a name="l00164"></a>00164   <span class="keywordflow">if</span> (nPulses == 0) <span class="keywordflow">return</span>;
<a name="l00165"></a>00165   std::vector&lt;int&gt; next_samples, current_samples;
<a name="l00166"></a>00166   <a class="code" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a>* temp_pulse;
<a name="l00167"></a>00167   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iPulse = 0; iPulse &lt; nPulses - 1; ++iPulse) {
<a name="l00168"></a>00168     next_samples = pulses[iPulse + 1]-&gt;GetSamples();
<a name="l00169"></a>00169     <span class="comment">// If the next pulse is less than the set number of samples,</span>
<a name="l00170"></a>00170     <span class="comment">// it&apos;s a continuation of this pulse</span>
<a name="l00171"></a>00171     <span class="keywordflow">while</span> (next_samples.size() &lt; nSamples) {
<a name="l00172"></a>00172       current_samples = pulses[iPulse]-&gt;GetSamples();
<a name="l00173"></a>00173       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; next_samples.size(); ++i)
<a name="l00174"></a>00174         current_samples.push_back(next_samples[i]);
<a name="l00175"></a>00175       temp_pulse = pulses[iPulse];
<a name="l00176"></a>00176       pulses[iPulse] = <span class="keyword">new</span> <a class="code" href="classTPulseIsland.html" title="A uniform format for data from many different detectors.">TPulseIsland</a>(temp_pulse-&gt;<a class="code" href="classTPulseIsland.html#af77ffa4ff59644151fed060663690bcf">GetTimeStamp</a>(), current_samples, temp_pulse-&gt;<a class="code" href="classTPulseIsland.html#acb8996d3388a3b4e6226edc251dea614">GetBankName</a>());
<a name="l00177"></a>00177       <span class="keyword">delete</span> temp_pulse;
<a name="l00178"></a>00178       <span class="keyword">delete</span> pulses[iPulse + 1];
<a name="l00179"></a>00179       pulses.erase(pulses.begin() + iPulse + 1);
<a name="l00180"></a>00180       <span class="keywordflow">if</span> (!(iPulse &lt; --nPulses - 1)) <span class="keywordflow">break</span>;
<a name="l00181"></a>00181       next_samples = pulses[iPulse + 1]-&gt;<a class="code" href="classTPulseIsland.html#a5e70c9bdef03512673fe2f7b90f42a63">GetSamples</a>();
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ga5af1e0906ed291493a73213c09917e43"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::pulse_islands_t_comp" ref="ga5af1e0906ed291493a73213c09917e43" args="(TPulseIsland *a, TPulseIsland *b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pulse_islands_t_comp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTPulseIsland.html">TPulseIsland</a> *&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTPulseIsland.html">TPulseIsland</a> *&nbsp;</td>
          <td class="paramname"> <em>b</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Ordering of pulse islands in time base on timestamp. </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00140">140</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>References <a class="el" href="TPulseIsland_8h_source.html#l00062">TPulseIsland::GetTimeStamp()</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00111">module_event_sort_and_stitch()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00141"></a>00141 { 
<a name="l00142"></a>00142   <span class="keywordflow">return</span> (a-&gt;<a class="code" href="classTPulseIsland.html#af77ffa4ff59644151fed060663690bcf">GetTimeStamp</a>() &lt; b-&gt;<a class="code" href="classTPulseIsland.html#af77ffa4ff59644151fed060663690bcf">GetTimeStamp</a>()); 
<a name="l00143"></a>00143 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ga69cb952a194ddefc6004dd96e70ccd62"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::gData" ref="ga69cb952a194ddefc6004dd96e70ccd62" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTGlobalData.html">TGlobalData</a>* <a class="el" href="group__MV1724ProcessRaw.html#ga69cb952a194ddefc6004dd96e70ccd62">gData</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Object to hold data used and produced by <a class="el" href="namespacemodules.html">modules</a> throughout alcapana stage of analysis. </p>

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00076">76</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gaad8aa5d5fe566b2f8f6ca3000b09f0e9"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::gSetup" ref="gaad8aa5d5fe566b2f8f6ca3000b09f0e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTSetupData.html">TSetupData</a>* <a class="el" href="group__MV1724ProcessRaw.html#gaad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Hardware information about digitizers and detectors to be used during alcapana stage of analysis. </p>

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00080">80</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gab1f60c53f74e806a3b9f687af38d7421"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::hDB" ref="gab1f60c53f74e806a3b9f687af38d7421" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HNDLE <a class="el" href="group__MV1724ProcessRaw.html#gab1f60c53f74e806a3b9f687af38d7421">hDB</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="MDQ__DAQLivetime_8cpp_source.html#l00098">MDQ_DAQLivetime_eor()</a>, <a class="el" href="MDQ__DigitizerOverflow_8cpp_source.html#l00095">MDQ_DigitizerOverflow_init()</a>, <a class="el" href="MDQ__FADCBufferOverflow_8cpp_source.html#l00091">MDQ_FADCBufferOverflow_init()</a>, <a class="el" href="MDQ__FADCPacketLoss_8cpp_source.html#l00090">MDQ_FADCPacketLoss_init()</a>, <a class="el" href="MDQ__IslandRate_8cpp_source.html#l00114">MDQ_IslandRate_eor()</a>, <a class="el" href="MDQ__MuPC_8cpp_source.html#l00068">MDQ_MuPC_init()</a>, <a class="el" href="MDQ__RunTime_8cpp_source.html#l00095">MDQ_RunTime_eor()</a>, <a class="el" href="MDQ__TDCCheck_8cpp_source.html#l00155">MDQ_TDCCheck_eor()</a>, <a class="el" href="MDQ__Thresholds_8cpp_source.html#l00115">MDQ_Thresholds_eor()</a>, <a class="el" href="MDT5720ProcessRaw_8cpp_source.html#l00079">module_init()</a>, <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">module_init_sort_and_stitch()</a>, and <a class="el" href="analyzer_8cpp_source.html#l00271">UpdateDetectorBankNameMap()</a>.</p>

</div>
</div>
<a class="anchor" id="ga9026287244a3602a9e4d6559c071ac89"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::MCAENPulseIslandSortAndStitch_module" ref="ga9026287244a3602a9e4d6559c071ac89" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ANA_MODULE <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga9026287244a3602a9e4d6559c071ac89">MCAENPulseIslandSortAndStitch_module</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
        <span class="stringliteral">&quot;MCAENPulseIslandSortAndStitch&quot;</span>,   
        <span class="stringliteral">&quot;Vladimir Tishchenko&quot;</span>,             
        <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#gab51f783b1f05e8ea11a7dea1c03575d2" title="This method sorts pulses in time and then stitches them together.">module_event_sort_and_stitch</a>,      
        NULL,                              
        NULL,                              
        <a class="code" href="group__MCAENPulseIslandSortAndStitch.html#ga82b003850d05363fe91927bce9f9333b">module_init_sort_and_stitch</a>,       
        NULL,                              
        NULL,                              
        0,                                 
        NULL,                              
}
</pre></div>
<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00062">62</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gaa50980c1e30bec1c1b7bddd93e2c5d83"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::nBUPreSamples" ref="gaa50980c1e30bec1c1b7bddd93e2c5d83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gaa50980c1e30bec1c1b7bddd93e2c5d83">nBUPreSamples</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of samples saved before a trigger on BU CAEN (from ODB). </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00060">60</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">module_init_sort_and_stitch()</a>.</p>

</div>
</div>
<a class="anchor" id="gad6375b0e0c1d53e9559ccba38903e91d"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::nBUSamples" ref="gad6375b0e0c1d53e9559ccba38903e91d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gad6375b0e0c1d53e9559ccba38903e91d">nBUSamples</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of samples we expect a BU CAEN pulse to be no shorter than (from ODB). </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00052">52</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00111">module_event_sort_and_stitch()</a>, and <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">module_init_sort_and_stitch()</a>.</p>

</div>
</div>
<a class="anchor" id="ga8aded88d4bba9664128c7bc8ca03e839"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::nUHPreSamples" ref="ga8aded88d4bba9664128c7bc8ca03e839" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#ga8aded88d4bba9664128c7bc8ca03e839">nUHPreSamples</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of samples saved before a trigger on UH CAEN (from ODB). </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00056">56</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">module_init_sort_and_stitch()</a>.</p>

</div>
</div>
<a class="anchor" id="gac9c72af944c78546212b4c3a982d6622"></a><!-- doxytag: member="MCAENPulseIslandSortAndStitch.cpp::nUHSamples" ref="gac9c72af944c78546212b4c3a982d6622" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="group__MCAENPulseIslandSortAndStitch.html#gac9c72af944c78546212b4c3a982d6622">nUHSamples</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of samples we expect a UH CAEN pulse to be no shorter than (from ODB). </p>

<p>Definition at line <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00048">48</a> of file <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html">MCAENPulseIslandSortAndStitch.cpp</a>.</p>

<p>Referenced by <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00111">module_event_sort_and_stitch()</a>, and <a class="el" href="MCAENPulseIslandSortAndStitch_8cpp_source.html#l00080">module_init_sort_and_stitch()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 7 Feb 2015 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
