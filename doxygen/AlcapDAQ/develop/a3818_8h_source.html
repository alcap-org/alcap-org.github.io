<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: CAEN/CAENUpgrader-1.4.1/CAENBridgeUpgrade/inc/a3818.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>CAEN/CAENUpgrader-1.4.1/CAENBridgeUpgrade/inc/a3818.h</h1><a href="a3818_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">        ----------------------------------------------------------------------</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">        --- CAEN SpA - Computing Systems Division ---</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">        a3818.h</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">        Header file for the CAEN A3818 HS CONET board driver.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">        November 2008 : Modified for A3818</span>
<a name="l00011"></a>00011 <span class="comment">        June  2004 :   Created (a2818).</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">        ----------------------------------------------------------------------</span>
<a name="l00014"></a>00014 <span class="comment">*/</span>
<a name="l00015"></a>00015 <span class="preprocessor">#ifndef _a3818_H</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor">#define _a3818_H</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef VERSION</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">        #define VERSION(ver,rel,seq) (((ver)&lt;&lt;16) | ((rel)&lt;&lt;8) | (seq))</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#ifdef WIN32</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#include &lt;windows.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">        #ifndef int8_t</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span><span class="preprocessor">        #define int8_t  INT8</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">    #ifndef int16_t</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">        #define int16_t INT16</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">    #ifndef int32_t</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">        #define int32_t INT32</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">    #ifndef int64_t</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">        #define int64_t INT64</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">    #ifndef uint8_t</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">        #define uint8_t  UINT8</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="preprocessor">    #ifndef uint16_t</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">        #define uint16_t UINT16</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">    #ifndef uint32_t</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">        #define uint32_t UINT32</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">    #ifndef uint64_t</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">        #define uint64_t UINT64</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">    #endif      </span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a>00052 <span class="comment">//#define DEBUG     1</span>
<a name="l00053"></a>00053 <span class="comment">/*</span>
<a name="l00054"></a>00054 <span class="comment">        Defines for the a3818</span>
<a name="l00055"></a>00055 <span class="comment">*/</span>
<a name="l00056"></a><a class="code" href="a3818_8h.html#acefdd49b75a80896eb7f4ddc3b668e57">00056</a> <span class="preprocessor">#define MIN_DMA_SIZE                    (80)</span>
<a name="l00057"></a><a class="code" href="a3818_8h.html#a97922f0d93fccdf90cb32b74fbbe8cf4">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_MINOR                       (256)</span>
<a name="l00058"></a><a class="code" href="a3818_8h.html#a176e4c39a833f4d01f0ecd322c0f4343">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define PFX                             &quot;a3818: &quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a><a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">00060</a> <span class="preprocessor">#define MAX_V2718                       (8)</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a><a class="code" href="a3818_8h.html#abc1fd7841409a70575895e6eef9d31bb">00062</a> <span class="preprocessor">#define A3818_MAX_PKT_SZ                (0x20000)</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a><a class="code" href="a3818_8h.html#a3fe520674e08de587c489f9094015fab">00064</a> <span class="preprocessor">#define A3818_RXFIFO_SZ                 (0x2000)</span>
<a name="l00065"></a><a class="code" href="a3818_8h.html#a0c482df82a658e83aad02a2e86f70a0d">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_REGION_SIZE               (0x100)</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a><a class="code" href="a3818_8h.html#afe864be239694b42fdd59f0fc8fece09">00067</a> <span class="preprocessor">#define PCI_VENDOR_XILINX_ID                    (0x10ee) // XILINX</span>
<a name="l00068"></a><a class="code" href="a3818_8h.html#ad04a7d8b3d61d6a54a131a4406e142f6">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define PCI_DEVICE_ID_VIRTEX                    (0x0007) // VIRTEX5</span>
<a name="l00069"></a><a class="code" href="a3818_8h.html#a9fbb1f4cccbc4c5169a32d6ca420daf3">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define PCI_SUBSYSTEM_VENDOR_ID_XILINX  (0x10ee)</span>
<a name="l00070"></a><a class="code" href="a3818_8h.html#a1f74bd8126a157cf403f4a6be9638882">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define PCI_SUBSYSTEM_ID_VIRTEX         (0x0007)</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="a3818_8h.html#a29513dad92b9053d9759c0e0ae6d93ac">00072</a> <span class="preprocessor">#define A3818_MAGIC                     &apos;8&apos;</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="a3818_8h.html#aaf31ce55e74cd0089774a49a68a0999d">00074</a> <span class="preprocessor">#define IOCTL_RESET                                             _IO(A3818_MAGIC, 0)</span>
<a name="l00075"></a><a class="code" href="a3818_8h.html#a1cccf7bb69540143a8232397780d02ed">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_COMM                                              _IOWR(A3818_MAGIC, 1, a3818_comm_t)</span>
<a name="l00076"></a><a class="code" href="a3818_8h.html#a42ea57005b7eca9602d6c172e12d11e1">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_REG_WR                                    _IOW(A3818_MAGIC, 2, a3818_reg_t)</span>
<a name="l00077"></a><a class="code" href="a3818_8h.html#a9183d968393a8e80fbebe346ab42e0f2">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_REG_RD                                    _IOWR(A3818_MAGIC, 3, a3818_reg_t)</span>
<a name="l00078"></a><a class="code" href="a3818_8h.html#aaf5ce168f774a7b952113e57a0c42353">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_IRQ_WAIT                                  _IOW(A3818_MAGIC, 4, a3818_intr_t)</span>
<a name="l00079"></a><a class="code" href="a3818_8h.html#a5e46ef56415bc29210f0dfb4001ac507">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_SEND                                              _IOWR(A3818_MAGIC, 5, a3818_comm_t)</span>
<a name="l00080"></a><a class="code" href="a3818_8h.html#ae55a40929eafd71fd84dfaee4e7b5709">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_RECV                                              _IOWR(A3818_MAGIC, 6, int)</span>
<a name="l00081"></a><a class="code" href="a3818_8h.html#a70647708ed843f92b99d74774c5d98f7">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_REV                                               _IOWR(A3818_MAGIC, 7, a3818_rev_t)</span>
<a name="l00082"></a><a class="code" href="a3818_8h.html#ad7901a3dc1f5107354bd3cd572148f17">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_COMM_REG_WR                               _IOW(A3818_MAGIC, 8, a3818_reg_t)</span>
<a name="l00083"></a><a class="code" href="a3818_8h.html#a811890049f2ec11909fa0c94350dc2dc">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_COMM_REG_RD                               _IOWR(A3818_MAGIC, 9, a3818_reg_t)</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span>
<a name="l00085"></a><a class="code" href="a3818_8h.html#a8201bc966dfabc802c36b6f119632035">00085</a> <span class="preprocessor">#define A3818_IOCTL_START_DMA_TO_PC     _IOWR(A3818_MAGIC, 10, a3818_comm_t)    // AM per debug su DMA dalla A3818 al PC</span>
<a name="l00086"></a><a class="code" href="a3818_8h.html#aa019ae189ffe3cbcefbf52a2b8e0d8b1">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define PCI_IOCTL_REG_RD                            _IOWR(A3818_MAGIC, 11, a3818_reg_t)     // AM per conoscere i registro del PCI</span>
<a name="l00087"></a><a class="code" href="a3818_8h.html#a279db0b87768fba194c383e89a2e1b57">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IOCTL_PCIE_BRIDGE_RESET   _IO(A3818_MAGIC, 12)</span>
<a name="l00088"></a><a class="code" href="a3818_8h.html#a081d622b6a751cf13cf7f906c9171913">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL_MATI                                              _IO(A3818_MAGIC, 13)</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span>
<a name="l00090"></a><a class="code" href="a3818_8h.html#a9cf3fece27b8eae7f1985d36617e6977">00090</a> <span class="preprocessor">#define START_WRITE_DMA                 (0x01)   // AM Write to PC in DMA da togliere!!!</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a><a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">00092</a> <span class="preprocessor">#define MAX_OPT_LINK                            (0x05)</span>
<a name="l00093"></a><a class="code" href="a3818_8h.html#acd410104aadbe99065046c1bbde5e2fe">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_COMMON_REG                        (0x05)</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a><a class="code" href="a3818_8h.html#a24e25a09b789979ee1b58cc7369068f4">00095</a> <span class="preprocessor">#define AT45DB321D_PAGE_SIZE            264   // AUG!</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="a3818_8h.html#a68e5525d2adb58f30fee47f8c7ec8c2e">00097</a> <span class="preprocessor">#define MAX_TLP32_DATA_PAYLOAD          32</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="comment">/************************************************/</span>
<a name="l00100"></a>00100 <span class="comment">/* A3818 ERROR MESSAGES */</span>
<a name="l00101"></a><a class="code" href="a3818_8h.html#af86cfd420558dd51abc90e4a07c24121">00101</a> <span class="preprocessor">#define A3818_OK               0</span>
<a name="l00102"></a><a class="code" href="a3818_8h.html#a889552da5b89e2ffa61840b04378260d">00102</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_ERR_NOT_READY    1</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span>
<a name="l00104"></a>00104 <span class="comment">/************************************************</span>
<a name="l00105"></a>00105 <span class="comment">        A3818 Registers offsets &amp; bits</span>
<a name="l00106"></a>00106 <span class="comment">*************************************************/</span>
<a name="l00107"></a>00107 <span class="comment">/************************************************/</span>
<a name="l00108"></a>00108 <span class="comment">/* LINK REGISTERS */</span>
<a name="l00109"></a><a class="code" href="a3818_8h.html#ac5abba85a9bc5495f42c5e6f3df44db9">00109</a> <span class="preprocessor">#define A3818_TXFIFO                    (0x00)</span>
<a name="l00110"></a><a class="code" href="a3818_8h.html#ad0d232e030cbbcd627fa36a1917f2717">00110</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_RXFIFO                    (0x04)</span>
<a name="l00111"></a><a class="code" href="a3818_8h.html#a85699dc8e51a8445392801b9e1994758">00111</a> <span class="preprocessor"></span><span class="preprocessor">#define IOCTL                                   (0x08)</span>
<a name="l00112"></a><a class="code" href="a3818_8h.html#a6c44693b8cfffd59e438e54c9d6024d2">00112</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_LNKRST                     (1)     // Link Reset</span>
<a name="l00113"></a><a class="code" href="a3818_8h.html#a473d2dc4642307ca9b760fe560cd9f28">00113</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_RDYINTDIS                  (1 &lt;&lt; 1)// Disable interrupt for data ready</span>
<a name="l00114"></a><a class="code" href="a3818_8h.html#a0da2b6afc70848adfac52a12afdc31ad">00114</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_SERVICE                    (1 &lt;&lt; 2)// SERV mode del CONET</span>
<a name="l00115"></a><a class="code" href="a3818_8h.html#a4b7459595b997997725c7f8736e9f53d">00115</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_VINTDIS                    (1 &lt;&lt; 3)// Disable interrupt from VME</span>
<a name="l00116"></a><a class="code" href="a3818_8h.html#a01e33ba5d6891efef52bc20669698312">00116</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_RES_LOCINT                 (1 &lt;&lt; 4)// Reset Local Interrupt</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a><a class="code" href="a3818_8h.html#ab25bc341ebf1d8fafbe1cf28cfa84f5d">00118</a> <span class="preprocessor">#define A3818_LINK_SR                   (0x0C)   // link status register</span>
<a name="l00119"></a><a class="code" href="a3818_8h.html#a68693104ff9e36ad2f2b8670057f691d">00119</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_RXFIFO_EMPTY               (1)</span>
<a name="l00120"></a><a class="code" href="a3818_8h.html#af22b520c6e9aac228736b50bc918a8ec">00120</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_RXFIFO_ALMFULL             (1 &lt;&lt; 1)</span>
<a name="l00121"></a><a class="code" href="a3818_8h.html#a2c00b8f53f1d7c8720265b564bc4aa9f">00121</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_TXFIFO_FULL                (1 &lt;&lt; 2)</span>
<a name="l00122"></a><a class="code" href="a3818_8h.html#a25a06aadd683675d8153ad1212d66744">00122</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_VMEINT                     (1 &lt;&lt; 3)</span>
<a name="l00123"></a>00123 <span class="preprocessor"></span>
<a name="l00124"></a><a class="code" href="a3818_8h.html#a9f23adc45c057321afa5af154a47c79a">00124</a> <span class="preprocessor">#       define A3818_LINKON                     (1 &lt;&lt; 5)</span>
<a name="l00125"></a><a class="code" href="a3818_8h.html#a159768db8a9856acdd4b15286506988e">00125</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_LINKRST_STAT               (1 &lt;&lt; 6)</span>
<a name="l00126"></a><a class="code" href="a3818_8h.html#a4b47f81455fbd4b8ff51efb5fad862b4">00126</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_SERV                       (1 &lt;&lt; 7)</span>
<a name="l00127"></a><a class="code" href="a3818_8h.html#a41c5ae19422d54431c64f1b03a70429d">00127</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_LINK_FAIL                  (1 &lt;&lt; 8)</span>
<a name="l00128"></a><a class="code" href="a3818_8h.html#a9c2d041a0816fe8b46e6119876b032bc">00128</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_LINT                       (1 &lt;&lt; 9)</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a><a class="code" href="a3818_8h.html#ada3ba4a633c6592c8e6fc3c0f618316d">00130</a> <span class="preprocessor">#       define A3818_LINK_TX_RES                (1 &lt;&lt; 16)</span>
<a name="l00131"></a><a class="code" href="a3818_8h.html#a292898193bf8da841b9c4b29dd3e269c">00131</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_LINK_RX_RES                (1 &lt;&lt; 17)</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00133"></a><a class="code" href="a3818_8h.html#aaceaffacfba965c3ee9169eff18bb58f">00133</a> <span class="preprocessor">#define A3818_LINK_TRS                  (0x18)   // link transfer status register</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span>
<a name="l00135"></a><a class="code" href="a3818_8h.html#ae65affda9416e36b395357484ef4275d">00135</a> <span class="preprocessor">#define A3818_DEBUG                     (0x20)</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>
<a name="l00137"></a><a class="code" href="a3818_8h.html#a102eb98fee5339be450f6aa44ef5575b">00137</a> <span class="preprocessor">#define A3818_IRQSTAT_0                                 (0x24)  // IRQ Stat dagli slave 0 to 3</span>
<a name="l00138"></a><a class="code" href="a3818_8h.html#a9a9adef4f61ecae05749841e10405282">00138</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IRQSTAT_1                                 (0x28)  // IRQ Stat dagli slave 4 to 7</span>
<a name="l00139"></a><a class="code" href="a3818_8h.html#a0c90b481c1112b38307bbc25761dc265">00139</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IRQMASK_0_S                               (0x30)  // IRQ Mask slave 0 to 3 - Set</span>
<a name="l00140"></a><a class="code" href="a3818_8h.html#adb0c46e4bcfa698db6e1e9436e0b206a">00140</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IRQMASK_0_C                               (0x34)  // IRQ Mask slave 0 to 3 - Clear</span>
<a name="l00141"></a><a class="code" href="a3818_8h.html#ac11a97ff665bf736f9fbf34275cfe231">00141</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IRQMASK_1_S                               (0x38)  // IRQ Mask slave 4 to 7 - Set</span>
<a name="l00142"></a><a class="code" href="a3818_8h.html#a4559424ca19254e9034ba8974c1a4b7d">00142</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IRQMASK_1_C                               (0x3C)  // IRQ Mask slave 4 to 7 - Clear</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>
<a name="l00144"></a><a class="code" href="a3818_8h.html#ab19324e5b20e96ec1c104c3e7cfc1ee0">00144</a> <span class="preprocessor">#define A3818_IOCTL_S                                   (0xA0)  // - IOCTL register set</span>
<a name="l00145"></a><a class="code" href="a3818_8h.html#a0f1eff858d5be48d145fae3807440b17">00145</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_IOCTL_C                                   (0xA4)  // - IOCTL register clear</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>
<a name="l00147"></a>00147 <span class="comment">/* DMA LINK REGISTERS*/</span>
<a name="l00148"></a><a class="code" href="a3818_8h.html#a0785368e09540df8caee65248a9d43fb">00148</a> <span class="preprocessor">#define A3818_DMACSR                    (0x100)   // DMA Control Status Register</span>
<a name="l00149"></a><a class="code" href="a3818_8h.html#a71c04d4672a4203a5dcd5e99a891b89c">00149</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_DMAREADSTART                       (1 &lt;&lt; 0)  // DMA Memory Read Start</span>
<a name="l00150"></a><a class="code" href="a3818_8h.html#a8d2345f64d8862fb21ab50c469840da2">00150</a> <span class="preprocessor"></span><span class="preprocessor">#       define A3818_DMAREADDONE                        (1 &lt;&lt; 8)  // DMA Memory Read Done</span>
<a name="l00151"></a><a class="code" href="a3818_8h.html#afca93e5b8aea58371e1e14a46ab2cf2c">00151</a> <span class="preprocessor"></span><span class="preprocessor">#           define A3818_RES_DMAINT                             (1 &lt;&lt; 31) // DMA Initiator Reset</span>
<a name="l00152"></a>00152 <span class="preprocessor"></span>
<a name="l00153"></a><a class="code" href="a3818_8h.html#ae6dc5ba7239dc07814af2e3e428cede2">00153</a> <span class="preprocessor">#define A3818_RDMATLPA                  (0x104)   // Read DMA Memory Address</span>
<a name="l00154"></a><a class="code" href="a3818_8h.html#a5b662c1a488eca509ef6f393ee79f71b">00154</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_RDMALADR                  (0x108)   // Read DMA Local Address</span>
<a name="l00155"></a><a class="code" href="a3818_8h.html#a89f21a6946230da871d5a1c668beac8b">00155</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_RDMASIZE                  (0x10C)   // Read DMA Size</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>
<a name="l00157"></a><a class="code" href="a3818_8h.html#a02f855e37b71fdd22cda7b9663e9023b">00157</a> <span class="preprocessor">#define A3818_RDMAMODE                  (0x110)   // Read DMA Mode</span>
<a name="l00158"></a><a class="code" href="a3818_8h.html#aa5766f2ec2972863ab9cc236f4db6cd1">00158</a> <span class="preprocessor"></span><span class="preprocessor">#               define A3818_DMAMODE_INTDIS                             (1 &lt;&lt; 6)  // Read Interrupt Disable</span>
<a name="l00159"></a>00159 <span class="preprocessor"></span>
<a name="l00160"></a><a class="code" href="a3818_8h.html#a7f3362a49ec34d49bc513e0d1dbd5d10">00160</a> <span class="preprocessor">#define A3818_WDMAPERF                  (0x114)   // DMA Performances Write to PC</span>
<a name="l00161"></a>00161 <span class="preprocessor"></span>
<a name="l00162"></a><a class="code" href="a3818_8h.html#ae5d16441d6109d081c0e038555d6615b">00162</a> <span class="preprocessor">#define A3818_DMACSR_S                                  (0x118)   // DMA Control Status Register - register set</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>
<a name="l00164"></a>00164 <span class="comment">/************************************************/</span>
<a name="l00165"></a>00165 <span class="comment">/* A3818 COMMON REGISTER */</span>
<a name="l00166"></a><a class="code" href="a3818_8h.html#a367f86cc896c87fad57e57614627db0e">00166</a> <span class="preprocessor">#define A3818_DLWSTAT                   (0x00)   // Device Link Width Status</span>
<a name="l00167"></a><a class="code" href="a3818_8h.html#a9cad23bfb985fcfc4739f1490402349b">00167</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_DLTRSSTAT                 (0x04)   // Device Link Transaction Size Status</span>
<a name="l00168"></a><a class="code" href="a3818_8h.html#a60dee8221088fc3bf86d4e4bc91c996b">00168</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_DMISCCS                   (0x08)   // Device Miscellaneous Control Status</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>
<a name="l00170"></a><a class="code" href="a3818_8h.html#a95dd77aaf61f19846ae563b36b18e214">00170</a> <span class="preprocessor">#       define  A3818_DMISCCS_CPL_STREAM        (1 &lt;&lt; 0) // Completion Streaming Enable (default 1)</span>
<a name="l00171"></a><a class="code" href="a3818_8h.html#a9dcb137228e24f8d40bd64b6f0e7a168">00171</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_RD_METERING       (1 &lt;&lt; 1) //  Read Metering Enable (default 0)</span>
<a name="l00172"></a><a class="code" href="a3818_8h.html#a1ffe6de662dd43bf612a279b2d833e4e">00172</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_REC_NON_POSTED_OK (1 &lt;&lt; 2) //  Receive Non-Posted OK (default 0)</span>
<a name="l00173"></a>00173 <span class="preprocessor"></span>
<a name="l00174"></a><a class="code" href="a3818_8h.html#a9e42371e5dbffc4d398377eceb7131cb">00174</a> <span class="preprocessor">#       define  A3818_DMISCCS_SPI_BPI_FLASH_SEL (1 &lt;&lt; 4) //  BPI/SPI FLASH access select (default 0 = SPI FLASH)</span>
<a name="l00175"></a><a class="code" href="a3818_8h.html#ad2f594d75052112d1e2388d6479dc06e">00175</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_SPI_FLASH_RDY     (1 &lt;&lt; 5) //  ATMEL SPI Flash Memory Ready (RO)</span>
<a name="l00176"></a><a class="code" href="a3818_8h.html#a64d414aac4da5e52bf4df9142f2e3d54">00176</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_ADC_CLK_SEL       (1 &lt;&lt; 6) //  ADC CLK Select (default 1 = SI571 clock)</span>
<a name="l00177"></a><a class="code" href="a3818_8h.html#a4e9ca51486a26972f7e370bff4143a97">00177</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_V_PB_EN           (1 &lt;&lt; 7) //  PB Power enable (default 1 = PB Power ON)</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span>
<a name="l00179"></a><a class="code" href="a3818_8h.html#aa4248dd15b01ea5c1eb23c153ea91015">00179</a> <span class="preprocessor">#       define  A3818_DMISCCS_RDDMA_DONE0       (1 &lt;&lt; 16)//  Link 0 DMA READ Done (RO)</span>
<a name="l00180"></a><a class="code" href="a3818_8h.html#af792f2a112d2d5b4d588a80df0b0c89a">00180</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_RDDMA_DONE1       (1 &lt;&lt; 17)//  Link 1 DMA READ Done (RO)</span>
<a name="l00181"></a><a class="code" href="a3818_8h.html#a6a01da8003fae20b471717b1cdbfa470">00181</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_RDDMA_DONE2       (1 &lt;&lt; 18)//  Link 2 DMA READ Done (RO)</span>
<a name="l00182"></a><a class="code" href="a3818_8h.html#a5d345f5d05f1f579c06b0c61d1c59a1c">00182</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_RDDMA_DONE3       (1 &lt;&lt; 19)//  Link 3 DMA READ Done (RO)</span>
<a name="l00183"></a><a class="code" href="a3818_8h.html#a5c7711207144272d755be6c2ae7b8b68">00183</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_RDDMA_DONE4       (1 &lt;&lt; 20)//  Link 4 Memory Write Done (RO)</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>
<a name="l00185"></a><a class="code" href="a3818_8h.html#a5db89c650369cc88f542ca25b666c72b">00185</a> <span class="preprocessor">#       define  A3818_DMISCCS_LOC_INT0          (1 &lt;&lt; 24)//  Link 0 Local Interrupt   (RO)</span>
<a name="l00186"></a><a class="code" href="a3818_8h.html#adb8a7270d9c793dffcc9b61a9f7f941d">00186</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_LOC_INT1          (1 &lt;&lt; 25)//  Link 1 Local Interrupt   (RO)</span>
<a name="l00187"></a><a class="code" href="a3818_8h.html#ab65bdee4a63210e89efa5f3d93ddad1e">00187</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_LOC_INT2          (1 &lt;&lt; 26)//  Link 2 Local Interrupt   (RO)</span>
<a name="l00188"></a><a class="code" href="a3818_8h.html#ad6a5bbfd66c9ac0e70567e6a57c9cf8c">00188</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_LOC_INT3          (1 &lt;&lt; 27)//  Link 3 Local Interrupt   (RO)</span>
<a name="l00189"></a><a class="code" href="a3818_8h.html#a00b5ed25ab8110c5c08d14aaf1e2f5b4">00189</a> <span class="preprocessor"></span><span class="preprocessor">#       define  A3818_DMISCCS_LOC_INT4          (1 &lt;&lt; 28)//  Link 4 Local Interrupt   (RO)</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>
<a name="l00191"></a><a class="code" href="a3818_8h.html#a749d95cd0e9c3c78d98988fc05a3d56e">00191</a> <span class="preprocessor">#define A3818_GTPRES                    (0x0C)   // W   - GTP reset</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>
<a name="l00193"></a><a class="code" href="a3818_8h.html#a26b0d85c7aa9a98e73cb7a1c43a20e83">00193</a> <span class="preprocessor">#define A3818_SPI_FLASH                 (0x10)   // R/W - ATMEL SPI Flash Memory access</span>
<a name="l00194"></a><a class="code" href="a3818_8h.html#a2abace59414f735ebfa2cc9b6c09475b">00194</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SPI_FLEN                  (0x14)   // R/W - ATMEL SPI Flash Memory enable</span>
<a name="l00195"></a><a class="code" href="a3818_8h.html#a86d4c9f4540cb7435d591194e033e44a">00195</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SPI_RELOAD                (0x18)   // W   - Re-read the SPI flash content</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>
<a name="l00197"></a><a class="code" href="a3818_8h.html#a63bde165de659d0a786a315e3d7831b6">00197</a> <span class="preprocessor">#define A3818_BPI_FLASH_AD              (0x20)   // R/W - BPI_FLASH TEST</span>
<a name="l00198"></a><a class="code" href="a3818_8h.html#af8c017c64eb76c07895e31b0d9f744c2">00198</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_BPI_FLASH_DT              (0x24)   // R/W</span>
<a name="l00199"></a><a class="code" href="a3818_8h.html#abdd754b573b71a394678fa2cec79c0fb">00199</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_BPI_FLASH_CMD             (0x28)   // R/W</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>
<a name="l00201"></a><a class="code" href="a3818_8h.html#a66af6ea382b7b55fed18ff391218c5de">00201</a> <span class="preprocessor">#define A3818_PHY_I2C_COMM              (0x30)   // W</span>
<a name="l00202"></a><a class="code" href="a3818_8h.html#afd32e35cd18f1393bc65afce260fc19d">00202</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_PHY_I2C_DAT               (0x34)   // R</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span>
<a name="l00204"></a><a class="code" href="a3818_8h.html#a1976808aab1157c275ea56551b5fdcf1">00204</a> <span class="preprocessor">#define A3818_ADC_I2C_COMM              (0x38)   // W</span>
<a name="l00205"></a><a class="code" href="a3818_8h.html#a7aacbe57990f5541babb31b683b47a34">00205</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_ADC_I2C_DAT               (0x3C)   // R</span>
<a name="l00206"></a>00206 <span class="preprocessor"></span>
<a name="l00207"></a><a class="code" href="a3818_8h.html#ac6bc0b4be1ef74c9d6a1fd0eccd0c81f">00207</a> <span class="preprocessor">#define A3818_FWREV                     (0x40)   // R   - Firmware Revision</span>
<a name="l00208"></a><a class="code" href="a3818_8h.html#a6ced980b6a33353282af0c73129c0040">00208</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_BOARD_ID                  (0x44)   // R   - Board ID</span>
<a name="l00209"></a><a class="code" href="a3818_8h.html#a2c0453f1c153024cb234aeb550f95046">00209</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_BOARD_VERS_ID             (0x48)   // R   - Board Version ID</span>
<a name="l00210"></a><a class="code" href="a3818_8h.html#a3f61cb3a6dbd48c11071b54765ed46c0">00210</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_BOARD_SERNUM              (0x4C)   // R   - Board Serial Number</span>
<a name="l00211"></a><a class="code" href="a3818_8h.html#a078df325851ea7b7fa673e62734a4069">00211</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_TEMP                      (0x50)   // R   - rilettura del sensore di temp. TMP422</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>
<a name="l00213"></a><a class="code" href="a3818_8h.html#ad96430370809cc50dc87bb74ff4cc28d">00213</a> <span class="preprocessor">#define A3818_SSRAM_AD                  (0x60)   // R/W - SSRAM TEST</span>
<a name="l00214"></a><a class="code" href="a3818_8h.html#af5b27e23f40b36741e54787b4e0a735c">00214</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SSRAM_DT_L                (0x64)   // R/W</span>
<a name="l00215"></a><a class="code" href="a3818_8h.html#ab43e522c83ff7d1cf22dd289da450774">00215</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SSRAM_DT_M                (0x68)   // R/W</span>
<a name="l00216"></a><a class="code" href="a3818_8h.html#a6d3acc9c5b7de5fec8e820b8f1464d79">00216</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SSRAM_DT_H                (0x6C)   // R/W</span>
<a name="l00217"></a><a class="code" href="a3818_8h.html#a72968e4aace6c90ab4613167e82bd129">00217</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818_SSRAM_CMD                 (0x70)   // R/W - SSRAM TEST</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="comment">/************************************************/</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a><a class="code" href="a3818_8h.html#ac8894916d0c56f0f942ca0928e6ac2c1">00221</a> <span class="preprocessor">#define A3818BOARD                      (0x0eea)</span>
<a name="l00222"></a><a class="code" href="a3818_8h.html#aaaea7c3aaba432d3f7db11f81d16aa40">00222</a> <span class="preprocessor"></span><span class="preprocessor">#   define ONE_LINK                     (0x0a)</span>
<a name="l00223"></a><a class="code" href="a3818_8h.html#a78304564d16895dd9aa2338c20257f54">00223</a> <span class="preprocessor"></span><span class="preprocessor">#   define TWO_LINK                     (0x0b)</span>
<a name="l00224"></a><a class="code" href="a3818_8h.html#aa869a00489129ac5ebc829376968c533">00224</a> <span class="preprocessor"></span><span class="preprocessor">#   define FOUR_LINK                    (0x0c)</span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>
<a name="l00226"></a><a class="code" href="a3818_8h.html#a42e2d095bdf022851ab166a31c51dcd3">00226</a> <span class="preprocessor">#define A3818DIGIT                      (0x0d)</span>
<a name="l00227"></a><a class="code" href="a3818_8h.html#a43b53d38b1d1c986ad91e1860e33092a">00227</a> <span class="preprocessor"></span><span class="preprocessor">#define A3818RAW                                                (0xffffff)</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>
<a name="l00229"></a>00229 <span class="comment">// Registri PCIE</span>
<a name="l00230"></a><a class="code" href="a3818_8h.html#adbbfa091e1dc23d0cd725c01579a88d5">00230</a> <span class="preprocessor">#define PCIE_DMA_CONF_REG               (0x68)</span>
<a name="l00231"></a><a class="code" href="a3818_8h.html#ad6c794d5d4eaed33fc1565f5f0a18ba3">00231</a> <span class="preprocessor"></span><span class="preprocessor">#define PCIE_MSI_CAPAB_REG                              (0x48)</span>
<a name="l00232"></a>00232 <span class="preprocessor"></span>
<a name="l00233"></a>00233 <span class="comment">/*</span>
<a name="l00234"></a>00234 <span class="comment">#ifdef DEBUG</span>
<a name="l00235"></a>00235 <span class="comment">#define DPRINTK(format,args...)                 printk(KERN_DEBUG format,##args)</span>
<a name="l00236"></a>00236 <span class="comment">#else</span>
<a name="l00237"></a>00237 <span class="comment">#define DPRINTK(format,args...)</span>
<a name="l00238"></a>00238 <span class="comment">#endif</span>
<a name="l00239"></a>00239 <span class="comment">*/</span>
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="preprocessor">#ifdef __KERNEL__</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span>
<a name="l00243"></a>00243 <span class="comment">/*</span>
<a name="l00244"></a>00244 <span class="comment">        ----------------------------------------------------------------------</span>
<a name="l00245"></a>00245 <span class="comment"></span>
<a name="l00246"></a>00246 <span class="comment">        Types</span>
<a name="l00247"></a>00247 <span class="comment"></span>
<a name="l00248"></a>00248 <span class="comment">        ----------------------------------------------------------------------</span>
<a name="l00249"></a>00249 <span class="comment">*/</span>
<a name="l00250"></a>00250 <span class="keyword">struct </span>a3818_state {
<a name="l00251"></a>00251         <span class="comment">/* Common globals */</span>
<a name="l00252"></a>00252         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>          *baseaddr[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a> + 1];  <span class="comment">// reindirizzamento dei 5 base address del pci</span>
<a name="l00253"></a>00253         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>           phys[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a> + 1];      <span class="comment">// indirizzo fisico dei 5 base address del pci</span>
<a name="l00254"></a>00254 
<a name="l00255"></a>00255         <span class="keyword">struct </span>pci_dev         *pcidev;
<a name="l00256"></a>00256         <span class="keywordtype">int</span>                     <a class="code" href="hyt1331_8c.html#ae960f3d6d8d9d8c9b29337a4983563c4">irq</a>;
<a name="l00257"></a>00257         <span class="keywordtype">int</span>                     minor;
<a name="l00258"></a>00258         <span class="keywordtype">int</span>                     <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>;
<a name="l00259"></a>00259         <span class="keywordtype">int</span>                                     NumOfLink;
<a name="l00260"></a>00260         <span class="keywordtype">int</span>                                             TypeOfBoard;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262         <span class="keywordtype">int</span>                                             SlaveOnLink[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];              <span class="comment">// per conoscere lo slave associato al link utilizzato</span>
<a name="l00263"></a>00263 
<a name="l00264"></a>00264         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>          *buff_dma_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];            <span class="comment">// buffer per i dma. CPU address.</span>
<a name="l00265"></a>00265         dma_addr_t              phy_dma_addr_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];  <span class="comment">// PCI address of buff_dma_in.</span>
<a name="l00266"></a>00266         <span class="keywordtype">int</span>                     ndata_dma_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         uint32_t                tr_stat[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            reads;
<a name="l00271"></a>00271         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            writes;
<a name="l00272"></a>00272         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            ioctls;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            DMAInProgress[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         spinlock_t              Alock;
<a name="l00277"></a>00277         <span class="keyword">struct </span>mutex            ioctl_lock;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="comment">/* Per slave globals */</span>
<a name="l00280"></a>00280         uint32_t               *buff_dma_out[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00281"></a>00281         dma_addr_t              phy_dma_addr_out[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00282"></a>00282         wait_queue_head_t       read_wait[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00283"></a>00283         wait_queue_head_t       intr_wait[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00284"></a>00284 
<a name="l00285"></a>00285         wait_queue_head_t       read_wait_debug[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];   <span class="comment">// AM per debug</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>          *app_dma_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00288"></a>00288         <span class="keywordtype">int</span>                     pos_app_dma_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00289"></a>00289         <span class="keywordtype">int</span>                     ndata_app_dma_in[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00290"></a>00290         <span class="keywordtype">int</span>                     rx_ready[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00291"></a>00291         <span class="keywordtype">int</span>                     rx_status[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00292"></a>00292         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            intr[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>][<a class="code" href="a3818_8h.html#a693999daecdf23eeea7e75b69308f91e">MAX_V2718</a>];
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         <span class="keywordtype">int</span>                     rx_ready_debug[<a class="code" href="a3818_8h.html#ab6fe85c77599ada71ea793fbc6353ece">MAX_OPT_LINK</a>];   <span class="comment">// AM per debug</span>
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 
<a name="l00297"></a>00297         <span class="comment">/* we keep a3818 cards in a linked list */</span>
<a name="l00298"></a>00298         <span class="keyword">struct                  </span>a3818_state *next;
<a name="l00299"></a>00299 };
<a name="l00300"></a>00300 <span class="preprocessor">#endif</span>
<a name="l00301"></a>00301 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00302"></a>00302 <span class="comment">        Struct for communication argument in ioctl calls</span>
<a name="l00303"></a>00303 <span class="comment">*/</span>
<a name="l00304"></a><a class="code" href="structa3818__comm.html">00304</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structa3818__comm.html">a3818_comm</a> {
<a name="l00305"></a><a class="code" href="structa3818__comm.html#aa9b42f291453ceb5eade328169ee505f">00305</a>         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structa3818__comm.html#aa9b42f291453ceb5eade328169ee505f">out_buf</a>;
<a name="l00306"></a><a class="code" href="structa3818__comm.html#a4a226ea245b05e926a6f3f3010cd8bea">00306</a>         <span class="keywordtype">int</span>         <a class="code" href="structa3818__comm.html#a4a226ea245b05e926a6f3f3010cd8bea">out_count</a>;
<a name="l00307"></a><a class="code" href="structa3818__comm.html#a2caa7b5370301d04e5d11947b1db2fdb">00307</a>         <span class="keywordtype">char</span>       *<a class="code" href="structa3818__comm.html#a2caa7b5370301d04e5d11947b1db2fdb">in_buf</a>;
<a name="l00308"></a><a class="code" href="structa3818__comm.html#a5f7c3e490d661566cc852a408e45c7b3">00308</a>         <span class="keywordtype">int</span>         <a class="code" href="structa3818__comm.html#a5f7c3e490d661566cc852a408e45c7b3">in_count</a>;
<a name="l00309"></a><a class="code" href="structa3818__comm.html#af35e93d40adebe95e6389706c62e296e">00309</a>         <span class="keywordtype">int</span>        *<a class="code" href="structa3818__comm.html#af35e93d40adebe95e6389706c62e296e">status</a>;
<a name="l00310"></a>00310 } <a class="code" href="structa3818__comm.html">a3818_comm_t</a>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 <span class="comment">/*</span>
<a name="l00313"></a>00313 <span class="comment">        Struct for register argument in ioctl calls</span>
<a name="l00314"></a>00314 <span class="comment">*/</span>
<a name="l00315"></a><a class="code" href="structa3818__reg.html">00315</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structa3818__reg.html">a3818_reg</a> {
<a name="l00316"></a>00316 <span class="comment">/* Rev. 1.6 */</span>
<a name="l00317"></a><a class="code" href="structa3818__reg.html#ac51817ce338c59d233676f0e2207b13c">00317</a>         uint32_t <a class="code" href="structa3818__reg.html#ac51817ce338c59d233676f0e2207b13c">address</a>;
<a name="l00318"></a><a class="code" href="structa3818__reg.html#ad8a513e5275357248cf251b0dba7a3ad">00318</a>         uint32_t <a class="code" href="structa3818__reg.html#ad8a513e5275357248cf251b0dba7a3ad">value</a>;
<a name="l00319"></a>00319 } <a class="code" href="structa3818__reg.html">a3818_reg_t</a>;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 <span class="comment">/*</span>
<a name="l00322"></a>00322 <span class="comment">        Struct for interrupt argument in ioctl calls</span>
<a name="l00323"></a>00323 <span class="comment">*/</span>
<a name="l00324"></a><a class="code" href="structa3818__intr.html">00324</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structa3818__intr.html">a3818_intr</a> {
<a name="l00325"></a><a class="code" href="structa3818__intr.html#a0b2fdb38dcdf41f2906f7a4f295d45db">00325</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structa3818__intr.html#a0b2fdb38dcdf41f2906f7a4f295d45db">Mask</a>;
<a name="l00326"></a><a class="code" href="structa3818__intr.html#af775c2f949fabdf33eaf5fbf298b1f3a">00326</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structa3818__intr.html#af775c2f949fabdf33eaf5fbf298b1f3a">Timeout</a>;
<a name="l00327"></a>00327 } <a class="code" href="structa3818__intr.html">a3818_intr_t</a>;
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 <span class="comment">// Rev 1.5</span>
<a name="l00330"></a>00330 <span class="comment">/*</span>
<a name="l00331"></a>00331 <span class="comment">        Struct for revision argument in ioctl calls</span>
<a name="l00332"></a>00332 <span class="comment">*/</span>
<a name="l00333"></a><a class="code" href="a3818_8h.html#ae3ae2448bffb79da460509c37a7fd5e1">00333</a> <span class="preprocessor">#define A3818_DRIVER_VERSION_LEN        20</span>
<a name="l00334"></a><a class="code" href="structa3818__rev.html">00334</a> <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structa3818__rev.html">a3818_rev</a> {
<a name="l00335"></a><a class="code" href="structa3818__rev.html#af1f8b15b324838513e5f1d478f426f72">00335</a>         <span class="keywordtype">char</span>            <a class="code" href="structa3818__rev.html#af1f8b15b324838513e5f1d478f426f72">rev_buf</a>[<a class="code" href="a3818_8h.html#ae3ae2448bffb79da460509c37a7fd5e1">A3818_DRIVER_VERSION_LEN</a>];
<a name="l00336"></a>00336 } <a class="code" href="structa3818__rev.html">a3818_rev_t</a>;
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
