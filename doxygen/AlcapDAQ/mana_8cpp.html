<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ: midas/src/mana.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/src/mana.cpp File Reference</h1><code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="midas_8h_source.html">midas.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="msystem_8h_source.html">msystem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hardware_8h_source.html">hardware.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="zlib_8h_source.html">zlib.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ybos_8h_source.html">ybos.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>

<p><a href="mana_8cpp_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structEVENT__DEF.html">EVENT_DEF</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMA__FILE.html">MA_FILE</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a87dfd475372bf9bce289d185b3bc5cf4">PVM_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;(1024*1024)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a4f4d653810d83035206144299458b3d0">HBOOK_LREC</a>&nbsp;&nbsp;&nbsp;8190</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>&nbsp;&nbsp;&nbsp;(5*(MAX_EVENT_SIZE+sizeof(<a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a>)))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a9b830b651a8c873d619d16eb495097af">ANALYZER_REQUEST_STR</a>&nbsp;&nbsp;&nbsp;&quot;\Event ID = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Trigger mask = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : -1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Sampling <a class="el" href="ybos_8c.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a> = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : 1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Buffer = STRING : [32] SYSTEM\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Enabled = <a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> : 1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Client name = STRING : [32] \<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Host = STRING : [32] \<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a407acb59ee878974632978f7682e8d23">ANALYZER_STATS_STR</a>&nbsp;&nbsp;&nbsp;&quot;\Events received = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Events per sec. = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Events written = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7c5689a91d273a5acdde5b6d6fd2a0b0">OUT_INFO_STR</a>&nbsp;&nbsp;&nbsp;&quot;\Filename = STRING : [256] <a class="el" href="odbhist_8c.html#a369e3b30815f09142abc86f462a501ff">run</a>%05d.asc\n\RWNT = BOOL : 0\n\Histo Dump = BOOL : 0\n\Histo Dump Filename = STRING : [256] his%05d.rz\n\Clear histos = BOOL : 1\n\Last Histo Filename = STRING : [256] last.rz\n\Events to ODB = BOOL : 1\n\Global Memory Name = STRING : [8] ONLN\n\&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a696fa60df0f6ed300eb2f4d17ea46054">EVENT_DEF_CACHE_SIZE</a>&nbsp;&nbsp;&nbsp;30</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(<a class="el" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, base)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a4f16e89aa9b9e0a0407f8611e0bfd17a">MA_DEVICE_DISK</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a1cfcef8fe3f0c8bca70aa08ffc445936">MA_DEVICE_TAPE</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a5238aca03baa556f4f1c6786e9de8af2">MA_DEVICE_FTP</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ae97c2576e5febbb750a3482a935da95f">MA_DEVICE_PVM</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a1595dea1508a366356bdc23083505ded">MA_FORMAT_MIDAS</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#af861b11d02a59ddde8874692b3c59737">MA_FORMAT_YBOS</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#af3f0df89b84a84b6e98576e1dc3a1989">MA_FORMAT_GZIP</a>&nbsp;&nbsp;&nbsp;(1&lt;&lt;3)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7987bd33585c5580d096cf8a54429f51">analyzer_init</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a4a14f75239e0a8c430e3706545197ad9">analyzer_exit</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ac268491d402244fca80333b38701c09f">analyzer_loop</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a22c6bd312e4f7ffd79162e64835cfd42">ana_begin_of_run</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a8e03cbe2637bd6f4488a659c9f23d29e">ana_end_of_run</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a86f2bc78d542107ce023a1d54f79b13e">ana_pause_run</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a35f57e1efbd308b1ca049035dcdc13f6">ana_resume_run</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#abe1e94ccaf2f7b108ef3291550a119c6">odb_load</a> (<a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a> (int argc, char **argv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__msectionh.html#ga42926f9062f24eb432ffb6414cde67e8">add_data_dir</a> (char *result, char *file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structEVENT__DEF.html">EVENT_DEF</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a> (short int <a class="el" href="mzdump_8c.html#ac6d03005c20c7feabe0b6be6902f0a5e">event_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__msectionh.html#gafe14ae429e3bc130043ebe683c41943e">test_register</a> (<a class="el" href="structANA__TEST.html">ANA_TEST</a> *t)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a443aaa38b1796a39d965acb610d31cc8">test_clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a5d0c60b46806a49cf44b5db6053b1e0f">test_increment</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a29da9175b91a9b8fbadf2499e84c11e3">test_write</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ae20b777778d5dcd241cf1dfb0dd2230f">load_parameters</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a2a0fbf63d5970373f81721ce136319dc">book_ntuples</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#aa2ad5915dcb13ea292c9b31f1cf492a9">banks_changed</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, void *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a12f9d4b93e18856d7ea847512163fc3b">mana_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a11a24986d9abfd2f14209cf7c8893f52">mana_exit</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#aad9e8ec0221ce200e2bd2fd32f77833b">bor</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#add7f1295fb688b84e58b96a50eae8df6">tr_prestart</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a5c030a1926f2439e78b7bd0d00221937">tr_stop</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7b3b6a2f570d0b31b1ad13c34536db5a">tr_pause</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ac69f1c3106f3389ed0dde43e7b86e54d">tr_resume</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, char *error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a548ba840d1c3a1f2a18009e48513f245">write_event_ascii</a> (FILE *file, <a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent, <a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *par)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a75ddaf388f46748e2585fa04d22278f2">write_event_midas</a> (FILE *file, <a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent, <a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *par)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a0b211773db8022bff4c277dc8bd8e90f">write_event_odb</a> (<a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#aaaa4a125e1a58b328027f929bc2ec7db">correct_num_events</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mzdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#adc93a18c662e7f5f7447c311e8ed7cac">process_event</a> (<a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *par, <a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ae64a9e12504afe61b5d065dd43b6c637">receive_event</a> (<a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> buffer_handle, <a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> request_id, <a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pheader, void *pevent)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a44060bd07543e42cf3d05407fc8909c8">update_request</a> (<a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, void *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a1a2128d90a2986636c9e80968c0d5c67">register_requests</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__msectionh.html#gae9ff90314dfa68157afd60af1a5ab817">lock_histo</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a0e79fc9202ddba8e379b10912fe709aa">load_last_histos</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ad767414c61d6a24611888cbdb899af31">save_last_histos</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#adce2146eee6315ed1feed2dc301f2427">loop_online</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a3faaffbd2cd679eb4a39eb234e4aef3b">init_module_parameters</a> (<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> bclose)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab4b3cf3c50a5b66e9c00af61e2b715cc">bevid_2_mheader</a> (<a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent, <a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> *pybos)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMA__FILE.html">MA_FILE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#acf053885bc02fc8661b8c5d23501be0f">ma_open</a> (char *<a class="el" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a715e03caa3809d9dce4e01e9be5d3232">ma_close</a> (<a class="el" href="structMA__FILE.html">MA_FILE</a> *file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a86d00d374a6aed95075c5778cb25b321">ma_read_event</a> (<a class="el" href="structMA__FILE.html">MA_FILE</a> *file, <a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent, int <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab4bcdcd2d272279d3afbaec8fc7e01a1">analyze_run</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>, char *<a class="el" href="mana__orig_8c.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, char *<a class="el" href="mana__orig_8c.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a6b0a51747fb7d6f42a04aa7813d88cd7">loop_runs_offline</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a> = FALSE</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a> = FALSE</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a> = &quot; &quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a8fd380b49c2d273b54ec6a6fb077d760">analyzer_loop_period</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7503268889a084b74a968787ffc025b7">odb_size</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#acad1970d3f9313bf7782eb6ae587c9a7">ntuple_flag</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a32357ef75116a47e988625b8d78ecfc5">lock_list</a> [10000]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#addcec48ded248cb150b9ded486f01da8">now_stopping</a> = FALSE</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a54e2499cfb7a66c138ef6c0e1b4714f4">QUEST</a> [100]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a145953d65e4f33a2308075f26c13bfbe">pawc_size</a></td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a7fd54785c88eccf892c6aa8d5f6e78d0">online</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#af65cc3664520b7cd0817adc7106f9624">host_name</a> [HOST_NAME_LENGTH]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a11eee1a5e2cef985b90bdfe0bfc8cf76">exp_name</a> [NAME_LENGTH]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a> [10][256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a24b25d290fef8bf6c0b21bfbbb4fefdd">secondary_output_file_name</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a6eaf70ed949e0b77f861573ffb313975">mias_tree_output_file_name</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a172a606e5fbb7290c1e2a89d0f2d39d0">run_number</a> [2]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a> [4]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#acd79c70e7b9dbde81f9a618bed1245e5">filter</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a4c4543fab10c0a1dc56223711d62f023">graphics</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a09aab23bbdc57f08685183469f2c34f6">config_file_name</a> [10][256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a> [10][256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a7016f372863223b54ca53ae070701a94">protect</a> [10][256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#ae9487d607449dedf95bca2636c33b5d3">rwnt</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a57f54b03009e95624f04afab052e6f2e">lrec</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a81f0a890e023743f1b88d0cb7d4f74db">debug</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#ad023bbf13e60f8caee82c26f70e0f0a5">verbose</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a34e0e7602d9696c3f499540a59d06a36">quiet</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#afb9f83013556b16cc1f547e955188356">no_load</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#abd4c58430e4e44ed3162b1beae228971">n_task</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a9c6222f0920e2024e2371df707389e55">pvm_buf_size</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a92facc49fbf15b92029c0c7dac1a8d35">root_port</a></td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a></td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a01d765415b8b865701ba44d771870744">flag_char</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#abf0f2b4c0e71c91c7405885282eb2c04">description</a> [1000]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;void *&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a735984d41155bc1032e09bece8f8d66d">data</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a></td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a> []</td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a258adbf16b88a7db88c7d8bce9708c50">filename</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#ae9487d607449dedf95bca2636c33b5d3">rwnt</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a6cddf80902f55138cf944ed06cbcbd61">histo_dump</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a81e1be5cc336f24597a82cfa087c1ac3">histo_dump_filename</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a4439d57afe08d556f78e4b0ba490c79a">clear_histos</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#aa43b224cec5b9bf4a8feb7fd364b9a7f">last_histo_filename</a> [256]</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#af68e872de565f722d84950f339b26cb9">events_to_odb</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a52bbe25f799ffa103a99650e3abd4e5e">global_memory_name</a> [8]</td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#af48fec10884611e9085a1d6e43362687">out_info</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">FILE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structANA__TEST.html">ANA_TEST</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a224d67b5dbc75c0db41de55f1869544f">hbook_types</a> [][8]</td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;short int&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#aff774cc3164dec02768f4104c5466c61">event_id</a></td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;<a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a>&nbsp;&nbsp;&nbsp;<a class="el" href="mana_8cpp.html#a5fecce64b1b883ada4ac0bc410fb3304">last_time</a></td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#aeba26f087848182d6f60b129fad82744">last_time_event</a> [50]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mana_8cpp.html#a3eb68b44171b0cd2d0c55c51a10188a4">_current_par</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a9b830b651a8c873d619d16eb495097af"></a><!-- doxytag: member="mana.cpp::ANALYZER_REQUEST_STR" ref="a9b830b651a8c873d619d16eb495097af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ANALYZER_REQUEST_STR&nbsp;&nbsp;&nbsp;&quot;\Event ID = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Trigger mask = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : -1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Sampling <a class="el" href="ybos_8c.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a> = <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> : 1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Buffer = STRING : [32] SYSTEM\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Enabled = <a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> : 1\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Client name = STRING : [32] \<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Host = STRING : [32] \<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00771">771</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a407acb59ee878974632978f7682e8d23"></a><!-- doxytag: member="mana.cpp::ANALYZER_STATS_STR" ref="a407acb59ee878974632978f7682e8d23" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ANALYZER_STATS_STR&nbsp;&nbsp;&nbsp;&quot;\Events received = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Events per sec. = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\Events written = DOUBLE : 0\<a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a>\&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00781">781</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a696fa60df0f6ed300eb2f4d17ea46054"></a><!-- doxytag: member="mana.cpp::EVENT_DEF_CACHE_SIZE" ref="a696fa60df0f6ed300eb2f4d17ea46054" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EVENT_DEF_CACHE_SIZE&nbsp;&nbsp;&nbsp;30</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2cfad5b8da98c11be16500fc15dba5aa"></a><!-- doxytag: member="mana.cpp::EXT_EVENT_SIZE" ref="a2cfad5b8da98c11be16500fc15dba5aa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXT_EVENT_SIZE&nbsp;&nbsp;&nbsp;(5*(MAX_EVENT_SIZE+sizeof(<a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a>)))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00640">640</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, <a class="el" href="mana_8cpp_source.html#l03596">process_event()</a>, <a class="el" href="mana_8cpp_source.html#l03795">receive_event()</a>, and <a class="el" href="mana_8cpp_source.html#l02743">write_event_midas()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f4d653810d83035206144299458b3d0"></a><!-- doxytag: member="mana.cpp::HBOOK_LREC" ref="a4f4d653810d83035206144299458b3d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HBOOK_LREC&nbsp;&nbsp;&nbsp;8190</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00636">636</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, and <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f16e89aa9b9e0a0407f8611e0bfd17a"></a><!-- doxytag: member="mana.cpp::MA_DEVICE_DISK" ref="a4f16e89aa9b9e0a0407f8611e0bfd17a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_DEVICE_DISK&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04318">4318</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, and <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a5238aca03baa556f4f1c6786e9de8af2"></a><!-- doxytag: member="mana.cpp::MA_DEVICE_FTP" ref="a5238aca03baa556f4f1c6786e9de8af2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_DEVICE_FTP&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04320">4320</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae97c2576e5febbb750a3482a935da95f"></a><!-- doxytag: member="mana.cpp::MA_DEVICE_PVM" ref="ae97c2576e5febbb750a3482a935da95f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_DEVICE_PVM&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04321">4321</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, and <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a1cfcef8fe3f0c8bca70aa08ffc445936"></a><!-- doxytag: member="mana.cpp::MA_DEVICE_TAPE" ref="a1cfcef8fe3f0c8bca70aa08ffc445936" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_DEVICE_TAPE&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04319">4319</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af3f0df89b84a84b6e98576e1dc3a1989"></a><!-- doxytag: member="mana.cpp::MA_FORMAT_GZIP" ref="af3f0df89b84a84b6e98576e1dc3a1989" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_FORMAT_GZIP&nbsp;&nbsp;&nbsp;(1&lt;&lt;3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04325">4325</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1595dea1508a366356bdc23083505ded"></a><!-- doxytag: member="mana.cpp::MA_FORMAT_MIDAS" ref="a1595dea1508a366356bdc23083505ded" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_FORMAT_MIDAS&nbsp;&nbsp;&nbsp;(1&lt;&lt;0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04323">4323</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, and <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>.</p>

</div>
</div>
<a class="anchor" id="af861b11d02a59ddde8874692b3c59737"></a><!-- doxytag: member="mana.cpp::MA_FORMAT_YBOS" ref="af861b11d02a59ddde8874692b3c59737" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MA_FORMAT_YBOS&nbsp;&nbsp;&nbsp;(1&lt;&lt;2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04324">4324</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04412">ma_close()</a>, <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, and <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c5689a91d273a5acdde5b6d6fd2a0b0"></a><!-- doxytag: member="mana.cpp::OUT_INFO_STR" ref="a7c5689a91d273a5acdde5b6d6fd2a0b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OUT_INFO_STR&nbsp;&nbsp;&nbsp;&quot;\Filename = STRING : [256] <a class="el" href="odbhist_8c.html#a369e3b30815f09142abc86f462a501ff">run</a>%05d.asc\n\RWNT = BOOL : 0\n\Histo Dump = BOOL : 0\n\Histo Dump Filename = STRING : [256] his%05d.rz\n\Clear histos = BOOL : 1\n\Last Histo Filename = STRING : [256] last.rz\n\Events to ODB = BOOL : 1\n\Global Memory Name = STRING : [8] ONLN\n\&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00787">787</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a87dfd475372bf9bce289d185b3bc5cf4"></a><!-- doxytag: member="mana.cpp::PVM_BUFFER_SIZE" ref="a87dfd475372bf9bce289d185b3bc5cf4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PVM_BUFFER_SIZE&nbsp;&nbsp;&nbsp;(1024*1024)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00554">554</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, and <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

</div>
</div>
<a class="anchor" id="af3dac432eb411d20fb144182a22c1f4e"></a><!-- doxytag: member="mana.cpp::STR_INC" ref="af3dac432eb411d20fb144182a22c1f4e" args="(p, base)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STR_INC</td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">base&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>+=strlen(<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>); \
                          <span class="keywordflow">if</span> (<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a> &gt; base+<span class="keyword">sizeof</span>(base)) \
                            <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;STR_INC&quot;</span>, <span class="stringliteral">&quot;ASCII buffer too small&quot;</span>); }
</pre></div>
<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02521">2521</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a22c6bd312e4f7ffd79162e64835cfd42"></a><!-- doxytag: member="mana.cpp::ana_begin_of_run" ref="a22c6bd312e4f7ffd79162e64835cfd42" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> ana_begin_of_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00206">206</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00207"></a>00207 {
<a name="l00208"></a>00208         printf(<span class="stringliteral">&quot;Analyzer saw beginning of run %d\n&quot;</span>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l00209"></a>00209         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00210"></a>00210 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e03cbe2637bd6f4488a659c9f23d29e"></a><!-- doxytag: member="mana.cpp::ana_end_of_run" ref="a8e03cbe2637bd6f4488a659c9f23d29e" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> ana_end_of_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00214">214</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00215"></a>00215 {
<a name="l00216"></a>00216         printf(<span class="stringliteral">&quot;Analyzer saw end of run %d\n&quot;</span>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l00217"></a>00217         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00218"></a>00218 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a86f2bc78d542107ce023a1d54f79b13e"></a><!-- doxytag: member="mana.cpp::ana_pause_run" ref="a86f2bc78d542107ce023a1d54f79b13e" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> ana_pause_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00222">222</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00223"></a>00223 {
<a name="l00224"></a>00224         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00225"></a>00225 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35f57e1efbd308b1ca049035dcdc13f6"></a><!-- doxytag: member="mana.cpp::ana_resume_run" ref="a35f57e1efbd308b1ca049035dcdc13f6" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> ana_resume_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00229">229</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00230"></a>00230 {
<a name="l00231"></a>00231         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00232"></a>00232 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4bcdcd2d272279d3afbaec8fc7e01a1"></a><!-- doxytag: member="mana.cpp::analyze_run" ref="ab4bcdcd2d272279d3afbaec8fc7e01a1" args="(INT run_number, char *input_file_name, char *output_file_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> analyze_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>input_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>output_file_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04544">4544</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l00904">ALIGN8</a>, <a class="el" href="midas_8h_source.html#l01499">ANALYZE_REQUEST::ar_info</a>, <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8c_source.html#l04166">cm_yield()</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="odb_8c_source.html#l03128">db_set_value()</a>, <a class="el" href="midas_8h_source.html#l01486">AR_INFO::enabled</a>, <a class="el" href="mana_8cpp_source.html#l02332">eor()</a>, <a class="el" href="midas_8h_source.html#l01482">AR_INFO::event_id</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8h_source.html#l00919">EVENTID_ALL</a>, <a class="el" href="midas_8h_source.html#l01229">EVENTID_BOR</a>, <a class="el" href="mana_8cpp_source.html#l00640">EXT_EVENT_SIZE</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="mana_8cpp_source.html#l04412">ma_close()</a>, <a class="el" href="mana_8cpp_source.html#l04340">ma_open()</a>, <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="lrs1821_8h_source.html#l00221">MINFO</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="miniana_8c_source.html#l00026">process_event()</a>, <a class="el" href="midas_8h_source.html#l00615">PTYPE</a>, <a class="el" href="pvm3_8h_source.html#l00243">PvmDataInPlace</a>, <a class="el" href="midas_8h_source.html#l01075">RPC_SHUTDOWN</a>, <a class="el" href="midas_8h_source.html#l01039">SS_FILE_ERROR</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, <a class="el" href="old__mevb_8cpp_source.html#l00065">start_time</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00742">TID_BOOL</a>, <a class="el" href="midas_8h_source.html#l00741">TID_INT</a>, <a class="el" href="midas_8h_source.html#l00746">TID_STRING</a>, <a class="el" href="midas_8h_source.html#l00920">TRIGGER_ALL</a>, <a class="el" href="midas_8h_source.html#l01192">EVENT_HEADER::trigger_mask</a>, <a class="el" href="midas_8h_source.html#l01483">AR_INFO::trigger_mask</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, and <a class="el" href="fal_8c_source.html#l03879">update_stats()</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04802">loop_runs_offline()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04545"></a>04545 {
<a name="l04546"></a>04546    <a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent, *pevent_unaligned;
<a name="l04547"></a>04547    <a class="code" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *par;
<a name="l04548"></a>04548    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l04549"></a>04549    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> num_events_in, num_events_out;
<a name="l04550"></a>04550    <span class="keywordtype">char</span> error[256], <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l04551"></a>04551    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a> = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04552"></a>04552    <a class="code" href="structMA__FILE.html">MA_FILE</a> *file;
<a name="l04553"></a>04553    <a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a> skip;
<a name="l04554"></a>04554    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="old__mevb_8cpp.html#af4211e1ba0e676018599e88cfae3537a">start_time</a>;
<a name="l04555"></a>04555 
<a name="l04556"></a>04556    <span class="comment">/* set output file name and flags in ODB */</span>
<a name="l04557"></a>04557    sprintf(str, <span class="stringliteral">&quot;/%s/Output/Filename&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l04558"></a>04558    <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="mana_8cpp.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a>, 256, 1, <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>);
<a name="l04559"></a>04559 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l04560"></a>04560 <span class="preprocessor"></span>   sprintf(str, <span class="stringliteral">&quot;/%s/Output/RWNT&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l04561"></a>04561    <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.rwnt, <span class="keyword">sizeof</span>(<a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a>), 1, <a class="code" href="group__mdefineh.html#ga252eb84661dfaa5959b5cb316117d696">TID_BOOL</a>);
<a name="l04562"></a>04562 <span class="preprocessor">#endif</span>
<a name="l04563"></a>04563 <span class="preprocessor"></span>
<a name="l04564"></a>04564    <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#a6e27d8876a43afce3ee4dd16527cbb9e">MINFO</a>, <span class="stringliteral">&quot;analyze_run&quot;</span>, <span class="stringliteral">&quot;Set run number %d in ODB&quot;</span>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l04565"></a>04565    <span class="comment">//assert(run_number &gt; 0);</span>
<a name="l04566"></a>04566 
<a name="l04567"></a>04567    <span class="comment">/* set run number in ODB */</span>
<a name="l04568"></a>04568    status =
<a name="l04569"></a>04569        <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/Runinfo/Run number&quot;</span>, &amp;<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, <span class="keyword">sizeof</span>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>), 1,
<a name="l04570"></a>04570                     <a class="code" href="group__mdefineh.html#gad950d5fde6dd3ea7eba59fb6760a38cb">TID_INT</a>);
<a name="l04571"></a>04571    assert(status == <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>);
<a name="l04572"></a>04572 
<a name="l04573"></a>04573    <span class="comment">/* set file name in out_info */</span>
<a name="l04574"></a>04574    strcpy(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, <a class="code" href="mana_8cpp.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a>);
<a name="l04575"></a>04575 
<a name="l04576"></a>04576    <span class="comment">/* let changes propagate to modules */</span>
<a name="l04577"></a>04577    <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(0);
<a name="l04578"></a>04578 
<a name="l04579"></a>04579    <span class="comment">/* open input file, will be changed to ma_open_file later... */</span>
<a name="l04580"></a>04580    file = <a class="code" href="mana_8cpp.html#acf053885bc02fc8661b8c5d23501be0f">ma_open</a>(<a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>);
<a name="l04581"></a>04581    <span class="keywordflow">if</span> (file == NULL) {
<a name="l04582"></a>04582       printf(<span class="stringliteral">&quot;Cannot open input file \&quot;%s\&quot;\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>);
<a name="l04583"></a>04583       <span class="keywordflow">return</span> -1;
<a name="l04584"></a>04584    }
<a name="l04585"></a>04585 
<a name="l04586"></a>04586    pevent_unaligned = (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) malloc(<a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>);
<a name="l04587"></a>04587    <span class="keywordflow">if</span> (pevent_unaligned == NULL) {
<a name="l04588"></a>04588       printf(<span class="stringliteral">&quot;Not enough memeory\n&quot;</span>);
<a name="l04589"></a>04589       <span class="keywordflow">return</span> -1;
<a name="l04590"></a>04590    }
<a name="l04591"></a>04591    pevent = (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) <a class="code" href="group__mmacroh.html#ga46bf3ace1698ee72389c30bc61d78686">ALIGN8</a>((<a class="code" href="group__midasincludecode.html#ga790216a8e71233fed28657b16a052e36">PTYPE</a>) pevent_unaligned);
<a name="l04592"></a>04592 
<a name="l04593"></a>04593    <span class="comment">/* call analyzer bor routines */</span>
<a name="l04594"></a>04594    <a class="code" href="mana_8cpp.html#aad9e8ec0221ce200e2bd2fd32f77833b">bor</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, error);
<a name="l04595"></a>04595 
<a name="l04596"></a>04596    num_events_in = num_events_out = 0;
<a name="l04597"></a>04597 
<a name="l04598"></a>04598    start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l04599"></a>04599 
<a name="l04600"></a>04600    <span class="comment">/* event loop */</span>
<a name="l04601"></a>04601    <span class="keywordflow">do</span> {
<a name="l04602"></a>04602       <span class="comment">/* read next event */</span>
<a name="l04603"></a>04603       memset(pevent_unaligned, 0, <a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>);
<a name="l04604"></a>04604       n = <a class="code" href="mana_8cpp.html#a86d00d374a6aed95075c5778cb25b321">ma_read_event</a>(file, pevent, <a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>);
<a name="l04605"></a>04605       <span class="keywordflow">if</span> (n &lt;= 0)
<a name="l04606"></a>04606          <span class="keywordflow">break</span>;
<a name="l04607"></a>04607 
<a name="l04608"></a>04608       num_events_in++;
<a name="l04609"></a>04609 
<a name="l04610"></a>04610       <span class="comment">/* copy system events (BOR, EOR, MESSAGE) to output file */</span>
<a name="l04611"></a>04611       <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> &lt; 0) {
<a name="l04612"></a>04612          status = <a class="code" href="miniana_8c.html#a681f90cedc0c323da19bfef26d8854b5">process_event</a>(NULL, pevent);
<a name="l04613"></a>04613          <span class="keywordflow">if</span> (status &lt; 0 || status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)      <span class="comment">/* disk full/stop analyzer */</span>
<a name="l04614"></a>04614             <span class="keywordflow">break</span>;
<a name="l04615"></a>04615 
<a name="l04616"></a>04616          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> &amp;&amp; <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l04617"></a>04617             size = pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l04618"></a>04618             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l04619"></a>04619                status = gzwrite(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>, pevent, size) == size ? <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l04620"></a>04620             <span class="keywordflow">else</span>
<a name="l04621"></a>04621                status =
<a name="l04622"></a>04622                    fwrite(pevent, 1, size,
<a name="l04623"></a>04623                           <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>) == (size_t) size ? <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l04624"></a>04624 
<a name="l04625"></a>04625             <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {
<a name="l04626"></a>04626                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;analyze_run&quot;</span>, <span class="stringliteral">&quot;Error writing to file (Disk full?)&quot;</span>);
<a name="l04627"></a>04627                <span class="keywordflow">return</span> -1;
<a name="l04628"></a>04628             }
<a name="l04629"></a>04629 
<a name="l04630"></a>04630             num_events_out++;
<a name="l04631"></a>04631          }
<a name="l04632"></a>04632 
<a name="l04633"></a>04633          <span class="comment">/* reinit start time after BOR event */</span>
<a name="l04634"></a>04634          <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> == <a class="code" href="group__mbufferh.html#gaea58a47233f988dd2f9a0320d99734dc">EVENTID_BOR</a>)
<a name="l04635"></a>04635             start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l04636"></a>04636       }
<a name="l04637"></a>04637 
<a name="l04638"></a>04638       <span class="comment">/* check if event is in event limit */</span>
<a name="l04639"></a>04639       skip = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l04640"></a>04640 
<a name="l04641"></a>04641       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {
<a name="l04642"></a>04642          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[0] &gt; 0 || <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[1] &gt; 0) {
<a name="l04643"></a>04643             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[1] == 0) {
<a name="l04644"></a>04644                <span class="comment">/* treat n[0] as upper limit */</span>
<a name="l04645"></a>04645                <span class="keywordflow">if</span> (num_events_in &gt; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[0]) {
<a name="l04646"></a>04646                   num_events_in--;
<a name="l04647"></a>04647                   status = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04648"></a>04648                   <span class="keywordflow">break</span>;
<a name="l04649"></a>04649                }
<a name="l04650"></a>04650             } <span class="keywordflow">else</span> {
<a name="l04651"></a>04651                <span class="keywordflow">if</span> (num_events_in &gt; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[1]) {
<a name="l04652"></a>04652                   status = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04653"></a>04653                   <span class="keywordflow">break</span>;
<a name="l04654"></a>04654                }
<a name="l04655"></a>04655                <span class="keywordflow">if</span> (num_events_in &lt; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[0])
<a name="l04656"></a>04656                   skip = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l04657"></a>04657                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[2] &gt; 0 &amp;&amp; num_events_in % <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.n[2] != 0)
<a name="l04658"></a>04658                   skip = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l04659"></a>04659             }
<a name="l04660"></a>04660          }
<a name="l04661"></a>04661       }
<a name="l04662"></a>04662 
<a name="l04663"></a>04663       <span class="keywordflow">if</span> (!skip) {
<a name="l04664"></a>04664          <span class="comment">/* find request belonging to this event */</span>
<a name="l04665"></a>04665          par = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>;
<a name="l04666"></a>04666          status = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04667"></a>04667          <span class="keywordflow">for</span> (i = 0; par-&gt;<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; par++)
<a name="l04668"></a>04668             <span class="keywordflow">if</span> ((par-&gt;<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="structAR__INFO.html#acb0cf26c5067b0c8eb7a895b70e42f11">event_id</a> == <a class="code" href="group__mdefineh.html#gabd88aa902705997125b541db3b94578c">EVENTID_ALL</a> ||
<a name="l04669"></a>04669                  par-&gt;<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="structAR__INFO.html#acb0cf26c5067b0c8eb7a895b70e42f11">event_id</a> == pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>) &amp;&amp;
<a name="l04670"></a>04670                 (par-&gt;<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="group__midasincludecode.html#ga947c408489c2b8cd8ea2fc8b2df83388">trigger_mask</a> == <a class="code" href="group__mdefineh.html#ga26aa4bcea89857cb7ca669339695ceac">TRIGGER_ALL</a> ||
<a name="l04671"></a>04671                  (par-&gt;<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="group__midasincludecode.html#ga947c408489c2b8cd8ea2fc8b2df83388">trigger_mask</a> &amp; pevent-&gt;<a class="code" href="group__midasincludecode.html#ga9b4b94f41521f5c188655b7bb0f1ec1b">trigger_mask</a>)) &amp;&amp;
<a name="l04672"></a>04672                 par-&gt;<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="group__midasincludecode.html#ga00b6cb7dc5fefe2d78d04caf3eb257cd">enabled</a>) {
<a name="l04673"></a>04673                <span class="comment">/* analyze this event */</span>
<a name="l04674"></a>04674                status = <a class="code" href="miniana_8c.html#a681f90cedc0c323da19bfef26d8854b5">process_event</a>(par, pevent);
<a name="l04675"></a>04675                <span class="keywordflow">if</span> (status == <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l04676"></a>04676                   num_events_out++;
<a name="l04677"></a>04677                <span class="keywordflow">if</span> (status &lt; 0 || status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)        <span class="comment">/* disk full/stop analyzer */</span>
<a name="l04678"></a>04678                   <span class="keywordflow">break</span>;
<a name="l04679"></a>04679 
<a name="l04680"></a>04680                <span class="comment">/* check for Ctrl-C */</span>
<a name="l04681"></a>04681                status = <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(0);
<a name="l04682"></a>04682             }
<a name="l04683"></a>04683          <span class="keywordflow">if</span> (status &lt; 0 || status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)
<a name="l04684"></a>04684             <span class="keywordflow">break</span>;
<a name="l04685"></a>04685       }
<a name="l04686"></a>04686 
<a name="l04687"></a>04687       <span class="comment">/* update ODB statistics once every 100 events */</span>
<a name="l04688"></a>04688       <span class="keywordflow">if</span> (num_events_in % 100 == 0) {
<a name="l04689"></a>04689          <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04690"></a>04690          <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet) {
<a name="l04691"></a>04691             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>)
<a name="l04692"></a>04692                printf(<span class="stringliteral">&quot;%s:%d  %s:%d  events\r&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, (<span class="keywordtype">int</span>) num_events_in,
<a name="l04693"></a>04693                       <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, (<span class="keywordtype">int</span>) num_events_out);
<a name="l04694"></a>04694             <span class="keywordflow">else</span>
<a name="l04695"></a>04695                printf(<span class="stringliteral">&quot;%s:%d  events\r&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, (<span class="keywordtype">int</span>) num_events_in);
<a name="l04696"></a>04696 
<a name="l04697"></a>04697 <span class="preprocessor">#ifndef OS_WINNT</span>
<a name="l04698"></a>04698 <span class="preprocessor"></span>            fflush(stdout);
<a name="l04699"></a>04699 <span class="preprocessor">#endif</span>
<a name="l04700"></a>04700 <span class="preprocessor"></span>         }
<a name="l04701"></a>04701       }
<a name="l04702"></a>04702    } <span class="keywordflow">while</span> (1);
<a name="l04703"></a>04703 
<a name="l04704"></a>04704 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l04705"></a>04705 <span class="preprocessor"></span>   PVM_DEBUG(<span class="stringliteral">&quot;analyze_run: event loop finished, status = %d&quot;</span>, status);
<a name="l04706"></a>04706 <span class="preprocessor">#endif</span>
<a name="l04707"></a>04707 <span class="preprocessor"></span>
<a name="l04708"></a>04708    <span class="comment">/* signal EOR to slaves */</span>
<a name="l04709"></a>04709 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l04710"></a>04710 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a>) {
<a name="l04711"></a>04711       <span class="keywordflow">if</span> (status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)
<a name="l04712"></a>04712          printf(<span class="stringliteral">&quot;\nShutting down distributed analyzers, please wait...\n&quot;</span>);
<a name="l04713"></a>04713       pvm_eor(status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a> ? TAG_EXIT : TAG_EOR);
<a name="l04714"></a>04714 
<a name="l04715"></a>04715       <span class="comment">/* merge slave output files */</span>
<a name="l04716"></a>04716       <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename[0] &amp;&amp; !<a class="code" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a>)
<a name="l04717"></a>04717          status = pvm_merge();
<a name="l04718"></a>04718 
<a name="l04719"></a>04719       start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>() - start_time;
<a name="l04720"></a>04720 
<a name="l04721"></a>04721       <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04722"></a>04722       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet) {
<a name="l04723"></a>04723          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>)
<a name="l04724"></a>04724             printf(<span class="stringliteral">&quot;%s:%d  %s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04725"></a>04725                    <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, num_events_out, start_time / 1000.0);
<a name="l04726"></a>04726          <span class="keywordflow">else</span>
<a name="l04727"></a>04727             printf(<span class="stringliteral">&quot;%s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04728"></a>04728                    start_time / 1000.0);
<a name="l04729"></a>04729       }
<a name="l04730"></a>04730    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {
<a name="l04731"></a>04731       start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>() - start_time;
<a name="l04732"></a>04732 
<a name="l04733"></a>04733       <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04734"></a>04734       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet) {
<a name="l04735"></a>04735          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>)
<a name="l04736"></a>04736             printf(<span class="stringliteral">&quot;%s:%d  %s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04737"></a>04737                    <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, num_events_out, start_time / 1000.0);
<a name="l04738"></a>04738          <span class="keywordflow">else</span>
<a name="l04739"></a>04739             printf(<span class="stringliteral">&quot;%s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04740"></a>04740                    start_time / 1000.0);
<a name="l04741"></a>04741       }
<a name="l04742"></a>04742 
<a name="l04743"></a>04743       <a class="code" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a>(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>, error);
<a name="l04744"></a>04744 
<a name="l04745"></a>04745       <span class="comment">/* send back tests */</span>
<a name="l04746"></a>04746       pvm_initsend(<a class="code" href="pvm3_8h.html#a4a488c409eabcd4587ced64938f4c43f">PvmDataInPlace</a>);
<a name="l04747"></a>04747 
<a name="l04748"></a>04748       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="fal_8c.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a>; i++)
<a name="l04749"></a>04749          pvm_pkbyte((<span class="keywordtype">char</span> *) <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i], <span class="keyword">sizeof</span>(<a class="code" href="structANA__TEST.html">ANA_TEST</a>), 1);
<a name="l04750"></a>04750 
<a name="l04751"></a>04751       PVM_DEBUG(<span class="stringliteral">&quot;analyze_run: send %d tests back to master&quot;</span>, n_test);
<a name="l04752"></a>04752 
<a name="l04753"></a>04753       status = pvm_send(pvm_myparent, TAG_EOR);
<a name="l04754"></a>04754       <span class="keywordflow">if</span> (status &lt; 0) {
<a name="l04755"></a>04755          pvm_perror(<span class="stringliteral">&quot;pvm_send&quot;</span>);
<a name="l04756"></a>04756          <span class="keywordflow">return</span> <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>;
<a name="l04757"></a>04757       }
<a name="l04758"></a>04758    } <span class="keywordflow">else</span> {
<a name="l04759"></a>04759       start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>() - start_time;
<a name="l04760"></a>04760 
<a name="l04761"></a>04761       <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04762"></a>04762       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet) {
<a name="l04763"></a>04763          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>)
<a name="l04764"></a>04764             printf(<span class="stringliteral">&quot;%s:%d  %s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04765"></a>04765                    <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, num_events_out, start_time / 1000.0);
<a name="l04766"></a>04766          <span class="keywordflow">else</span>
<a name="l04767"></a>04767             printf(<span class="stringliteral">&quot;%s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, num_events_in,
<a name="l04768"></a>04768                    start_time / 1000.0);
<a name="l04769"></a>04769       }
<a name="l04770"></a>04770 
<a name="l04771"></a>04771       <span class="comment">/* call analyzer eor routines */</span>
<a name="l04772"></a>04772       <a class="code" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a>(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>, error);
<a name="l04773"></a>04773    }
<a name="l04774"></a>04774 <span class="preprocessor">#else</span>
<a name="l04775"></a>04775 <span class="preprocessor"></span>
<a name="l04776"></a>04776    start_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>() - start_time;
<a name="l04777"></a>04777 
<a name="l04778"></a>04778    <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04779"></a>04779    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet) {
<a name="l04780"></a>04780       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>)
<a name="l04781"></a>04781          printf(<span class="stringliteral">&quot;%s:%d  %s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, (<span class="keywordtype">int</span>) num_events_in,
<a name="l04782"></a>04782                 <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename, (<span class="keywordtype">int</span>) num_events_out, start_time / 1000.0);
<a name="l04783"></a>04783       <span class="keywordflow">else</span>
<a name="l04784"></a>04784          printf(<span class="stringliteral">&quot;%s:%d  events, %1.2lfs\n&quot;</span>, <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>, (<span class="keywordtype">int</span>) num_events_in,
<a name="l04785"></a>04785                 start_time / 1000.0);
<a name="l04786"></a>04786    }
<a name="l04787"></a>04787 
<a name="l04788"></a>04788    <span class="comment">/* call analyzer eor routines */</span>
<a name="l04789"></a>04789    <a class="code" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a>(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>, error);
<a name="l04790"></a>04790 
<a name="l04791"></a>04791 <span class="preprocessor">#endif</span>
<a name="l04792"></a>04792 <span class="preprocessor"></span>
<a name="l04793"></a>04793    <a class="code" href="mana_8cpp.html#a715e03caa3809d9dce4e01e9be5d3232">ma_close</a>(file);
<a name="l04794"></a>04794 
<a name="l04795"></a>04795    free(pevent_unaligned);
<a name="l04796"></a>04796 
<a name="l04797"></a>04797    <span class="keywordflow">return</span> status;
<a name="l04798"></a>04798 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a14f75239e0a8c430e3706545197ad9"></a><!-- doxytag: member="mana.cpp::analyzer_exit" ref="a4a14f75239e0a8c430e3706545197ad9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> analyzer_exit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00184">184</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00185"></a>00185 {
<a name="l00186"></a>00186         <span class="keywordflow">if</span>(<a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#a69cb952a194ddefc6004dd96e70ccd62">gData</a>) {
<a name="l00187"></a>00187                 <span class="keyword">delete</span> <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#a69cb952a194ddefc6004dd96e70ccd62">gData</a>;
<a name="l00188"></a>00188                 <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#a69cb952a194ddefc6004dd96e70ccd62">gData</a> = NULL;
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         <span class="keywordflow">if</span>(<a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#aad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a>) {
<a name="l00192"></a>00192                 <span class="keyword">delete</span> <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#aad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a>;
<a name="l00193"></a>00193                 <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#aad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a> = NULL;
<a name="l00194"></a>00194         }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196         <span class="keywordflow">if</span>(<a class="code" href="analyzer_8cpp.html#ae5d613fcc5d7b3c8290e5be515df17f5">gVacuum</a>) {
<a name="l00197"></a>00197                 <span class="keyword">delete</span> <a class="code" href="analyzer_8cpp.html#ae5d613fcc5d7b3c8290e5be515df17f5">gVacuum</a>;
<a name="l00198"></a>00198                 <a class="code" href="analyzer_8cpp.html#ae5d613fcc5d7b3c8290e5be515df17f5">gVacuum</a> = NULL;
<a name="l00199"></a>00199         }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00202"></a>00202 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7987bd33585c5580d096cf8a54429f51"></a><!-- doxytag: member="mana.cpp::analyzer_init" ref="a7987bd33585c5580d096cf8a54429f51" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> analyzer_init </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00150">150</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {
<a name="l00152"></a>00152         <span class="keywordtype">bool</span> ret;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         <span class="comment">// Initialize gData</span>
<a name="l00155"></a>00155         <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#a69cb952a194ddefc6004dd96e70ccd62">gData</a> = <span class="keyword">new</span> <a class="code" href="classTGlobalData.html">TGlobalData</a>();
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         <span class="comment">// Initialize gSetup</span>
<a name="l00158"></a>00158         <a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#aad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a> = <span class="keyword">new</span> <a class="code" href="classTSetupData.html">TSetupData</a>();
<a name="l00159"></a>00159         ret = <a class="code" href="analyzer_8cpp.html#a2863bc10925723cab7743b567bb31905">UpdateDetectorBankNameMap</a>(<a class="code" href="MCAENPulseIslandSortAndStitch_8cpp.html#aad8aa5d5fe566b2f8f6ca3000b09f0e9">gSetup</a>);
<a name="l00160"></a>00160         <span class="keywordflow">if</span> (!ret) {
<a name="l00161"></a>00161                 printf(<span class="stringliteral">&quot;THERE WAS AN ERROR!\n&quot;</span>);
<a name="l00162"></a>00162                 <span class="keywordflow">return</span> 0;
<a name="l00163"></a>00163         }
<a name="l00164"></a>00164         <span class="comment">// Override ROOT&apos;s handling of signals</span>
<a name="l00165"></a>00165         signal(SIGHUP , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00166"></a>00166         signal(SIGINT , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00167"></a>00167         signal(SIGQUIT , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00168"></a>00168         signal(SIGILL , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00169"></a>00169         signal(SIGABRT , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00170"></a>00170         signal(SIGFPE , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00171"></a>00171         signal(SIGKILL , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00172"></a>00172         signal(SIGSEGV , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00173"></a>00173         signal(SIGPIPE , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00174"></a>00174         signal(SIGTERM , <a class="code" href="analyzer_8cpp.html#aa2f081a34e67d04d46dba4fa2bd840bc">catastrophe</a>);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176         <span class="comment">// Initialize gVacuum</span>
<a name="l00177"></a>00177         <a class="code" href="analyzer_8cpp.html#ae5d613fcc5d7b3c8290e5be515df17f5">gVacuum</a> = <span class="keyword">new</span> <a class="code" href="classTVacuumData.html">TVacuumData</a>();
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00180"></a>00180 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac268491d402244fca80333b38701c09f"></a><!-- doxytag: member="mana.cpp::analyzer_loop" ref="ac268491d402244fca80333b38701c09f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> analyzer_loop </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00236">236</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00237"></a>00237 {
<a name="l00238"></a>00238         <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l00239"></a>00239 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa2ad5915dcb13ea292c9b31f1cf492a9"></a><!-- doxytag: member="mana.cpp::banks_changed" ref="aa2ad5915dcb13ea292c9b31f1cf492a9" args="(INT hDB, INT hKey, void *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void banks_changed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01157">1157</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l02926">book_ntuples()</a>, <a class="el" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree()</a>, <a class="el" href="odb_8c_source.html#l07875">db_close_record()</a>, and <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01158"></a>01158 {
<a name="l01159"></a>01159    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80];
<a name="l01160"></a>01160    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162    <span class="comment">/* close previously opened hot link */</span>
<a name="l01163"></a>01163    sprintf(str, <span class="stringliteral">&quot;/%s/Bank switches&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l01164"></a>01164    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l01165"></a>01165    <a class="code" href="group__msectionh.html#gae60eb33ad37ee9a9ce1cbc872db2fb19">db_close_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey);
<a name="l01166"></a>01166 
<a name="l01167"></a>01167 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l01168"></a>01168 <span class="preprocessor"></span>   <a class="code" href="fal_8c.html#a2a0fbf63d5970373f81721ce136319dc">book_ntuples</a>();
<a name="l01169"></a>01169    printf(<span class="stringliteral">&quot;N-tuples rebooked\n&quot;</span>);
<a name="l01170"></a>01170 <span class="preprocessor">#endif</span>
<a name="l01171"></a>01171 <span class="preprocessor"></span><span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l01172"></a>01172 <span class="preprocessor"></span>   <a class="code" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree</a>();
<a name="l01173"></a>01173    printf(<span class="stringliteral">&quot;ROOT TTree rebooked\n&quot;</span>);
<a name="l01174"></a>01174 <span class="preprocessor">#endif</span>
<a name="l01175"></a>01175 <span class="preprocessor"></span>}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4b3cf3c50a5b66e9c00af61e2b715cc"></a><!-- doxytag: member="mana.cpp::bevid_2_mheader" ref="ab4b3cf3c50a5b66e9c00af61e2b715cc" args="(EVENT_HEADER *pevent, DWORD *pybos)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> bevid_2_mheader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> *&nbsp;</td>
          <td class="paramname"> <em>pybos</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04206">4206</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="midas_8h_source.html#l01193">EVENT_HEADER::serial_number</a>, <a class="el" href="midas_8h_source.html#l01033">SS_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01194">EVENT_HEADER::time_stamp</a>, <a class="el" href="midas_8h_source.html#l01192">EVENT_HEADER::trigger_mask</a>, <a class="el" href="ybos_8h_source.html#l00151">YB_SUCCESS</a>, <a class="el" href="ybos_8c_source.html#l00643">ybk_find()</a>, <a class="el" href="ybos_8h_source.html#l00283">YBOS_EVID_EVENT_ID</a>, <a class="el" href="ybos_8h_source.html#l00288">YBOS_EVID_EVENT_NB</a>, <a class="el" href="ybos_8h_source.html#l00287">YBOS_EVID_RUN_NUMBER</a>, <a class="el" href="ybos_8h_source.html#l00285">YBOS_EVID_SERIAL</a>, <a class="el" href="ybos_8h_source.html#l00286">YBOS_EVID_TIME</a>, and <a class="el" href="ybos_8h_source.html#l00284">YBOS_EVID_TRIGGER_MASK</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04425">ma_read_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04207"></a>04207 {
<a name="l04208"></a>04208    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l04209"></a>04209    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> bklen, bktyp, *pdata;
<a name="l04210"></a>04210    <a class="code" href="structYBOS__BANK__HEADER.html">YBOS_BANK_HEADER</a> *pybk;
<a name="l04211"></a>04211 
<a name="l04212"></a>04212    <span class="comment">/* check if EVID is present if so display its content */</span>
<a name="l04213"></a>04213    <span class="keywordflow">if</span> ((status = <a class="code" href="group__ybosincludecode.html#ga9f326548ddf809e142d16ff26a48e1a9">ybk_find</a>(pybos, <span class="stringliteral">&quot;EVID&quot;</span>, &amp;bklen, &amp;bktyp, (<span class="keywordtype">void</span> **) &amp;pybk)) == <a class="code" href="group__yboserrorh.html#gaf3834f9669e9c611d56b2b8b71f29869">YB_SUCCESS</a>) {
<a name="l04214"></a>04214       pdata = (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) ((<a class="code" href="structYBOS__BANK__HEADER.html">YBOS_BANK_HEADER</a> *) pybk + 1);
<a name="l04215"></a>04215       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.verbose) {
<a name="l04216"></a>04216          printf(<span class="stringliteral">&quot;--------- EVID --------- Event# %i ------Run#:%i--------\n&quot;</span>,
<a name="l04217"></a>04217                 (<span class="keywordtype">int</span>) (<a class="code" href="group__ybosmacroh.html#gac47f8cd70b6a4857e158b1db1cabd03f">YBOS_EVID_EVENT_NB</a>(pdata)), (<span class="keywordtype">int</span>) (<a class="code" href="group__ybosmacroh.html#gaf76637492097ef968ebe97d512e19b8d">YBOS_EVID_RUN_NUMBER</a>(pdata)));
<a name="l04218"></a>04218          printf(<span class="stringliteral">&quot;Evid:%4.4x- Mask:%4.4x- Serial:%i- Time:0x%x- Dsize:%i/0x%x&quot;</span>,
<a name="l04219"></a>04219                 (<span class="keywordtype">int</span>) <a class="code" href="group__ybosmacroh.html#gaa20b5bd51971a3dbf65ffa09dbda00db">YBOS_EVID_EVENT_ID</a>(pdata), (<span class="keywordtype">int</span>) <a class="code" href="group__ybosmacroh.html#gaf95ed2186275c9508470d03257254759">YBOS_EVID_TRIGGER_MASK</a>(pdata)
<a name="l04220"></a>04220                 , (<span class="keywordtype">int</span>) <a class="code" href="group__ybosmacroh.html#ga5b01530723b63088e380d00404f8860f">YBOS_EVID_SERIAL</a>(pdata), (<span class="keywordtype">int</span>) <a class="code" href="group__ybosmacroh.html#gaaa8203df912fab8c9315ce77bbfda60f">YBOS_EVID_TIME</a>(pdata)
<a name="l04221"></a>04221                 , (<span class="keywordtype">int</span>) pybk-&gt;length, (<span class="keywordtype">int</span>) pybk-&gt;length);
<a name="l04222"></a>04222       }
<a name="l04223"></a>04223       pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> = <a class="code" href="group__ybosmacroh.html#gaa20b5bd51971a3dbf65ffa09dbda00db">YBOS_EVID_EVENT_ID</a>(pdata);
<a name="l04224"></a>04224       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga9b4b94f41521f5c188655b7bb0f1ec1b">trigger_mask</a> = <a class="code" href="group__ybosmacroh.html#gaf95ed2186275c9508470d03257254759">YBOS_EVID_TRIGGER_MASK</a>(pdata);
<a name="l04225"></a>04225       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a> = <a class="code" href="group__ybosmacroh.html#ga5b01530723b63088e380d00404f8860f">YBOS_EVID_SERIAL</a>(pdata);
<a name="l04226"></a>04226       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga989421ee804ab76a0e11ac1c9c3b0e7a">time_stamp</a> = <a class="code" href="group__ybosmacroh.html#gaaa8203df912fab8c9315ce77bbfda60f">YBOS_EVID_TIME</a>(pdata);
<a name="l04227"></a>04227       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> = pybk-&gt;length;
<a name="l04228"></a>04228    }
<a name="l04229"></a>04229    <span class="keywordflow">return</span> <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a>;
<a name="l04230"></a>04230 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2a0fbf63d5970373f81721ce136319dc"></a><!-- doxytag: member="mana.cpp::book_ntuples" ref="a2a0fbf63d5970373f81721ce136319dc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> book_ntuples </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fal_8c_source.html#l02926">2926</a> of file <a class="el" href="fal_8c_source.html">fal.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02927"></a>02927 {
<a name="l02928"></a>02928    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, n_tag, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, id;
<a name="l02929"></a>02929    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l02930"></a>02930    <a class="code" href="structKEY.html">KEY</a> <a class="code" href="mdump_8c.html#a5cdb181553f9aa7bb182db5c195bb079">key</a>;
<a name="l02931"></a>02931    <span class="keywordtype">char</span> rw_tag[512][8];
<a name="l02932"></a>02932    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80], key_name[<a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>], block_name[<a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>];
<a name="l02933"></a>02933    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *bank_list;
<a name="l02934"></a>02934    <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def;
<a name="l02935"></a>02935 
<a name="l02936"></a>02936    <span class="comment">/* copy output flag from ODB to bank_list */</span>
<a name="l02937"></a>02937    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02938"></a>02938       bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l02939"></a>02939 
<a name="l02940"></a>02940       <span class="keywordflow">if</span> (bank_list != NULL)
<a name="l02941"></a>02941          <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++) {
<a name="l02942"></a>02942             sprintf(str, <span class="stringliteral">&quot;/%s/Bank switches/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>);
<a name="l02943"></a>02943             bank_list-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02944"></a>02944             size = <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>);
<a name="l02945"></a>02945             <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;bank_list-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a>, &amp;size, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02946"></a>02946          }
<a name="l02947"></a>02947    }
<a name="l02948"></a>02948 
<a name="l02949"></a>02949    <span class="comment">/* hot link bank switches to N-tuple re-booking */</span>
<a name="l02950"></a>02950    sprintf(str, <span class="stringliteral">&quot;/%s/Bank switches&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l02951"></a>02951    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l02952"></a>02952    <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, NULL, 0, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="fal_8c.html#aa2ad5915dcb13ea292c9b31f1cf492a9">banks_changed</a>, NULL);
<a name="l02953"></a>02953 
<a name="l02954"></a>02954    <span class="comment">/* book RW N-tuples */</span>
<a name="l02955"></a>02955 
<a name="l02956"></a>02956    <span class="comment">/* go through all analyzer requests (events) */</span>
<a name="l02957"></a>02957    <span class="keywordflow">for</span> (index = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; index++) {
<a name="l02958"></a>02958       <span class="comment">/* don&apos;t book N-tuples if buffer size is zero */</span>
<a name="l02959"></a>02959       <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].rwnt_buffer_size == 0)
<a name="l02960"></a>02960          <span class="keywordflow">continue</span>;
<a name="l02961"></a>02961 
<a name="l02962"></a>02962       n_tag = 0;
<a name="l02963"></a>02963 
<a name="l02964"></a>02964       strcpy(rw_tag[n_tag++], <span class="stringliteral">&quot;Run&quot;</span>);
<a name="l02965"></a>02965       strcpy(rw_tag[n_tag++], <span class="stringliteral">&quot;Number&quot;</span>);
<a name="l02966"></a>02966       strcpy(rw_tag[n_tag++], <span class="stringliteral">&quot;Time&quot;</span>);
<a name="l02967"></a>02967 
<a name="l02968"></a>02968       bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l02969"></a>02969       <span class="keywordflow">if</span> (bank_list == NULL) {
<a name="l02970"></a>02970          <span class="comment">/* book fixed event */</span>
<a name="l02971"></a>02971          event_def =
<a name="l02972"></a>02972              <a class="code" href="fal_8c.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a>((<span class="keywordtype">short</span> <span class="keywordtype">int</span>) <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].ar_info.event_id);
<a name="l02973"></a>02973 
<a name="l02974"></a>02974          <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l02975"></a>02975             status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, event_def-&gt;<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a>, i, &amp;hkey);
<a name="l02976"></a>02976             <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l02977"></a>02977                <span class="keywordflow">break</span>;
<a name="l02978"></a>02978 
<a name="l02979"></a>02979             <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;key);
<a name="l02980"></a>02980 
<a name="l02981"></a>02981             <span class="comment">/* convert blanks etc to &apos;_&apos; */</span>
<a name="l02982"></a>02982             strcpy(key_name, key.<a class="code" href="group__midasincludecode.html#gaab4927ab8eb9921525d82761adb11f5c">name</a>);
<a name="l02983"></a>02983             <span class="keywordflow">for</span> (j = 0; key_name[j]; j++) {
<a name="l02984"></a>02984                <span class="keywordflow">if</span> (!(key_name[j] &gt;= <span class="charliteral">&apos;a&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;z&apos;</span>) &amp;&amp;
<a name="l02985"></a>02985                    !(key_name[j] &gt;= <span class="charliteral">&apos;A&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;Z&apos;</span>) &amp;&amp;
<a name="l02986"></a>02986                    !(key_name[j] &gt;= <span class="charliteral">&apos;0&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;9&apos;</span>))
<a name="l02987"></a>02987                   key_name[j] = <span class="charliteral">&apos;_&apos;</span>;
<a name="l02988"></a>02988             }
<a name="l02989"></a>02989 
<a name="l02990"></a>02990             <span class="keywordflow">if</span> (key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a> &gt; 1)
<a name="l02991"></a>02991                <span class="keywordflow">for</span> (j = 0; j &lt; key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>; j++) {
<a name="l02992"></a>02992                   sprintf(str, <span class="stringliteral">&quot;%s%d&quot;</span>, key_name, j);
<a name="l02993"></a>02993                   strncpy(rw_tag[n_tag++], str, 8);
<a name="l02994"></a>02994                   <span class="keywordflow">if</span> (n_tag &gt;= 512) {
<a name="l02995"></a>02995                      <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;book_ntuples&quot;</span>,
<a name="l02996"></a>02996                             <span class="stringliteral">&quot;Too much tags for RW N-tupeles (512 maximum)&quot;</span>);
<a name="l02997"></a>02997                      <span class="keywordflow">return</span> 0;
<a name="l02998"></a>02998                   }
<a name="l02999"></a>02999             } <span class="keywordflow">else</span>
<a name="l03000"></a>03000                strncpy(rw_tag[n_tag++], key_name, 8);
<a name="l03001"></a>03001             <span class="keywordflow">if</span> (n_tag &gt;= 512) {
<a name="l03002"></a>03002                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;book_ntuples&quot;</span>,
<a name="l03003"></a>03003                       <span class="stringliteral">&quot;Too much tags for RW N-tupeles (512 maximum)&quot;</span>);
<a name="l03004"></a>03004                <span class="keywordflow">return</span> 0;
<a name="l03005"></a>03005             }
<a name="l03006"></a>03006          }
<a name="l03007"></a>03007       } <span class="keywordflow">else</span> {
<a name="l03008"></a>03008          <span class="comment">/* go through all banks in bank_list */</span>
<a name="l03009"></a>03009          <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++) {
<a name="l03010"></a>03010             <span class="comment">/* remember tag offset in n_data variable */</span>
<a name="l03011"></a>03011             bank_list-&gt;<a class="code" href="group__midasincludecode.html#gabea5afb1cbece5741ede80d53469368e">n_data</a> = n_tag;
<a name="l03012"></a>03012 
<a name="l03013"></a>03013             <span class="keywordflow">if</span> (bank_list-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a> == 0)
<a name="l03014"></a>03014                <span class="keywordflow">continue</span>;
<a name="l03015"></a>03015 
<a name="l03016"></a>03016             <span class="keywordflow">if</span> (bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga949d7a28bdf3923796ffb2dff8f28690">type</a> != <a class="code" href="group__mdefineh.html#ga8d82076a05b53876103e1c53d5878b75">TID_STRUCT</a>) {
<a name="l03017"></a>03017                <span class="keywordflow">for</span> (i = 0; i &lt; (<a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a>) bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga4208294c0d0b8b4df63102ff7d4eb887">size</a>; i++) {
<a name="l03018"></a>03018                   sprintf(str, <span class="stringliteral">&quot;%s%d&quot;</span>, bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>, i);
<a name="l03019"></a>03019                   strncpy(rw_tag[n_tag++], str, 8);
<a name="l03020"></a>03020                }
<a name="l03021"></a>03021             } <span class="keywordflow">else</span> {
<a name="l03022"></a>03022                <span class="comment">/* define structured bank */</span>
<a name="l03023"></a>03023                <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l03024"></a>03024                   status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga732747585d79c8c76c856d376aa56cf0">def_key</a>, i, &amp;hkey);
<a name="l03025"></a>03025                   <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l03026"></a>03026                      <span class="keywordflow">break</span>;
<a name="l03027"></a>03027 
<a name="l03028"></a>03028                   <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;key);
<a name="l03029"></a>03029 
<a name="l03030"></a>03030                   <span class="comment">/* convert blanks etc to &apos;_&apos; */</span>
<a name="l03031"></a>03031                   strcpy(key_name, key.<a class="code" href="group__midasincludecode.html#gaab4927ab8eb9921525d82761adb11f5c">name</a>);
<a name="l03032"></a>03032                   <span class="keywordflow">for</span> (j = 0; key_name[j]; j++) {
<a name="l03033"></a>03033                      <span class="keywordflow">if</span> (!(key_name[j] &gt;= <span class="charliteral">&apos;a&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;z&apos;</span>) &amp;&amp;
<a name="l03034"></a>03034                          !(key_name[j] &gt;= <span class="charliteral">&apos;A&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;Z&apos;</span>) &amp;&amp;
<a name="l03035"></a>03035                          !(key_name[j] &gt;= <span class="charliteral">&apos;0&apos;</span> &amp;&amp; key_name[j] &lt;= <span class="charliteral">&apos;9&apos;</span>))
<a name="l03036"></a>03036                         key_name[j] = <span class="charliteral">&apos;_&apos;</span>;
<a name="l03037"></a>03037                   }
<a name="l03038"></a>03038 
<a name="l03039"></a>03039                   <span class="keywordflow">if</span> (key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a> &gt; 1)
<a name="l03040"></a>03040                      <span class="keywordflow">for</span> (j = 0; j &lt; key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>; j++) {
<a name="l03041"></a>03041                         sprintf(str, <span class="stringliteral">&quot;%s%d&quot;</span>, key_name, j);
<a name="l03042"></a>03042                         strncpy(rw_tag[n_tag++], str, 8);
<a name="l03043"></a>03043                         <span class="keywordflow">if</span> (n_tag &gt;= 512) {
<a name="l03044"></a>03044                            <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;book_ntuples&quot;</span>,
<a name="l03045"></a>03045                                   <span class="stringliteral">&quot;Too much tags for RW N-tupeles (512 maximum)&quot;</span>);
<a name="l03046"></a>03046                            <span class="keywordflow">return</span> 0;
<a name="l03047"></a>03047                         }
<a name="l03048"></a>03048                   } <span class="keywordflow">else</span>
<a name="l03049"></a>03049                      strncpy(rw_tag[n_tag++], key_name, 8);
<a name="l03050"></a>03050                   <span class="keywordflow">if</span> (n_tag &gt;= 512) {
<a name="l03051"></a>03051                      <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;book_ntuples&quot;</span>,
<a name="l03052"></a>03052                             <span class="stringliteral">&quot;Too much tags for RW N-tupeles (512 maximum)&quot;</span>);
<a name="l03053"></a>03053                      <span class="keywordflow">return</span> 0;
<a name="l03054"></a>03054                   }
<a name="l03055"></a>03055                }
<a name="l03056"></a>03056             }
<a name="l03057"></a>03057          }
<a name="l03058"></a>03058       }
<a name="l03059"></a>03059 
<a name="l03060"></a>03060       <span class="comment">/* book N-tuple with evend ID */</span>
<a name="l03061"></a>03061       strcpy(block_name, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].event_name);
<a name="l03062"></a>03062       block_name[8] = 0;
<a name="l03063"></a>03063 <span class="preprocessor">#ifndef MANA_LITE</span>
<a name="l03064"></a>03064 <span class="preprocessor"></span>      <span class="keywordtype">id</span> = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>.<a class="code" href="structAR__INFO.html#acb0cf26c5067b0c8eb7a895b70e42f11">event_id</a>;
<a name="l03065"></a>03065       <span class="keywordflow">if</span> (<a class="code" href="hbook_8h.html#a3efc0c35b6588eb50787985bb6440719">HEXIST</a>(<span class="keywordtype">id</span>))
<a name="l03066"></a>03066          <a class="code" href="hbook_8h.html#a3d7fcc23e32f4f11cb69aa1f97073ac0">HDELET</a>(<span class="keywordtype">id</span>);
<a name="l03067"></a>03067 
<a name="l03068"></a>03068       <a class="code" href="hbook_8h.html#afa68d551e34550d853d9a019dfcad8a0">HBOOKN</a>(<span class="keywordtype">id</span>, block_name, n_tag, <a class="code" href="fal_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a>,
<a name="l03069"></a>03069              n_tag * <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].rwnt_buffer_size, rw_tag);
<a name="l03070"></a>03070 
<a name="l03071"></a>03071       <span class="keywordflow">if</span> (!<a class="code" href="hbook_8h.html#a3efc0c35b6588eb50787985bb6440719">HEXIST</a>(<span class="keywordtype">id</span>)) {
<a name="l03072"></a>03072          printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l03073"></a>03073          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#a6e27d8876a43afce3ee4dd16527cbb9e">MINFO</a>, <span class="stringliteral">&quot;book_ntuples&quot;</span>,
<a name="l03074"></a>03074                 <span class="stringliteral">&quot;Cannot book N-tuple #%d. Increase PAWC size via the -s flag or switch off banks&quot;</span>,
<a name="l03075"></a>03075                 <span class="keywordtype">id</span>);
<a name="l03076"></a>03076       }
<a name="l03077"></a>03077 <span class="preprocessor">#endif</span>
<a name="l03078"></a>03078 <span class="preprocessor"></span>   }
<a name="l03079"></a>03079 
<a name="l03080"></a>03080    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l03081"></a>03081 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1231b896720547aa0748ecfaa9e68d05"></a><!-- doxytag: member="mana.cpp::book_ttree" ref="a1231b896720547aa0748ecfaa9e68d05" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> book_ttree </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l01157">banks_changed()</a>, <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, and <a class="el" href="mana_8cpp_source.html#l01935">mana_init()</a>.</p>

</div>
</div>
<a class="anchor" id="aad9e8ec0221ce200e2bd2fd32f77833b"></a><!-- doxytag: member="mana.cpp::bor" ref="aad9e8ec0221ce200e2bd2fd32f77833b" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> bor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02079">2079</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="analyzer_8cpp_source.html#l00206">ana_begin_of_run()</a>, <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="fal_8c_source.html#l02926">book_ntuples()</a>, <a class="el" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree()</a>, <a class="el" href="group__midasincludecode.html#ga288a69852e0bcf07f90f4f344c42801b">ANA_MODULE::bor</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="odb_8c_source.html#l03261">db_get_value()</a>, <a class="el" href="crate3_2rpc__master_8cpp_source.html#l00027">enabled</a>, <a class="el" href="midas_8h_source.html#l01477">ANA_MODULE::enabled</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="odbhist_8c_source.html#l00059">file_name</a>, <a class="el" href="midas_8h_source.html#l00720">FORMAT_ASCII</a>, <a class="el" href="midas_8h_source.html#l00723">FORMAT_HBOOK</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l00724">FORMAT_ROOT</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#ad8864ed116c986a346b9899eced11cb1">gManaOutputFile</a>, <a class="el" href="mana_8cpp_source.html#l00636">HBOOK_LREC</a>, <a class="el" href="hbook_8h_source.html#l00043">HBSET</a>, <a class="el" href="hbook_8h_source.html#l00171">HEXIST</a>, <a class="el" href="hbook_8h_source.html#l00096">HIDALL</a>, <a class="el" href="hbook_8h_source.html#l00149">HRESET</a>, <a class="el" href="hbook_8h_source.html#l00154">HROPEN</a>, <a class="el" href="mana_8cpp_source.html#l01069">load_parameters()</a>, <a class="el" href="mana_8cpp_source.html#l00660">lrec</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>, <a class="el" href="camac_8c_source.html#l00506">n</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="midas_8h_source.html#l01452">BANK_LIST::output_flag</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="fal_8c_source.html#l02530">test_clear()</a>, <a class="el" href="midas_8h_source.html#l00742">TID_BOOL</a>, <a class="el" href="midas_8h_source.html#l00740">TID_DWORD</a>, and <a class="el" href="p30_8h_source.html#l00043">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, <a class="el" href="crate3_2crate_8cpp_source.html#l00295">begin_of_run()</a>, <a class="el" href="mana__orig_8c_source.html#l02081">bor()</a>, <a class="el" href="mana_8cpp_source.html#l02438">tr_prestart()</a>, <a class="el" href="mana__orig_8c_source.html#l02449">tr_start()</a>, and <a class="el" href="fal_8c_source.html#l02572">tr_start2()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02080"></a>02080 {
<a name="l02081"></a>02081    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l02082"></a>02082    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l02083"></a>02083    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>[256], *ext_str;
<a name="l02084"></a>02084    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *bank_list;
<a name="l02085"></a>02085 
<a name="l02086"></a>02086    <span class="comment">/* load parameters */</span>
<a name="l02087"></a>02087    <a class="code" href="mana_8cpp.html#ae20b777778d5dcd241cf1dfb0dd2230f">load_parameters</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l02088"></a>02088 
<a name="l02089"></a>02089    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02090"></a>02090       <span class="comment">/* copy output flag from ODB to bank_list */</span>
<a name="l02091"></a>02091       bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l02092"></a>02092 
<a name="l02093"></a>02093       <span class="keywordflow">if</span> (bank_list != NULL)
<a name="l02094"></a>02094          <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++) {
<a name="l02095"></a>02095             sprintf(str, <span class="stringliteral">&quot;/%s/Bank switches/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>);
<a name="l02096"></a>02096             bank_list-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02097"></a>02097             size = <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>);
<a name="l02098"></a>02098             <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;bank_list-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a>, &amp;size, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02099"></a>02099          }
<a name="l02100"></a>02100 
<a name="l02101"></a>02101       <span class="comment">/* copy module enabled flag to ana_module */</span>
<a name="l02102"></a>02102       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l02103"></a>02103       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++) {
<a name="l02104"></a>02104          sprintf(str, <span class="stringliteral">&quot;/%s/Module switches/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, module[j]-&gt;<a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>);
<a name="l02105"></a>02105          module[j]-&gt;<a class="code" href="group__midasincludecode.html#ga0d86abcfd4f421658176e51c24f7eb29">enabled</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02106"></a>02106          size = <span class="keyword">sizeof</span>(<a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a>);
<a name="l02107"></a>02107          <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>, &amp;size, <a class="code" href="group__mdefineh.html#ga252eb84661dfaa5959b5cb316117d696">TID_BOOL</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02108"></a>02108       }
<a name="l02109"></a>02109    }
<a name="l02110"></a>02110 
<a name="l02111"></a>02111    <span class="comment">/* clear histos, N-tuples and tests */</span>
<a name="l02112"></a>02112    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.clear_histos) {
<a name="l02113"></a>02113 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02114"></a>02114 <span class="preprocessor"></span>      <span class="keywordtype">int</span> hid[10000];
<a name="l02115"></a>02115       <span class="keywordtype">int</span> <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
<a name="l02116"></a>02116 
<a name="l02117"></a>02117       <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++)
<a name="l02118"></a>02118          <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].bank_list != NULL)
<a name="l02119"></a>02119             <span class="keywordflow">if</span> (<a class="code" href="hbook_8h.html#a3efc0c35b6588eb50787985bb6440719">HEXIST</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].ar_info.event_id))
<a name="l02120"></a>02120                <a class="code" href="hbook_8h.html#aabf9d6f4996c66f08569c299f1f48f8c">HRESET</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].ar_info.event_id, <a class="code" href="fal_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a>);
<a name="l02121"></a>02121 
<a name="l02122"></a>02122       <span class="comment">/* get list of all histos */</span>
<a name="l02123"></a>02123       <a class="code" href="hbook_8h.html#a9adb23be1d3ce4990eecbe93dc2c1d40">HIDALL</a>(hid, n);
<a name="l02124"></a>02124       <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
<a name="l02125"></a>02125          <span class="keywordflow">for</span> (j = 0; j &lt; 10000; j++)
<a name="l02126"></a>02126             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a32357ef75116a47e988625b8d78ecfc5">lock_list</a>[j] == 0 || <a class="code" href="mana_8cpp.html#a32357ef75116a47e988625b8d78ecfc5">lock_list</a>[j] == hid[i])
<a name="l02127"></a>02127                <span class="keywordflow">break</span>;
<a name="l02128"></a>02128 
<a name="l02129"></a>02129          <span class="comment">/* clear histo if not locked */</span>
<a name="l02130"></a>02130          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a32357ef75116a47e988625b8d78ecfc5">lock_list</a>[j] != hid[i])
<a name="l02131"></a>02131             <a class="code" href="hbook_8h.html#aabf9d6f4996c66f08569c299f1f48f8c">HRESET</a>(hid[i], <a class="code" href="fal_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a>);
<a name="l02132"></a>02132       }
<a name="l02133"></a>02133 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02134"></a>02134 
<a name="l02135"></a>02135 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02136"></a>02136 <span class="preprocessor"></span>      <span class="comment">/* clear histos */</span>
<a name="l02137"></a>02137       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.clear_histos)
<a name="l02138"></a>02138          ClearRootHistograms(gManaHistsDir);
<a name="l02139"></a>02139 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02140"></a>02140 
<a name="l02141"></a>02141       <span class="comment">/* clear tests */</span>
<a name="l02142"></a>02142       <a class="code" href="fal_8c.html#a443aaa38b1796a39d965acb610d31cc8">test_clear</a>();
<a name="l02143"></a>02143    }
<a name="l02144"></a>02144 
<a name="l02145"></a>02145    <span class="comment">/* open output file if not already open (append mode) and in offline mode */</span>
<a name="l02146"></a>02146    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> == NULL &amp;&amp; !<a class="code" href="mana_8cpp.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a>
<a name="l02147"></a>02147        &amp;&amp; !<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="stringliteral">&quot;OFLN&quot;</span>)) {
<a name="l02148"></a>02148       <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename[0]) {
<a name="l02149"></a>02149          strcpy(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename);
<a name="l02150"></a>02150          <span class="keywordflow">if</span> (strchr(str, <span class="charliteral">&apos;%&apos;</span>) != NULL)
<a name="l02151"></a>02151             sprintf(file_name, str, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l02152"></a>02152          <span class="keywordflow">else</span>
<a name="l02153"></a>02153             strcpy(file_name, str);
<a name="l02154"></a>02154 
<a name="l02155"></a>02155          <span class="comment">/* check output file extension */</span>
<a name="l02156"></a>02156          <a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02157"></a>02157          <span class="keywordflow">if</span> (strchr(file_name, <span class="charliteral">&apos;.&apos;</span>)) {
<a name="l02158"></a>02158             ext_str = file_name + strlen(file_name) - 1;
<a name="l02159"></a>02159             <span class="keywordflow">while</span> (*ext_str != <span class="charliteral">&apos;.&apos;</span>)
<a name="l02160"></a>02160                ext_str--;
<a name="l02161"></a>02161 
<a name="l02162"></a>02162             <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.gz&quot;</span>, 3) == 0) {
<a name="l02163"></a>02163                <a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02164"></a>02164                ext_str--;
<a name="l02165"></a>02165                <span class="keywordflow">while</span> (*ext_str != <span class="charliteral">&apos;.&apos;</span> &amp;&amp; ext_str &gt; file_name)
<a name="l02166"></a>02166                   ext_str--;
<a name="l02167"></a>02167             }
<a name="l02168"></a>02168 
<a name="l02169"></a>02169             <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.asc&quot;</span>, 4) == 0)
<a name="l02170"></a>02170                <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> = <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>;
<a name="l02171"></a>02171             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.mid&quot;</span>, 4) == 0)
<a name="l02172"></a>02172                <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> = <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>;
<a name="l02173"></a>02173             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.rz&quot;</span>, 3) == 0)
<a name="l02174"></a>02174                <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> = <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>;
<a name="l02175"></a>02175             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.root&quot;</span>, 5) == 0)
<a name="l02176"></a>02176                <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> = <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>;
<a name="l02177"></a>02177             <span class="keywordflow">else</span> {
<a name="l02178"></a>02178                strcpy(error,
<a name="l02179"></a>02179                       <span class="stringliteral">&quot;Unknown output data format. Please use file extension .asc, .mid, .rz or .root.\n&quot;</span>);
<a name="l02180"></a>02180                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, error);
<a name="l02181"></a>02181                <span class="keywordflow">return</span> 0;
<a name="l02182"></a>02182             }
<a name="l02183"></a>02183          } <span class="keywordflow">else</span>
<a name="l02184"></a>02184             <a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> = <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>;
<a name="l02185"></a>02185 
<a name="l02186"></a>02186 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l02187"></a>02187 <span class="preprocessor"></span>         <span class="comment">/* use node name as filename if PVM slave */</span>
<a name="l02188"></a>02188          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {
<a name="l02189"></a>02189             <span class="comment">/* extract extension */</span>
<a name="l02190"></a>02190             <span class="keywordflow">if</span> (strchr(file_name, <span class="charliteral">&apos;.&apos;</span>)) {
<a name="l02191"></a>02191                strcpy(str, strchr(file_name, <span class="charliteral">&apos;.&apos;</span>) + 1);
<a name="l02192"></a>02192                sprintf(file_name, <span class="stringliteral">&quot;n%d&quot;</span>, pvm_client_index);
<a name="l02193"></a>02193                strcat(file_name, <span class="stringliteral">&quot;.&quot;</span>);
<a name="l02194"></a>02194                strcat(file_name, str);
<a name="l02195"></a>02195             } <span class="keywordflow">else</span> {
<a name="l02196"></a>02196                sprintf(file_name, <span class="stringliteral">&quot;n%d&quot;</span>, pvm_client_index);
<a name="l02197"></a>02197             }
<a name="l02198"></a>02198 
<a name="l02199"></a>02199             PVM_DEBUG(<span class="stringliteral">&quot;BOR: file_name = %s&quot;</span>, file_name);
<a name="l02200"></a>02200          }
<a name="l02201"></a>02201 <span class="preprocessor">#endif</span>
<a name="l02202"></a>02202 <span class="preprocessor"></span>
<a name="l02203"></a>02203          <span class="comment">/* open output file */</span>
<a name="l02204"></a>02204          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>) {
<a name="l02205"></a>02205 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02206"></a>02206 <span class="preprocessor"></span>            <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="mana_8cpp.html#a57f54b03009e95624f04afab052e6f2e">lrec</a>;
<a name="l02207"></a>02207             <span class="keywordtype">char</span> str2[80];
<a name="l02208"></a>02208 
<a name="l02209"></a>02209             lrec = <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.lrec;
<a name="l02210"></a>02210 <span class="preprocessor">#ifdef extname</span>
<a name="l02211"></a>02211 <span class="preprocessor"></span>            quest_[9] = 65000;
<a name="l02212"></a>02212 <span class="preprocessor">#else</span>
<a name="l02213"></a>02213 <span class="preprocessor"></span>            <a class="code" href="fal_8c.html#a54e2499cfb7a66c138ef6c0e1b4714f4">QUEST</a>[9] = 65000;
<a name="l02214"></a>02214 <span class="preprocessor">#endif</span>
<a name="l02215"></a>02215 <span class="preprocessor"></span>
<a name="l02216"></a>02216             strcpy(str, <span class="stringliteral">&quot;BSIZE&quot;</span>);
<a name="l02217"></a>02217             <a class="code" href="hbook_8h.html#ac48bfb20cfbfc47ea35b184e6d7ca4bb">HBSET</a>(str, <a class="code" href="mana_8cpp.html#a4f4d653810d83035206144299458b3d0">HBOOK_LREC</a>, status);
<a name="l02218"></a>02218             strcpy(str, <span class="stringliteral">&quot;OFFLINE&quot;</span>);
<a name="l02219"></a>02219             strcpy(str2, <span class="stringliteral">&quot;NQP&quot;</span>);
<a name="l02220"></a>02220             <a class="code" href="hbook_8h.html#a8090e517e3eaf8ef982f3fdb986b7faa">HROPEN</a>(1, str, file_name, str2, lrec, status);
<a name="l02221"></a>02221             <span class="keywordflow">if</span> (status != 0) {
<a name="l02222"></a>02222                sprintf(error, <span class="stringliteral">&quot;Cannot open output file %s&quot;</span>, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename);
<a name="l02223"></a>02223                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, error);
<a name="l02224"></a>02224                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = NULL;
<a name="l02225"></a>02225                <span class="keywordflow">return</span> 0;
<a name="l02226"></a>02226             } <span class="keywordflow">else</span>
<a name="l02227"></a>02227                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = (FILE *) 1;
<a name="l02228"></a>02228 <span class="preprocessor">#else</span>
<a name="l02229"></a>02229 <span class="preprocessor"></span>            <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, <span class="stringliteral">&quot;HBOOK support is not compiled in&quot;</span>);
<a name="l02230"></a>02230 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02231"></a>02231          }
<a name="l02232"></a>02232 
<a name="l02233"></a>02233          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>) {
<a name="l02234"></a>02234 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02235"></a>02235 <span class="preprocessor"></span>            <span class="comment">// ensure the output file is closed</span>
<a name="l02236"></a>02236             assert(gManaOutputFile == NULL);
<a name="l02237"></a>02237 
<a name="l02238"></a>02238             <a class="code" href="MDQ__Amplitude_8cpp.html#ad8864ed116c986a346b9899eced11cb1">gManaOutputFile</a> =
<a name="l02239"></a>02239                 <span class="keyword">new</span> TFile(file_name, <span class="stringliteral">&quot;RECREATE&quot;</span>, <span class="stringliteral">&quot;Midas Analyzer output file&quot;</span>);
<a name="l02240"></a>02240             <span class="keywordflow">if</span> (gManaOutputFile == NULL) {
<a name="l02241"></a>02241                sprintf(error, <span class="stringliteral">&quot;Cannot open output file %s&quot;</span>, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename);
<a name="l02242"></a>02242                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, error);
<a name="l02243"></a>02243                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = NULL;
<a name="l02244"></a>02244                <span class="keywordflow">return</span> 0;
<a name="l02245"></a>02245             }
<a name="l02246"></a>02246             <span class="comment">// make all ROOT objects created by user module bor() functions</span>
<a name="l02247"></a>02247             <span class="comment">// go into the output file</span>
<a name="l02248"></a>02248             <a class="code" href="MDQ__Amplitude_8cpp.html#ad8864ed116c986a346b9899eced11cb1">gManaOutputFile</a>-&gt;cd();
<a name="l02249"></a>02249 
<a name="l02250"></a>02250             <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = (FILE *) 1;
<a name="l02251"></a>02251 <span class="preprocessor">#else</span>
<a name="l02252"></a>02252 <span class="preprocessor"></span>            <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, <span class="stringliteral">&quot;ROOT support is not compiled in&quot;</span>);
<a name="l02253"></a>02253 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02254"></a>02254          }
<a name="l02255"></a>02255 
<a name="l02256"></a>02256          <span class="keywordflow">else</span> {
<a name="l02257"></a>02257             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l02258"></a>02258                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = (FILE *) gzopen(file_name, <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l02259"></a>02259             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>)
<a name="l02260"></a>02260                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = fopen(file_name, <span class="stringliteral">&quot;wt&quot;</span>);
<a name="l02261"></a>02261             <span class="keywordflow">else</span>
<a name="l02262"></a>02262                <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = fopen(file_name, <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l02263"></a>02263             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> == NULL) {
<a name="l02264"></a>02264                sprintf(error, <span class="stringliteral">&quot;Cannot open output file %s&quot;</span>, file_name);
<a name="l02265"></a>02265                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, error);
<a name="l02266"></a>02266                <span class="keywordflow">return</span> 0;
<a name="l02267"></a>02267             }
<a name="l02268"></a>02268          }
<a name="l02269"></a>02269       } <span class="keywordflow">else</span>
<a name="l02270"></a>02270          <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = NULL;
<a name="l02271"></a>02271 
<a name="l02272"></a>02272 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02273"></a>02273 <span class="preprocessor"></span>      <span class="comment">/* book N-tuples */</span>
<a name="l02274"></a>02274       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>) {
<a name="l02275"></a>02275          <span class="keywordtype">int</span> status = <a class="code" href="fal_8c.html#a2a0fbf63d5970373f81721ce136319dc">book_ntuples</a>();
<a name="l02276"></a>02276          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02277"></a>02277             <span class="keywordflow">return</span> status;
<a name="l02278"></a>02278       }
<a name="l02279"></a>02279 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02280"></a>02280 
<a name="l02281"></a>02281 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02282"></a>02282 <span class="preprocessor"></span>      <span class="comment">/* book ROOT TTree */</span>
<a name="l02283"></a>02283       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>) {
<a name="l02284"></a>02284          <span class="keywordtype">int</span> status = <a class="code" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree</a>();
<a name="l02285"></a>02285          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02286"></a>02286             <span class="keywordflow">return</span> status;
<a name="l02287"></a>02287       }
<a name="l02288"></a>02288 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02289"></a>02289 
<a name="l02290"></a>02290    }
<a name="l02291"></a>02291 
<a name="l02292"></a>02292 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02293"></a>02293 <span class="preprocessor"></span>   <span class="comment">/* open secondary output file if applicable. */</span>
<a name="l02294"></a>02294    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> != <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a> &amp;&amp; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.secondary_output_file_name[0] != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l02295"></a>02295     <span class="comment">// ensure the output file is closed</span>
<a name="l02296"></a>02296     assert(gManaOutputFile == NULL);
<a name="l02297"></a>02297 
<a name="l02298"></a>02298     <a class="code" href="MDQ__Amplitude_8cpp.html#ad8864ed116c986a346b9899eced11cb1">gManaOutputFile</a> =
<a name="l02299"></a>02299         <span class="keyword">new</span> TFile(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.secondary_output_file_name, <span class="stringliteral">&quot;RECREATE&quot;</span>, 
<a name="l02300"></a>02300                         <span class="stringliteral">&quot;Midas Analyzer output file&quot;</span>);
<a name="l02301"></a>02301     <span class="keywordflow">if</span> (gManaOutputFile == NULL) {
<a name="l02302"></a>02302        sprintf(error, <span class="stringliteral">&quot;Cannot open secondary output file %s&quot;</span>, 
<a name="l02303"></a>02303                        <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.secondary_output_file_name);
<a name="l02304"></a>02304        <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, error);
<a name="l02305"></a>02305        <span class="keywordflow">return</span> 0;
<a name="l02306"></a>02306     }
<a name="l02307"></a>02307     <span class="comment">// make all ROOT objects created by user module bor() functions</span>
<a name="l02308"></a>02308     <span class="comment">// go into the output file</span>
<a name="l02309"></a>02309     <a class="code" href="MDQ__Amplitude_8cpp.html#ad8864ed116c986a346b9899eced11cb1">gManaOutputFile</a>-&gt;cd();
<a name="l02310"></a>02310    }
<a name="l02311"></a>02311 
<a name="l02312"></a>02312 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02313"></a>02313 
<a name="l02314"></a>02314    <span class="comment">/* if (out_file == NULL) */</span>
<a name="l02315"></a>02315    <span class="comment">/* save run number */</span>
<a name="l02316"></a>02316    <a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a> = <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>;
<a name="l02317"></a>02317 
<a name="l02318"></a>02318    <span class="comment">/* call bor for modules */</span>
<a name="l02319"></a>02319    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02320"></a>02320       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l02321"></a>02321       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++)
<a name="l02322"></a>02322          <span class="keywordflow">if</span> (module[j]-&gt;<a class="code" href="mana_8cpp.html#aad9e8ec0221ce200e2bd2fd32f77833b">bor</a> != NULL &amp;&amp; module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>)
<a name="l02323"></a>02323             module[j]-&gt;<a class="code" href="group__midasincludecode.html#ga288a69852e0bcf07f90f4f344c42801b">bor</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l02324"></a>02324    }
<a name="l02325"></a>02325 
<a name="l02326"></a>02326    <span class="comment">/* call main analyzer BOR routine */</span>
<a name="l02327"></a>02327    <span class="keywordflow">return</span> <a class="code" href="analyzer_8cpp.html#a22c6bd312e4f7ffd79162e64835cfd42">ana_begin_of_run</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, error);
<a name="l02328"></a>02328 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaaa4a125e1a58b328027f929bc2ec7db"></a><!-- doxytag: member="mana.cpp::correct_num_events" ref="aaaa4a125e1a58b328027f929bc2ec7db" args="(INT i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void correct_num_events </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>i</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03590">3590</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01517">ANALYZE_REQUEST::events_received</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03591"></a>03591 {
<a name="l03592"></a>03592    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a3eb68b44171b0cd2d0c55c51a10188a4">_current_par</a>)
<a name="l03593"></a>03593       <a class="code" href="mana_8cpp.html#a3eb68b44171b0cd2d0c55c51a10188a4">_current_par</a>-&gt;<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a> += <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a> - 1;
<a name="l03594"></a>03594 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad5d6f1e4c99351c9278d6189b7e87b08"></a><!-- doxytag: member="mana.cpp::db_get_event_definition" ref="ad5d6f1e4c99351c9278d6189b7e87b08" args="(short int event_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structEVENT__DEF.html">EVENT_DEF</a>* db_get_event_definition </td>
          <td>(</td>
          <td class="paramtype">short int&nbsp;</td>
          <td class="paramname"> <em>event_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00893">893</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="odb_8c_source.html#l03390">db_enum_key()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l03261">db_get_value()</a>, <a class="el" href="midas_8h_source.html#l01016">DB_NO_MORE_SUBKEYS</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="mana_8cpp_source.html#l00890">EVENT_DEF::disabled</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="fal_8c.html#a696fa60df0f6ed300eb2f4d17ea46054">EVENT_DEF_CACHE_SIZE</a>, <a class="el" href="fal_8c_source.html#l00764">EVENT_DEF::event_id</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="fal_8c_source.html#l00765">EVENT_DEF::format</a>, <a class="el" href="midas_8h_source.html#l00720">FORMAT_ASCII</a>, <a class="el" href="midas_8h_source.html#l00722">FORMAT_DUMP</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="fal_8c_source.html#l00766">EVENT_DEF::hDefKey</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="mana_8cpp_source.html#l00677">index</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="ybos_8c_source.html#l00373">size</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="midas_8h_source.html#l00741">TID_INT</a>, <a class="el" href="midas_8h_source.html#l00746">TID_STRING</a>, <a class="el" href="midas_8h_source.html#l00738">TID_WORD</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, <a class="el" href="mana_8cpp_source.html#l00887">EVENT_DEF::type</a>, and <a class="el" href="mana_8cpp_source.html#l00675">type</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00894"></a>00894 {
<a name="l00895"></a>00895    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, <a class="code" href="mana_8cpp.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a>;
<a name="l00896"></a>00896    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80];
<a name="l00897"></a>00897    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, hKeyRoot;
<a name="l00898"></a>00898    <a class="code" href="unionWORD.html">WORD</a> id;
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 <span class="preprocessor">#define EVENT_DEF_CACHE_SIZE 30</span>
<a name="l00901"></a>00901 <span class="preprocessor"></span>   <span class="keyword">static</span> <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def = NULL;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903    <span class="comment">/* allocate memory for cache */</span>
<a name="l00904"></a>00904    <span class="keywordflow">if</span> (event_def == NULL)
<a name="l00905"></a>00905       event_def = (<a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *) calloc(EVENT_DEF_CACHE_SIZE, <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__DEF.html">EVENT_DEF</a>));
<a name="l00906"></a>00906 
<a name="l00907"></a>00907    <span class="comment">/* lookup if event definition in cache */</span>
<a name="l00908"></a>00908    <span class="keywordflow">for</span> (i = 0; event_def[i].<a class="code" href="structEVENT__DEF.html#a450b12516bc22bbd288f8172099ef85f">event_id</a>; i++)
<a name="l00909"></a>00909       <span class="keywordflow">if</span> (event_def[i].<a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a> == <a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a>)
<a name="l00910"></a>00910          <span class="keywordflow">return</span> &amp;event_def[i];
<a name="l00911"></a>00911 
<a name="l00912"></a>00912    <span class="comment">/* search free cache entry */</span>
<a name="l00913"></a>00913    <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="fal_8c.html#a696fa60df0f6ed300eb2f4d17ea46054">EVENT_DEF_CACHE_SIZE</a>; index++)
<a name="l00914"></a>00914       <span class="keywordflow">if</span> (event_def[index].<a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a> == 0)
<a name="l00915"></a>00915          <span class="keywordflow">break</span>;
<a name="l00916"></a>00916 
<a name="l00917"></a>00917    <span class="keywordflow">if</span> (index == EVENT_DEF_CACHE_SIZE) {
<a name="l00918"></a>00918       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;db_get_event_definition&quot;</span>, <span class="stringliteral">&quot;too many event definitions&quot;</span>);
<a name="l00919"></a>00919       <span class="keywordflow">return</span> NULL;
<a name="l00920"></a>00920    }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922    <span class="comment">/* check for system events */</span>
<a name="l00923"></a>00923    <span class="keywordflow">if</span> (<a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a> &lt; 0) {
<a name="l00924"></a>00924       event_def[index].<a class="code" href="structEVENT__DEF.html#a450b12516bc22bbd288f8172099ef85f">event_id</a> = <a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a>;
<a name="l00925"></a>00925       event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>;
<a name="l00926"></a>00926       event_def[index].<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a> = 0;
<a name="l00927"></a>00927       event_def[index].<a class="code" href="structEVENT__DEF.html#a66d1640adf533d3d29e015244e0c4fd2">disabled</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00928"></a>00928       <span class="keywordflow">return</span> &amp;event_def[index];
<a name="l00929"></a>00929    }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931    status = <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/equipment&quot;</span>, &amp;hKeyRoot);
<a name="l00932"></a>00932    <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l00933"></a>00933       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;db_get_event_definition&quot;</span>, <span class="stringliteral">&quot;cannot find /equipment entry in ODB&quot;</span>);
<a name="l00934"></a>00934       <span class="keywordflow">return</span> NULL;
<a name="l00935"></a>00935    }
<a name="l00936"></a>00936 
<a name="l00937"></a>00937    <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l00938"></a>00938       <span class="comment">/* search for equipment with specific name */</span>
<a name="l00939"></a>00939       status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, i, &amp;hKey);
<a name="l00940"></a>00940       <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>) {
<a name="l00941"></a>00941          sprintf(str, <span class="stringliteral">&quot;Cannot find event id %d under /equipment&quot;</span>, <a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a>);
<a name="l00942"></a>00942          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;db_get_event_definition&quot;</span>, str);
<a name="l00943"></a>00943          <span class="keywordflow">return</span> NULL;
<a name="l00944"></a>00944       }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946       size = <span class="keyword">sizeof</span>(id);
<a name="l00947"></a>00947       status = <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <span class="stringliteral">&quot;Common/Event ID&quot;</span>, &amp;<span class="keywordtype">id</span>, &amp;size, <a class="code" href="group__mdefineh.html#ga681cbe2c114c62cecccb882544d2debb">TID_WORD</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00948"></a>00948       <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00949"></a>00949          <span class="keywordflow">continue</span>;
<a name="l00950"></a>00950 
<a name="l00951"></a>00951       size = <span class="keyword">sizeof</span>(type);
<a name="l00952"></a>00952       status = <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <span class="stringliteral">&quot;Common/Type&quot;</span>, &amp;type, &amp;size, <a class="code" href="group__mdefineh.html#gad950d5fde6dd3ea7eba59fb6760a38cb">TID_INT</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00953"></a>00953       <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00954"></a>00954          <span class="keywordflow">continue</span>;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956       <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a>) {
<a name="l00957"></a>00957          <span class="comment">/* set cache entry */</span>
<a name="l00958"></a>00958          event_def[index].<a class="code" href="structEVENT__DEF.html#a450b12516bc22bbd288f8172099ef85f">event_id</a> = id;
<a name="l00959"></a>00959          event_def[index].<a class="code" href="structEVENT__DEF.html#a1f9fe59026081d85b2ee6ad8645e060b">type</a> = type;
<a name="l00960"></a>00960 
<a name="l00961"></a>00961          size = <span class="keyword">sizeof</span>(str);
<a name="l00962"></a>00962          str[0] = 0;
<a name="l00963"></a>00963          <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <span class="stringliteral">&quot;Common/Format&quot;</span>, str, &amp;size, <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;Fixed&quot;</span>))
<a name="l00966"></a>00966             event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a>;
<a name="l00967"></a>00967          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;ASCII&quot;</span>))
<a name="l00968"></a>00968             event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>;
<a name="l00969"></a>00969          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;MIDAS&quot;</span>))
<a name="l00970"></a>00970             event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>;
<a name="l00971"></a>00971          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;YBOS&quot;</span>))
<a name="l00972"></a>00972             event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>;
<a name="l00973"></a>00973          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;DUMP&quot;</span>))
<a name="l00974"></a>00974             event_def[index].<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> = <a class="code" href="group__mdefineh.html#gaffaf04a985dfa6ff43ab39a8c6e3f0a7">FORMAT_DUMP</a>;
<a name="l00975"></a>00975          <span class="keywordflow">else</span> {
<a name="l00976"></a>00976             <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;db_get_event_definition&quot;</span>, <span class="stringliteral">&quot;unknown data format&quot;</span>);
<a name="l00977"></a>00977             event_def[index].<a class="code" href="structEVENT__DEF.html#a450b12516bc22bbd288f8172099ef85f">event_id</a> = 0;
<a name="l00978"></a>00978             <span class="keywordflow">return</span> NULL;
<a name="l00979"></a>00979          }
<a name="l00980"></a>00980 
<a name="l00981"></a>00981          <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <span class="stringliteral">&quot;Variables&quot;</span>, &amp;event_def[index].hDefKey);
<a name="l00982"></a>00982          <span class="keywordflow">return</span> &amp;event_def[index];
<a name="l00983"></a>00983       }
<a name="l00984"></a>00984    }
<a name="l00985"></a>00985 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="accdfb5cb6649097a857202444fbc3aa6"></a><!-- doxytag: member="mana.cpp::eor" ref="accdfb5cb6649097a857202444fbc3aa6" args="(INT run_number, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> eor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02332">2332</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l02470">add_data_dir()</a>, <a class="el" href="midas_8h_source.html#l01453">BANK_LIST::addr</a>, <a class="el" href="midas_8h_source.html#l01511">ANALYZE_REQUEST::addr</a>, <a class="el" href="lrs1821_8c_source.html#l00037">addr</a>, <a class="el" href="analyzer_8cpp_source.html#l00214">ana_end_of_run()</a>, <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="crate3_2rpc__master_8cpp_source.html#l00027">enabled</a>, <a class="el" href="group__midasincludecode.html#gab6b3f976d916f185922ed4ccfe6453c6">ANA_MODULE::eor</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="odbhist_8c_source.html#l00059">file_name</a>, <a class="el" href="midas_8h_source.html#l00723">FORMAT_HBOOK</a>, <a class="el" href="midas_8h_source.html#l00724">FORMAT_ROOT</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>, <a class="el" href="hbook_8h_source.html#l00148">HREND</a>, <a class="el" href="hbook_8h_source.html#l00155">HROUT</a>, <a class="el" href="hbook_8h_source.html#l00156">HRPUT</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, and <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, <a class="el" href="crate3_2crate_8cpp_source.html#l00330">end_of_run()</a>, <a class="el" href="mana__orig_8c_source.html#l02342">eor()</a>, and <a class="el" href="fal_8c_source.html#l02661">tr_stop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02333"></a>02333 {
<a name="l02334"></a>02334    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l02335"></a>02335    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *bank_list;
<a name="l02336"></a>02336    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l02337"></a>02337    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>[256];
<a name="l02338"></a>02338 
<a name="l02339"></a>02339    <span class="comment">/* call EOR routines modules */</span>
<a name="l02340"></a>02340    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02341"></a>02341       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l02342"></a>02342       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++)
<a name="l02343"></a>02343          <span class="keywordflow">if</span> (module[j]-&gt;<a class="code" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a> != NULL &amp;&amp; module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>)
<a name="l02344"></a>02344             module[j]-&gt;<a class="code" href="group__midasincludecode.html#gab6b3f976d916f185922ed4ccfe6453c6">eor</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l02345"></a>02345    }
<a name="l02346"></a>02346 
<a name="l02347"></a>02347    <span class="comment">/* call main analyzer BOR routine */</span>
<a name="l02348"></a>02348    status = <a class="code" href="analyzer_8cpp.html#a8e03cbe2637bd6f4488a659c9f23d29e">ana_end_of_run</a>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>, error);
<a name="l02349"></a>02349 
<a name="l02350"></a>02350    <span class="comment">/* save histos if requested */</span>
<a name="l02351"></a>02351    <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump &amp;&amp; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l02352"></a>02352       strcpy(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump_filename);
<a name="l02353"></a>02353       <span class="keywordflow">if</span> (strchr(str, <span class="charliteral">&apos;%&apos;</span>) != NULL)
<a name="l02354"></a>02354          sprintf(file_name, str, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l02355"></a>02355       <span class="keywordflow">else</span>
<a name="l02356"></a>02356          strcpy(file_name, str);
<a name="l02357"></a>02357 
<a name="l02358"></a>02358       <a class="code" href="group__msectionh.html#ga42926f9062f24eb432ffb6414cde67e8">add_data_dir</a>(str, file_name);
<a name="l02359"></a>02359 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02360"></a>02360 <span class="preprocessor"></span>      <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(str); i++)
<a name="l02361"></a>02361          <span class="keywordflow">if</span> (isupper(str[i]))
<a name="l02362"></a>02362             <span class="keywordflow">break</span>;
<a name="l02363"></a>02363 
<a name="l02364"></a>02364       <span class="keywordflow">if</span> (i &lt; (<span class="keywordtype">int</span>) strlen(str)) {
<a name="l02365"></a>02365          printf
<a name="l02366"></a>02366              (<span class="stringliteral">&quot;Error: Due to a limitation in HBOOK, directoy names may not contain uppercase\n&quot;</span>);
<a name="l02367"></a>02367          printf(<span class="stringliteral">&quot;       characters. Histogram saving to %s will not work.\n&quot;</span>, str);
<a name="l02368"></a>02368       } <span class="keywordflow">else</span> {
<a name="l02369"></a>02369          <span class="keywordtype">char</span> str2[256];
<a name="l02370"></a>02370          strcpy(str2, <span class="stringliteral">&quot;NT&quot;</span>);
<a name="l02371"></a>02371          <a class="code" href="hbook_8h.html#afebb35542c02eb885020475cb221afaf">HRPUT</a>(0, str, str2);
<a name="l02372"></a>02372       }
<a name="l02373"></a>02373 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02374"></a>02374 
<a name="l02375"></a>02375 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02376"></a>02376 <span class="preprocessor"></span>      SaveRootHistograms(gManaHistsDir, str);
<a name="l02377"></a>02377 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02378"></a>02378    }
<a name="l02379"></a>02379 
<a name="l02380"></a>02380    <span class="comment">/* close output file */</span>
<a name="l02381"></a>02381    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> &amp;&amp; !<a class="code" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a>) {
<a name="l02382"></a>02382       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>) {
<a name="l02383"></a>02383 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02384"></a>02384 <span class="preprocessor"></span>         <a class="code" href="hbook_8h.html#aa909f5e02f93a1b3fadcf02ecfb1c460">HROUT</a>(0, i, <a class="code" href="fal_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a>);
<a name="l02385"></a>02385          strcpy(str, <span class="stringliteral">&quot;OFFLINE&quot;</span>);
<a name="l02386"></a>02386          <a class="code" href="hbook_8h.html#ab87aad0525ef5d5966116b420c2bc24e">HREND</a>(str);
<a name="l02387"></a>02387 <span class="preprocessor">#else</span>
<a name="l02388"></a>02388 <span class="preprocessor"></span>         <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;eor&quot;</span>, <span class="stringliteral">&quot;HBOOK support is not compiled in&quot;</span>);
<a name="l02389"></a>02389 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02390"></a>02390       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>) {
<a name="l02391"></a>02391 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02392"></a>02392 <span class="preprocessor"></span>         CloseRootOutputFile();
<a name="l02393"></a>02393 <span class="preprocessor">#else</span>
<a name="l02394"></a>02394 <span class="preprocessor"></span>         <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;eor&quot;</span>, <span class="stringliteral">&quot;ROOT support is not compiled in&quot;</span>);
<a name="l02395"></a>02395 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l02396"></a>02396       } <span class="keywordflow">else</span> {
<a name="l02397"></a>02397          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l02398"></a>02398             gzclose(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>);
<a name="l02399"></a>02399          <span class="keywordflow">else</span>
<a name="l02400"></a>02400             fclose(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>);
<a name="l02401"></a>02401       }
<a name="l02402"></a>02402 
<a name="l02403"></a>02403       <a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> = NULL;
<a name="l02404"></a>02404 
<a name="l02405"></a>02405       <span class="comment">/* free CWNT buffer */</span>
<a name="l02406"></a>02406       <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02407"></a>02407          bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l02408"></a>02408 
<a name="l02409"></a>02409          <span class="keywordflow">if</span> (bank_list == NULL) {
<a name="l02410"></a>02410             <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="lrs1821_8c.html#a83a7514b5202f841d4b7a22b2eaece9c">addr</a>) {
<a name="l02411"></a>02411                free(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].addr);
<a name="l02412"></a>02412                <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga9a0765582d554039a03d79a119c60558">addr</a> = NULL;
<a name="l02413"></a>02413             }
<a name="l02414"></a>02414          } <span class="keywordflow">else</span> {
<a name="l02415"></a>02415             <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++)
<a name="l02416"></a>02416                <span class="keywordflow">if</span> (bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a>) {
<a name="l02417"></a>02417                   free(bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a>);
<a name="l02418"></a>02418                   bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a> = NULL;
<a name="l02419"></a>02419                }
<a name="l02420"></a>02420          }
<a name="l02421"></a>02421       }
<a name="l02422"></a>02422    }
<a name="l02423"></a>02423 
<a name="l02424"></a>02424 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02425"></a>02425 <span class="preprocessor"></span>   <span class="comment">/* close secondary output file */</span>
<a name="l02426"></a>02426    <span class="keywordflow">if</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.secondary_output_file_name[0] != <span class="charliteral">&apos;\0&apos;</span>) {
<a name="l02427"></a>02427      CloseRootOutputFile();
<a name="l02428"></a>02428    }
<a name="l02429"></a>02429 <span class="preprocessor">#endif</span>
<a name="l02430"></a>02430 <span class="preprocessor"></span>
<a name="l02431"></a>02431    <span class="keywordflow">return</span> status;
<a name="l02432"></a>02432 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac965acb06ece6889fd3b68d82ca916c5"></a><!-- doxytag: member="mana.cpp::getparam" ref="ac965acb06ece6889fd3b68d82ca916c5" args="(int argc, char **argv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> getparam </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>argv</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00800">800</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>, <a class="el" href="lrs1821_8c_source.html#l00038">data</a>, <a class="el" href="odb_8c_source.html#l06435">db_sscanf()</a>, <a class="el" href="mana_8cpp_source.html#l00673">description</a>, <a class="el" href="mana_8cpp_source.html#l00672">flag_char</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="mana_8cpp_source.html#l00677">index</a>, <a class="el" href="odbhist_8c_source.html#l00058">j</a>, <a class="el" href="camac_8c_source.html#l00506">n</a>, <a class="el" href="ybos_8c_source.html#l00373">size</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00742">TID_BOOL</a>, <a class="el" href="midas_8h_source.html#l00746">TID_STRING</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, <a class="el" href="mana_8cpp_source.html#l00675">type</a>, and <a class="el" href="odb__check_8cc_source.html#l00011">usage()</a>.</p>

<p>Referenced by <a class="el" href="mhttpd_8c_source.html#l09142">interprete()</a>, <a class="el" href="mana_8cpp_source.html#l05702">main()</a>, <a class="el" href="mhttpd_8c_source.html#l05301">show_cnaf_page()</a>, <a class="el" href="mhttpd_8c_source.html#l05192">show_custom_page()</a>, <a class="el" href="mhttpd_8c_source.html#l02941">show_elog_delete()</a>, <a class="el" href="mhttpd_8c_source.html#l04103">show_elog_page()</a>, <a class="el" href="mhttpd_8c_source.html#l03003">show_elog_submit_query()</a>, <a class="el" href="mhttpd_8c_source.html#l03588">show_form_query()</a>, <a class="el" href="mhttpd_8c_source.html#l08158">show_hist_config_page()</a>, <a class="el" href="mhttpd_8c_source.html#l08606">show_hist_page()</a>, <a class="el" href="mhttpd_8c_source.html#l06598">show_programs_page()</a>, <a class="el" href="mhttpd_8c_source.html#l08029">show_query_page()</a>, <a class="el" href="mhttpd_8c_source.html#l03449">show_rawfile()</a>, <a class="el" href="mhttpd_8c_source.html#l04659">show_sc_page()</a>, <a class="el" href="mhttpd_8c_source.html#l05983">show_set_page()</a>, <a class="el" href="mhttpd_8c_source.html#l03805">submit_elog()</a>, and <a class="el" href="mhttpd_8c_source.html#l04034">submit_form()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00801"></a>00801 {
<a name="l00802"></a>00802    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l00803"></a>00803 
<a name="l00804"></a>00804    <span class="comment">/* parse command line parameters */</span>
<a name="l00805"></a>00805    <span class="keywordflow">for</span> (index = 1; index &lt; argc;) {
<a name="l00806"></a>00806       <span class="comment">/* search flag in parameter description */</span>
<a name="l00807"></a>00807       <span class="keywordflow">if</span> (argv[index][0] == <span class="charliteral">&apos;-&apos;</span>) {
<a name="l00808"></a>00808          <span class="keywordflow">for</span> (j = 0; <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].flag_char; j++)
<a name="l00809"></a>00809             <span class="keywordflow">if</span> (argv[index][1] == <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="mana_8cpp.html#a01d765415b8b865701ba44d771870744">flag_char</a>)
<a name="l00810"></a>00810                <span class="keywordflow">break</span>;
<a name="l00811"></a>00811 
<a name="l00812"></a>00812          <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].flag_char)
<a name="l00813"></a>00813             <span class="keywordflow">goto</span> <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>;
<a name="l00814"></a>00814 
<a name="l00815"></a>00815          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &gt; 0 &amp;&amp; index &gt;= argc - 1)
<a name="l00816"></a>00816             <span class="keywordflow">goto</span> <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>;
<a name="l00817"></a>00817          index++;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="mana_8cpp.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a> == <a class="code" href="group__mdefineh.html#ga252eb84661dfaa5959b5cb316117d696">TID_BOOL</a>) {
<a name="l00820"></a>00820             *((<a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a> *) <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>) = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00821"></a>00821             <span class="keywordflow">continue</span>;
<a name="l00822"></a>00822          }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824          <span class="keywordflow">do</span> {
<a name="l00825"></a>00825             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="mana_8cpp.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a> == <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>)
<a name="l00826"></a>00826                strcpy((<span class="keywordtype">char</span> *) <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a> + <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].index * 256,
<a name="l00827"></a>00827                       argv[index]);
<a name="l00828"></a>00828             <span class="keywordflow">else</span>
<a name="l00829"></a>00829                <a class="code" href="group__msectionh.html#ga7b3d26e7b258c093ad999bf1286bb871">db_sscanf</a>(argv[index], <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>,
<a name="l00830"></a>00830                          &amp;size, <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].index, <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="mana_8cpp.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a>);
<a name="l00831"></a>00831 
<a name="l00832"></a>00832             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> &gt; 1)
<a name="l00833"></a>00833                <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].index++;
<a name="l00834"></a>00834 
<a name="l00835"></a>00835             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].index &gt; <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].<a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>) {
<a name="l00836"></a>00836                printf(<span class="stringliteral">&quot;Note more than %d options possible for flag -%c\n&quot;</span>,
<a name="l00837"></a>00837                       <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].n, <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[j].flag_char);
<a name="l00838"></a>00838                <span class="keywordflow">return</span> 0;
<a name="l00839"></a>00839             }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841             index++;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843          } <span class="keywordflow">while</span> (index &lt; argc &amp;&amp; argv[index][0] != <span class="charliteral">&apos;-&apos;</span>);
<a name="l00844"></a>00844 
<a name="l00845"></a>00845       } <span class="keywordflow">else</span>
<a name="l00846"></a>00846          <span class="keywordflow">goto</span> <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>;
<a name="l00847"></a>00847    }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851  <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>:
<a name="l00852"></a>00852 
<a name="l00853"></a>00853    printf(<span class="stringliteral">&quot;usage: analyzer [options]\n\n&quot;</span>);
<a name="l00854"></a>00854    printf(<span class="stringliteral">&quot;valid options are:\n&quot;</span>);
<a name="l00855"></a>00855    <span class="keywordflow">for</span> (i = 0; <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[i].flag_char; i++)
<a name="l00856"></a>00856       printf(<span class="stringliteral">&quot;  -%c %s\n&quot;</span>, <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[i].flag_char, <a class="code" href="mana_8cpp.html#ab39aaaee5cd095effe8aca0c1c4e4245">clp_descrip</a>[i].<a class="code" href="mana_8cpp.html#abf0f2b4c0e71c91c7405885282eb2c04">description</a>);
<a name="l00857"></a>00857 
<a name="l00858"></a>00858    <span class="keywordflow">return</span> 0;
<a name="l00859"></a>00859 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3faaffbd2cd679eb4a39eb234e4aef3b"></a><!-- doxytag: member="mana.cpp::init_module_parameters" ref="a3faaffbd2cd679eb4a39eb234e4aef3b" args="(BOOL bclose)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> init_module_parameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>&nbsp;</td>
          <td class="paramname"> <em>bclose</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04155">4155</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="odb_8c_source.html#l07436">db_check_record()</a>, <a class="el" href="odb_8c_source.html#l07875">db_close_record()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l06684">db_get_record_size()</a>, <a class="el" href="odb_8c_source.html#l07741">db_open_record()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="midas_8h_source.html#l00760">MODE_READ</a>, <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, <a class="el" href="odb_8c_source.html#l00631">strcomb()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="p30_8h_source.html#l00043">TRUE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04156"></a>04156 {
<a name="l04157"></a>04157    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l04158"></a>04158    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l04159"></a>04159    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80];
<a name="l04160"></a>04160    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l04161"></a>04161 
<a name="l04162"></a>04162    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l04163"></a>04163       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l04164"></a>04164       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++) {
<a name="l04165"></a>04165          <span class="keywordflow">if</span> (module[j]-&gt;parameters != NULL) {
<a name="l04166"></a>04166             sprintf(str, <span class="stringliteral">&quot;/%s/Parameters/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, module[j]-&gt;<a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>);
<a name="l04167"></a>04167 
<a name="l04168"></a>04168             <span class="keywordflow">if</span> (bclose) {
<a name="l04169"></a>04169                <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l04170"></a>04170                <a class="code" href="group__msectionh.html#gae60eb33ad37ee9a9ce1cbc872db2fb19">db_close_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey);
<a name="l04171"></a>04171             } <span class="keywordflow">else</span> {
<a name="l04172"></a>04172                status = <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l04173"></a>04173                <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l04174"></a>04174                   <a class="code" href="group__msectionh.html#ga1880903c0ebb0d58809f48f6b2d59704">db_get_record_size</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, 0, &amp;size);
<a name="l04175"></a>04175                   <span class="keywordflow">if</span> (size != module[j]-&gt;param_size)
<a name="l04176"></a>04176                      status = 0;
<a name="l04177"></a>04177                }
<a name="l04178"></a>04178                <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a> &amp;&amp; module[j]-&gt;init_str) {
<a name="l04179"></a>04179                   <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="group__msectionh.html#gaccf82d3dbd8eb7090db598725713e012">strcomb</a>(module[j]-&gt;init_str), <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) !=
<a name="l04180"></a>04180                       <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l04181"></a>04181                      <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;init_module_parameters&quot;</span>,
<a name="l04182"></a>04182                             <span class="stringliteral">&quot;Cannot create/check \&quot;%s\&quot; parameters in ODB&quot;</span>, str);
<a name="l04183"></a>04183                      <span class="keywordflow">return</span> 0;
<a name="l04184"></a>04184                   }
<a name="l04185"></a>04185                }
<a name="l04186"></a>04186 
<a name="l04187"></a>04187                <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l04188"></a>04188                assert(hkey);
<a name="l04189"></a>04189 
<a name="l04190"></a>04190                <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, module[j]-&gt;parameters, module[j]-&gt;param_size,
<a name="l04191"></a>04191                                   <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL) != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l04192"></a>04192                   <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;init_module_parameters&quot;</span>,
<a name="l04193"></a>04193                          <span class="stringliteral">&quot;Cannot open \&quot;%s\&quot; parameters in ODB&quot;</span>, str);
<a name="l04194"></a>04194                   <span class="keywordflow">return</span> 0;
<a name="l04195"></a>04195                }
<a name="l04196"></a>04196             }
<a name="l04197"></a>04197          }
<a name="l04198"></a>04198       }
<a name="l04199"></a>04199    }
<a name="l04200"></a>04200 
<a name="l04201"></a>04201    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04202"></a>04202 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0e79fc9202ddba8e379b10912fe709aa"></a><!-- doxytag: member="mana.cpp::load_last_histos" ref="a0e79fc9202ddba8e379b10912fe709aa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_last_histos </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04009">4009</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l02470">add_data_dir()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8h_source.html#l00639">DIR_SEPARATOR</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>, <a class="el" href="hbook_8h_source.html#l00050">HDELET</a>, <a class="el" href="hbook_8h_source.html#l00171">HEXIST</a>, <a class="el" href="hbook_8h_source.html#l00151">HRGET</a>, and <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04010"></a>04010 {
<a name="l04011"></a>04011    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l04012"></a>04012 
<a name="l04013"></a>04013    <span class="comment">/* load previous online histos */</span>
<a name="l04014"></a>04014    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.no_load) {
<a name="l04015"></a>04015       strcpy(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename);
<a name="l04016"></a>04016 
<a name="l04017"></a>04017       <span class="keywordflow">if</span> (strchr(str, <a class="code" href="group__midasincludecode.html#ga0920890c442b665b0c6609fa796e9047">DIR_SEPARATOR</a>) == NULL)
<a name="l04018"></a>04018          <a class="code" href="group__msectionh.html#ga42926f9062f24eb432ffb6414cde67e8">add_data_dir</a>(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename);
<a name="l04019"></a>04019 
<a name="l04020"></a>04020 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l04021"></a>04021 <span class="preprocessor"></span>      {
<a name="l04022"></a>04022          FILE *f;
<a name="l04023"></a>04023          <span class="keywordtype">char</span> str2[256];
<a name="l04024"></a>04024          <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l04025"></a>04025 
<a name="l04026"></a>04026          <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(str); i++)
<a name="l04027"></a>04027             <span class="keywordflow">if</span> (isupper(str[i]))
<a name="l04028"></a>04028                <span class="keywordflow">break</span>;
<a name="l04029"></a>04029 
<a name="l04030"></a>04030          <span class="keywordflow">if</span> (i &lt; (<span class="keywordtype">int</span>) strlen(str)) {
<a name="l04031"></a>04031             printf
<a name="l04032"></a>04032                 (<span class="stringliteral">&quot;Error: Due to a limitation in HBOOK, directoy names may not contain uppercase\n&quot;</span>);
<a name="l04033"></a>04033             printf(<span class="stringliteral">&quot;       characters. Histogram loading from %s will not work.\n&quot;</span>, str);
<a name="l04034"></a>04034          } <span class="keywordflow">else</span> {
<a name="l04035"></a>04035             f = fopen(str, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l04036"></a>04036             <span class="keywordflow">if</span> (f != NULL) {
<a name="l04037"></a>04037                fclose(f);
<a name="l04038"></a>04038                printf(<span class="stringliteral">&quot;Loading previous online histos from %s\n&quot;</span>, str);
<a name="l04039"></a>04039                strcpy(str2, <span class="stringliteral">&quot;A&quot;</span>);
<a name="l04040"></a>04040                <a class="code" href="hbook_8h.html#a11968ef8e1e4fa504ea4e4fdb43d8e8f">HRGET</a>(0, str, str2);
<a name="l04041"></a>04041 
<a name="l04042"></a>04042                <span class="comment">/* fix wrongly booked N-tuples at ID 100000 */</span>
<a name="l04043"></a>04043                <span class="keywordflow">if</span> (<a class="code" href="hbook_8h.html#a3efc0c35b6588eb50787985bb6440719">HEXIST</a>(100000))
<a name="l04044"></a>04044                   <a class="code" href="hbook_8h.html#a3d7fcc23e32f4f11cb69aa1f97073ac0">HDELET</a>(100000);
<a name="l04045"></a>04045             }
<a name="l04046"></a>04046          }
<a name="l04047"></a>04047       }
<a name="l04048"></a>04048 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l04049"></a>04049 
<a name="l04050"></a>04050 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l04051"></a>04051 <span class="preprocessor"></span>      printf(<span class="stringliteral">&quot;Loading previous online histos from %s\n&quot;</span>, str);
<a name="l04052"></a>04052       LoadRootHistograms(gManaHistsDir, str);
<a name="l04053"></a>04053 <span class="preprocessor">#endif</span>
<a name="l04054"></a>04054 <span class="preprocessor"></span>   }
<a name="l04055"></a>04055 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae20b777778d5dcd241cf1dfb0dd2230f"></a><!-- doxytag: member="mana.cpp::load_parameters" ref="ae20b777778d5dcd241cf1dfb0dd2230f" args="(INT run_number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> load_parameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>run_number</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01069">1069</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8c_source.html#l04166">cm_yield()</a>, <a class="el" href="lrs1821_8c_source.html#l00038">data</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l03722">db_get_key()</a>, <a class="el" href="odb_8c_source.html#l05138">db_load()</a>, <a class="el" href="odb_8c_source.html#l04727">db_set_data_index()</a>, <a class="el" href="odb_8c_source.html#l06435">db_sscanf()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="odbhist_8c_source.html#l00059">file_name</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="mana_8cpp_source.html#l00677">index</a>, <a class="el" href="mdump_8c_source.html#l00116">key</a>, <a class="el" href="ybos_8c_source.html#l00373">size</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="midas_8h_source.html#l01315">KEY::type</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, and <a class="el" href="mana_8cpp_source.html#l04234">odb_load()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01070"></a>01070 {
<a name="l01071"></a>01071    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l01072"></a>01072    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l01073"></a>01073    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>[256], <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80], value_string[80], param_string[80];
<a name="l01074"></a>01074    <span class="keywordtype">char</span> <a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>[32];
<a name="l01075"></a>01075    <a class="code" href="structKEY.html">KEY</a> <a class="code" href="mdump_8c.html#a5cdb181553f9aa7bb182db5c195bb079">key</a>;
<a name="l01076"></a>01076 
<a name="l01077"></a>01077    <span class="comment">/* loop over configutation file names */</span>
<a name="l01078"></a>01078    <span class="keywordflow">for</span> (i = 0; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.config_file_name[i][0] &amp;&amp; i &lt; 10; i++) {
<a name="l01079"></a>01079       <span class="keywordflow">if</span> (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.config_file_name[i], <span class="charliteral">&apos;%&apos;</span>) != NULL)
<a name="l01080"></a>01080          sprintf(file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.config_file_name[i], <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>);
<a name="l01081"></a>01081       <span class="keywordflow">else</span>
<a name="l01082"></a>01082          strcpy(file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.config_file_name[i]);
<a name="l01083"></a>01083 
<a name="l01084"></a>01084       <span class="comment">/* load file under &quot;/&quot; */</span>
<a name="l01085"></a>01085       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#gaf1812a69d21a199cc1bbb110620051b8">db_load</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, file_name, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) == <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l01086"></a>01086          printf(<span class="stringliteral">&quot;Configuration file \&quot;%s\&quot; loaded\n&quot;</span>, file_name);
<a name="l01087"></a>01087    }
<a name="l01088"></a>01088 
<a name="l01089"></a>01089    <span class="comment">/* loop over parameters */</span>
<a name="l01090"></a>01090    <span class="keywordflow">for</span> (i = 0; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.param[i][0] &amp;&amp; i &lt; 10; i++) {
<a name="l01091"></a>01091       <span class="keywordflow">if</span> (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.param[i], <span class="charliteral">&apos;=&apos;</span>) == NULL) {
<a name="l01092"></a>01092          printf(<span class="stringliteral">&quot;Error: parameter %s contains no value\n&quot;</span>, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.param[i]);
<a name="l01093"></a>01093       } <span class="keywordflow">else</span> {
<a name="l01094"></a>01094          strcpy(value_string, strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.param[i], <span class="charliteral">&apos;=&apos;</span>) + 1);
<a name="l01095"></a>01095          strcpy(param_string, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.param[i]);
<a name="l01096"></a>01096          *strchr(param_string, <span class="charliteral">&apos;=&apos;</span>) = 0;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098          index = 0;
<a name="l01099"></a>01099          <span class="keywordflow">if</span> (strchr(param_string, <span class="charliteral">&apos;[&apos;</span>) != NULL) {
<a name="l01100"></a>01100             index = atoi(strchr(param_string, <span class="charliteral">&apos;[&apos;</span>) + 1);
<a name="l01101"></a>01101             *strchr(param_string, <span class="charliteral">&apos;[&apos;</span>) = 0;
<a name="l01102"></a>01102          }
<a name="l01103"></a>01103 
<a name="l01104"></a>01104          <span class="keywordflow">if</span> (param_string[0] == <span class="charliteral">&apos;/&apos;</span>)
<a name="l01105"></a>01105             strcpy(str, param_string);
<a name="l01106"></a>01106          <span class="keywordflow">else</span>
<a name="l01107"></a>01107             sprintf(str, <span class="stringliteral">&quot;/%s/Parameters/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, param_string);
<a name="l01108"></a>01108          <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l01109"></a>01109          <span class="keywordflow">if</span> (hkey == 0) {
<a name="l01110"></a>01110             printf(<span class="stringliteral">&quot;Error: cannot find parameter %s in ODB\n&quot;</span>, str);
<a name="l01111"></a>01111          } <span class="keywordflow">else</span> {
<a name="l01112"></a>01112             <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;key);
<a name="l01113"></a>01113             <a class="code" href="group__msectionh.html#ga7b3d26e7b258c093ad999bf1286bb871">db_sscanf</a>(value_string, data, &amp;size, 0, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l01114"></a>01114 
<a name="l01115"></a>01115             status = <a class="code" href="group__msectionh.html#ga18f5e7743545b06fca4f3d5ce9889034">db_set_data_index</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, data, size, index, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l01116"></a>01116             <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l01117"></a>01117                printf(<span class="stringliteral">&quot;Parameter %s changed to %s\n&quot;</span>, str, value_string);
<a name="l01118"></a>01118             <span class="keywordflow">else</span>
<a name="l01119"></a>01119                printf(<span class="stringliteral">&quot;Cannot change parameter %s\n&quot;</span>, str);
<a name="l01120"></a>01120          }
<a name="l01121"></a>01121       }
<a name="l01122"></a>01122    }
<a name="l01123"></a>01123 
<a name="l01124"></a>01124    <span class="comment">/* let parameter changes propagate to modules */</span>
<a name="l01125"></a>01125    <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(0);
<a name="l01126"></a>01126 
<a name="l01127"></a>01127    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l01128"></a>01128 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adce2146eee6315ed1feed2dc301f2427"></a><!-- doxytag: member="mana.cpp::loop_online" ref="adce2146eee6315ed1feed2dc301f2427" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> loop_online </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04098">4098</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00324">actual_time</a>, <a class="el" href="analyzer_8cpp_source.html#l00236">analyzer_loop()</a>, <a class="el" href="midas_8c_source.html#l04166">cm_yield()</a>, <a class="el" href="midas_8h_source.html#l01075">RPC_SHUTDOWN</a>, <a class="el" href="midas_8h_source.html#l01047">SS_ABORT</a>, <a class="el" href="system_8c_source.html#l05443">ss_getchar()</a>, <a class="el" href="system_8c_source.html#l02545">ss_kbhit()</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="fal_8c_source.html#l03879">update_stats()</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04099"></a>04099 {
<a name="l04100"></a>04100    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a> = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04101"></a>04101    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> last_time_loop, last_time_update, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a6431147bd66aebfe3ca728d244da1253">actual_time</a>;
<a name="l04102"></a>04102    <span class="keywordtype">int</span> ch;
<a name="l04103"></a>04103 
<a name="l04104"></a>04104    printf(<span class="stringliteral">&quot;Running analyzer online. Stop with \&quot;!\&quot;\n&quot;</span>);
<a name="l04105"></a>04105 
<a name="l04106"></a>04106    <span class="comment">/* main loop */</span>
<a name="l04107"></a>04107    last_time_update = 0;
<a name="l04108"></a>04108    last_time_loop = 0;
<a name="l04109"></a>04109 
<a name="l04110"></a>04110    <span class="keywordflow">do</span> {
<a name="l04111"></a>04111       <span class="comment">/* calculate events per second */</span>
<a name="l04112"></a>04112       actual_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l04113"></a>04113 
<a name="l04114"></a>04114       <span class="keywordflow">if</span> (actual_time - last_time_update &gt; 1000) {
<a name="l04115"></a>04115          <span class="comment">/* update statistics */</span>
<a name="l04116"></a>04116          <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04117"></a>04117          last_time_update = actual_time;
<a name="l04118"></a>04118 
<a name="l04119"></a>04119          <span class="comment">/* check keyboard */</span>
<a name="l04120"></a>04120          ch = 0;
<a name="l04121"></a>04121          <span class="keywordflow">while</span> (<a class="code" href="group__msectionh.html#gae96b0ebe47aa1d54f800e4f2e7f564b9">ss_kbhit</a>()) {
<a name="l04122"></a>04122             ch = <a class="code" href="group__msectionh.html#ga421c43305fae4215de164a5dd418909c">ss_getchar</a>(0);
<a name="l04123"></a>04123             <span class="keywordflow">if</span> (ch == -1)
<a name="l04124"></a>04124                ch = getchar();
<a name="l04125"></a>04125 
<a name="l04126"></a>04126             <span class="keywordflow">if</span> ((<span class="keywordtype">char</span>) ch == <span class="charliteral">&apos;!&apos;</span>)
<a name="l04127"></a>04127                <span class="keywordflow">break</span>;
<a name="l04128"></a>04128          }
<a name="l04129"></a>04129 
<a name="l04130"></a>04130          <span class="keywordflow">if</span> ((<span class="keywordtype">char</span>) ch == <span class="charliteral">&apos;!&apos;</span>)
<a name="l04131"></a>04131             <span class="keywordflow">break</span>;
<a name="l04132"></a>04132       }
<a name="l04133"></a>04133 
<a name="l04134"></a>04134       <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#a8fd380b49c2d273b54ec6a6fb077d760">analyzer_loop_period</a> == 0)
<a name="l04135"></a>04135          status = <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(1000);
<a name="l04136"></a>04136       <span class="keywordflow">else</span> {
<a name="l04137"></a>04137          <span class="keywordflow">if</span> (actual_time - last_time_loop &gt; (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>) <a class="code" href="analyzer_8cpp.html#a8fd380b49c2d273b54ec6a6fb077d760">analyzer_loop_period</a>) {
<a name="l04138"></a>04138             last_time_loop = actual_time;
<a name="l04139"></a>04139             <a class="code" href="analyzer_8cpp.html#a7173b35a859f0740c437df5f68ccf80b">analyzer_loop</a>();
<a name="l04140"></a>04140          }
<a name="l04141"></a>04141 
<a name="l04142"></a>04142          status = <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(analyzer_loop_period);
<a name="l04143"></a>04143       }
<a name="l04144"></a>04144 
<a name="l04145"></a>04145    } <span class="keywordflow">while</span> (status != <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a> &amp;&amp; status != <a class="code" href="group__err24.html#ga136923b4499af07f13a3cd631b88ec0e">SS_ABORT</a>);
<a name="l04146"></a>04146 
<a name="l04147"></a>04147    <span class="comment">/* update statistics */</span>
<a name="l04148"></a>04148    <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l04149"></a>04149 
<a name="l04150"></a>04150    <span class="keywordflow">return</span> status;
<a name="l04151"></a>04151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6b0a51747fb7d6f42a04aa7813d88cd7"></a><!-- doxytag: member="mana.cpp::loop_runs_offline" ref="a6b0a51747fb7d6f42a04aa7813d88cd7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> loop_runs_offline </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04802">4802</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01453">BANK_LIST::addr</a>, <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l00956">CM_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00639">DIR_SEPARATOR</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8h_source.html#l00723">FORMAT_HBOOK</a>, <a class="el" href="midas_8h_source.html#l00724">FORMAT_ROOT</a>, <a class="el" href="hbook_8h_source.html#l00148">HREND</a>, <a class="el" href="hbook_8h_source.html#l00155">HROUT</a>, <a class="el" href="mana_8cpp_source.html#l00648">input_file_name</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="mana_8cpp_source.html#l00649">output_file_name</a>, <a class="el" href="midas_8h_source.html#l01075">RPC_SHUTDOWN</a>, and <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00323">run_number</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04803"></a>04803 {
<a name="l04804"></a>04804    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a16695ea2bfd19f294afe066d6007ab36">run_number</a>;
<a name="l04805"></a>04805    <span class="keywordtype">char</span> <a class="code" href="mana_8cpp.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>[256], <a class="code" href="mana_8cpp.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a>[256], *prn;
<a name="l04806"></a>04806    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *bank_list;
<a name="l04807"></a>04807 
<a name="l04808"></a>04808    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet)
<a name="l04809"></a>04809       printf(<span class="stringliteral">&quot;Running analyzer offline. Stop with \&quot;!\&quot;\n&quot;</span>);
<a name="l04810"></a>04810 
<a name="l04811"></a>04811    run_number = 0;
<a name="l04812"></a>04812    <a class="code" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a> = ((strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[0], <span class="charliteral">&apos;%&apos;</span>) != NULL) &amp;&amp;
<a name="l04813"></a>04813                  (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="charliteral">&apos;%&apos;</span>) == NULL)) ||
<a name="l04814"></a>04814        <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[1][0];
<a name="l04815"></a>04815 
<a name="l04816"></a>04816    <span class="comment">/* loop over range of files */</span>
<a name="l04817"></a>04817    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.run_number[0] &gt; 0) {
<a name="l04818"></a>04818       <span class="keywordflow">if</span> (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[0], <span class="charliteral">&apos;%&apos;</span>) == NULL) {
<a name="l04819"></a>04819          printf
<a name="l04820"></a>04820              (<span class="stringliteral">&quot;Input file name must contain a wildcard like \&quot;%%05d\&quot; when using a range.\n&quot;</span>);
<a name="l04821"></a>04821          <span class="keywordflow">return</span> 0;
<a name="l04822"></a>04822       }
<a name="l04823"></a>04823 
<a name="l04824"></a>04824       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.run_number[0] == 0) {
<a name="l04825"></a>04825          printf(<span class="stringliteral">&quot;End of range not specified.\n&quot;</span>);
<a name="l04826"></a>04826          <span class="keywordflow">return</span> 0;
<a name="l04827"></a>04827       }
<a name="l04828"></a>04828 
<a name="l04829"></a>04829       <span class="keywordflow">for</span> (run_number = <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.run_number[0]; run_number &lt;= <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.run_number[1]; run_number++) {
<a name="l04830"></a>04830          sprintf(input_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[0], run_number);
<a name="l04831"></a>04831          <span class="keywordflow">if</span> (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="charliteral">&apos;%&apos;</span>) != NULL)
<a name="l04832"></a>04832             sprintf(output_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, run_number);
<a name="l04833"></a>04833          <span class="keywordflow">else</span>
<a name="l04834"></a>04834             strcpy(output_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name);
<a name="l04835"></a>04835 
<a name="l04836"></a>04836          status = <a class="code" href="mana_8cpp.html#ab4bcdcd2d272279d3afbaec8fc7e01a1">analyze_run</a>(run_number, input_file_name, output_file_name);
<a name="l04837"></a>04837          <span class="keywordflow">if</span> (status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)
<a name="l04838"></a>04838             <span class="keywordflow">break</span>;
<a name="l04839"></a>04839       }
<a name="l04840"></a>04840    } <span class="keywordflow">else</span> {
<a name="l04841"></a>04841       <span class="comment">/* loop over input file names */</span>
<a name="l04842"></a>04842       <span class="keywordflow">for</span> (i = 0; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[i][0] &amp;&amp; i &lt; 10; i++) {
<a name="l04843"></a>04843          strcpy(input_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[i]);
<a name="l04844"></a>04844 
<a name="l04845"></a>04845          <span class="comment">/* get run number from input file */</span>
<a name="l04846"></a>04846          prn = input_file_name;
<a name="l04847"></a>04847          <span class="keywordflow">while</span> (strchr(prn, <a class="code" href="group__midasincludecode.html#ga0920890c442b665b0c6609fa796e9047">DIR_SEPARATOR</a>) != NULL)
<a name="l04848"></a>04848             prn = strchr(prn, <a class="code" href="group__midasincludecode.html#ga0920890c442b665b0c6609fa796e9047">DIR_SEPARATOR</a>) + 1;
<a name="l04849"></a>04849 
<a name="l04850"></a>04850          <span class="keywordflow">if</span> (strpbrk(prn, <span class="stringliteral">&quot;0123456789&quot;</span>))
<a name="l04851"></a>04851             run_number = atoi(strpbrk(prn, <span class="stringliteral">&quot;0123456789&quot;</span>));
<a name="l04852"></a>04852 
<a name="l04853"></a>04853          <span class="keywordflow">if</span> (strchr(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="charliteral">&apos;%&apos;</span>) != NULL) {
<a name="l04854"></a>04854             <span class="keywordflow">if</span> (run_number == 0) {
<a name="l04855"></a>04855                printf(<span class="stringliteral">&quot;Cannot extract run number from input file name.\n&quot;</span>);
<a name="l04856"></a>04856                <span class="keywordflow">return</span> 0;
<a name="l04857"></a>04857             }
<a name="l04858"></a>04858             sprintf(output_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, run_number);
<a name="l04859"></a>04859          } <span class="keywordflow">else</span>
<a name="l04860"></a>04860             strcpy(output_file_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name);
<a name="l04861"></a>04861 
<a name="l04862"></a>04862          status = <a class="code" href="mana_8cpp.html#ab4bcdcd2d272279d3afbaec8fc7e01a1">analyze_run</a>(run_number, input_file_name, output_file_name);
<a name="l04863"></a>04863          <span class="keywordflow">if</span> (status == <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>)
<a name="l04864"></a>04864             <span class="keywordflow">break</span>;
<a name="l04865"></a>04865       }
<a name="l04866"></a>04866    }
<a name="l04867"></a>04867 
<a name="l04868"></a>04868    <span class="comment">/* close output file in append mode */</span>
<a name="l04869"></a>04869    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a> &amp;&amp; <a class="code" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a>) {
<a name="l04870"></a>04870       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>) {
<a name="l04871"></a>04871 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l04872"></a>04872 <span class="preprocessor"></span>         <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[80];
<a name="l04873"></a>04873 
<a name="l04874"></a>04874          <a class="code" href="hbook_8h.html#aa909f5e02f93a1b3fadcf02ecfb1c460">HROUT</a>(0, i, <a class="code" href="fal_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a>);
<a name="l04875"></a>04875          strcpy(str, <span class="stringliteral">&quot;OFFLINE&quot;</span>);
<a name="l04876"></a>04876          <a class="code" href="hbook_8h.html#ab87aad0525ef5d5966116b420c2bc24e">HREND</a>(str);
<a name="l04877"></a>04877 <span class="preprocessor">#else</span>
<a name="l04878"></a>04878 <span class="preprocessor"></span>         <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;loop_runs_offline&quot;</span>, <span class="stringliteral">&quot;HBOOK support is not compiled in&quot;</span>);
<a name="l04879"></a>04879 <span class="preprocessor">#endif</span>
<a name="l04880"></a>04880 <span class="preprocessor"></span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>) {
<a name="l04881"></a>04881 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l04882"></a>04882 <span class="preprocessor"></span>         CloseRootOutputFile();
<a name="l04883"></a>04883 <span class="preprocessor">#else</span>
<a name="l04884"></a>04884 <span class="preprocessor"></span>         <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;loop_runs_offline&quot;</span>, <span class="stringliteral">&quot;ROOT support is not compiled in&quot;</span>);
<a name="l04885"></a>04885 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l04886"></a>04886       } <span class="keywordflow">else</span> {
<a name="l04887"></a>04887          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l04888"></a>04888             gzclose(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>);
<a name="l04889"></a>04889          <span class="keywordflow">else</span>
<a name="l04890"></a>04890             fclose(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>);
<a name="l04891"></a>04891       }
<a name="l04892"></a>04892 
<a name="l04893"></a>04893       <span class="comment">/* free bank buffer */</span>
<a name="l04894"></a>04894       <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l04895"></a>04895          bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l04896"></a>04896 
<a name="l04897"></a>04897          <span class="keywordflow">if</span> (bank_list == NULL)
<a name="l04898"></a>04898             <span class="keywordflow">continue</span>;
<a name="l04899"></a>04899 
<a name="l04900"></a>04900          <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++)
<a name="l04901"></a>04901             <span class="keywordflow">if</span> (bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a>) {
<a name="l04902"></a>04902                free(bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a>);
<a name="l04903"></a>04903                bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga1c924a02fd91149314d805f025d52d40">addr</a> = NULL;
<a name="l04904"></a>04904             }
<a name="l04905"></a>04905       }
<a name="l04906"></a>04906    }
<a name="l04907"></a>04907 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l04908"></a>04908 <span class="preprocessor"></span>   <span class="comment">/* merge slave output files */</span>
<a name="l04909"></a>04909    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a> &amp;&amp; <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.filename[0] &amp;&amp; <a class="code" href="mana_8cpp.html#abbc229a696029d540d0e1261e0fd6880">out_append</a>)
<a name="l04910"></a>04910       pvm_merge();
<a name="l04911"></a>04911 <span class="preprocessor">#endif</span>
<a name="l04912"></a>04912 <span class="preprocessor"></span>
<a name="l04913"></a>04913    <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l04914"></a>04914 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a715e03caa3809d9dce4e01e9be5d3232"></a><!-- doxytag: member="mana.cpp::ma_close" ref="a715e03caa3809d9dce4e01e9be5d3232" args="(MA_FILE *file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ma_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMA__FILE.html">MA_FILE</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04412">4412</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp_source.html#l04329">MA_FILE::format</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="mana_8cpp_source.html#l04332">MA_FILE::gzfile</a>, <a class="el" href="mana_8cpp_source.html#l04324">MA_FORMAT_YBOS</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="ybos_8c_source.html#l01668">yb_any_file_rclose()</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04413"></a>04413 {
<a name="l04414"></a>04414    <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> == <a class="code" href="mana_8cpp.html#af861b11d02a59ddde8874692b3c59737">MA_FORMAT_YBOS</a>)
<a name="l04415"></a>04415       <a class="code" href="group__ybosincludecode.html#gaad6fca852eb2016b4a4547272512e0ae">yb_any_file_rclose</a>(<a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>);
<a name="l04416"></a>04416    <span class="keywordflow">else</span>
<a name="l04417"></a>04417       gzclose(file-&gt;<a class="code" href="structMA__FILE.html#a9e6cc8290f83cf202d54b4d17b039225">gzfile</a>);
<a name="l04418"></a>04418 
<a name="l04419"></a>04419    free(file);
<a name="l04420"></a>04420    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l04421"></a>04421 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acf053885bc02fc8661b8c5d23501be0f"></a><!-- doxytag: member="mana.cpp::ma_open" ref="acf053885bc02fc8661b8c5d23501be0f" args="(char *file_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMA__FILE.html">MA_FILE</a>* ma_open </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>file_name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04340">4340</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp_source.html#l04333">MA_FILE::buffer</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="mana_8cpp_source.html#l04330">MA_FILE::device</a>, <a class="el" href="mana_8cpp_source.html#l04328">MA_FILE::file_name</a>, <a class="el" href="mana_8cpp_source.html#l04329">MA_FILE::format</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="mana_8cpp_source.html#l04332">MA_FILE::gzfile</a>, <a class="el" href="mana_8cpp_source.html#l04318">MA_DEVICE_DISK</a>, <a class="el" href="mana_8cpp_source.html#l04321">MA_DEVICE_PVM</a>, <a class="el" href="mana_8cpp_source.html#l04323">MA_FORMAT_MIDAS</a>, <a class="el" href="mana_8cpp_source.html#l04324">MA_FORMAT_YBOS</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="mana_8cpp_source.html#l00554">PVM_BUFFER_SIZE</a>, <a class="el" href="mana_8cpp_source.html#l04334">MA_FILE::rp</a>, <a class="el" href="midas_8h_source.html#l01033">SS_SUCCESS</a>, <a class="el" href="mana_8cpp_source.html#l04334">MA_FILE::wp</a>, <a class="el" href="ybos_8c_source.html#l01559">yb_any_file_ropen()</a>, <a class="el" href="ybos_8c_source.html#l02227">yb_any_physrec_skip()</a>, and <a class="el" href="ybos_8h_source.html#l00151">YB_SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04341"></a>04341 {
<a name="l04342"></a>04342    <span class="keywordtype">char</span> *ext_str;
<a name="l04343"></a>04343    <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l04344"></a>04344    <a class="code" href="structMA__FILE.html">MA_FILE</a> *file;
<a name="l04345"></a>04345 
<a name="l04346"></a>04346    <span class="comment">/* allocate MA_FILE structure */</span>
<a name="l04347"></a>04347    file = (<a class="code" href="structMA__FILE.html">MA_FILE</a> *) calloc(<span class="keyword">sizeof</span>(<a class="code" href="structMA__FILE.html">MA_FILE</a>), 1);
<a name="l04348"></a>04348    <span class="keywordflow">if</span> (file == NULL) {
<a name="l04349"></a>04349       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;open_input_file&quot;</span>, <span class="stringliteral">&quot;Cannot allocate MA file structure&quot;</span>);
<a name="l04350"></a>04350       <span class="keywordflow">return</span> NULL;
<a name="l04351"></a>04351    }
<a name="l04352"></a>04352 
<a name="l04353"></a>04353    <span class="comment">/* save file name */</span>
<a name="l04354"></a>04354    strcpy(file-&gt;<a class="code" href="structMA__FILE.html#ad357c0f8ebc9dec3d3c00f7fa0b35402">file_name</a>, <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>);
<a name="l04355"></a>04355 
<a name="l04356"></a>04356    <span class="comment">/* for now, just read from disk */</span>
<a name="l04357"></a>04357    file-&gt;<a class="code" href="structMA__FILE.html#af882f0918954b8a2e9917fd143923180">device</a> = <a class="code" href="mana_8cpp.html#a4f16e89aa9b9e0a0407f8611e0bfd17a">MA_DEVICE_DISK</a>;
<a name="l04358"></a>04358 
<a name="l04359"></a>04359    <span class="comment">/* or from PVM */</span>
<a name="l04360"></a>04360    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {
<a name="l04361"></a>04361       file-&gt;<a class="code" href="structMA__FILE.html#af882f0918954b8a2e9917fd143923180">device</a> = <a class="code" href="mana_8cpp.html#ae97c2576e5febbb750a3482a935da95f">MA_DEVICE_PVM</a>;
<a name="l04362"></a>04362       file-&gt;<a class="code" href="structMA__FILE.html#a906a4f95ffc31bc4332faa57c8b0ff03">buffer</a> = (<span class="keywordtype">char</span> *) malloc(<a class="code" href="mana_8cpp.html#a87dfd475372bf9bce289d185b3bc5cf4">PVM_BUFFER_SIZE</a>);
<a name="l04363"></a>04363       file-&gt;<a class="code" href="structMA__FILE.html#a804f30da1e7d7f25740b19e0be74e66c">wp</a> = file-&gt;<a class="code" href="structMA__FILE.html#a69151ddb38db163d85ed4e43fc9e46a9">rp</a> = 0;
<a name="l04364"></a>04364    }
<a name="l04365"></a>04365 
<a name="l04366"></a>04366    <span class="comment">/* check input file extension */</span>
<a name="l04367"></a>04367    <span class="keywordflow">if</span> (strchr(<a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>, <span class="charliteral">&apos;.&apos;</span>)) {
<a name="l04368"></a>04368       ext_str = <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a> + strlen(<a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>) - 1;
<a name="l04369"></a>04369       <span class="keywordflow">while</span> (*ext_str != <span class="charliteral">&apos;.&apos;</span>)
<a name="l04370"></a>04370          ext_str--;
<a name="l04371"></a>04371    } <span class="keywordflow">else</span>
<a name="l04372"></a>04372       ext_str = <span class="stringliteral">&quot;&quot;</span>;
<a name="l04373"></a>04373 
<a name="l04374"></a>04374    <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.gz&quot;</span>, 3) == 0) {
<a name="l04375"></a>04375       ext_str--;
<a name="l04376"></a>04376       <span class="keywordflow">while</span> (*ext_str != <span class="charliteral">&apos;.&apos;</span> &amp;&amp; ext_str &gt; <a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>)
<a name="l04377"></a>04377          ext_str--;
<a name="l04378"></a>04378    }
<a name="l04379"></a>04379 
<a name="l04380"></a>04380    <span class="keywordflow">if</span> (strncmp(<a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>, <span class="stringliteral">&quot;/dev/&quot;</span>, 4) == 0)     <span class="comment">/* assume MIDAS tape */</span>
<a name="l04381"></a>04381       file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> = <a class="code" href="mana_8cpp.html#a1595dea1508a366356bdc23083505ded">MA_FORMAT_MIDAS</a>;
<a name="l04382"></a>04382    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.mid&quot;</span>, 4) == 0)
<a name="l04383"></a>04383       file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> = <a class="code" href="mana_8cpp.html#a1595dea1508a366356bdc23083505ded">MA_FORMAT_MIDAS</a>;
<a name="l04384"></a>04384    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(ext_str, <span class="stringliteral">&quot;.ybs&quot;</span>, 4) == 0)
<a name="l04385"></a>04385       file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> = <a class="code" href="mana_8cpp.html#af861b11d02a59ddde8874692b3c59737">MA_FORMAT_YBOS</a>;
<a name="l04386"></a>04386    <span class="keywordflow">else</span> {
<a name="l04387"></a>04387       printf
<a name="l04388"></a>04388           (<span class="stringliteral">&quot;Unknown input data format \&quot;%s\&quot;. Please use file extension .mid or mid.gz.\n&quot;</span>,
<a name="l04389"></a>04389            ext_str);
<a name="l04390"></a>04390       <span class="keywordflow">return</span> NULL;
<a name="l04391"></a>04391    }
<a name="l04392"></a>04392 
<a name="l04393"></a>04393    <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#af882f0918954b8a2e9917fd143923180">device</a> == <a class="code" href="mana_8cpp.html#a4f16e89aa9b9e0a0407f8611e0bfd17a">MA_DEVICE_DISK</a>) {
<a name="l04394"></a>04394       <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> == <a class="code" href="mana_8cpp.html#af861b11d02a59ddde8874692b3c59737">MA_FORMAT_YBOS</a>) {
<a name="l04395"></a>04395          status = <a class="code" href="group__ybosincludecode.html#gaa4ba04457fe9576c87b2710fea69f770">yb_any_file_ropen</a>(<a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>, <a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>);
<a name="l04396"></a>04396          <span class="keywordflow">if</span> (status != <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a>)
<a name="l04397"></a>04397             <span class="keywordflow">return</span> NULL;
<a name="l04398"></a>04398          <span class="keywordflow">if</span> (<a class="code" href="group__ybosincludecode.html#ga6a13d257d54a1d5e5c0bf126ae85edc9">yb_any_physrec_skip</a>(<a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>, -1) != <a class="code" href="group__yboserrorh.html#gaf3834f9669e9c611d56b2b8b71f29869">YB_SUCCESS</a>)
<a name="l04399"></a>04399             <span class="keywordflow">return</span> (NULL);
<a name="l04400"></a>04400       } <span class="keywordflow">else</span> {
<a name="l04401"></a>04401          file-&gt;<a class="code" href="structMA__FILE.html#a9e6cc8290f83cf202d54b4d17b039225">gzfile</a> = gzopen(<a class="code" href="odbhist_8c.html#a4da1fcf44864d811e793f03bf36e6e17">file_name</a>, <span class="stringliteral">&quot;rb&quot;</span>);
<a name="l04402"></a>04402          <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a9e6cc8290f83cf202d54b4d17b039225">gzfile</a> == NULL)
<a name="l04403"></a>04403             <span class="keywordflow">return</span> NULL;
<a name="l04404"></a>04404       }
<a name="l04405"></a>04405    }
<a name="l04406"></a>04406 
<a name="l04407"></a>04407    <span class="keywordflow">return</span> file;
<a name="l04408"></a>04408 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a86d00d374a6aed95075c5778cb25b321"></a><!-- doxytag: member="mana.cpp::ma_read_event" ref="a86d00d374a6aed95075c5778cb25b321" args="(MA_FILE *file, EVENT_HEADER *pevent, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ma_read_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMA__FILE.html">MA_FILE</a> *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04425">4425</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mana_8cpp_source.html#l04206">bevid_2_mheader()</a>, <a class="el" href="mana_8cpp_source.html#l04333">MA_FILE::buffer</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="mana_8cpp_source.html#l04330">MA_FILE::device</a>, <a class="el" href="msystem_8h_source.html#l00221">DWORD_SWAP</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="mana_8cpp_source.html#l04328">MA_FILE::file_name</a>, <a class="el" href="mana_8cpp_source.html#l04329">MA_FILE::format</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="mana_8cpp_source.html#l04332">MA_FILE::gzfile</a>, <a class="el" href="mana_8cpp_source.html#l04318">MA_DEVICE_DISK</a>, <a class="el" href="mana_8cpp_source.html#l04321">MA_DEVICE_PVM</a>, <a class="el" href="mana_8cpp_source.html#l04323">MA_FORMAT_MIDAS</a>, <a class="el" href="mana_8cpp_source.html#l04324">MA_FORMAT_YBOS</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="pvm3_8h_source.html#l00243">PvmDataInPlace</a>, <a class="el" href="mana_8cpp_source.html#l04334">MA_FILE::rp</a>, <a class="el" href="midas_8h_source.html#l01193">EVENT_HEADER::serial_number</a>, <a class="el" href="system_8c_source.html#l02491">ss_sleep()</a>, <a class="el" href="midas_8h_source.html#l01033">SS_SUCCESS</a>, <a class="el" href="mhist_8c_source.html#l00102">tag</a>, <a class="el" href="midas_8h_source.html#l01194">EVENT_HEADER::time_stamp</a>, <a class="el" href="midas_8h_source.html#l01192">EVENT_HEADER::trigger_mask</a>, <a class="el" href="msystem_8h_source.html#l00214">WORD_SWAP</a>, <a class="el" href="mana_8cpp_source.html#l04334">MA_FILE::wp</a>, <a class="el" href="ybos_8c_source.html#l02424">yb_any_event_swap()</a>, and <a class="el" href="ybos_8c_source.html#l02568">ybos_event_get()</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, and <a class="el" href="mana__orig_8c_source.html#l04484">ma_read_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04426"></a>04426 {
<a name="l04427"></a>04427    <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
<a name="l04428"></a>04428 
<a name="l04429"></a>04429    <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#af882f0918954b8a2e9917fd143923180">device</a> == <a class="code" href="mana_8cpp.html#a4f16e89aa9b9e0a0407f8611e0bfd17a">MA_DEVICE_DISK</a>) {
<a name="l04430"></a>04430       <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> == <a class="code" href="mana_8cpp.html#a1595dea1508a366356bdc23083505ded">MA_FORMAT_MIDAS</a>) {
<a name="l04431"></a>04431          <span class="keywordflow">if</span> (<a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a> &lt; (<span class="keywordtype">int</span>) <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>)) {
<a name="l04432"></a>04432             <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;ma_read_event&quot;</span>, <span class="stringliteral">&quot;Buffer size too small&quot;</span>);
<a name="l04433"></a>04433             <span class="keywordflow">return</span> -1;
<a name="l04434"></a>04434          }
<a name="l04435"></a>04435 
<a name="l04436"></a>04436          <span class="comment">/* read event header */</span>
<a name="l04437"></a>04437          n = gzread(file-&gt;<a class="code" href="structMA__FILE.html#a9e6cc8290f83cf202d54b4d17b039225">gzfile</a>, pevent, <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>));
<a name="l04438"></a>04438          <span class="keywordflow">if</span> (n &lt; (<span class="keywordtype">int</span>) <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>)) {
<a name="l04439"></a>04439             <span class="keywordflow">if</span> (n &gt; 0)
<a name="l04440"></a>04440                printf(<span class="stringliteral">&quot;Unexpected end of file %s, last event skipped\n&quot;</span>, file-&gt;<a class="code" href="structMA__FILE.html#ad357c0f8ebc9dec3d3c00f7fa0b35402">file_name</a>);
<a name="l04441"></a>04441             <span class="keywordflow">return</span> -1;
<a name="l04442"></a>04442          }
<a name="l04443"></a>04443 
<a name="l04444"></a>04444          <span class="comment">/* swap event header if in wrong format */</span>
<a name="l04445"></a>04445          <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a> &gt; 0x1000000) {
<a name="l04446"></a>04446             <a class="code" href="group__msmacroh.html#ga4670ac841b4b8e3c3141a91a743bc61d">WORD_SWAP</a>(&amp;pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l04447"></a>04447             <a class="code" href="group__msmacroh.html#ga4670ac841b4b8e3c3141a91a743bc61d">WORD_SWAP</a>(&amp;pevent-&gt;<a class="code" href="group__midasincludecode.html#ga9b4b94f41521f5c188655b7bb0f1ec1b">trigger_mask</a>);
<a name="l04448"></a>04448             <a class="code" href="group__msmacroh.html#gadb40ea04e4e009bbde68c027a8f95039">DWORD_SWAP</a>(&amp;pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>);
<a name="l04449"></a>04449             <a class="code" href="group__msmacroh.html#gadb40ea04e4e009bbde68c027a8f95039">DWORD_SWAP</a>(&amp;pevent-&gt;<a class="code" href="group__midasincludecode.html#ga989421ee804ab76a0e11ac1c9c3b0e7a">time_stamp</a>);
<a name="l04450"></a>04450             <a class="code" href="group__msmacroh.html#gadb40ea04e4e009bbde68c027a8f95039">DWORD_SWAP</a>(&amp;pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a>);
<a name="l04451"></a>04451          }
<a name="l04452"></a>04452 
<a name="l04453"></a>04453          <span class="comment">/* read event */</span>
<a name="l04454"></a>04454          n = 0;
<a name="l04455"></a>04455          <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> &gt; 0) {
<a name="l04456"></a>04456             <span class="keywordflow">if</span> (<a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a> &lt; (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + (<span class="keywordtype">int</span>) <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>)) {
<a name="l04457"></a>04457                <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;ma_read_event&quot;</span>, <span class="stringliteral">&quot;Buffer size too small&quot;</span>);
<a name="l04458"></a>04458                <span class="keywordflow">return</span> -1;
<a name="l04459"></a>04459             }
<a name="l04460"></a>04460 
<a name="l04461"></a>04461             n = gzread(file-&gt;<a class="code" href="structMA__FILE.html#a9e6cc8290f83cf202d54b4d17b039225">gzfile</a>, pevent + 1, pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a>);
<a name="l04462"></a>04462             <span class="keywordflow">if</span> (n != (<a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a>) {
<a name="l04463"></a>04463                printf(<span class="stringliteral">&quot;Unexpected end of file %s, last event skipped\n&quot;</span>, file-&gt;<a class="code" href="structMA__FILE.html#ad357c0f8ebc9dec3d3c00f7fa0b35402">file_name</a>);
<a name="l04464"></a>04464                <span class="keywordflow">return</span> -1;
<a name="l04465"></a>04465             }
<a name="l04466"></a>04466          }
<a name="l04467"></a>04467 
<a name="l04468"></a>04468          <span class="keywordflow">return</span> n + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l04469"></a>04469       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a52d038c118c4fba1a02c520c620a10dd">format</a> == <a class="code" href="mana_8cpp.html#af861b11d02a59ddde8874692b3c59737">MA_FORMAT_YBOS</a>) {
<a name="l04470"></a>04470          <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *pybos, readn;
<a name="l04471"></a>04471          <span class="keywordflow">if</span> (<a class="code" href="group__ybosincludecode.html#ga195a8275899e64304dbbff765293795c">ybos_event_get</a>(&amp;pybos, &amp;readn) != <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a>)
<a name="l04472"></a>04472             <span class="keywordflow">return</span> -1;
<a name="l04473"></a>04473          status = <a class="code" href="group__ybosincludecode.html#ga851698587a1300be6b8f1f1b0e3e03ea">yb_any_event_swap</a>(<a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>, pybos);
<a name="l04474"></a>04474          memcpy((<span class="keywordtype">char</span> *) (pevent + 1), (<span class="keywordtype">char</span> *) pybos, readn);
<a name="l04475"></a>04475          status = <a class="code" href="mana_8cpp.html#ab4b3cf3c50a5b66e9c00af61e2b715cc">bevid_2_mheader</a>(pevent, pybos);
<a name="l04476"></a>04476          <span class="keywordflow">return</span> readn;
<a name="l04477"></a>04477       }
<a name="l04478"></a>04478    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#af882f0918954b8a2e9917fd143923180">device</a> == <a class="code" href="mana_8cpp.html#ae97c2576e5febbb750a3482a935da95f">MA_DEVICE_PVM</a>) {
<a name="l04479"></a>04479 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l04480"></a>04480 <span class="preprocessor"></span>      <span class="keywordtype">int</span> bufid, len, <a class="code" href="mhist_8c.html#a27ce05f73a16e6abc070da1007833b9b">tag</a>, tid;
<a name="l04481"></a>04481       <a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pe;
<a name="l04482"></a>04482       <span class="keyword">struct </span>timeval <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>;
<a name="l04483"></a>04483 
<a name="l04484"></a>04484       <span class="comment">/* check if anything in buffer */</span>
<a name="l04485"></a>04485       <span class="keywordflow">if</span> (file-&gt;<a class="code" href="structMA__FILE.html#a804f30da1e7d7f25740b19e0be74e66c">wp</a> &gt; file-&gt;<a class="code" href="structMA__FILE.html#a69151ddb38db163d85ed4e43fc9e46a9">rp</a>) {
<a name="l04486"></a>04486          pe = (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) (file-&gt;<a class="code" href="structMA__FILE.html#a906a4f95ffc31bc4332faa57c8b0ff03">buffer</a> + file-&gt;<a class="code" href="structMA__FILE.html#a69151ddb38db163d85ed4e43fc9e46a9">rp</a>);
<a name="l04487"></a>04487          <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a> = <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>) + pe-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a>;
<a name="l04488"></a>04488          memcpy(pevent, pe, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>);
<a name="l04489"></a>04489          file-&gt;<a class="code" href="structMA__FILE.html#a69151ddb38db163d85ed4e43fc9e46a9">rp</a> += <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l04490"></a>04490          <span class="keywordflow">return</span> <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l04491"></a>04491       }
<a name="l04492"></a>04492 
<a name="l04493"></a>04493       <span class="comment">/* send data request */</span>
<a name="l04494"></a>04494       pvm_initsend(<a class="code" href="pvm3_8h.html#a4a488c409eabcd4587ced64938f4c43f">PvmDataInPlace</a>);
<a name="l04495"></a>04495       pvm_send(pvm_myparent, TAG_DATA);
<a name="l04496"></a>04496 
<a name="l04497"></a>04497       <span class="comment">/* receive data */</span>
<a name="l04498"></a>04498       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_sec = 60;
<a name="l04499"></a>04499       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_usec = 0;
<a name="l04500"></a>04500 
<a name="l04501"></a>04501       bufid = pvm_trecv(-1, -1, &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l04502"></a>04502       <span class="keywordflow">if</span> (bufid &lt; 0) {
<a name="l04503"></a>04503          pvm_perror(<span class="stringliteral">&quot;pvm_recv&quot;</span>);
<a name="l04504"></a>04504          <span class="keywordflow">return</span> -1;
<a name="l04505"></a>04505       }
<a name="l04506"></a>04506       <span class="keywordflow">if</span> (bufid == 0) {
<a name="l04507"></a>04507          PVM_DEBUG(<span class="stringliteral">&quot;ma_read_event: timeout receiving data, aborting analyzer.\n&quot;</span>);
<a name="l04508"></a>04508          <span class="keywordflow">return</span> -1;
<a name="l04509"></a>04509       }
<a name="l04510"></a>04510 
<a name="l04511"></a>04511       status = pvm_bufinfo(bufid, &amp;len, &amp;tag, &amp;tid);
<a name="l04512"></a>04512       <span class="keywordflow">if</span> (status &lt; 0) {
<a name="l04513"></a>04513          pvm_perror(<span class="stringliteral">&quot;pvm_bufinfo&quot;</span>);
<a name="l04514"></a>04514          <span class="keywordflow">return</span> -1;
<a name="l04515"></a>04515       }
<a name="l04516"></a>04516 
<a name="l04517"></a>04517       PVM_DEBUG(<span class="stringliteral">&quot;ma_read_event: receive tag %d, buflen %d&quot;</span>, tag, len);
<a name="l04518"></a>04518 
<a name="l04519"></a>04519       <span class="keywordflow">if</span> (tag == TAG_EOR || tag == TAG_EXIT)
<a name="l04520"></a>04520          <span class="keywordflow">return</span> -1;
<a name="l04521"></a>04521 
<a name="l04522"></a>04522       file-&gt;<a class="code" href="structMA__FILE.html#a804f30da1e7d7f25740b19e0be74e66c">wp</a> = len;
<a name="l04523"></a>04523       file-&gt;<a class="code" href="structMA__FILE.html#a69151ddb38db163d85ed4e43fc9e46a9">rp</a> = 0;
<a name="l04524"></a>04524       status = pvm_upkbyte((<span class="keywordtype">char</span> *) file-&gt;<a class="code" href="structMA__FILE.html#a906a4f95ffc31bc4332faa57c8b0ff03">buffer</a>, len, 1);
<a name="l04525"></a>04525       <span class="keywordflow">if</span> (status &lt; 0) {
<a name="l04526"></a>04526          pvm_perror(<span class="stringliteral">&quot;pvm_upkbyte&quot;</span>);
<a name="l04527"></a>04527          <span class="keywordflow">return</span> -1;
<a name="l04528"></a>04528       }
<a name="l04529"></a>04529 
<a name="l04530"></a>04530       <span class="comment">/* no new data available, sleep some time to reduce network traffic */</span>
<a name="l04531"></a>04531       <span class="keywordflow">if</span> (len == 0)
<a name="l04532"></a>04532          <a class="code" href="group__msectionh.html#gaaec652d8878ceb5ef38ad1ba2cbf7dec">ss_sleep</a>(200);
<a name="l04533"></a>04533 
<a name="l04534"></a>04534       <span class="comment">/* re-call this function */</span>
<a name="l04535"></a>04535       <span class="keywordflow">return</span> <a class="code" href="mana_8cpp.html#a86d00d374a6aed95075c5778cb25b321">ma_read_event</a>(file, pevent, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>);
<a name="l04536"></a>04536 <span class="preprocessor">#endif</span>
<a name="l04537"></a>04537 <span class="preprocessor"></span>   }
<a name="l04538"></a>04538 
<a name="l04539"></a>04539    <span class="keywordflow">return</span> 0;
<a name="l04540"></a>04540 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a><!-- doxytag: member="mana.cpp::main" ref="a0ddf1224851353fc92bfbff6f499fa97" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>argv</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l05702">5702</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l03935">ana_callback()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8c_source.html#l05147">cm_cleanup()</a>, <a class="el" href="midas_8c_source.html#l02349">cm_connect_experiment1()</a>, <a class="el" href="midas_8c_source.html#l02768">cm_disconnect_experiment()</a>, <a class="el" href="midas_8c_source.html#l05069">cm_exist()</a>, <a class="el" href="patch__mevb_8cpp.html#aa598123f60ccd5496f2421c7bf2fabbf">cm_get_environment()</a>, <a class="el" href="midas_8c_source.html#l00987">cm_get_error()</a>, <a class="el" href="midas_8c_source.html#l02913">cm_get_experiment_database()</a>, <a class="el" href="midas_8c_source.html#l04255">cm_register_function()</a>, <a class="el" href="group__msectionh.html#ga4cf8478a882b7dac40756a9549e9748b">cm_register_transition()</a>, <a class="el" href="midas_8c_source.html#l03000">cm_set_watchdog_params()</a>, <a class="el" href="midas_8h_source.html#l00962">CM_SHUTDOWN</a>, <a class="el" href="midas_8c_source.html#l04979">cm_shutdown()</a>, <a class="el" href="midas_8h_source.html#l00956">CM_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00960">CM_UNDEF_EXP</a>, <a class="el" href="odb_8c_source.html#l07436">db_check_record()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l06770">db_get_record()</a>, <a class="el" href="odb_8c_source.html#l06874">db_set_record()</a>, <a class="el" href="odb_8c_source.html#l03128">db_set_value()</a>, <a class="el" href="midas_8h_source.html#l00696">DEFAULT_RPC_TIMEOUT</a>, <a class="el" href="midas_8h_source.html#l00699">DEFAULT_WATCHDOG_TIMEOUT</a>, <a class="el" href="system_8c_source.html#l00348">disable_shm_write</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>, <a class="el" href="mana_8cpp_source.html#l00636">HBOOK_LREC</a>, <a class="el" href="hbook_8h_source.html#l00204">HLIMAP</a>, <a class="el" href="hbook_8h_source.html#l00108">HLIMIT</a>, <a class="el" href="fal_8c_source.html#l03403">init_module_parameters()</a>, <a class="el" href="mana_8cpp_source.html#l04009">load_last_histos()</a>, <a class="el" href="mana_8cpp_source.html#l04098">loop_online()</a>, <a class="el" href="mana_8cpp_source.html#l04802">loop_runs_offline()</a>, <a class="el" href="fal_8c_source.html#l03435">mana_exit()</a>, <a class="el" href="fal_8c_source.html#l03313">mana_init()</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#afd64558b184072361ea06d2b253ae428">manaApp</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="fal_8c_source.html#l00285">OUT_INFO_STR</a>, <a class="el" href="mana_8cpp_source.html#l00554">PVM_BUFFER_SIZE</a>, <a class="el" href="fal_8c_source.html#l03837">register_requests()</a>, <a class="el" href="mrpc_8h_source.html#l00190">RPC_ANA_CLEAR_HISTOS</a>, <a class="el" href="mana_8cpp_source.html#l04059">save_last_histos()</a>, <a class="el" href="system_8c_source.html#l01466">ss_daemon_init()</a>, <a class="el" href="system_8c_source.html#l01045">ss_force_single_thread()</a>, <a class="el" href="system_8c_source.html#l05443">ss_getchar()</a>, <a class="el" href="midas_8h_source.html#l00741">TID_INT</a>, <a class="el" href="crate9_2mfe__mucap_8c_source.html#l00471">tr_pause()</a>, <a class="el" href="midas_8h_source.html#l00793">TR_PAUSE</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00125">tr_prestart</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00511">tr_resume()</a>, <a class="el" href="midas_8h_source.html#l00794">TR_RESUME</a>, <a class="el" href="midas_8h_source.html#l00791">TR_START</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00128">tr_stop</a>, <a class="el" href="midas_8h_source.html#l00792">TR_STOP</a>, and <a class="el" href="p30_8h_source.html#l00043">TRUE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05703"></a>05703 {
<a name="l05704"></a>05704    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l05705"></a>05705    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l05706"></a>05706    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l05707"></a>05707 
<a name="l05708"></a>05708    <span class="comment">/* read in command line parameters into clp structure */</span>
<a name="l05709"></a>05709    status = <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(argc, argv);
<a name="l05710"></a>05710    <span class="keywordflow">if</span> (status != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>)
<a name="l05711"></a>05711       <span class="keywordflow">return</span> 1;
<a name="l05712"></a>05712    <span class="comment">/* Determine the run number from the input file - Kiburg 1/24/2008 */</span>
<a name="l05713"></a>05713    <span class="keywordtype">int</span> myrunnumber=0;
<a name="l05714"></a>05714    <span class="keywordtype">int</span> mystrlen=0;
<a name="l05715"></a>05715    <span class="keywordtype">char</span> mystr[256];
<a name="l05716"></a>05716    strcpy(mystr,<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[0]);
<a name="l05717"></a>05717    mystrlen = strlen(mystr);
<a name="l05718"></a>05718    <span class="keywordflow">if</span> (mystrlen&gt;8){ 
<a name="l05719"></a>05719      <span class="keywordtype">char</span> tmpstr[]={mystr[mystrlen-9], 
<a name="l05720"></a>05720                     mystr[mystrlen-8],
<a name="l05721"></a>05721                     mystr[mystrlen-7],
<a name="l05722"></a>05722                     mystr[mystrlen-6], 
<a name="l05723"></a>05723                     mystr[mystrlen-5]};
<a name="l05724"></a>05724      myrunnumber=atoi(tmpstr);
<a name="l05725"></a>05725      printf(<span class="stringliteral">&quot;This file indicates the run number is %d\n&quot;</span>,myrunnumber);
<a name="l05726"></a>05726    }
<a name="l05727"></a>05727    <span class="comment">/* myrunnumber now contains the current run number, or 0 if it was not poss */</span>
<a name="l05728"></a>05728 
<a name="l05729"></a>05729 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l05730"></a>05730 <span class="preprocessor"></span>   <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l05731"></a>05731 
<a name="l05732"></a>05732    str[0] = 0;
<a name="l05733"></a>05733    <span class="keywordflow">for</span> (i = 0; i &lt; argc; i++) {
<a name="l05734"></a>05734       strcat(str, argv[i]);
<a name="l05735"></a>05735       strcat(str, <span class="stringliteral">&quot; &quot;</span>);
<a name="l05736"></a>05736    }
<a name="l05737"></a>05737    PVM_DEBUG(<span class="stringliteral">&quot;Analyzer started: %s&quot;</span>, str);
<a name="l05738"></a>05738 <span class="preprocessor">#endif</span>
<a name="l05739"></a>05739 <span class="preprocessor"></span>
<a name="l05740"></a>05740 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l05741"></a>05741 <span class="preprocessor"></span>   <span class="keywordtype">char</span> **rargv;
<a name="l05742"></a>05742    <span class="keywordtype">int</span> rargc;
<a name="l05743"></a>05743 
<a name="l05744"></a>05744    <span class="comment">/* copy first argument */</span>
<a name="l05745"></a>05745    rargc = 0;
<a name="l05746"></a>05746    rargv = (<span class="keywordtype">char</span> **) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *) * 2);
<a name="l05747"></a>05747    rargv[rargc] = (<span class="keywordtype">char</span> *) malloc(strlen(argv[rargc]) + 1);
<a name="l05748"></a>05748    strcpy(rargv[rargc], argv[rargc]);
<a name="l05749"></a>05749    rargc++;
<a name="l05750"></a>05750 
<a name="l05751"></a>05751    <span class="comment">/* append argument &quot;-b&quot; for batch mode without graphics, unless graphics */</span>
<a name="l05752"></a>05752    <span class="comment">/* mode has been requested. */</span>
<a name="l05753"></a>05753    <span class="keywordflow">if</span>(!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.graphics) {
<a name="l05754"></a>05754      rargv[rargc] = (<span class="keywordtype">char</span> *) malloc(3);
<a name="l05755"></a>05755      rargv[rargc++] = <span class="stringliteral">&quot;-b&quot;</span>;
<a name="l05756"></a>05756    }
<a name="l05757"></a>05757    <a class="code" href="MDQ__Amplitude_8cpp.html#afd64558b184072361ea06d2b253ae428">manaApp</a> = <span class="keyword">new</span> TApplication(<span class="stringliteral">&quot;ranalyzer&quot;</span>, &amp;rargc, rargv);
<a name="l05758"></a>05758 
<a name="l05759"></a>05759    <span class="comment">/* free argument memory */</span>
<a name="l05760"></a>05760    free(rargv[0]);
<a name="l05761"></a>05761    <span class="keywordflow">if</span>(rargc == 2) {
<a name="l05762"></a>05762      free(rargv[1]);
<a name="l05763"></a>05763    }
<a name="l05764"></a>05764    free(rargv);
<a name="l05765"></a>05765 
<a name="l05766"></a>05766    <span class="comment">/* default server port */</span>
<a name="l05767"></a>05767    <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.root_port = 9090;
<a name="l05768"></a>05768 <span class="preprocessor">#endif</span>
<a name="l05769"></a>05769 <span class="preprocessor"></span>
<a name="l05770"></a>05770    <span class="comment">/* get default from environment */</span>
<a name="l05771"></a>05771    <a class="code" href="patch__mevb_8cpp.html#aa598123f60ccd5496f2421c7bf2fabbf">cm_get_environment</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.host_name, <span class="keyword">sizeof</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.host_name), <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name,
<a name="l05772"></a>05772                       <span class="keyword">sizeof</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name));
<a name="l05773"></a>05773 
<a name="l05774"></a>05774 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05775"></a>05775 <span class="preprocessor"></span>   <span class="comment">/* set default lrec size */</span>
<a name="l05776"></a>05776    <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.lrec = <a class="code" href="mana_8cpp.html#a4f4d653810d83035206144299458b3d0">HBOOK_LREC</a>;
<a name="l05777"></a>05777 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l05778"></a>05778 
<a name="l05779"></a>05779 
<a name="l05780"></a>05780    <span class="comment">/* become a daemon */</span>
<a name="l05781"></a>05781    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.daemon) {
<a name="l05782"></a>05782       printf(<span class="stringliteral">&quot;Becoming a daemon...\n&quot;</span>);
<a name="l05783"></a>05783       <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l05784"></a>05784       <a class="code" href="group__msystemincludecode.html#ga957613d29ce8b6e66f075ace4f32c1e1">ss_daemon_init</a>(<a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05785"></a>05785    } 
<a name="l05786"></a>05786  
<a name="l05787"></a>05787    <span class="comment">/* set default buffer size */</span>
<a name="l05788"></a>05788    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.pvm_buf_size == 0)
<a name="l05789"></a>05789       <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.pvm_buf_size = 512 * 1024;
<a name="l05790"></a>05790    <span class="keywordflow">else</span>
<a name="l05791"></a>05791       <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.pvm_buf_size *= 1024;
<a name="l05792"></a>05792    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.pvm_buf_size &gt; <a class="code" href="mana_8cpp.html#a87dfd475372bf9bce289d185b3bc5cf4">PVM_BUFFER_SIZE</a>) {
<a name="l05793"></a>05793       printf(<span class="stringliteral">&quot;Buffer size cannot be larger than %dkB\n&quot;</span>, <a class="code" href="mana_8cpp.html#a87dfd475372bf9bce289d185b3bc5cf4">PVM_BUFFER_SIZE</a> / 1024);
<a name="l05794"></a>05794       <span class="keywordflow">return</span> 1;
<a name="l05795"></a>05795    }
<a name="l05796"></a>05796 
<a name="l05797"></a>05797    <span class="comment">/* set online mode if no input filename is given */</span>
<a name="l05798"></a>05798    <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online = (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.input_file_name[0][0] == 0);
<a name="l05799"></a>05799 
<a name="l05800"></a>05800   <span class="comment">/* Don&apos;t run offline if MIDAS_DIR is not defined */</span> 
<a name="l05801"></a>05801    <span class="keywordflow">if</span> ( ! <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online ) 
<a name="l05802"></a>05802      { 
<a name="l05803"></a>05803        <span class="keywordflow">if</span> ( !getenv(<span class="stringliteral">&quot;MIDAS_DIR&quot;</span>) ) 
<a name="l05804"></a>05804          { 
<a name="l05805"></a>05805            printf(<span class="stringliteral">&quot;For offline running the directory MIDAS_DIR must be defined\n&quot;</span>); 
<a name="l05806"></a>05806            <span class="keywordflow">return</span> 1; 
<a name="l05807"></a>05807          } 
<a name="l05808"></a>05808      } 
<a name="l05809"></a>05809 
<a name="l05810"></a>05810 
<a name="l05811"></a>05811 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05812"></a>05812 <span class="preprocessor"></span>   <span class="comment">/* set Ntuple format to RWNT if online */</span>
<a name="l05813"></a>05813    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online || <a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="stringliteral">&quot;OFLN&quot;</span>))
<a name="l05814"></a>05814       <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.rwnt = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l05815"></a>05815 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l05816"></a>05816 
<a name="l05817"></a>05817 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l05818"></a>05818 <span class="preprocessor"></span>   status = pvm_main(argv);
<a name="l05819"></a>05819    <span class="keywordflow">if</span> (status != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>)
<a name="l05820"></a>05820       <span class="keywordflow">return</span> 1;
<a name="l05821"></a>05821 <span class="preprocessor">#endif</span>
<a name="l05822"></a>05822 <span class="preprocessor"></span>
<a name="l05823"></a>05823 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l05824"></a>05824 <span class="preprocessor"></span>   <span class="comment">/* workaround for multi-threading with midas system calls */</span>
<a name="l05825"></a>05825    <a class="code" href="group__msystemincludecode.html#gae2d1c335b2d2b6a7d904e36e1a9e1d93">ss_force_single_thread</a>();
<a name="l05826"></a>05826 <span class="preprocessor">#endif</span>
<a name="l05827"></a>05827 <span class="preprocessor"></span>
<a name="l05828"></a>05828    <span class="comment">/* now connect to server */</span>
<a name="l05829"></a>05829    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l05830"></a>05830       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.host_name[0])
<a name="l05831"></a>05831          printf(<span class="stringliteral">&quot;Connect to experiment %s on host %s...&quot;</span>, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.host_name);
<a name="l05832"></a>05832       <span class="keywordflow">else</span>
<a name="l05833"></a>05833          printf(<span class="stringliteral">&quot;Connect to experiment %s...&quot;</span>, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name);
<a name="l05834"></a>05834    }
<a name="l05835"></a>05835 
<a name="l05836"></a>05836    status =
<a name="l05837"></a>05837        <a class="code" href="group__msectionh.html#gae2c7dedc142d472208e2e67f920b91e2">cm_connect_experiment1</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.host_name, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, NULL, <a class="code" href="analyzer_8cpp.html#a7503268889a084b74a968787ffc025b7">odb_size</a>,
<a name="l05838"></a>05838                               <a class="code" href="group__midasincludecode.html#ga277afc8607c7a55aafffc11d69be143c">DEFAULT_WATCHDOG_TIMEOUT</a>);
<a name="l05839"></a>05839 
<a name="l05840"></a>05840    <span class="keywordflow">if</span> (status == <a class="code" href="group__err21.html#ga10f9c3f1a23d0f63f86edf36143c849d">CM_UNDEF_EXP</a>) {
<a name="l05841"></a>05841       printf(<span class="stringliteral">&quot;\nError: Experiment \&quot;%s\&quot; not defined.\n&quot;</span>, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.exp_name);
<a name="l05842"></a>05842       <span class="keywordflow">if</span> (getenv(<span class="stringliteral">&quot;MIDAS_DIR&quot;</span>)) {
<a name="l05843"></a>05843          printf
<a name="l05844"></a>05844              (<span class="stringliteral">&quot;Note that \&quot;MIDAS_DIR\&quot; is defined, which results in a single experiment\n&quot;</span>);
<a name="l05845"></a>05845          printf
<a name="l05846"></a>05846              (<span class="stringliteral">&quot;called \&quot;Default\&quot;. If you want to use the \&quot;exptab\&quot; file, undefine \&quot;MIDAS_DIR\&quot;.\n&quot;</span>);
<a name="l05847"></a>05847       }
<a name="l05848"></a>05848       <span class="keywordflow">return</span> 1;
<a name="l05849"></a>05849    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (status != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05850"></a>05850       <a class="code" href="group__msectionh.html#gabfcb4ad0fdc5fe978b8dc0f606306215">cm_get_error</a>(status, str);
<a name="l05851"></a>05851       printf(<span class="stringliteral">&quot;\nError: %s\n&quot;</span>, str);
<a name="l05852"></a>05852       <span class="keywordflow">return</span> 1;
<a name="l05853"></a>05853    }
<a name="l05854"></a>05854 
<a name="l05855"></a>05855    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l05856"></a>05856       printf(<span class="stringliteral">&quot;OK\n&quot;</span>);
<a name="l05857"></a>05857 
<a name="l05858"></a>05858    <span class="comment">/* set online/offline mode */</span>
<a name="l05859"></a>05859    <a class="code" href="group__msectionh.html#ga1932e7947b0a024a845c5b8c19c3dda0">cm_get_experiment_database</a>(&amp;<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, NULL);
<a name="l05860"></a>05860    <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/Runinfo/Online Mode&quot;</span>, &amp;<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online, <span class="keyword">sizeof</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online), 1,
<a name="l05861"></a>05861                 <a class="code" href="group__mdefineh.html#gad950d5fde6dd3ea7eba59fb6760a38cb">TID_INT</a>);
<a name="l05862"></a>05862    <span class="comment">/* set run number in the database -- Brendan Kiburg 1/24/2008 */</span>
<a name="l05863"></a>05863    <span class="comment">/* commented out by VT on 11/25/2013 */</span>
<a name="l05864"></a>05864    <span class="comment">//db_set_value(hDB, 0, &quot;/Runinfo/Run number&quot;, &amp;myrunnumber, sizeof(int), 1, TID_INT);</span>
<a name="l05865"></a>05865 
<a name="l05866"></a>05866    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l05867"></a>05867       <span class="comment">/* check for duplicate name */</span>
<a name="l05868"></a>05868       status = <a class="code" href="group__msectionh.html#gafe2e23ec2e5c20fbc65ee238bd6cd48e">cm_exist</a>(<a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05869"></a>05869       <span class="keywordflow">if</span> (status == <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05870"></a>05870          <a class="code" href="group__msectionh.html#ga9792ed24b1150464250ac794067c9196">cm_disconnect_experiment</a>();
<a name="l05871"></a>05871          printf(<span class="stringliteral">&quot;An analyzer named \&quot;%s\&quot; is already running in this experiment.\n&quot;</span>,
<a name="l05872"></a>05872                 <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l05873"></a>05873          printf
<a name="l05874"></a>05874              (<span class="stringliteral">&quot;Please select another analyzer name in analyzer.c or stop other analyzer.\n&quot;</span>);
<a name="l05875"></a>05875          <span class="keywordflow">return</span> 1;
<a name="l05876"></a>05876       }
<a name="l05877"></a>05877 
<a name="l05878"></a>05878       <span class="comment">/* register transitions if started online */</span>
<a name="l05879"></a>05879       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga4cf8478a882b7dac40756a9549e9748b">cm_register_transition</a>(<a class="code" href="group__mdefineh.html#ga2abbc514b87837cc235da54a4cf59e09">TR_START</a>, <a class="code" href="patch__mevb_8cpp.html#a6e149fe266abfc4575be750a5ae1d3b0">tr_prestart</a>, 500) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a> ||
<a name="l05880"></a>05880           <a class="code" href="group__msectionh.html#ga4cf8478a882b7dac40756a9549e9748b">cm_register_transition</a>(<a class="code" href="group__mdefineh.html#gadd7d0605113ff6e1b4e705d31332a1a0">TR_STOP</a>, <a class="code" href="patch__mevb_8cpp.html#a29971c513f4451dd5c79373edd928ca0">tr_stop</a>, 500) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a> ||
<a name="l05881"></a>05881           <a class="code" href="group__msectionh.html#ga4cf8478a882b7dac40756a9549e9748b">cm_register_transition</a>(<a class="code" href="group__mdefineh.html#ga11713399cfb35e58b8fae045836c0d88">TR_PAUSE</a>, <a class="code" href="crate9_2mfe__mucap_8c.html#a7b3b6a2f570d0b31b1ad13c34536db5a">tr_pause</a>, 500) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a> ||
<a name="l05882"></a>05882           <a class="code" href="group__msectionh.html#ga4cf8478a882b7dac40756a9549e9748b">cm_register_transition</a>(<a class="code" href="group__mdefineh.html#ga0b69b728877f100fe6ff76e667ff8831">TR_RESUME</a>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#ac69f1c3106f3389ed0dde43e7b86e54d">tr_resume</a>, 500) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05883"></a>05883          printf(<span class="stringliteral">&quot;Failed to start local RPC server&quot;</span>);
<a name="l05884"></a>05884          <span class="keywordflow">return</span> 1;
<a name="l05885"></a>05885       }
<a name="l05886"></a>05886    } <span class="keywordflow">else</span> {
<a name="l05887"></a>05887       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {         <span class="comment">/* slave could run on same machine... */</span>
<a name="l05888"></a>05888          status = <a class="code" href="group__msectionh.html#gafe2e23ec2e5c20fbc65ee238bd6cd48e">cm_exist</a>(<a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05889"></a>05889          <span class="keywordflow">if</span> (status == <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05890"></a>05890             <span class="comment">/* kill hanging previous analyzer */</span>
<a name="l05891"></a>05891             <a class="code" href="group__msectionh.html#ga2bb78358bf566eb83197810aee9c59b5">cm_cleanup</a>(<a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05892"></a>05892 
<a name="l05893"></a>05893             status = <a class="code" href="group__msectionh.html#gafe2e23ec2e5c20fbc65ee238bd6cd48e">cm_exist</a>(<a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05894"></a>05894             <span class="keywordflow">if</span> (status == <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05895"></a>05895                <span class="comment">/* analyzer may only run once if offline */</span>
<a name="l05896"></a>05896                status = <a class="code" href="group__msectionh.html#ga5c224ebc90480c8df5bc2a7dd81ff27c">cm_shutdown</a>(<a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l05897"></a>05897                <span class="keywordflow">if</span> (status == <a class="code" href="group__err21.html#ga76db0fac26b6f3dcdc29ec8b640c5a5f">CM_SHUTDOWN</a>)
<a name="l05898"></a>05898                   printf(<span class="stringliteral">&quot;Previous analyzer stopped\n&quot;</span>);
<a name="l05899"></a>05899             }
<a name="l05900"></a>05900          }
<a name="l05901"></a>05901       }
<a name="l05902"></a>05902    }
<a name="l05903"></a>05903 
<a name="l05904"></a>05904 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05905"></a>05905 <span class="preprocessor"></span>   <span class="comment">/* register callback for clearing histos */</span>
<a name="l05906"></a>05906    <a class="code" href="group__msectionh.html#gad3115b4913387a49fb131e5144509557">cm_register_function</a>(<a class="code" href="group__mrpcdefineh.html#gab04cd68bb2484fcbaa62d2eda3100250">RPC_ANA_CLEAR_HISTOS</a>, <a class="code" href="fal_8c.html#a6286c3b1e900cb783d0b57e910d06f8a">ana_callback</a>);
<a name="l05907"></a>05907 <span class="preprocessor">#endif</span>
<a name="l05908"></a>05908 <span class="preprocessor"></span>
<a name="l05909"></a>05909    <span class="comment">/* turn on keepalive messages */</span>
<a name="l05910"></a>05910    <a class="code" href="group__msectionh.html#ga070f5551bb23bbfd54ca81554e729136">cm_set_watchdog_params</a>(<a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="group__midasincludecode.html#ga39d21da28bfcbf0caba6bd19ef551f36">DEFAULT_RPC_TIMEOUT</a>);
<a name="l05911"></a>05911 
<a name="l05912"></a>05912    <span class="comment">/* decrease watchdog timeout in offline mode */</span>
<a name="l05913"></a>05913    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l05914"></a>05914       <a class="code" href="group__msectionh.html#ga070f5551bb23bbfd54ca81554e729136">cm_set_watchdog_params</a>(<a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, 2000);
<a name="l05915"></a>05915 
<a name="l05916"></a>05916    <span class="comment">/* turn off watchdog if in debug mode */</span>
<a name="l05917"></a>05917    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.debug)
<a name="l05918"></a>05918       <a class="code" href="group__msectionh.html#ga070f5551bb23bbfd54ca81554e729136">cm_set_watchdog_params</a>(0, 0);
<a name="l05919"></a>05919 
<a name="l05920"></a>05920    <span class="comment">/* initialize module parameters */</span>
<a name="l05921"></a>05921    <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a9527329c5d4ec01a728dfc43ad33b2fa">init_module_parameters</a>(<a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05922"></a>05922       <a class="code" href="group__msectionh.html#ga9792ed24b1150464250ac794067c9196">cm_disconnect_experiment</a>();
<a name="l05923"></a>05923       <span class="keywordflow">return</span> 1;
<a name="l05924"></a>05924    }
<a name="l05925"></a>05925 
<a name="l05926"></a>05926    <span class="comment">/* create ODB structure for output */</span>
<a name="l05927"></a>05927    sprintf(str, <span class="stringliteral">&quot;/%s/Output&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l05928"></a>05928    <a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="fal_8c.html#a7c5689a91d273a5acdde5b6d6fd2a0b0">OUT_INFO_STR</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l05929"></a>05929    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l05930"></a>05930    assert(hkey);
<a name="l05931"></a>05931    size = <span class="keyword">sizeof</span>(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>);
<a name="l05932"></a>05932    <a class="code" href="group__msectionh.html#gaae4cf88eaadf5d2dd9eefa3e1b6389e6">db_get_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, &amp;size, 0);
<a name="l05933"></a>05933 
<a name="l05934"></a>05934 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l05935"></a>05935 <span class="preprocessor"></span>   <span class="comment">/* create the directory for analyzer histograms */</span>
<a name="l05936"></a>05936    <a class="code" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a> = <span class="keyword">new</span> TDirectory(<span class="stringliteral">&quot;MidasHists&quot;</span>, <span class="stringliteral">&quot;MIDAS Analyzer Histograms&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l05937"></a>05937    assert(gManaHistsDir != NULL);
<a name="l05938"></a>05938 
<a name="l05939"></a>05939    <span class="comment">/* make all ROOT objects created in user module init() functions to into gManaHistsDir */</span>
<a name="l05940"></a>05940    <a class="code" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>-&gt;cd();
<a name="l05941"></a>05941 
<a name="l05942"></a>05942    <span class="comment">/* convert .rz names to .root names */</span>
<a name="l05943"></a>05943    <span class="keywordflow">if</span> (strstr(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename, <span class="stringliteral">&quot;.rz&quot;</span>))
<a name="l05944"></a>05944       strcpy(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename, <span class="stringliteral">&quot;last.root&quot;</span>);
<a name="l05945"></a>05945 
<a name="l05946"></a>05946    <span class="keywordflow">if</span> (strstr(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump_filename, <span class="stringliteral">&quot;.rz&quot;</span>))
<a name="l05947"></a>05947       strcpy(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump_filename, <span class="stringliteral">&quot;his%05d.root&quot;</span>);
<a name="l05948"></a>05948 
<a name="l05949"></a>05949    <a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <span class="keyword">sizeof</span>(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>), 0);
<a name="l05950"></a>05950 
<a name="l05951"></a>05951 <span class="preprocessor">#ifdef OS_LINUX</span>
<a name="l05952"></a>05952 <span class="preprocessor"></span>   <span class="comment">/* start socket server */</span>
<a name="l05953"></a>05953    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.root_port) {
<a name="l05954"></a>05954       TThread *th1 = <span class="keyword">new</span> TThread(<span class="stringliteral">&quot;root_server_loop&quot;</span>, root_server_loop, NULL);
<a name="l05955"></a>05955       th1-&gt;Run();
<a name="l05956"></a>05956    }
<a name="l05957"></a>05957 <span class="preprocessor">#endif</span>
<a name="l05958"></a>05958 <span class="preprocessor"></span>
<a name="l05959"></a>05959 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l05960"></a>05960 
<a name="l05961"></a>05961 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05962"></a>05962 <span class="preprocessor"></span>   <span class="comment">/* convert .root names to .rz names */</span>
<a name="l05963"></a>05963    <span class="keywordflow">if</span> (strstr(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename, <span class="stringliteral">&quot;.root&quot;</span>))
<a name="l05964"></a>05964       strcpy(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename, <span class="stringliteral">&quot;last.rz&quot;</span>);
<a name="l05965"></a>05965 
<a name="l05966"></a>05966    <span class="keywordflow">if</span> (strstr(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump_filename, <span class="stringliteral">&quot;.root&quot;</span>))
<a name="l05967"></a>05967       strcpy(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.histo_dump_filename, <span class="stringliteral">&quot;his%05d.rz&quot;</span>);
<a name="l05968"></a>05968 
<a name="l05969"></a>05969    <a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <span class="keyword">sizeof</span>(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>), 0);
<a name="l05970"></a>05970 <span class="preprocessor">#endif</span>
<a name="l05971"></a>05971 <span class="preprocessor"></span>
<a name="l05972"></a>05972 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05973"></a>05973 <span class="preprocessor"></span>   <span class="comment">/* create global memory */</span>
<a name="l05974"></a>05974    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l05975"></a>05975       <a class="code" href="hbook_8h.html#ac41e1ed0bb8347eadf199c22a759b0ba">HLIMAP</a>(pawc_size / 4, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.global_memory_name);
<a name="l05976"></a>05976       printf(<span class="stringliteral">&quot;\nGLOBAL MEMORY NAME = %s\n&quot;</span>, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.global_memory_name);
<a name="l05977"></a>05977    } <span class="keywordflow">else</span> {
<a name="l05978"></a>05978       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="stringliteral">&quot;OFLN&quot;</span>)) {
<a name="l05979"></a>05979          strcpy(str, <span class="stringliteral">&quot;OFLN&quot;</span>);
<a name="l05980"></a>05980          <a class="code" href="hbook_8h.html#ac41e1ed0bb8347eadf199c22a759b0ba">HLIMAP</a>(pawc_size / 4, str);
<a name="l05981"></a>05981          printf(<span class="stringliteral">&quot;\nGLOBAL MEMORY NAME = %s\n&quot;</span>, <span class="stringliteral">&quot;OFLN&quot;</span>);
<a name="l05982"></a>05982       } <span class="keywordflow">else</span>
<a name="l05983"></a>05983          <a class="code" href="hbook_8h.html#a91bcdef204bed62580e3bae742de1a24">HLIMIT</a>(pawc_size / 4);
<a name="l05984"></a>05984    }
<a name="l05985"></a>05985 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l05986"></a>05986 
<a name="l05987"></a>05987 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l05988"></a>05988 <span class="preprocessor"></span>   <span class="comment">/* load histos from last.xxx */</span>
<a name="l05989"></a>05989    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l05990"></a>05990       <a class="code" href="mana_8cpp.html#a0e79fc9202ddba8e379b10912fe709aa">load_last_histos</a>();
<a name="l05991"></a>05991 <span class="preprocessor">#endif</span>
<a name="l05992"></a>05992 <span class="preprocessor"></span>
<a name="l05993"></a>05993    <span class="comment">/* analyzer init function */</span>
<a name="l05994"></a>05994    <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a12f9d4b93e18856d7ea847512163fc3b">mana_init</a>() != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>) {
<a name="l05995"></a>05995       <a class="code" href="group__msectionh.html#ga9792ed24b1150464250ac794067c9196">cm_disconnect_experiment</a>();
<a name="l05996"></a>05996       <span class="keywordflow">return</span> 1;
<a name="l05997"></a>05997    }
<a name="l05998"></a>05998 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l05999"></a>05999 <span class="preprocessor"></span>   <span class="comment">/* load histos from last.xxx */</span>
<a name="l06000"></a>06000    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l06001"></a>06001       <a class="code" href="mana_8cpp.html#a0e79fc9202ddba8e379b10912fe709aa">load_last_histos</a>();
<a name="l06002"></a>06002 <span class="preprocessor">#endif</span>
<a name="l06003"></a>06003 <span class="preprocessor"></span>
<a name="l06004"></a>06004    <span class="comment">/* reqister event requests */</span>
<a name="l06005"></a>06005    <a class="code" href="fal_8c.html#a1a2128d90a2986636c9e80968c0d5c67">register_requests</a>();
<a name="l06006"></a>06006 
<a name="l06007"></a>06007    <span class="comment">/* initialize ss_getchar */</span>
<a name="l06008"></a>06008    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet &amp;&amp; !<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>)
<a name="l06009"></a>06009       <a class="code" href="group__msectionh.html#ga421c43305fae4215de164a5dd418909c">ss_getchar</a>(0);
<a name="l06010"></a>06010 
<a name="l06011"></a>06011   <span class="comment">/*---- start main loop ----*/</span>
<a name="l06012"></a>06012 
<a name="l06013"></a>06013 <span class="comment">/* multi-threaded root server only under Linux */</span>
<a name="l06014"></a>06014 <span class="comment">//#if defined(HAVE_ROOT) &amp;&amp; defined(OS_LINUX)</span>
<a name="l06015"></a>06015 <span class="preprocessor">#if 0</span>
<a name="l06016"></a>06016 <span class="preprocessor"></span>   <span class="comment">/* start event thread */</span>
<a name="l06017"></a>06017    TThread *th2 = <span class="keyword">new</span> TThread(<span class="stringliteral">&quot;root_event_loop&quot;</span>, root_event_loop, NULL);
<a name="l06018"></a>06018    th2-&gt;Run();
<a name="l06019"></a>06019 
<a name="l06020"></a>06020    <a class="code" href="MDQ__Amplitude_8cpp.html#afd64558b184072361ea06d2b253ae428">manaApp</a>-&gt;Run();
<a name="l06021"></a>06021 <span class="preprocessor">#else</span>
<a name="l06022"></a>06022 <span class="preprocessor"></span><span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l06023"></a>06023 <span class="preprocessor"></span>   <span class="keywordflow">if</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.graphics){
<a name="l06024"></a>06024      <span class="comment">/* start event thread */</span>
<a name="l06025"></a>06025      TThread *th2 = <span class="keyword">new</span> TThread(<span class="stringliteral">&quot;root_event_loop&quot;</span>, root_event_loop, NULL);
<a name="l06026"></a>06026      th2-&gt;Run();
<a name="l06027"></a>06027      
<a name="l06028"></a>06028      <a class="code" href="MDQ__Amplitude_8cpp.html#afd64558b184072361ea06d2b253ae428">manaApp</a>-&gt;Run();
<a name="l06029"></a>06029    }
<a name="l06030"></a>06030 <span class="preprocessor">#endif // HAVE_ROOT</span>
<a name="l06031"></a>06031 <span class="preprocessor"></span>
<a name="l06032"></a>06032    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l06033"></a>06033       <a class="code" href="mana_8cpp.html#adce2146eee6315ed1feed2dc301f2427">loop_online</a>();
<a name="l06034"></a>06034    <span class="keywordflow">else</span>
<a name="l06035"></a>06035       <a class="code" href="mana_8cpp.html#a6b0a51747fb7d6f42a04aa7813d88cd7">loop_runs_offline</a>();
<a name="l06036"></a>06036 <span class="preprocessor">#endif</span>
<a name="l06037"></a>06037 <span class="preprocessor"></span>
<a name="l06038"></a>06038    <span class="comment">/* reset terminal */</span>
<a name="l06039"></a>06039    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet &amp;&amp; !<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>)
<a name="l06040"></a>06040       <a class="code" href="group__msectionh.html#ga421c43305fae4215de164a5dd418909c">ss_getchar</a>(<a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l06041"></a>06041 
<a name="l06042"></a>06042    <span class="comment">/* call exit function */</span>
<a name="l06043"></a>06043    <a class="code" href="fal_8c.html#a11a24986d9abfd2f14209cf7c8893f52">mana_exit</a>();
<a name="l06044"></a>06044 
<a name="l06045"></a>06045    <span class="comment">/* save histos to last.xxx */</span>
<a name="l06046"></a>06046    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l06047"></a>06047       <a class="code" href="mana_8cpp.html#ad767414c61d6a24611888cbdb899af31">save_last_histos</a>();
<a name="l06048"></a>06048 
<a name="l06049"></a>06049 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l06050"></a>06050 <span class="preprocessor"></span>
<a name="l06051"></a>06051    PVM_DEBUG(<span class="stringliteral">&quot;Analyzer stopped&quot;</span>);
<a name="l06052"></a>06052 
<a name="l06053"></a>06053    <span class="comment">/* exit PVM */</span>
<a name="l06054"></a>06054    pvm_exit();
<a name="l06055"></a>06055 
<a name="l06056"></a>06056    <span class="comment">/* if PVM slave, don&apos;t write *SHM file back */</span>
<a name="l06057"></a>06057    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>)
<a name="l06058"></a>06058       <a class="code" href="group__msfunctionc.html#ga92e8e4e8fae25311b5816a776399a0c1">disable_shm_write</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l06059"></a>06059 
<a name="l06060"></a>06060 <span class="preprocessor">#endif</span>
<a name="l06061"></a>06061 <span class="preprocessor"></span>
<a name="l06062"></a>06062    <span class="comment">/* disconnect from experiment */</span>
<a name="l06063"></a>06063    <a class="code" href="group__msectionh.html#ga9792ed24b1150464250ac794067c9196">cm_disconnect_experiment</a>();
<a name="l06064"></a>06064 
<a name="l06065"></a>06065    <span class="keywordflow">return</span> 0;
<a name="l06066"></a>06066 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11a24986d9abfd2f14209cf7c8893f52"></a><!-- doxytag: member="mana.cpp::mana_exit" ref="a11a24986d9abfd2f14209cf7c8893f52" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> mana_exit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02060">2060</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="analyzer_8cpp_source.html#l00184">analyzer_exit()</a>, <a class="el" href="crate3_2rpc__master_8cpp_source.html#l00027">enabled</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="group__midasincludecode.html#gaf3b4cc4d6a12a8eadeea80d82866b780">ANA_MODULE::exit</a>, and <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02061"></a>02061 {
<a name="l02062"></a>02062    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l02063"></a>02063    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>;
<a name="l02064"></a>02064 
<a name="l02065"></a>02065    <span class="comment">/* call exit routines from modules */</span>
<a name="l02066"></a>02066    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02067"></a>02067       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l02068"></a>02068       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++)
<a name="l02069"></a>02069          <span class="keywordflow">if</span> (module[j]-&gt;exit != NULL &amp;&amp; module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>)
<a name="l02070"></a>02070             module[j]-&gt;<a class="code" href="group__midasincludecode.html#gaf3b4cc4d6a12a8eadeea80d82866b780">exit</a>();
<a name="l02071"></a>02071    }
<a name="l02072"></a>02072 
<a name="l02073"></a>02073    <span class="comment">/* call main analyzer exit routine */</span>
<a name="l02074"></a>02074    <span class="keywordflow">return</span> <a class="code" href="analyzer_8cpp.html#a7738840c25fb678186362479850b4df6">analyzer_exit</a>();
<a name="l02075"></a>02075 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a12f9d4b93e18856d7ea847512163fc3b"></a><!-- doxytag: member="mana.cpp::mana_init" ref="a12f9d4b93e18856d7ea847512163fc3b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> mana_init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01935">1935</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="analyzer_8cpp_source.html#l00150">analyzer_init()</a>, <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="fal_8c_source.html#l02926">book_ntuples()</a>, <a class="el" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="odb_8c_source.html#l07436">db_check_record()</a>, <a class="el" href="odb_8c_source.html#l02160">db_delete_key()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l03261">db_get_value()</a>, <a class="el" href="odb_8c_source.html#l07741">db_open_record()</a>, <a class="el" href="odb_8c_source.html#l03128">db_set_value()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01455">BANK_LIST::def_key</a>, <a class="el" href="crate3_2rpc__master_8cpp_source.html#l00027">enabled</a>, <a class="el" href="midas_8h_source.html#l01477">ANA_MODULE::enabled</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="MTreeOutput_8cpp.html#a1eb4ae60b0d63b452d2b8c0341985730">gMiasTreeOutputFileName</a>, <a class="el" href="group__midasincludecode.html#ga8ae1120805260da00f37f34ed6d519c5">ANA_MODULE::init</a>, <a class="el" href="midas_8h_source.html#l01451">BANK_LIST::init_str</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="midas_8h_source.html#l00760">MODE_READ</a>, <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="midas_8c_source.html#l08162">rpc_tid_size()</a>, <a class="el" href="odb_8c_source.html#l00631">strcomb()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00742">TID_BOOL</a>, <a class="el" href="midas_8h_source.html#l00748">TID_STRUCT</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, and <a class="el" href="midas_8h_source.html#l01449">BANK_LIST::type</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01936"></a>01936 {
<a name="l01937"></a>01937    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l01938"></a>01938    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>;
<a name="l01939"></a>01939    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hkey;
<a name="l01940"></a>01940    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], block_name[32];
<a name="l01941"></a>01941    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *bank_list;
<a name="l01942"></a>01942    <span class="keywordtype">double</span> dummy;
<a name="l01943"></a>01943 
<a name="l01944"></a>01944    sprintf(str, <span class="stringliteral">&quot;/%s/Output&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l01945"></a>01945    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l01946"></a>01946 
<a name="l01947"></a>01947    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l01948"></a>01948       status =
<a name="l01949"></a>01949           <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, &amp;<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <span class="keyword">sizeof</span>(<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l01950"></a>01950       <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l01951"></a>01951          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;bor&quot;</span>, <span class="stringliteral">&quot;Cannot read output info record&quot;</span>);
<a name="l01952"></a>01952          <span class="keywordflow">return</span> 0;
<a name="l01953"></a>01953       }
<a name="l01954"></a>01954    }
<a name="l01955"></a>01955 
<a name="l01956"></a>01956 <span class="preprocessor">#if HAVE_ROOT</span>
<a name="l01957"></a>01957 <span class="preprocessor"></span>   <span class="comment">/* MIAS Tree output file opened in src/uiuc/EventTree/TEventTreeAnalysis.cpp. */</span>
<a name="l01958"></a>01958    <a class="code" href="MTreeOutput_8cpp.html#a1eb4ae60b0d63b452d2b8c0341985730">gMiasTreeOutputFileName</a> = <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.mias_tree_output_file_name;
<a name="l01959"></a>01959    <span class="keywordflow">if</span>(gMiasTreeOutputFileName) {
<a name="l01960"></a>01960      printf(<span class="stringliteral">&quot;gMiasTreeOutputFileName = %s\n&quot;</span>, gMiasTreeOutputFileName);
<a name="l01961"></a>01961    } <span class="keywordflow">else</span> {
<a name="l01962"></a>01962      printf(<span class="stringliteral">&quot;gMiasTreeOutputFileName == NULL\n&quot;</span>);
<a name="l01963"></a>01963    }
<a name="l01964"></a>01964 <span class="preprocessor">#endif</span>
<a name="l01965"></a>01965 <span class="preprocessor"></span>
<a name="l01966"></a>01966    <span class="comment">/* create ODB structures for banks */</span>
<a name="l01967"></a>01967    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l01968"></a>01968       bank_list = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>;
<a name="l01969"></a>01969 
<a name="l01970"></a>01970       <span class="keywordflow">if</span> (bank_list == NULL)
<a name="l01971"></a>01971          <span class="keywordflow">continue</span>;
<a name="l01972"></a>01972 
<a name="l01973"></a>01973       <span class="keywordflow">for</span> (; bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; bank_list++) {
<a name="l01974"></a>01974          strncpy(block_name, bank_list-&gt;<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>, 4);
<a name="l01975"></a>01975          block_name[4] = 0;
<a name="l01976"></a>01976 
<a name="l01977"></a>01977          <span class="keywordflow">if</span> (bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga949d7a28bdf3923796ffb2dff8f28690">type</a> == <a class="code" href="group__mdefineh.html#ga8d82076a05b53876103e1c53d5878b75">TID_STRUCT</a>) {
<a name="l01978"></a>01978             sprintf(str, <span class="stringliteral">&quot;/Equipment/%s/Variables/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].event_name,
<a name="l01979"></a>01979                     block_name);
<a name="l01980"></a>01980             <a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="group__msectionh.html#gaccf82d3dbd8eb7090db598725713e012">strcomb</a>(bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga7ebd92f00cb428fcbb555f3ad30b86c8">init_str</a>), <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01981"></a>01981             <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l01982"></a>01982             bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga732747585d79c8c76c856d376aa56cf0">def_key</a> = hkey;
<a name="l01983"></a>01983          } <span class="keywordflow">else</span> {
<a name="l01984"></a>01984             sprintf(str, <span class="stringliteral">&quot;/Equipment/%s/Variables/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].event_name,
<a name="l01985"></a>01985                     block_name);
<a name="l01986"></a>01986             dummy = 0;
<a name="l01987"></a>01987             <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;dummy, <a class="code" href="group__msectionh.html#gaa0bf5cc257f83e9a7f3936738fe009f3">rpc_tid_size</a>(bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga949d7a28bdf3923796ffb2dff8f28690">type</a>), 1,
<a name="l01988"></a>01988                          bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga949d7a28bdf3923796ffb2dff8f28690">type</a>);
<a name="l01989"></a>01989             <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l01990"></a>01990             bank_list-&gt;<a class="code" href="group__midasincludecode.html#ga732747585d79c8c76c856d376aa56cf0">def_key</a> = hkey;
<a name="l01991"></a>01991          }
<a name="l01992"></a>01992       }
<a name="l01993"></a>01993    }
<a name="l01994"></a>01994 
<a name="l01995"></a>01995    <span class="comment">/* create ODB structures for fixed events */</span>
<a name="l01996"></a>01996    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l01997"></a>01997       <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].init_string) {
<a name="l01998"></a>01998          sprintf(str, <span class="stringliteral">&quot;/Equipment/%s/Variables&quot;</span>, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].event_name);
<a name="l01999"></a>01999          <a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="group__msectionh.html#gaccf82d3dbd8eb7090db598725713e012">strcomb</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].init_string), <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02000"></a>02000       }
<a name="l02001"></a>02001    }
<a name="l02002"></a>02002 
<a name="l02003"></a>02003    <span class="comment">/* delete tests in ODB */</span>
<a name="l02004"></a>02004    sprintf(str, <span class="stringliteral">&quot;/%s/Tests&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l02005"></a>02005    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hkey);
<a name="l02006"></a>02006    <span class="keywordflow">if</span> (hkey)
<a name="l02007"></a>02007       <a class="code" href="group__msectionh.html#ga91277a012e0bfddbc32885da450409e0">db_delete_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hkey, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l02008"></a>02008 
<a name="l02009"></a>02009 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l02010"></a>02010 <span class="preprocessor"></span>   <span class="comment">/* create global memory */</span>
<a name="l02011"></a>02011    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l02012"></a>02012       <span class="comment">/* book online N-tuples only once when online */</span>
<a name="l02013"></a>02013       status = <a class="code" href="fal_8c.html#a2a0fbf63d5970373f81721ce136319dc">book_ntuples</a>();
<a name="l02014"></a>02014       <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02015"></a>02015          <span class="keywordflow">return</span> status;
<a name="l02016"></a>02016    } <span class="keywordflow">else</span> {
<a name="l02017"></a>02017       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="stringliteral">&quot;OFLN&quot;</span>)) {
<a name="l02018"></a>02018          <span class="comment">/* book online N-tuples only once when online */</span>
<a name="l02019"></a>02019          status = <a class="code" href="fal_8c.html#a2a0fbf63d5970373f81721ce136319dc">book_ntuples</a>();
<a name="l02020"></a>02020          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02021"></a>02021             <span class="keywordflow">return</span> status;
<a name="l02022"></a>02022       }
<a name="l02023"></a>02023    }
<a name="l02024"></a>02024 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l02027"></a>02027 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l02028"></a>02028       <span class="comment">/* book online N-tuples only once when online */</span>
<a name="l02029"></a>02029       status = <a class="code" href="mana_8cpp.html#a1231b896720547aa0748ecfaa9e68d05">book_ttree</a>();
<a name="l02030"></a>02030       <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02031"></a>02031          <span class="keywordflow">return</span> status;
<a name="l02032"></a>02032    }
<a name="l02033"></a>02033 <span class="preprocessor">#endif</span>
<a name="l02034"></a>02034 <span class="preprocessor"></span>
<a name="l02035"></a>02035    <span class="comment">/* call main analyzer init routine */</span>
<a name="l02036"></a>02036    status = <a class="code" href="analyzer_8cpp.html#afeea792d4dbe0001bd025397e494ab5b">analyzer_init</a>();
<a name="l02037"></a>02037    <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02038"></a>02038       <span class="keywordflow">return</span> status;
<a name="l02039"></a>02039 
<a name="l02040"></a>02040    <span class="comment">/* initialize modules */</span>
<a name="l02041"></a>02041    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02042"></a>02042       module = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l02043"></a>02043       <span class="keywordflow">for</span> (j = 0; module != NULL &amp;&amp; module[j] != NULL; j++) {
<a name="l02044"></a>02044          <span class="comment">/* copy module enabled flag to ana_module */</span>
<a name="l02045"></a>02045          sprintf(str, <span class="stringliteral">&quot;/%s/Module switches/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, module[j]-&gt;<a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>);
<a name="l02046"></a>02046          module[j]-&gt;<a class="code" href="group__midasincludecode.html#ga0d86abcfd4f421658176e51c24f7eb29">enabled</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02047"></a>02047          size = <span class="keyword">sizeof</span>(<a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a>);
<a name="l02048"></a>02048          <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>, &amp;size, <a class="code" href="group__mdefineh.html#ga252eb84661dfaa5959b5cb316117d696">TID_BOOL</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l02049"></a>02049 
<a name="l02050"></a>02050          <span class="keywordflow">if</span> (module[j]-&gt;init != NULL &amp;&amp; module[j]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>)
<a name="l02051"></a>02051             module[j]-&gt;<a class="code" href="group__midasincludecode.html#ga8ae1120805260da00f37f34ed6d519c5">init</a>();
<a name="l02052"></a>02052       }
<a name="l02053"></a>02053    }
<a name="l02054"></a>02054 
<a name="l02055"></a>02055    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l02056"></a>02056 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abe1e94ccaf2f7b108ef3291550a119c6"></a><!-- doxytag: member="mana.cpp::odb_load" ref="abe1e94ccaf2f7b108ef3291550a119c6" args="(EVENT_HEADER *pevent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void odb_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04234">4234</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="analyzer_8cpp_source.html#l00150">analyzer_init()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="odb_8c_source.html#l03390">db_enum_key()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l03261">db_get_value()</a>, <a class="el" href="midas_8h_source.html#l01016">DB_NO_MORE_SUBKEYS</a>, <a class="el" href="odb_8c_source.html#l05473">db_paste()</a>, <a class="el" href="odb_8c_source.html#l05019">db_set_mode()</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="scs__310__ql355p_8c_source.html#l00055">flag</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="fal_8c_source.html#l03403">init_module_parameters()</a>, <a class="el" href="mana_8cpp_source.html#l01069">load_parameters()</a>, <a class="el" href="midas_8h_source.html#l00762">MODE_DELETE</a>, <a class="el" href="midas_8h_source.html#l00760">MODE_READ</a>, <a class="el" href="midas_8h_source.html#l00761">MODE_WRITE</a>, <a class="el" href="midas_8h_source.html#l00742">TID_BOOL</a>, and <a class="el" href="p30_8h_source.html#l00043">TRUE</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l03596">process_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04235"></a>04235 {
<a name="l04236"></a>04236    <a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a> <a class="code" href="scs__310__ql355p_8c.html#a11764cc96bb263d1f257bcc01205a787">flag</a>;
<a name="l04237"></a>04237    <span class="keywordtype">int</span> <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l04238"></a>04238    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l04239"></a>04239    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, hKeyRoot, hKeyEq;
<a name="l04240"></a>04240 
<a name="l04241"></a>04241    flag = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l04242"></a>04242    size = <span class="keyword">sizeof</span>(flag);
<a name="l04243"></a>04243    sprintf(str, <span class="stringliteral">&quot;/%s/ODB Load&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l04244"></a>04244    <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;flag, &amp;size, <a class="code" href="group__mdefineh.html#ga252eb84661dfaa5959b5cb316117d696">TID_BOOL</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04245"></a>04245 
<a name="l04246"></a>04246    <span class="keywordflow">if</span> (flag) {
<a name="l04247"></a>04247       <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)
<a name="l04248"></a>04248          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.protect[i][0] &amp;&amp; !<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet)
<a name="l04249"></a>04249             printf(<span class="stringliteral">&quot;Protect ODB tree \&quot;%s\&quot;\n&quot;</span>, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.protect[i]);
<a name="l04250"></a>04250 
<a name="l04251"></a>04251       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet)
<a name="l04252"></a>04252          printf(<span class="stringliteral">&quot;Load ODB from run %d...&quot;</span>, (<span class="keywordtype">int</span>) <a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>);
<a name="l04253"></a>04253 
<a name="l04254"></a>04254       <span class="keywordflow">if</span> (flag == 1) {
<a name="l04255"></a>04255          <span class="comment">/* lock all ODB values except run parameters */</span>
<a name="l04256"></a>04256          <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04257"></a>04257 
<a name="l04258"></a>04258          <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/Experiment/Run Parameters&quot;</span>, &amp;hKey);
<a name="l04259"></a>04259          <span class="keywordflow">if</span> (hKey)
<a name="l04260"></a>04260             <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a> | <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a> | <a class="code" href="group__mdefineh.html#ga75f614b7ebb2b887b9e8f13c1b53ca6f">MODE_DELETE</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04261"></a>04261 
<a name="l04262"></a>04262          <span class="comment">/* and analyzer parameters */</span>
<a name="l04263"></a>04263          sprintf(str, <span class="stringliteral">&quot;/%s/Parameters&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l04264"></a>04264          <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hKey);
<a name="l04265"></a>04265          <span class="keywordflow">if</span> (hKey)
<a name="l04266"></a>04266             <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a> | <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a> | <a class="code" href="group__mdefineh.html#ga75f614b7ebb2b887b9e8f13c1b53ca6f">MODE_DELETE</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04267"></a>04267 
<a name="l04268"></a>04268          <span class="comment">/* and equipment (except /variables) */</span>
<a name="l04269"></a>04269          <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/Equipment&quot;</span>, &amp;hKeyRoot);
<a name="l04270"></a>04270          <span class="keywordflow">if</span> (hKeyRoot) {
<a name="l04271"></a>04271             <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a> | <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a> | <a class="code" href="group__mdefineh.html#ga75f614b7ebb2b887b9e8f13c1b53ca6f">MODE_DELETE</a>, <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l04272"></a>04272 
<a name="l04273"></a>04273             <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l04274"></a>04274                status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, i, &amp;hKeyEq);
<a name="l04275"></a>04275                <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l04276"></a>04276                   <span class="keywordflow">break</span>;
<a name="l04277"></a>04277 
<a name="l04278"></a>04278                <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyEq, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a> | <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a> | <a class="code" href="group__mdefineh.html#ga75f614b7ebb2b887b9e8f13c1b53ca6f">MODE_DELETE</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04279"></a>04279 
<a name="l04280"></a>04280                <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyEq, <span class="stringliteral">&quot;Variables&quot;</span>, &amp;hKey);
<a name="l04281"></a>04281                <span class="keywordflow">if</span> (hKey)
<a name="l04282"></a>04282                   <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04283"></a>04283             }
<a name="l04284"></a>04284          }
<a name="l04285"></a>04285 
<a name="l04286"></a>04286          <span class="comment">/* lock protected trees */</span>
<a name="l04287"></a>04287          <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)
<a name="l04288"></a>04288             <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.protect[i][0]) {
<a name="l04289"></a>04289                <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.protect[i], &amp;hKey);
<a name="l04290"></a>04290                <span class="keywordflow">if</span> (hKey)
<a name="l04291"></a>04291                   <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04292"></a>04292             }
<a name="l04293"></a>04293       }
<a name="l04294"></a>04294 
<a name="l04295"></a>04295       <span class="comment">/* close open records to parameters */</span>
<a name="l04296"></a>04296       <a class="code" href="fal_8c.html#a9527329c5d4ec01a728dfc43ad33b2fa">init_module_parameters</a>(<a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04297"></a>04297 
<a name="l04298"></a>04298       <a class="code" href="group__msectionh.html#ga99680031cca96d7eb7b4ac7cd20ae0fa">db_paste</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, (<span class="keywordtype">char</span> *) (pevent + 1));
<a name="l04299"></a>04299 
<a name="l04300"></a>04300       <span class="keywordflow">if</span> (flag == 1)
<a name="l04301"></a>04301          <a class="code" href="group__msectionh.html#ga1ff4f06d1c0c4301454b49daaf998a4c">db_set_mode</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a> | <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a> | <a class="code" href="group__mdefineh.html#ga75f614b7ebb2b887b9e8f13c1b53ca6f">MODE_DELETE</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l04302"></a>04302 
<a name="l04303"></a>04303       <span class="comment">/* reinit structured opened by user analyzer */</span>
<a name="l04304"></a>04304       <a class="code" href="analyzer_8cpp.html#afeea792d4dbe0001bd025397e494ab5b">analyzer_init</a>();
<a name="l04305"></a>04305 
<a name="l04306"></a>04306       <span class="comment">/* reload parameter files after BOR event */</span>
<a name="l04307"></a>04307       <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet)
<a name="l04308"></a>04308          printf(<span class="stringliteral">&quot;OK\n&quot;</span>);
<a name="l04309"></a>04309       <a class="code" href="mana_8cpp.html#ae20b777778d5dcd241cf1dfb0dd2230f">load_parameters</a>(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>);
<a name="l04310"></a>04310 
<a name="l04311"></a>04311       <span class="comment">/* open module parameters again */</span>
<a name="l04312"></a>04312       <a class="code" href="fal_8c.html#a9527329c5d4ec01a728dfc43ad33b2fa">init_module_parameters</a>(<a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l04313"></a>04313    }
<a name="l04314"></a>04314 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adc93a18c662e7f5f7447c311e8ed7cac"></a><!-- doxytag: member="mana.cpp::process_event" ref="adc93a18c662e7f5f7447c311e8ed7cac" args="(ANALYZE_REQUEST *par, EVENT_HEADER *pevent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> process_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03596">3596</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00324">actual_time</a>, <a class="el" href="midas_8h_source.html#l01501">ANALYZE_REQUEST::ana_module</a>, <a class="el" href="midas_8h_source.html#l01175">ANA_SKIP</a>, <a class="el" href="group__midasincludecode.html#gaf3d6511a274c1946ce0bf45e7000e756">ANA_MODULE::analyzer</a>, <a class="el" href="group__midasincludecode.html#gae0728031c8b33ebc32851d6c2099a8f9">ANALYZE_REQUEST::analyzer</a>, <a class="el" href="midas_8c_source.html#l12678">bk_size()</a>, <a class="el" href="midas_8c_source.html#l13132">bk_swap()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="fal_8c_source.html#l00769">db_get_event_definition()</a>, <a class="el" href="odb_8c_source.html#l03128">db_set_value()</a>, <a class="el" href="crate3_2rpc__master_8cpp_source.html#l00027">enabled</a>, <a class="el" href="midas_8h_source.html#l00799">EQ_PERIODIC</a>, <a class="el" href="midas_8h_source.html#l00802">EQ_SLOW</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00248">event_id</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="midas_8h_source.html#l01229">EVENTID_BOR</a>, <a class="el" href="midas_8h_source.html#l01517">ANALYZE_REQUEST::events_received</a>, <a class="el" href="midas_8h_source.html#l01518">ANALYZE_REQUEST::events_written</a>, <a class="el" href="mana_8cpp_source.html#l00640">EXT_EVENT_SIZE</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="fal_8c_source.html#l00765">EVENT_DEF::format</a>, <a class="el" href="midas_8h_source.html#l00720">FORMAT_ASCII</a>, <a class="el" href="midas_8h_source.html#l00723">FORMAT_HBOOK</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l00724">FORMAT_ROOT</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>, <a class="el" href="midas_8h_source.html#l00677">MAX_EVENT_SIZE</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="lrs1821_8h_source.html#l00221">MINFO</a>, <a class="el" href="generate-MODULES_8h_source.html#l00017">module</a>, <a class="el" href="mana_8cpp_source.html#l04234">odb_load()</a>, <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>, <a class="el" href="midas_8h_source.html#l01075">RPC_SHUTDOWN</a>, <a class="el" href="midas_8h_source.html#l01503">ANALYZE_REQUEST::rwnt_buffer_size</a>, <a class="el" href="midas_8h_source.html#l01193">EVENT_HEADER::serial_number</a>, <a class="el" href="system_8c_source.html#l05443">ss_getchar()</a>, <a class="el" href="system_8c_source.html#l02545">ss_kbhit()</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="fal_8c_source.html#l02545">test_increment()</a>, <a class="el" href="midas_8h_source.html#l00741">TID_INT</a>, <a class="el" href="mana_8cpp_source.html#l00887">EVENT_DEF::type</a>, <a class="el" href="midas_8h_source.html#l01504">ANALYZE_REQUEST::use_tests</a>, <a class="el" href="mana_8cpp_source.html#l02526">write_event_ascii()</a>, <a class="el" href="fal_8c_source.html#l03085">write_event_hbook()</a>, <a class="el" href="mana_8cpp_source.html#l02743">write_event_midas()</a>, <a class="el" href="fal_8c_source.html#l02785">write_event_odb()</a>, and <a class="el" href="ybos_8c_source.html#l00579">ybk_size()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03597"></a>03597 {
<a name="l03598"></a>03598    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a> = <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>, ch;
<a name="l03599"></a>03599    <a class="code" href="structANA__MODULE.html">ANA_MODULE</a> **<a class="code" href="generate-MODULES_8h.html#a96e5f0eca87c2426370e0897ac7b8ca6">module</a>;
<a name="l03600"></a>03600    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a6431147bd66aebfe3ca728d244da1253">actual_time</a>;
<a name="l03601"></a>03601    <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def;
<a name="l03602"></a>03602    <span class="keyword">static</span> <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> last_time_kb = 0;
<a name="l03603"></a>03603    <span class="keyword">static</span> <span class="keywordtype">char</span> *orig_event = NULL;
<a name="l03604"></a>03604 
<a name="l03605"></a>03605    <span class="comment">/* verbose output */</span>
<a name="l03606"></a>03606    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.verbose)
<a name="l03607"></a>03607       printf(<span class="stringliteral">&quot;event %d, number %d, total size %d\n&quot;</span>,
<a name="l03608"></a>03608              (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>,
<a name="l03609"></a>03609              (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>,
<a name="l03610"></a>03610              (<span class="keywordtype">int</span>) (pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>)));
<a name="l03611"></a>03611 
<a name="l03612"></a>03612    <span class="comment">/* save analyze_request for event number correction */</span>
<a name="l03613"></a>03613    <a class="code" href="mana_8cpp.html#a3eb68b44171b0cd2d0c55c51a10188a4">_current_par</a> = par;
<a name="l03614"></a>03614 
<a name="l03615"></a>03615    <span class="comment">/* check keyboard once every second */</span>
<a name="l03616"></a>03616    actual_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l03617"></a>03617    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; actual_time - last_time_kb &gt; 1000 &amp;&amp; !<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.quiet &amp;&amp; !<a class="code" href="mana_8cpp.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a>) {
<a name="l03618"></a>03618       last_time_kb = actual_time;
<a name="l03619"></a>03619 
<a name="l03620"></a>03620       <span class="keywordflow">while</span> (<a class="code" href="group__msectionh.html#gae96b0ebe47aa1d54f800e4f2e7f564b9">ss_kbhit</a>()) {
<a name="l03621"></a>03621          ch = <a class="code" href="group__msectionh.html#ga421c43305fae4215de164a5dd418909c">ss_getchar</a>(0);
<a name="l03622"></a>03622          <span class="keywordflow">if</span> (ch == -1)
<a name="l03623"></a>03623             ch = getchar();
<a name="l03624"></a>03624 
<a name="l03625"></a>03625          <span class="keywordflow">if</span> ((<span class="keywordtype">char</span>) ch == <span class="charliteral">&apos;!&apos;</span>)
<a name="l03626"></a>03626             <span class="keywordflow">return</span> <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>;
<a name="l03627"></a>03627       }
<a name="l03628"></a>03628    }
<a name="l03629"></a>03629 
<a name="l03630"></a>03630    <span class="keywordflow">if</span> (par == NULL) {
<a name="l03631"></a>03631       <span class="comment">/* load ODB with BOR event */</span>
<a name="l03632"></a>03632       <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> == <a class="code" href="group__mbufferh.html#gaea58a47233f988dd2f9a0320d99734dc">EVENTID_BOR</a>) {
<a name="l03633"></a>03633          <span class="comment">/* get run number from BOR event */</span>
<a name="l03634"></a>03634          <a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a> = pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>;
<a name="l03635"></a>03635 
<a name="l03636"></a>03636          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#a6e27d8876a43afce3ee4dd16527cbb9e">MINFO</a>, <span class="stringliteral">&quot;process_event&quot;</span>, <span class="stringliteral">&quot;Set run number %d in ODB&quot;</span>, <a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>);
<a name="l03637"></a>03637          assert(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a> &gt; 0);
<a name="l03638"></a>03638 
<a name="l03639"></a>03639          <span class="comment">/* set run number in ODB */</span>
<a name="l03640"></a>03640          status = <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, <span class="stringliteral">&quot;/Runinfo/Run number&quot;</span>, &amp;<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>,
<a name="l03641"></a>03641                                <span class="keyword">sizeof</span>(<a class="code" href="mana_8cpp.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a>), 1, <a class="code" href="group__mdefineh.html#gad950d5fde6dd3ea7eba59fb6760a38cb">TID_INT</a>);
<a name="l03642"></a>03642          assert(status == <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>);
<a name="l03643"></a>03643 
<a name="l03644"></a>03644          <span class="comment">/* load ODB from event */</span>
<a name="l03645"></a>03645          <a class="code" href="mana_8cpp.html#abe1e94ccaf2f7b108ef3291550a119c6">odb_load</a>(pevent);
<a name="l03646"></a>03646 
<a name="l03647"></a>03647 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l03648"></a>03648 <span class="preprocessor"></span>         PVM_DEBUG(<span class="stringliteral">&quot;process_event: ODB load&quot;</span>);
<a name="l03649"></a>03649 <span class="preprocessor">#endif</span>
<a name="l03650"></a>03650 <span class="preprocessor"></span>      }
<a name="l03651"></a>03651    } <span class="keywordflow">else</span>
<a name="l03652"></a>03652       <span class="comment">/* increment event counter */</span>
<a name="l03653"></a>03653       par-&gt;<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a>++;
<a name="l03654"></a>03654 
<a name="l03655"></a>03655 <span class="preprocessor">#ifdef HAVE_PVM</span>
<a name="l03656"></a>03656 <span class="preprocessor"></span>
<a name="l03657"></a>03657    <span class="comment">/* if master, distribute events to clients */</span>
<a name="l03658"></a>03658    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a>) {
<a name="l03659"></a>03659       status = pvm_distribute(par, pevent);
<a name="l03660"></a>03660       <span class="keywordflow">return</span> status;
<a name="l03661"></a>03661    }
<a name="l03662"></a>03662 <span class="preprocessor">#endif</span>
<a name="l03663"></a>03663 <span class="preprocessor"></span>
<a name="l03664"></a>03664    <span class="comment">/* don&apos;t analyze special (BOR,MESSAGE,...) events */</span>
<a name="l03665"></a>03665    <span class="keywordflow">if</span> (par == NULL)
<a name="l03666"></a>03666       <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l03667"></a>03667 
<a name="l03668"></a>03668    <span class="comment">/* swap event if necessary */</span>
<a name="l03669"></a>03669    event_def = <a class="code" href="fal_8c.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a>(pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l03670"></a>03670    <span class="keywordflow">if</span> (event_def == NULL)
<a name="l03671"></a>03671       <span class="keywordflow">return</span> 0;
<a name="l03672"></a>03672 
<a name="l03673"></a>03673    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>)
<a name="l03674"></a>03674       <a class="code" href="group__msectionh.html#gacc5a45e8cd3b781a7622c4e00bdc348a">bk_swap</a>((<a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *) (pevent + 1), <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l03675"></a>03675 
<a name="l03676"></a>03676    <span class="comment">/* keep copy of original event */</span>
<a name="l03677"></a>03677    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.filter) {
<a name="l03678"></a>03678       <span class="keywordflow">if</span> (orig_event == NULL)
<a name="l03679"></a>03679          orig_event = (<span class="keywordtype">char</span> *) malloc(<a class="code" href="group__midasincludecode.html#ga05d5acc365e3342523d84bc4540adc09">MAX_EVENT_SIZE</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>));
<a name="l03680"></a>03680       memcpy(orig_event, pevent, pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>));
<a name="l03681"></a>03681    } 
<a name="l03682"></a>03682 
<a name="l03683"></a>03683   <span class="comment">/* skip events after end of run when online */</span>
<a name="l03684"></a>03684   <span class="keywordflow">if</span>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online &amp;&amp; <a class="code" href="mana_8cpp.html#addcec48ded248cb150b9ded486f01da8">now_stopping</a>) {
<a name="l03685"></a>03685     <span class="keywordflow">return</span> 0;
<a name="l03686"></a>03686   }
<a name="l03687"></a>03687 
<a name="l03688"></a>03688   <span class="comment">/*---- analyze event ----*/</span>
<a name="l03689"></a>03689 
<a name="l03690"></a>03690    <span class="comment">/* call non-modular analyzer if defined */</span>
<a name="l03691"></a>03691    <span class="keywordflow">if</span> (par-&gt;<a class="code" href="group__midasincludecode.html#gae0728031c8b33ebc32851d6c2099a8f9">analyzer</a>) {
<a name="l03692"></a>03692       status = par-&gt;<a class="code" href="group__midasincludecode.html#gae0728031c8b33ebc32851d6c2099a8f9">analyzer</a>(pevent, (<span class="keywordtype">void</span> *) (pevent + 1));
<a name="l03693"></a>03693 
<a name="l03694"></a>03694       <span class="comment">/* don&apos;t continue if event was rejected */</span>
<a name="l03695"></a>03695       <span class="keywordflow">if</span> (status == <a class="code" href="group__midasincludecode.html#ga0ab5be4c0e2780166a0b7ed977fe3f01">ANA_SKIP</a>)
<a name="l03696"></a>03696          <span class="keywordflow">return</span> 0;
<a name="l03697"></a>03697    }
<a name="l03698"></a>03698 
<a name="l03699"></a>03699    <span class="comment">/* loop over analyzer modules */</span>
<a name="l03700"></a>03700    module = par-&gt;<a class="code" href="group__midasincludecode.html#ga84e88396cff69efebe3dad2289fe70c9">ana_module</a>;
<a name="l03701"></a>03701    <span class="keywordflow">for</span> (i = 0; module != NULL &amp;&amp; module[i] != NULL; i++) {
<a name="l03702"></a>03702       <span class="keywordflow">if</span> (module[i]-&gt;<a class="code" href="crate3_2rpc__master_8cpp.html#ac19b89f25c9dfa8d24866a5c108d6477">enabled</a>) {
<a name="l03703"></a>03703         <span class="comment">//printf(&quot;%s\n&quot;, module[i]-&gt;name);</span>
<a name="l03704"></a>03704          status = module[i]-&gt;<a class="code" href="group__midasincludecode.html#gaf3d6511a274c1946ce0bf45e7000e756">analyzer</a>(pevent, (<span class="keywordtype">void</span> *) (pevent + 1));
<a name="l03705"></a>03705 
<a name="l03706"></a>03706          <span class="comment">/* don&apos;t continue if event was rejected */</span>
<a name="l03707"></a>03707          <span class="keywordflow">if</span> (status == <a class="code" href="group__midasincludecode.html#ga0ab5be4c0e2780166a0b7ed977fe3f01">ANA_SKIP</a>)
<a name="l03708"></a>03708             <span class="keywordflow">return</span> 0;
<a name="l03709"></a>03709       }
<a name="l03710"></a>03710    }
<a name="l03711"></a>03711 
<a name="l03712"></a>03712    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l03713"></a>03713       <span class="comment">/* check if event got too large */</span>
<a name="l03714"></a>03714       i = <a class="code" href="group__msectionh.html#ga825db64c9ef9b4656698c890fca37c05">bk_size</a>(pevent + 1);
<a name="l03715"></a>03715 <span class="comment">//      if (i &gt; MAX_EVENT_SIZE)</span>
<a name="l03716"></a>03716       <span class="keywordflow">if</span> (i &gt;= 8*<a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>/10)
<a name="l03717"></a>03717          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;process_event&quot;</span>, <span class="stringliteral">&quot;Event got too large (%d Bytes) in analyzer&quot;</span>, i); 
<a name="l03718"></a>03718 
<a name="l03719"></a>03719       <span class="comment">/* correct for increased event size */</span>
<a name="l03720"></a>03720       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> = i;
<a name="l03721"></a>03721    }
<a name="l03722"></a>03722 
<a name="l03723"></a>03723    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>) {
<a name="l03724"></a>03724       <span class="comment">/* check if event got too large */</span>
<a name="l03725"></a>03725       i = <a class="code" href="group__ybosincludecode.html#gab97b7d0d9ea164c791c36374826d19fe">ybk_size</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) (pevent + 1));
<a name="l03726"></a>03726       <span class="keywordflow">if</span> (i &gt; <a class="code" href="group__midasincludecode.html#ga05d5acc365e3342523d84bc4540adc09">MAX_EVENT_SIZE</a>)
<a name="l03727"></a>03727          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;process_event&quot;</span>, <span class="stringliteral">&quot;Event got too large (%d Bytes) in analyzer&quot;</span>, i);
<a name="l03728"></a>03728 
<a name="l03729"></a>03729       <span class="comment">/* correct for increased event size */</span>
<a name="l03730"></a>03730       pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> = i;
<a name="l03731"></a>03731    }
<a name="l03732"></a>03732 
<a name="l03733"></a>03733    <span class="comment">/* increment tests */</span>
<a name="l03734"></a>03734    <span class="keywordflow">if</span> (par-&gt;<a class="code" href="group__midasincludecode.html#ga08306810e609b1e3854d3e19abe3a919">use_tests</a>)
<a name="l03735"></a>03735       <a class="code" href="fal_8c.html#a5d0c60b46806a49cf44b5db6053b1e0f">test_increment</a>();
<a name="l03736"></a>03736 
<a name="l03737"></a>03737    <span class="comment">/* in filter mode, use original event */</span>
<a name="l03738"></a>03738    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.filter)
<a name="l03739"></a>03739       pevent = (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) orig_event;
<a name="l03740"></a>03740 
<a name="l03741"></a>03741    <span class="comment">/* write resulting event */</span>
<a name="l03742"></a>03742    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>) {
<a name="l03743"></a>03743 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l03744"></a>03744 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac3a857e4820ecdaa22f9a66a560dccad">FORMAT_HBOOK</a>)
<a name="l03745"></a>03745          status = <a class="code" href="fal_8c.html#a2ba1d8e79f061e622f62471ae9bc7063">write_event_hbook</a>(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>, pevent, par);
<a name="l03746"></a>03746 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l03747"></a>03747 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l03748"></a>03748 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#ga9663ae12f7cbf4295b3804ebd335e408">FORMAT_ROOT</a>)
<a name="l03749"></a>03749          status = write_event_ttree(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>, pevent, par);
<a name="l03750"></a>03750 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_ROOT */</span>
<a name="l03751"></a>03751       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gaf900017aedf1bdc7e50fcbf949464e6d">FORMAT_ASCII</a>)
<a name="l03752"></a>03752          status = <a class="code" href="mana_8cpp.html#a548ba840d1c3a1f2a18009e48513f245">write_event_ascii</a>(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>, pevent, par);
<a name="l03753"></a>03753       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a57462a01b2494cba89ae18620110c130">out_format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>)
<a name="l03754"></a>03754          status = <a class="code" href="mana_8cpp.html#a75ddaf388f46748e2585fa04d22278f2">write_event_midas</a>(<a class="code" href="mana_8cpp.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a>, pevent, par);
<a name="l03755"></a>03755 
<a name="l03756"></a>03756       <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {
<a name="l03757"></a>03757          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;process_event&quot;</span>, <span class="stringliteral">&quot;Error writing to file (Disk full?)&quot;</span>);
<a name="l03758"></a>03758          <span class="keywordflow">return</span> -1;
<a name="l03759"></a>03759       }
<a name="l03760"></a>03760 
<a name="l03761"></a>03761       par-&gt;<a class="code" href="group__midasincludecode.html#gaeaa47cc2392bfdc8a1ee1a459082c876">events_written</a>++;
<a name="l03762"></a>03762    }
<a name="l03763"></a>03763 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l03764"></a>03764 <span class="preprocessor"></span>   <span class="comment">/* fill shared memory */</span>
<a name="l03765"></a>03765    <span class="keywordflow">if</span> ((<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online || <a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.output_file_name, <span class="stringliteral">&quot;OFLN&quot;</span>))
<a name="l03766"></a>03766        &amp;&amp; par-&gt;<a class="code" href="group__midasincludecode.html#gab9f17100ff718ee4da42cdd86a7f3cab">rwnt_buffer_size</a> &gt; 0)
<a name="l03767"></a>03767       <a class="code" href="fal_8c.html#a2ba1d8e79f061e622f62471ae9bc7063">write_event_hbook</a>(NULL, pevent, par);
<a name="l03768"></a>03768 <span class="preprocessor">#endif                          </span><span class="comment">/* HAVE_HBOOK */</span>
<a name="l03769"></a>03769 
<a name="l03770"></a>03770    <span class="comment">/* put event in ODB once every second */</span>
<a name="l03771"></a>03771    <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.events_to_odb)
<a name="l03772"></a>03772       <span class="keywordflow">for</span> (i = 0; i &lt; 50; i++) {
<a name="l03773"></a>03773          <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].<a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a> == pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>) {
<a name="l03774"></a>03774             <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a1f9fe59026081d85b2ee6ad8645e060b">type</a> == <a class="code" href="group__mdefineh.html#ga58e919e4e401b299c1834be965c3e78c">EQ_PERIODIC</a> ||
<a name="l03775"></a>03775                 event_def-&gt;<a class="code" href="structEVENT__DEF.html#a1f9fe59026081d85b2ee6ad8645e060b">type</a> == <a class="code" href="group__mdefineh.html#gafffdc5135b2e8f3c6bc61b8701084df6">EQ_SLOW</a> ||
<a name="l03776"></a>03776                 actual_time - <a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].last_time &gt; 1000) {
<a name="l03777"></a>03777                <a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].last_time = actual_time;
<a name="l03778"></a>03778                <a class="code" href="fal_8c.html#ab55e3bbd032e2ede908194386fdd0dc3">write_event_odb</a>(pevent);
<a name="l03779"></a>03779             }
<a name="l03780"></a>03780             <span class="keywordflow">break</span>;
<a name="l03781"></a>03781          }
<a name="l03782"></a>03782          <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].<a class="code" href="examples_2macro_2midas__macro_8h.html#a6bff0a5e8995a80f74212d31f551167a">event_id</a> == 0) {
<a name="l03783"></a>03783             <a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].event_id = pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>;
<a name="l03784"></a>03784             <a class="code" href="fal_8c.html#a1bb2767e19e7d887ef6f9b80f7835af3">last_time_event</a>[i].last_time = actual_time;
<a name="l03785"></a>03785             <a class="code" href="fal_8c.html#ab55e3bbd032e2ede908194386fdd0dc3">write_event_odb</a>(pevent);
<a name="l03786"></a>03786             <span class="keywordflow">break</span>;
<a name="l03787"></a>03787          }
<a name="l03788"></a>03788       }
<a name="l03789"></a>03789 
<a name="l03790"></a>03790    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l03791"></a>03791 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae64a9e12504afe61b5d065dd43b6c637"></a><!-- doxytag: member="mana.cpp::receive_event" ref="ae64a9e12504afe61b5d065dd43b6c637" args="(HNDLE buffer_handle, HNDLE request_id, EVENT_HEADER *pheader, void *pevent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void receive_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a>&nbsp;</td>
          <td class="paramname"> <em>buffer_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a>&nbsp;</td>
          <td class="paramname"> <em>request_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pheader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pevent</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03795">3795</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l00904">ALIGN8</a>, <a class="el" href="fal_8c_source.html#l00201">buffer</a>, <a class="el" href="midas_8h_source.html#l01507">ANALYZE_REQUEST::buffer_handle</a>, <a class="el" href="fal_8c_source.html#l00202">buffer_size</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="mana_8cpp_source.html#l00640">EXT_EVENT_SIZE</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="miniana_8c_source.html#l00026">process_event()</a>, <a class="el" href="midas_8h_source.html#l00615">PTYPE</a>, and <a class="el" href="midas_8h_source.html#l01508">ANALYZE_REQUEST::request_id</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03798"></a>03798 {
<a name="l03799"></a>03799    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l03800"></a>03800    <a class="code" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *par;
<a name="l03801"></a>03801    <span class="keyword">static</span> <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="fal_8c.html#a72c9a6de0ddd97509a04d596e1886e80">buffer_size</a> = 0;
<a name="l03802"></a>03802    <span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="fal_8c.html#a368f7094dc38acca20612bbb392552f4">buffer</a> = NULL;
<a name="l03803"></a>03803    <span class="keywordtype">char</span> *pb;
<a name="l03804"></a>03804 
<a name="l03805"></a>03805    <span class="keywordflow">if</span> (buffer == NULL) {
<a name="l03806"></a>03806       buffer = (<span class="keywordtype">char</span> *) malloc(<a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>);
<a name="l03807"></a>03807 
<a name="l03808"></a>03808       <span class="keywordflow">if</span> (buffer == NULL) {
<a name="l03809"></a>03809          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;receive_event&quot;</span>, <span class="stringliteral">&quot;Not enough memory to buffer event of size %d&quot;</span>,
<a name="l03810"></a>03810                 buffer_size);
<a name="l03811"></a>03811          <span class="keywordflow">return</span>;
<a name="l03812"></a>03812       }
<a name="l03813"></a>03813    }
<a name="l03814"></a>03814 
<a name="l03815"></a>03815    <span class="comment">/* align buffer */</span>
<a name="l03816"></a>03816    pb = (<span class="keywordtype">char</span> *) <a class="code" href="group__mmacroh.html#ga46bf3ace1698ee72389c30bc61d78686">ALIGN8</a>((<a class="code" href="group__midasincludecode.html#ga790216a8e71233fed28657b16a052e36">PTYPE</a>) buffer);
<a name="l03817"></a>03817 
<a name="l03818"></a>03818    <span class="comment">/* copy event to local buffer */</span>
<a name="l03819"></a>03819    memcpy(pb, pheader, pheader-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>));
<a name="l03820"></a>03820 
<a name="l03821"></a>03821    par = <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>;
<a name="l03822"></a>03822 
<a name="l03823"></a>03823    <span class="keywordflow">for</span> (i = 0; par-&gt;<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; par++)
<a name="l03824"></a>03824       <span class="keywordflow">if</span> (par-&gt;<a class="code" href="group__midasincludecode.html#gafe5109f95d2a2c6406d5b6a6c661479e">buffer_handle</a> == buffer_handle &amp;&amp; par-&gt;<a class="code" href="group__midasincludecode.html#ga2ee7a01967465e8a725bb968246c01de">request_id</a> == request_id) {
<a name="l03825"></a>03825          <a class="code" href="miniana_8c.html#a681f90cedc0c323da19bfef26d8854b5">process_event</a>(par, (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) pb);
<a name="l03826"></a>03826       }
<a name="l03827"></a>03827 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1a2128d90a2986636c9e80968c0d5c67"></a><!-- doxytag: member="mana.cpp::register_requests" ref="a1a2128d90a2986636c9e80968c0d5c67" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_requests </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03861">3861</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l00269">ANALYZER_REQUEST_STR</a>, <a class="el" href="fal_8c_source.html#l00279">ANALYZER_STATS_STR</a>, <a class="el" href="midas_8h_source.html#l01499">ANALYZE_REQUEST::ar_info</a>, <a class="el" href="midas_8h_source.html#l01519">ANALYZE_REQUEST::ar_stats</a>, <a class="el" href="midas_8c_source.html#l04389">bm_open_buffer()</a>, <a class="el" href="group__msectionh.html#ga10c1d7f3486ab4ab4ee58a95bb98e820">bm_request_event()</a>, <a class="el" href="midas_8c_source.html#l05589">bm_set_cache_size()</a>, <a class="el" href="midas_8h_source.html#l01485">AR_INFO::buffer</a>, <a class="el" href="midas_8h_source.html#l01507">ANALYZE_REQUEST::buffer_handle</a>, <a class="el" href="midas_8h_source.html#l01487">AR_INFO::client_name</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="odb_8c_source.html#l07436">db_check_record()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l07741">db_open_record()</a>, <a class="el" href="odb_8c_source.html#l06874">db_set_record()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01486">AR_INFO::enabled</a>, <a class="el" href="midas_8h_source.html#l00675">EVENT_BUFFER_SIZE</a>, <a class="el" href="midas_8h_source.html#l01482">AR_INFO::event_id</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8h_source.html#l01493">AR_STATS::events_per_sec</a>, <a class="el" href="midas_8h_source.html#l01492">AR_STATS::events_received</a>, <a class="el" href="midas_8h_source.html#l01494">AR_STATS::events_written</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="midas_8h_source.html#l01510">ANALYZE_REQUEST::hkey_common</a>, <a class="el" href="midas_8h_source.html#l01488">AR_INFO::host</a>, <a class="el" href="midas_8h_source.html#l00760">MODE_READ</a>, <a class="el" href="midas_8h_source.html#l00761">MODE_WRITE</a>, <a class="el" href="fal_8c.html#a54200266ef010a58dcf76468aadace0b">receive_event()</a>, <a class="el" href="midas_8h_source.html#l01508">ANALYZE_REQUEST::request_id</a>, <a class="el" href="midas_8h_source.html#l01484">AR_INFO::sampling_type</a>, <a class="el" href="midas_8h_source.html#l01483">AR_INFO::trigger_mask</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, and <a class="el" href="mana_8cpp_source.html#l03831">update_request()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03862"></a>03862 {
<a name="l03863"></a>03863    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l03864"></a>03864    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l03865"></a>03865    <a class="code" href="structAR__INFO.html">AR_INFO</a> *ar_info;
<a name="l03866"></a>03866    <a class="code" href="structAR__STATS.html">AR_STATS</a> *ar_stats;
<a name="l03867"></a>03867    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>;
<a name="l03868"></a>03868 
<a name="l03869"></a>03869    <span class="comment">/* scan ANALYZE_REQUEST table from ANALYZE.C */</span>
<a name="l03870"></a>03870    <span class="keywordflow">for</span> (index = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; index++) {
<a name="l03871"></a>03871       ar_info = &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>;
<a name="l03872"></a>03872       ar_stats = &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#ga069e2a89b82e12f5257325227343b4c0">ar_stats</a>;
<a name="l03873"></a>03873 
<a name="l03874"></a>03874       <span class="comment">/* create common subtree from analyze_request table in analyze.c */</span>
<a name="l03875"></a>03875       sprintf(str, <span class="stringliteral">&quot;/%s/%s/Common&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].event_name);
<a name="l03876"></a>03876       <a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="fal_8c.html#a9b830b651a8c873d619d16eb495097af">ANALYZER_REQUEST_STR</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03877"></a>03877       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hKey);
<a name="l03878"></a>03878       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#ga7c9dd18e861558a006b694b3c9f197a1">hkey_common</a> = hKey;
<a name="l03879"></a>03879 
<a name="l03880"></a>03880       strcpy(ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga1331a0c0525a7f42a0f9c23d897cf46c">client_name</a>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>);
<a name="l03881"></a>03881       gethostname(ar_info-&gt;<a class="code" href="group__midasincludecode.html#gae70ac5ffc29fabfaf9a87e717f75dae0">host</a>, <span class="keyword">sizeof</span>(ar_info-&gt;<a class="code" href="group__midasincludecode.html#gae70ac5ffc29fabfaf9a87e717f75dae0">host</a>));
<a name="l03882"></a>03882       <a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, ar_info, <span class="keyword">sizeof</span>(<a class="code" href="structAR__INFO.html">AR_INFO</a>), 0);
<a name="l03883"></a>03883 
<a name="l03884"></a>03884       <span class="comment">/* open hot link to analyzer request info */</span>
<a name="l03885"></a>03885       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, ar_info, <span class="keyword">sizeof</span>(<a class="code" href="structAR__INFO.html">AR_INFO</a>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="mana_8cpp.html#a44060bd07543e42cf3d05407fc8909c8">update_request</a>,
<a name="l03886"></a>03886                      NULL);
<a name="l03887"></a>03887 
<a name="l03888"></a>03888       <span class="comment">/* create statistics tree */</span>
<a name="l03889"></a>03889       sprintf(str, <span class="stringliteral">&quot;/%s/%s/Statistics&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].event_name);
<a name="l03890"></a>03890       <a class="code" href="group__msectionh.html#gaba7341fc6e27b70739734a50b489ef4f">db_check_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, <a class="code" href="fal_8c.html#a407acb59ee878974632978f7682e8d23">ANALYZER_STATS_STR</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l03891"></a>03891       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;hKey);
<a name="l03892"></a>03892       assert(hKey);
<a name="l03893"></a>03893 
<a name="l03894"></a>03894       ar_stats-&gt;<a class="code" href="structAR__STATS.html#ae75a481fd926f515b17a3e2b63ee283a">events_received</a> = 0;
<a name="l03895"></a>03895       ar_stats-&gt;<a class="code" href="group__midasincludecode.html#ga3695a89775259f076f838bf46af2e00f">events_per_sec</a> = 0;
<a name="l03896"></a>03896       ar_stats-&gt;<a class="code" href="group__midasincludecode.html#ga142015e81c965f9e9fba58f5a6322525">events_written</a> = 0;
<a name="l03897"></a>03897 
<a name="l03898"></a>03898       <span class="comment">/* open hot link to statistics tree */</span>
<a name="l03899"></a>03899       status =
<a name="l03900"></a>03900           <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, ar_stats, <span class="keyword">sizeof</span>(<a class="code" href="structAR__STATS.html">AR_STATS</a>), <a class="code" href="group__mdefineh.html#gab8fac4c725bb7d4b05ae138c07ef54af">MODE_WRITE</a>, NULL, NULL);
<a name="l03901"></a>03901       <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l03902"></a>03902          printf(<span class="stringliteral">&quot;Cannot open statistics record, probably other analyzer is using it\n&quot;</span>);
<a name="l03903"></a>03903 
<a name="l03904"></a>03904       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l03905"></a>03905       <span class="comment">/*---- open event buffer ---------------------------------------*/</span>
<a name="l03906"></a>03906          <a class="code" href="group__msectionh.html#ga50e2528e639499eb42a75d47c7d58ca1">bm_open_buffer</a>(ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga8b5be2917680552f8f9850c8bd7f9b4b">buffer</a>, <a class="code" href="group__midasincludecode.html#gacc4dda1aaabc9862fe79fd94e0b722bf">EVENT_BUFFER_SIZE</a>,
<a name="l03907"></a>03907                         &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#gafe5109f95d2a2c6406d5b6a6c661479e">buffer_handle</a>);
<a name="l03908"></a>03908 
<a name="l03909"></a>03909 <span class="comment">//         /* set the default buffer cache size */</span>
<a name="l03910"></a>03910 <span class="comment">//         bm_set_cache_size(analyze_request[index].buffer_handle, 100000, 0);</span>
<a name="l03911"></a>03911          <span class="comment">/* turn off buffer cache */</span>
<a name="l03912"></a>03912          <a class="code" href="group__msectionh.html#ga3d70a1e1e38b6ccf6bde4bc5b436ae5b">bm_set_cache_size</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].buffer_handle, 0, 0);
<a name="l03913"></a>03913 
<a name="l03914"></a>03914       <span class="comment">/*---- request event -------------------------------------------*/</span>
<a name="l03915"></a>03915          <span class="keywordflow">if</span> (ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga00b6cb7dc5fefe2d78d04caf3eb257cd">enabled</a>)
<a name="l03916"></a>03916             <a class="code" href="group__msectionh.html#ga10c1d7f3486ab4ab4ee58a95bb98e820">bm_request_event</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].buffer_handle,
<a name="l03917"></a>03917                              (<span class="keywordtype">short</span>) ar_info-&gt;<a class="code" href="structAR__INFO.html#acb0cf26c5067b0c8eb7a895b70e42f11">event_id</a>, (<span class="keywordtype">short</span>) ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga947c408489c2b8cd8ea2fc8b2df83388">trigger_mask</a>,
<a name="l03918"></a>03918                              ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga023ac635bfecdb696c795dc7120209b7">sampling_type</a>, &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#ga2ee7a01967465e8a725bb968246c01de">request_id</a>,
<a name="l03919"></a>03919                              <a class="code" href="fal_8c.html#a54200266ef010a58dcf76468aadace0b">receive_event</a>);
<a name="l03920"></a>03920          <span class="keywordflow">else</span>
<a name="l03921"></a>03921             <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[index].<a class="code" href="group__midasincludecode.html#ga2ee7a01967465e8a725bb968246c01de">request_id</a> = -1;
<a name="l03922"></a>03922       }
<a name="l03923"></a>03923    }
<a name="l03924"></a>03924 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad767414c61d6a24611888cbdb899af31"></a><!-- doxytag: member="mana.cpp::save_last_histos" ref="ad767414c61d6a24611888cbdb899af31" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_last_histos </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l04059">4059</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="fal_8c_source.html#l02470">add_data_dir()</a>, <a class="el" href="midas_8h_source.html#l00639">DIR_SEPARATOR</a>, <a class="el" href="MDQ__Amplitude_8cpp.html#a0908e10bfc0059b6be675134c75599d4">gManaHistsDir</a>, <a class="el" href="hbook_8h_source.html#l00156">HRPUT</a>, and <a class="el" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l05702">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04060"></a>04060 {
<a name="l04061"></a>04061    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l04062"></a>04062 
<a name="l04063"></a>04063    <span class="comment">/* save online histos */</span>
<a name="l04064"></a>04064    strcpy(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename);
<a name="l04065"></a>04065    <span class="keywordflow">if</span> (strchr(str, <a class="code" href="group__midasincludecode.html#ga0920890c442b665b0c6609fa796e9047">DIR_SEPARATOR</a>) == NULL)
<a name="l04066"></a>04066       <a class="code" href="group__msectionh.html#ga42926f9062f24eb432ffb6414cde67e8">add_data_dir</a>(str, <a class="code" href="fal_8c.html#a318694742ba8b26fea209b7a2a525f03">out_info</a>.last_histo_filename);
<a name="l04067"></a>04067 
<a name="l04068"></a>04068    printf(<span class="stringliteral">&quot;Saving current online histos to %s\n&quot;</span>, str);
<a name="l04069"></a>04069 
<a name="l04070"></a>04070 <span class="preprocessor">#ifdef HAVE_HBOOK</span>
<a name="l04071"></a>04071 <span class="preprocessor"></span>   {
<a name="l04072"></a>04072       <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l04073"></a>04073       <span class="keywordtype">char</span> str2[256];
<a name="l04074"></a>04074 
<a name="l04075"></a>04075       <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(str); i++)
<a name="l04076"></a>04076          <span class="keywordflow">if</span> (isupper(str[i]))
<a name="l04077"></a>04077             <span class="keywordflow">break</span>;
<a name="l04078"></a>04078 
<a name="l04079"></a>04079       <span class="keywordflow">if</span> (i &lt; (<span class="keywordtype">int</span>) strlen(str)) {
<a name="l04080"></a>04080          printf
<a name="l04081"></a>04081              (<span class="stringliteral">&quot;Error: Due to a limitation in HBOOK, directoy names may not contain uppercase\n&quot;</span>);
<a name="l04082"></a>04082          printf(<span class="stringliteral">&quot;       characters. Histogram saving to %s will not work.\n&quot;</span>, str);
<a name="l04083"></a>04083       } <span class="keywordflow">else</span> {
<a name="l04084"></a>04084          strcpy(str2, <span class="stringliteral">&quot;NT&quot;</span>);
<a name="l04085"></a>04085          <a class="code" href="hbook_8h.html#afebb35542c02eb885020475cb221afaf">HRPUT</a>(0, str, str2);
<a name="l04086"></a>04086       }
<a name="l04087"></a>04087    }
<a name="l04088"></a>04088 <span class="preprocessor">#endif</span>
<a name="l04089"></a>04089 <span class="preprocessor"></span>
<a name="l04090"></a>04090 <span class="preprocessor">#ifdef HAVE_ROOT</span>
<a name="l04091"></a>04091 <span class="preprocessor"></span>   SaveRootHistograms(gManaHistsDir, str);
<a name="l04092"></a>04092 <span class="preprocessor">#endif</span>
<a name="l04093"></a>04093 <span class="preprocessor"></span>
<a name="l04094"></a>04094 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a443aaa38b1796a39d965acb610d31cc8"></a><!-- doxytag: member="mana.cpp::test_clear" ref="a443aaa38b1796a39d965acb610d31cc8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01027">1027</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01528">ANA_TEST::count</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, and <a class="el" href="midas_8h_source.html#l01530">ANA_TEST::value</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01028"></a>01028 {
<a name="l01029"></a>01029    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031    <span class="comment">/* clear all tests in interal list */</span>
<a name="l01032"></a>01032    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="fal_8c.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a>; i++) {
<a name="l01033"></a>01033       <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="group__midasincludecode.html#ga76f53e0e2afd1fcfc50195a05d715227">count</a> = 0;
<a name="l01034"></a>01034       <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="group__midasincludecode.html#gaf1cbe49e3d68b42b77c02eb7c5e175fb">value</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01035"></a>01035    }
<a name="l01036"></a>01036 
<a name="l01037"></a>01037    <span class="comment">/* set &quot;always true&quot; test */</span>
<a name="l01038"></a>01038    <span class="keywordflow">if</span> (n_test &gt; 0)
<a name="l01039"></a>01039       <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[0]-&gt;<a class="code" href="group__midasincludecode.html#gaf1cbe49e3d68b42b77c02eb7c5e175fb">value</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01040"></a>01040 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5d0c60b46806a49cf44b5db6053b1e0f"></a><!-- doxytag: member="mana.cpp::test_increment" ref="a5d0c60b46806a49cf44b5db6053b1e0f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_increment </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01042">1042</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01528">ANA_TEST::count</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="midas_8h_source.html#l01530">ANA_TEST::value</a>, and <a class="el" href="ADCS_8h_source.html#l00004">value</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01043"></a>01043 {
<a name="l01044"></a>01044    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01045"></a>01045 
<a name="l01046"></a>01046    <span class="comment">/* increment test counters based on their value and reset them */</span>
<a name="l01047"></a>01047    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="fal_8c.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a>; i++) {
<a name="l01048"></a>01048       <span class="keywordflow">if</span> (<a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)
<a name="l01049"></a>01049          <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="group__midasincludecode.html#ga76f53e0e2afd1fcfc50195a05d715227">count</a>++;
<a name="l01050"></a>01050       <span class="keywordflow">if</span> (i &gt; 0)
<a name="l01051"></a>01051          <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="group__midasincludecode.html#gaf1cbe49e3d68b42b77c02eb7c5e175fb">value</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01052"></a>01052    }
<a name="l01053"></a>01053 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a29da9175b91a9b8fbadf2499e84c11e3"></a><!-- doxytag: member="mana.cpp::test_write" ref="a29da9175b91a9b8fbadf2499e84c11e3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_write </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01055">1055</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">count</a>, <a class="el" href="odb_8c_source.html#l03128">db_set_value()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, and <a class="el" href="midas_8h_source.html#l00740">TID_DWORD</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01056"></a>01056 {
<a name="l01057"></a>01057    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01058"></a>01058    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l01059"></a>01059 
<a name="l01060"></a>01060    <span class="comment">/* write all test counts to /analyzer/tests/&lt;name&gt; */</span>
<a name="l01061"></a>01061    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="fal_8c.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a>; i++) {
<a name="l01062"></a>01062       sprintf(str, <span class="stringliteral">&quot;/%s/Tests/%s&quot;</span>, <a class="code" href="analyzer_8cpp.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a>, <a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>);
<a name="l01063"></a>01063       <a class="code" href="group__msectionh.html#gaf83159c12a4e73b2ec3bf6099b3c5544">db_set_value</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, 0, str, &amp;<a class="code" href="fal_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a>[i]-&gt;<a class="code" href="mdump_8c.html#a3d42cdd395a9c14f809d2fe53748c620">count</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>), 1, <a class="code" href="group__mdefineh.html#gafed9e8d519719d7347f9fdb3031201d1">TID_DWORD</a>);
<a name="l01064"></a>01064    }
<a name="l01065"></a>01065 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7b3b6a2f570d0b31b1ad13c34536db5a"></a><!-- doxytag: member="mana.cpp::tr_pause" ref="a7b3b6a2f570d0b31b1ad13c34536db5a" args="(INT rn, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> tr_pause </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>rn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02495">2495</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="analyzer_8cpp_source.html#l00222">ana_pause_run()</a>, and <a class="el" href="midas_8h_source.html#l00956">CM_SUCCESS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02496"></a>02496 {
<a name="l02497"></a>02497    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l02498"></a>02498 
<a name="l02499"></a>02499    status = <a class="code" href="analyzer_8cpp.html#a86f2bc78d542107ce023a1d54f79b13e">ana_pause_run</a>(<a class="code" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, error);
<a name="l02500"></a>02500    <span class="keywordflow">if</span> (status != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>)
<a name="l02501"></a>02501       <span class="keywordflow">return</span> status;
<a name="l02502"></a>02502 
<a name="l02503"></a>02503    <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l02504"></a>02504 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add7f1295fb688b84e58b96a50eae8df6"></a><!-- doxytag: member="mana.cpp::tr_prestart" ref="add7f1295fb688b84e58b96a50eae8df6" args="(INT rn, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> tr_prestart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>rn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02438">2438</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01519">ANALYZE_REQUEST::ar_stats</a>, <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8h_source.html#l01493">AR_STATS::events_per_sec</a>, <a class="el" href="midas_8h_source.html#l01517">ANALYZE_REQUEST::events_received</a>, <a class="el" href="midas_8h_source.html#l01492">AR_STATS::events_received</a>, <a class="el" href="midas_8h_source.html#l01518">ANALYZE_REQUEST::events_written</a>, <a class="el" href="midas_8h_source.html#l01494">AR_STATS::events_written</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, and <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02439"></a>02439 {
<a name="l02440"></a>02440    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l02441"></a>02441 
<a name="l02442"></a>02442    <a class="code" href="mana_8cpp.html#addcec48ded248cb150b9ded486f01da8">now_stopping</a> = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02443"></a>02443 
<a name="l02444"></a>02444    <span class="comment">/* reset counters */</span>
<a name="l02445"></a>02445    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02446"></a>02446       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga069e2a89b82e12f5257325227343b4c0">ar_stats</a>.<a class="code" href="structAR__STATS.html#ae75a481fd926f515b17a3e2b63ee283a">events_received</a> = 0;
<a name="l02447"></a>02447       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga069e2a89b82e12f5257325227343b4c0">ar_stats</a>.<a class="code" href="group__midasincludecode.html#ga3695a89775259f076f838bf46af2e00f">events_per_sec</a> = 0;
<a name="l02448"></a>02448       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga069e2a89b82e12f5257325227343b4c0">ar_stats</a>.<a class="code" href="group__midasincludecode.html#ga142015e81c965f9e9fba58f5a6322525">events_written</a> = 0;
<a name="l02449"></a>02449       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a> = 0;
<a name="l02450"></a>02450       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gaeaa47cc2392bfdc8a1ee1a459082c876">events_written</a> = 0;
<a name="l02451"></a>02451    }
<a name="l02452"></a>02452 
<a name="l02453"></a>02453    status = <a class="code" href="mana_8cpp.html#aad9e8ec0221ce200e2bd2fd32f77833b">bor</a>(<a class="code" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, error);
<a name="l02454"></a>02454    <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02455"></a>02455       <span class="keywordflow">return</span> status;
<a name="l02456"></a>02456 
<a name="l02457"></a>02457    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l02458"></a>02458 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac69f1c3106f3389ed0dde43e7b86e54d"></a><!-- doxytag: member="mana.cpp::tr_resume" ref="ac69f1c3106f3389ed0dde43e7b86e54d" args="(INT rn, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> tr_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>rn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02508">2508</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="analyzer_8cpp_source.html#l00229">ana_resume_run()</a>, and <a class="el" href="midas_8h_source.html#l00956">CM_SUCCESS</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02509"></a>02509 {
<a name="l02510"></a>02510    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l02511"></a>02511 
<a name="l02512"></a>02512    status = <a class="code" href="analyzer_8cpp.html#a35f57e1efbd308b1ca049035dcdc13f6">ana_resume_run</a>(<a class="code" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, error);
<a name="l02513"></a>02513    <span class="keywordflow">if</span> (status != <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>)
<a name="l02514"></a>02514       <span class="keywordflow">return</span> status;
<a name="l02515"></a>02515 
<a name="l02516"></a>02516    <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l02517"></a>02517 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c030a1926f2439e78b7bd0d00221937"></a><!-- doxytag: member="mana.cpp::tr_stop" ref="a5c030a1926f2439e78b7bd0d00221937" args="(INT rn, char *error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> tr_stop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>rn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02462">2462</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8c_source.html#l05385">bm_get_buffer_level()</a>, <a class="el" href="midas_8c_source.html#l07616">bm_poll_event()</a>, <a class="el" href="midas_8h_source.html#l00956">CM_SUCCESS</a>, <a class="el" href="midas_8c_source.html#l04166">cm_yield()</a>, <a class="el" href="mana_8cpp_source.html#l02332">eor()</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8c_source.html#l09022">rpc_is_remote()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, and <a class="el" href="fal_8c_source.html#l03879">update_stats()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02463"></a>02463 {
<a name="l02464"></a>02464    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, n_bytes;
<a name="l02465"></a>02465 
<a name="l02466"></a>02466    <span class="comment">/* wait until all events in buffers are analyzed */</span>
<a name="l02467"></a>02467 
<a name="l02468"></a>02468   <a class="code" href="mana_8cpp.html#addcec48ded248cb150b9ded486f01da8">now_stopping</a> = <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l02469"></a>02469 
<a name="l02470"></a>02470   printf(<span class="stringliteral">&quot;*** Received stop request ***\n&quot;</span>);
<a name="l02471"></a>02471 
<a name="l02472"></a>02472    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga0090933001e7e1ddd52ed3f321bea957">rpc_is_remote</a>())
<a name="l02473"></a>02473       <span class="keywordflow">while</span> (<a class="code" href="group__msectionh.html#ga545449f5acb6b13f78b1194cb92b3d63">bm_poll_event</a>(<a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>));
<a name="l02474"></a>02474    <span class="keywordflow">else</span>
<a name="l02475"></a>02475       <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l02476"></a>02476          <span class="keywordflow">do</span> {
<a name="l02477"></a>02477             <a class="code" href="group__msectionh.html#ga16a2c902dc41dd323e6552c940b37af9">bm_get_buffer_level</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].buffer_handle, &amp;n_bytes);
<a name="l02478"></a>02478             <span class="keywordflow">if</span> (n_bytes &gt; 0)
<a name="l02479"></a>02479                <a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(100);
<a name="l02480"></a>02480          } <span class="keywordflow">while</span> (n_bytes &gt; 0);
<a name="l02481"></a>02481       }
<a name="l02482"></a>02482 
<a name="l02483"></a>02483    <span class="comment">/* update statistics */</span>
<a name="l02484"></a>02484    <a class="code" href="fal_8c.html#ae9ecbc5912c68c52edab9a9ddf41c5c7">update_stats</a>();
<a name="l02485"></a>02485 
<a name="l02486"></a>02486    status = <a class="code" href="mana_8cpp.html#accdfb5cb6649097a857202444fbc3aa6">eor</a>(<a class="code" href="mstat_8c.html#a2c1c963021a4d8af2cce969c892c10f1">rn</a>, error);
<a name="l02487"></a>02487    <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l02488"></a>02488       <span class="keywordflow">return</span> status;
<a name="l02489"></a>02489 
<a name="l02490"></a>02490    <span class="keywordflow">return</span> <a class="code" href="group__err21.html#ga0180947941230d805f5dbb6f1801c17c">CM_SUCCESS</a>;
<a name="l02491"></a>02491 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a44060bd07543e42cf3d05407fc8909c8"></a><!-- doxytag: member="mana.cpp::update_request" ref="a44060bd07543e42cf3d05407fc8909c8" args="(HNDLE hDB, HNDLE hKey, void *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a>&nbsp;</td>
          <td class="paramname"> <em>hDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a>&nbsp;</td>
          <td class="paramname"> <em>hKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03831">3831</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01499">ANALYZE_REQUEST::ar_info</a>, <a class="el" href="midas_8c_source.html#l05993">bm_delete_request()</a>, <a class="el" href="group__msectionh.html#ga10c1d7f3486ab4ab4ee58a95bb98e820">bm_request_event()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8h_source.html#l01486">AR_INFO::enabled</a>, <a class="el" href="midas_8h_source.html#l01482">AR_INFO::event_id</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="fal_8c.html#a54200266ef010a58dcf76468aadace0b">receive_event()</a>, <a class="el" href="midas_8h_source.html#l01508">ANALYZE_REQUEST::request_id</a>, <a class="el" href="midas_8h_source.html#l01484">AR_INFO::sampling_type</a>, and <a class="el" href="midas_8h_source.html#l01483">AR_INFO::trigger_mask</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l03861">register_requests()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03832"></a>03832 {
<a name="l03833"></a>03833    <a class="code" href="structAR__INFO.html">AR_INFO</a> *ar_info;
<a name="l03834"></a>03834    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l03835"></a>03835 
<a name="l03836"></a>03836    <span class="keywordflow">if</span> (!<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online)
<a name="l03837"></a>03837       <span class="keywordflow">return</span>;
<a name="l03838"></a>03838 
<a name="l03839"></a>03839    <span class="comment">/* check which request&apos;s key has changed */</span>
<a name="l03840"></a>03840    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++)
<a name="l03841"></a>03841       <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].hkey_common == <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>) {
<a name="l03842"></a>03842          ar_info = &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gabb8861e2bf01fae8d66f0f49ca6cd74c">ar_info</a>;
<a name="l03843"></a>03843 
<a name="l03844"></a>03844          <span class="comment">/* remove previous request */</span>
<a name="l03845"></a>03845          <span class="keywordflow">if</span> (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].request_id != -1)
<a name="l03846"></a>03846             <a class="code" href="group__msectionh.html#ga642e51b416da6cd6e27035fdd43ed71b">bm_delete_request</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].request_id);
<a name="l03847"></a>03847 
<a name="l03848"></a>03848          <span class="comment">/* if enabled, add new request */</span>
<a name="l03849"></a>03849          <span class="keywordflow">if</span> (ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga00b6cb7dc5fefe2d78d04caf3eb257cd">enabled</a>)
<a name="l03850"></a>03850             <a class="code" href="group__msectionh.html#ga10c1d7f3486ab4ab4ee58a95bb98e820">bm_request_event</a>(<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].buffer_handle, (<span class="keywordtype">short</span>) ar_info-&gt;<a class="code" href="structAR__INFO.html#acb0cf26c5067b0c8eb7a895b70e42f11">event_id</a>,
<a name="l03851"></a>03851                              (<span class="keywordtype">short</span>) ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga947c408489c2b8cd8ea2fc8b2df83388">trigger_mask</a>, ar_info-&gt;<a class="code" href="group__midasincludecode.html#ga023ac635bfecdb696c795dc7120209b7">sampling_type</a>,
<a name="l03852"></a>03852                              &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga2ee7a01967465e8a725bb968246c01de">request_id</a>, <a class="code" href="fal_8c.html#a54200266ef010a58dcf76468aadace0b">receive_event</a>);
<a name="l03853"></a>03853          <span class="keywordflow">else</span>
<a name="l03854"></a>03854             <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga2ee7a01967465e8a725bb968246c01de">request_id</a> = -1;
<a name="l03855"></a>03855       }
<a name="l03856"></a>03856 
<a name="l03857"></a>03857 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae9ecbc5912c68c52edab9a9ddf41c5c7"></a><!-- doxytag: member="mana.cpp::update_stats" ref="ae9ecbc5912c68c52edab9a9ddf41c5c7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_stats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03928">3928</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00324">actual_time</a>, <a class="el" href="midas_8h_source.html#l01519">ANALYZE_REQUEST::ar_stats</a>, <a class="el" href="odb_8c_source.html#l08155">db_send_changed_records()</a>, <a class="el" href="midas_8h_source.html#l01498">ANALYZE_REQUEST::event_name</a>, <a class="el" href="midas_8h_source.html#l01493">AR_STATS::events_per_sec</a>, <a class="el" href="midas_8h_source.html#l01517">ANALYZE_REQUEST::events_received</a>, <a class="el" href="midas_8h_source.html#l01492">AR_STATS::events_received</a>, <a class="el" href="midas_8h_source.html#l01518">ANALYZE_REQUEST::events_written</a>, <a class="el" href="midas_8h_source.html#l01494">AR_STATS::events_written</a>, <a class="el" href="mevb_8cpp_source.html#l00090">last_time</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, and <a class="el" href="fal_8c_source.html#l02558">test_write()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03929"></a>03929 {
<a name="l03930"></a>03930    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l03931"></a>03931    <a class="code" href="structAR__STATS.html">AR_STATS</a> *ar_stats;
<a name="l03932"></a>03932    <span class="keyword">static</span> <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="mevb_8cpp.html#a5fecce64b1b883ada4ac0bc410fb3304">last_time</a> = 0;
<a name="l03933"></a>03933    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a6431147bd66aebfe3ca728d244da1253">actual_time</a>;
<a name="l03934"></a>03934 
<a name="l03935"></a>03935    actual_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l03936"></a>03936 
<a name="l03937"></a>03937    <span class="keywordflow">if</span> (last_time == 0)
<a name="l03938"></a>03938       last_time = actual_time;
<a name="l03939"></a>03939 
<a name="l03940"></a>03940    <span class="keywordflow">if</span> (actual_time - last_time == 0)
<a name="l03941"></a>03941       <span class="keywordflow">return</span>;
<a name="l03942"></a>03942 
<a name="l03943"></a>03943    <span class="keywordflow">for</span> (i = 0; <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="structANALYZE__REQUEST.html#abc24698c600ca2b3eec735b84832d0b0">event_name</a>[0]; i++) {
<a name="l03944"></a>03944       ar_stats = &amp;<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#ga069e2a89b82e12f5257325227343b4c0">ar_stats</a>;
<a name="l03945"></a>03945       ar_stats-&gt;<a class="code" href="structAR__STATS.html#ae75a481fd926f515b17a3e2b63ee283a">events_received</a> += <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a>;
<a name="l03946"></a>03946       ar_stats-&gt;<a class="code" href="group__midasincludecode.html#ga142015e81c965f9e9fba58f5a6322525">events_written</a> += <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gaeaa47cc2392bfdc8a1ee1a459082c876">events_written</a>;
<a name="l03947"></a>03947       ar_stats-&gt;<a class="code" href="group__midasincludecode.html#ga3695a89775259f076f838bf46af2e00f">events_per_sec</a> =
<a name="l03948"></a>03948           (<a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a> / ((actual_time - last_time) / 1000.0));
<a name="l03949"></a>03949       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gabf605e9e770da11f91f501febd274aad">events_received</a> = 0;
<a name="l03950"></a>03950       <a class="code" href="analyzer_8cpp.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[i].<a class="code" href="group__midasincludecode.html#gaeaa47cc2392bfdc8a1ee1a459082c876">events_written</a> = 0;
<a name="l03951"></a>03951    }
<a name="l03952"></a>03952 
<a name="l03953"></a>03953    <span class="comment">/* propagate new statistics to ODB */</span>
<a name="l03954"></a>03954    <a class="code" href="group__msectionh.html#ga90c77b8a4ca06f60b0f595c8f16a39bc">db_send_changed_records</a>();
<a name="l03955"></a>03955 
<a name="l03956"></a>03956    <span class="comment">/* save tests in ODB */</span>
<a name="l03957"></a>03957    <a class="code" href="fal_8c.html#a29da9175b91a9b8fbadf2499e84c11e3">test_write</a>();
<a name="l03958"></a>03958 
<a name="l03959"></a>03959    last_time = actual_time;
<a name="l03960"></a>03960 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a548ba840d1c3a1f2a18009e48513f245"></a><!-- doxytag: member="mana.cpp::write_event_ascii" ref="a548ba840d1c3a1f2a18009e48513f245" args="(FILE *file, EVENT_HEADER *pevent, ANALYZE_REQUEST *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> write_event_ascii </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02526">2526</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="midas_8c_source.html#l12633">bk_is32()</a>, <a class="el" href="midas_8c_source.html#l13055">bk_iterate()</a>, <a class="el" href="midas_8c_source.html#l13078">bk_iterate32()</a>, <a class="el" href="hardware_8h_source.html#l00062">LRS1877_HEADER::buffer</a>, <a class="el" href="fal_8c_source.html#l00201">buffer</a>, <a class="el" href="ADCS_8h_source.html#l00003">channel</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="hardware_8h_source.html#l00061">LRS1877_HEADER::count</a>, <a class="el" href="mdump_8c_source.html#l00115">count</a>, <a class="el" href="lrs1821_8c_source.html#l00038">data</a>, <a class="el" href="odb_8c_source.html#l03390">db_enum_key()</a>, <a class="el" href="fal_8c_source.html#l00769">db_get_event_definition()</a>, <a class="el" href="odb_8c_source.html#l03722">db_get_key()</a>, <a class="el" href="midas_8h_source.html#l01016">DB_NO_MORE_SUBKEYS</a>, <a class="el" href="odb_8c_source.html#l06308">db_sprintf()</a>, <a class="el" href="midas_8h_source.html#l01455">BANK_LIST::def_key</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="midas_8h_source.html#l01229">EVENTID_BOR</a>, <a class="el" href="midas_8h_source.html#l01230">EVENTID_EOR</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="fal_8c_source.html#l00765">EVENT_DEF::format</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="hardware_8h_source.html#l00066">LRS1877_HEADER::geo_addr</a>, <a class="el" href="fal_8c_source.html#l00766">EVENT_DEF::hDefKey</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="midas_8h_source.html#l01320">KEY::item_size</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="Mql_8h_source.html#l00007">MIN</a>, <a class="el" href="midas_8h_source.html#l01317">KEY::name</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, <a class="el" href="midas_8h_source.html#l01430">BANK::name</a>, <a class="el" href="midas_8h_source.html#l01436">BANK32::name</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, <a class="el" href="midas_8h_source.html#l01316">KEY::num_values</a>, <a class="el" href="midas_8h_source.html#l01452">BANK_LIST::output_flag</a>, <a class="el" href="midas_8c_source.html#l08170">rpc_tid_name()</a>, <a class="el" href="midas_8c_source.html#l08162">rpc_tid_size()</a>, <a class="el" href="midas_8h_source.html#l01193">EVENT_HEADER::serial_number</a>, <a class="el" href="midas_8h_source.html#l01039">SS_FILE_ERROR</a>, <a class="el" href="system_8c_source.html#l00969">ss_get_struct_align()</a>, <a class="el" href="midas_8h_source.html#l01033">SS_SUCCESS</a>, <a class="el" href="fal_8c_source.html#l00858">STR_INC</a>, <a class="el" href="hardware_8h_source.html#l00036">TID_LRS1877</a>, <a class="el" href="hardware_8h_source.html#l00035">TID_LRS1882</a>, <a class="el" href="hardware_8h_source.html#l00037">TID_PCOS3</a>, <a class="el" href="midas_8h_source.html#l00748">TID_STRUCT</a>, <a class="el" href="midas_8h_source.html#l01192">EVENT_HEADER::trigger_mask</a>, <a class="el" href="midas_8h_source.html#l01315">KEY::type</a>, <a class="el" href="midas_8h_source.html#l01431">BANK::type</a>, <a class="el" href="midas_8h_source.html#l01437">BANK32::type</a>, <a class="el" href="msgdump_8c_source.html#l00028">type_name</a>, and <a class="el" href="midas_8h_source.html#l00908">VALIGN</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l03596">process_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02527"></a>02527 {
<a name="l02528"></a>02528    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="mdump_8c.html#a3d42cdd395a9c14f809d2fe53748c620">count</a>;
<a name="l02529"></a>02529    <a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a> exclude;
<a name="l02530"></a>02530    <a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *pbh;
<a name="l02531"></a>02531    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *pbl;
<a name="l02532"></a>02532    <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def;
<a name="l02533"></a>02533    <a class="code" href="structBANK.html">BANK</a> *pbk;
<a name="l02534"></a>02534    <a class="code" href="structBANK32.html">BANK32</a> *pbk32;
<a name="l02535"></a>02535    <span class="keywordtype">void</span> *pdata;
<a name="l02536"></a>02536    <span class="keywordtype">char</span> *pbuf, <a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>[5], <a class="code" href="msgdump_8c.html#ae8c4f86d88b7b85ae0f2bd5ceecfe425">type_name</a>[10];
<a name="l02537"></a>02537    <a class="code" href="structLRS1882__DATA.html">LRS1882_DATA</a> *lrs1882;
<a name="l02538"></a>02538    <a class="code" href="structLRS1877__DATA.html">LRS1877_DATA</a> *lrs1877;
<a name="l02539"></a>02539    <a class="code" href="structLRS1877__HEADER.html">LRS1877_HEADER</a> *lrs1877_header;
<a name="l02540"></a>02540    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>;
<a name="l02541"></a>02541    <a class="code" href="structKEY.html">KEY</a> <a class="code" href="mdump_8c.html#a5cdb181553f9aa7bb182db5c195bb079">key</a>;
<a name="l02542"></a>02542    <span class="keywordtype">char</span> <a class="code" href="fal_8c.html#a368f7094dc38acca20612bbb392552f4">buffer</a>[100000];
<a name="l02543"></a>02543    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> bkname;
<a name="l02544"></a>02544    <a class="code" href="unionWORD.html">WORD</a> bktype;
<a name="l02545"></a>02545 
<a name="l02546"></a>02546    event_def = <a class="code" href="fal_8c.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a>(pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l02547"></a>02547    <span class="keywordflow">if</span> (event_def == NULL)
<a name="l02548"></a>02548       <span class="keywordflow">return</span> <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a>;
<a name="l02549"></a>02549 
<a name="l02550"></a>02550    <span class="comment">/* write event header */</span>
<a name="l02551"></a>02551    pbuf = buffer;
<a name="l02552"></a>02552    name[4] = 0;
<a name="l02553"></a>02553 
<a name="l02554"></a>02554    <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> == <a class="code" href="group__mbufferh.html#gaea58a47233f988dd2f9a0320d99734dc">EVENTID_BOR</a>)
<a name="l02555"></a>02555       sprintf(pbuf, <span class="stringliteral">&quot;%%ID BOR NR %d\n&quot;</span>, (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>);
<a name="l02556"></a>02556    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a> == <a class="code" href="group__mbufferh.html#ga8f46d90b4c90a2387685d422625c654f">EVENTID_EOR</a>)
<a name="l02557"></a>02557       sprintf(pbuf, <span class="stringliteral">&quot;%%ID EOR NR %d\n&quot;</span>, (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>);
<a name="l02558"></a>02558    <span class="keywordflow">else</span>
<a name="l02559"></a>02559       sprintf(pbuf, <span class="stringliteral">&quot;%%ID %d TR %d NR %d\n&quot;</span>, pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>, pevent-&gt;<a class="code" href="group__midasincludecode.html#ga9b4b94f41521f5c188655b7bb0f1ec1b">trigger_mask</a>,
<a name="l02560"></a>02560               (<span class="keywordtype">int</span>) pevent-&gt;<a class="code" href="group__midasincludecode.html#ga5ed07c075ebce619a8fa47e96f188440">serial_number</a>);
<a name="l02561"></a>02561    <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02562"></a>02562 
<a name="l02563"></a>02563   <span class="comment">/*---- MIDAS format ----------------------------------------------*/</span>
<a name="l02564"></a>02564    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l02565"></a>02565       pbh = (<a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *) (pevent + 1);
<a name="l02566"></a>02566       pbk = NULL;
<a name="l02567"></a>02567       pbk32 = NULL;
<a name="l02568"></a>02568       <span class="keywordflow">do</span> {
<a name="l02569"></a>02569          <span class="comment">/* scan all banks */</span>
<a name="l02570"></a>02570          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga75339a20fd35a8e8644f4a0fb77e96fe">bk_is32</a>(pbh)) {
<a name="l02571"></a>02571             size = <a class="code" href="group__msectionh.html#ga6ef3064c432f60af815e109bbf6acbd3">bk_iterate32</a>(pbh, &amp;pbk32, &amp;pdata);
<a name="l02572"></a>02572             <span class="keywordflow">if</span> (pbk32 == NULL)
<a name="l02573"></a>02573                <span class="keywordflow">break</span>;
<a name="l02574"></a>02574             bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk32-&gt;<a class="code" href="structBANK32.html#a048e3afc084c62bffb7af80f110c30c3">name</a>);
<a name="l02575"></a>02575             bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk32-&gt;<a class="code" href="group__midasincludecode.html#ga24b3068dc97237c8525e2188586a2c1b">type</a>;
<a name="l02576"></a>02576          } <span class="keywordflow">else</span> {
<a name="l02577"></a>02577             size = <a class="code" href="group__msectionh.html#gab47ee14db38356b8392632ba94b559d8">bk_iterate</a>(pbh, &amp;pbk, &amp;pdata);
<a name="l02578"></a>02578             <span class="keywordflow">if</span> (pbk == NULL)
<a name="l02579"></a>02579                <span class="keywordflow">break</span>;
<a name="l02580"></a>02580             bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk-&gt;<a class="code" href="structBANK.html#a39a277bc7edde0d3e783ef0d93f44c1e">name</a>);
<a name="l02581"></a>02581             bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk-&gt;<a class="code" href="group__midasincludecode.html#ga91558478db8ed86d585715b8217ca72f">type</a>;
<a name="l02582"></a>02582          }
<a name="l02583"></a>02583 
<a name="l02584"></a>02584          <span class="comment">/* look if bank is in exclude list */</span>
<a name="l02585"></a>02585          exclude = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02586"></a>02586          pbl = NULL;
<a name="l02587"></a>02587          <span class="keywordflow">if</span> (par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a> != NULL)
<a name="l02588"></a>02588             <span class="keywordflow">for</span> (i = 0; par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[i].<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; i++)
<a name="l02589"></a>02589                <span class="keywordflow">if</span> (*((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[i].<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>) == bkname) {
<a name="l02590"></a>02590                   pbl = &amp;par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[i];
<a name="l02591"></a>02591                   exclude = (pbl-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a> == 0);
<a name="l02592"></a>02592                   <span class="keywordflow">break</span>;
<a name="l02593"></a>02593                }
<a name="l02594"></a>02594 
<a name="l02595"></a>02595          <span class="keywordflow">if</span> (!exclude) {
<a name="l02596"></a>02596             <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#gaa0bf5cc257f83e9a7f3936738fe009f3">rpc_tid_size</a>(bktype &amp; 0xFF))
<a name="l02597"></a>02597                size /= <a class="code" href="group__msectionh.html#gaa0bf5cc257f83e9a7f3936738fe009f3">rpc_tid_size</a>(bktype &amp; 0xFF);
<a name="l02598"></a>02598 
<a name="l02599"></a>02599             lrs1882 = (<a class="code" href="structLRS1882__DATA.html">LRS1882_DATA</a> *) pdata;
<a name="l02600"></a>02600             lrs1877 = (<a class="code" href="structLRS1877__DATA.html">LRS1877_DATA</a> *) pdata;
<a name="l02601"></a>02601 
<a name="l02602"></a>02602             <span class="comment">/* write bank header */</span>
<a name="l02603"></a>02603             *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) name) = bkname;
<a name="l02604"></a>02604 
<a name="l02605"></a>02605             <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == 0)
<a name="l02606"></a>02606                strcpy(type_name, <a class="code" href="group__msectionh.html#ga94fb45fa1cdd442e964ebe32c7668976">rpc_tid_name</a>(bktype &amp; 0xFF));
<a name="l02607"></a>02607             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#ae970f1c88e76ada2bcb23a140e27e37c">TID_LRS1882</a>)
<a name="l02608"></a>02608                strcpy(type_name, <span class="stringliteral">&quot;LRS1882&quot;</span>);
<a name="l02609"></a>02609             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#ab4bb71b415e8b5ba35490697817c0415">TID_LRS1877</a>)
<a name="l02610"></a>02610                strcpy(type_name, <span class="stringliteral">&quot;LRS1877&quot;</span>);
<a name="l02611"></a>02611             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#a9446e243f13a3078e1237e48543021fd">TID_PCOS3</a>)
<a name="l02612"></a>02612                strcpy(type_name, <span class="stringliteral">&quot;PCOS3&quot;</span>);
<a name="l02613"></a>02613             <span class="keywordflow">else</span>
<a name="l02614"></a>02614                strcpy(type_name, <span class="stringliteral">&quot;unknown&quot;</span>);
<a name="l02615"></a>02615 
<a name="l02616"></a>02616             sprintf(pbuf, <span class="stringliteral">&quot;BK %s TP %s SZ %d\n&quot;</span>, name, type_name, size);
<a name="l02617"></a>02617             <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02618"></a>02618 
<a name="l02619"></a>02619             <span class="keywordflow">if</span> (bktype == <a class="code" href="group__mdefineh.html#ga8d82076a05b53876103e1c53d5878b75">TID_STRUCT</a>) {
<a name="l02620"></a>02620                <span class="keywordflow">if</span> (pbl == NULL)
<a name="l02621"></a>02621                   <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_ascii&quot;</span>, <span class="stringliteral">&quot;received unknown bank %s&quot;</span>, name);
<a name="l02622"></a>02622                <span class="keywordflow">else</span>
<a name="l02623"></a>02623                   <span class="comment">/* write structured bank */</span>
<a name="l02624"></a>02624                   <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l02625"></a>02625                      status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, pbl-&gt;<a class="code" href="group__midasincludecode.html#ga732747585d79c8c76c856d376aa56cf0">def_key</a>, i, &amp;hKey);
<a name="l02626"></a>02626                      <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l02627"></a>02627                         <span class="keywordflow">break</span>;
<a name="l02628"></a>02628 
<a name="l02629"></a>02629                      <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, &amp;key);
<a name="l02630"></a>02630                      sprintf(pbuf, <span class="stringliteral">&quot;%s:\n&quot;</span>, key.<a class="code" href="group__midasincludecode.html#gaab4927ab8eb9921525d82761adb11f5c">name</a>);
<a name="l02631"></a>02631                      <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02632"></a>02632 
<a name="l02633"></a>02633                      <span class="comment">/* adjust for alignment */</span>
<a name="l02634"></a>02634                      pdata =
<a name="l02635"></a>02635                          (<span class="keywordtype">void</span> *) <a class="code" href="group__mmacroh.html#ga03bfa072452094d4d31ce3d304438f14">VALIGN</a>(pdata,
<a name="l02636"></a>02636                                          <a class="code" href="Mql_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="group__msystemincludecode.html#gabae408f8715e9063be5cdf650a699282">ss_get_struct_align</a>(), key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a>));
<a name="l02637"></a>02637 
<a name="l02638"></a>02638                      <span class="keywordflow">for</span> (j = 0; j &lt; key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>; j++) {
<a name="l02639"></a>02639                         <a class="code" href="group__msectionh.html#ga14e4b0190141d168b49e36178705552e">db_sprintf</a>(pbuf, pdata, key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a>, j, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l02640"></a>02640                         strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02641"></a>02641                         <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02642"></a>02642                      }
<a name="l02643"></a>02643 
<a name="l02644"></a>02644                      <span class="comment">/* shift data pointer to next item */</span>
<a name="l02645"></a>02645                      pdata = (<span class="keywordtype">char</span> *) pdata + key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a> * key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>;
<a name="l02646"></a>02646                   }
<a name="l02647"></a>02647             } <span class="keywordflow">else</span> {
<a name="l02648"></a>02648                <span class="comment">/* write variable length bank  */</span>
<a name="l02649"></a>02649                <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#ab4bb71b415e8b5ba35490697817c0415">TID_LRS1877</a>) {
<a name="l02650"></a>02650                   <span class="keywordflow">for</span> (i = 0; i &lt; size;) {
<a name="l02651"></a>02651                      lrs1877_header = (<a class="code" href="structLRS1877__HEADER.html">LRS1877_HEADER</a> *) &amp; lrs1877[i];
<a name="l02652"></a>02652 
<a name="l02653"></a>02653                      <span class="comment">/* print header */</span>
<a name="l02654"></a>02654                      sprintf(pbuf, <span class="stringliteral">&quot;GA %d BF %d CN %d&quot;</span>,
<a name="l02655"></a>02655                              lrs1877_header-&gt;<a class="code" href="structLRS1877__HEADER.html#a5c3514b7bef026ab66f56dd7f165a175">geo_addr</a>, lrs1877_header-&gt;<a class="code" href="structLRS1877__HEADER.html#ad874ba2882df823d261c24579bc589ed">buffer</a>,
<a name="l02656"></a>02656                              lrs1877_header-&gt;<a class="code" href="structLRS1877__HEADER.html#a8aa9a9acc7efc7ed688d99758c5af954">count</a>);
<a name="l02657"></a>02657                      strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02658"></a>02658                      <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02659"></a>02659 
<a name="l02660"></a>02660                      count = lrs1877_header-&gt;<a class="code" href="structLRS1877__HEADER.html#a8aa9a9acc7efc7ed688d99758c5af954">count</a>;
<a name="l02661"></a>02661                      <span class="keywordflow">if</span> (count == 0)
<a name="l02662"></a>02662                         <span class="keywordflow">break</span>;
<a name="l02663"></a>02663                      <span class="keywordflow">for</span> (j = 1; j &lt; count; j++) {
<a name="l02664"></a>02664                         <span class="comment">/* print data */</span>
<a name="l02665"></a>02665                         sprintf(pbuf, <span class="stringliteral">&quot;GA %d CH %02d ED %d DA %1.1lf&quot;</span>,
<a name="l02666"></a>02666                                 lrs1877[i].geo_addr, lrs1877[i + j].<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>,
<a name="l02667"></a>02667                                 lrs1877[i + j].edge, lrs1877[i + j].<a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a> * 0.5);
<a name="l02668"></a>02668                         strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02669"></a>02669                         <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02670"></a>02670                      }
<a name="l02671"></a>02671 
<a name="l02672"></a>02672                      i += count;
<a name="l02673"></a>02673                   }
<a name="l02674"></a>02674                } <span class="keywordflow">else</span>
<a name="l02675"></a>02675                   <span class="keywordflow">for</span> (i = 0; i &lt; size; i++) {
<a name="l02676"></a>02676                      <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == 0)
<a name="l02677"></a>02677                         <a class="code" href="group__msectionh.html#ga14e4b0190141d168b49e36178705552e">db_sprintf</a>(pbuf, pdata, size, i, bktype &amp; 0xFF);
<a name="l02678"></a>02678 
<a name="l02679"></a>02679                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#ae970f1c88e76ada2bcb23a140e27e37c">TID_LRS1882</a>)
<a name="l02680"></a>02680                         sprintf(pbuf, <span class="stringliteral">&quot;GA %d CH %02d DA %d&quot;</span>,
<a name="l02681"></a>02681                                 lrs1882[i].geo_addr, lrs1882[i].<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>, lrs1882[i].<a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>);
<a name="l02682"></a>02682 
<a name="l02683"></a>02683                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((bktype &amp; 0xFF00) == <a class="code" href="hardware_8h.html#a9446e243f13a3078e1237e48543021fd">TID_PCOS3</a>)
<a name="l02684"></a>02684                         sprintf(pbuf, <span class="stringliteral">&quot;TBD&quot;</span>);
<a name="l02685"></a>02685                      <span class="keywordflow">else</span>
<a name="l02686"></a>02686                         <a class="code" href="group__msectionh.html#ga14e4b0190141d168b49e36178705552e">db_sprintf</a>(pbuf, pdata, size, i, bktype &amp; 0xFF);
<a name="l02687"></a>02687 
<a name="l02688"></a>02688                      strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02689"></a>02689                      <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02690"></a>02690                   }
<a name="l02691"></a>02691             }
<a name="l02692"></a>02692          }
<a name="l02693"></a>02693 
<a name="l02694"></a>02694       } <span class="keywordflow">while</span> (1);
<a name="l02695"></a>02695    }
<a name="l02696"></a>02696 
<a name="l02697"></a>02697   <span class="comment">/*---- FIXED format ----------------------------------------------*/</span>
<a name="l02698"></a>02698    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a>) {
<a name="l02699"></a>02699       <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a> == 0)
<a name="l02700"></a>02700          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_ascii&quot;</span>, <span class="stringliteral">&quot;cannot find event definition&quot;</span>);
<a name="l02701"></a>02701       <span class="keywordflow">else</span> {
<a name="l02702"></a>02702          pdata = (<span class="keywordtype">char</span> *) (pevent + 1);
<a name="l02703"></a>02703          <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l02704"></a>02704             status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, event_def-&gt;<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a>, i, &amp;hKey);
<a name="l02705"></a>02705             <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l02706"></a>02706                <span class="keywordflow">break</span>;
<a name="l02707"></a>02707 
<a name="l02708"></a>02708             <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, &amp;key);
<a name="l02709"></a>02709             sprintf(pbuf, <span class="stringliteral">&quot;%s\n&quot;</span>, key.<a class="code" href="group__midasincludecode.html#gaab4927ab8eb9921525d82761adb11f5c">name</a>);
<a name="l02710"></a>02710             <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02711"></a>02711 
<a name="l02712"></a>02712             <span class="comment">/* adjust for alignment */</span>
<a name="l02713"></a>02713             pdata = (<span class="keywordtype">void</span> *) <a class="code" href="group__mmacroh.html#ga03bfa072452094d4d31ce3d304438f14">VALIGN</a>(pdata, <a class="code" href="Mql_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="group__msystemincludecode.html#gabae408f8715e9063be5cdf650a699282">ss_get_struct_align</a>(), key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a>));
<a name="l02714"></a>02714 
<a name="l02715"></a>02715             <span class="keywordflow">for</span> (j = 0; j &lt; key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>; j++) {
<a name="l02716"></a>02716                <a class="code" href="group__msectionh.html#ga14e4b0190141d168b49e36178705552e">db_sprintf</a>(pbuf, pdata, key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a>, j, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l02717"></a>02717                strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02718"></a>02718                <a class="code" href="fal_8c.html#af3dac432eb411d20fb144182a22c1f4e">STR_INC</a>(pbuf, buffer);
<a name="l02719"></a>02719             }
<a name="l02720"></a>02720 
<a name="l02721"></a>02721             <span class="comment">/* shift data pointer to next item */</span>
<a name="l02722"></a>02722             pdata = (<span class="keywordtype">char</span> *) pdata + key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a> * key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>;
<a name="l02723"></a>02723          }
<a name="l02724"></a>02724       }
<a name="l02725"></a>02725    }
<a name="l02726"></a>02726 
<a name="l02727"></a>02727    <span class="comment">/* insert empty line after each event */</span>
<a name="l02728"></a>02728    strcat(pbuf, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02729"></a>02729    size = strlen(buffer);
<a name="l02730"></a>02730 
<a name="l02731"></a>02731    <span class="comment">/* write record to device */</span>
<a name="l02732"></a>02732    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l02733"></a>02733       status = gzwrite(file, buffer, size) == size ? <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l02734"></a>02734    <span class="keywordflow">else</span>
<a name="l02735"></a>02735       status =
<a name="l02736"></a>02736           fwrite(buffer, 1, size, file) == (size_t) size ? <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l02737"></a>02737 
<a name="l02738"></a>02738    <span class="keywordflow">return</span> status;
<a name="l02739"></a>02739 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a75ddaf388f46748e2585fa04d22278f2"></a><!-- doxytag: member="mana.cpp::write_event_midas" ref="a75ddaf388f46748e2585fa04d22278f2" args="(FILE *file, EVENT_HEADER *pevent, ANALYZE_REQUEST *par)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> write_event_midas </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> *&nbsp;</td>
          <td class="paramname"> <em>par</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l02743">2743</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l00904">ALIGN8</a>, <a class="el" href="midas_8h_source.html#l01502">ANALYZE_REQUEST::bank_list</a>, <a class="el" href="midas_8c_source.html#l12826">bk_close()</a>, <a class="el" href="midas_8c_source.html#l12705">bk_create()</a>, <a class="el" href="midas_8c_source.html#l12623">bk_init()</a>, <a class="el" href="midas_8c_source.html#l12664">bk_init32()</a>, <a class="el" href="midas_8c_source.html#l12633">bk_is32()</a>, <a class="el" href="midas_8c_source.html#l13055">bk_iterate()</a>, <a class="el" href="midas_8c_source.html#l13078">bk_iterate32()</a>, <a class="el" href="midas_8c_source.html#l12678">bk_size()</a>, <a class="el" href="fal_8c_source.html#l00201">buffer</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="midas_8h_source.html#l01432">BANK::data_size</a>, <a class="el" href="midas_8h_source.html#l01438">BANK32::data_size</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="fal_8c_source.html#l00769">db_get_event_definition()</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="mana_8cpp_source.html#l00640">EXT_EVENT_SIZE</a>, <a class="el" href="p30_8h_source.html#l00042">FALSE</a>, <a class="el" href="fal_8c_source.html#l00765">EVENT_DEF::format</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l01448">BANK_LIST::name</a>, <a class="el" href="midas_8h_source.html#l01430">BANK::name</a>, <a class="el" href="midas_8h_source.html#l01436">BANK32::name</a>, <a class="el" href="midas_8h_source.html#l01452">BANK_LIST::output_flag</a>, <a class="el" href="midas_8h_source.html#l00615">PTYPE</a>, <a class="el" href="midas_8h_source.html#l01039">SS_FILE_ERROR</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01431">BANK::type</a>, and <a class="el" href="midas_8h_source.html#l01437">BANK32::type</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l03596">process_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l02744"></a>02744 {
<a name="l02745"></a>02745    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a> = 0, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l02746"></a>02746    <a class="code" href="group__midasincludecode.html#ga239c7f0d40651c3e419c5b9651507d14">BOOL</a> exclude;
<a name="l02747"></a>02747    <a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *pbh;
<a name="l02748"></a>02748    <a class="code" href="structBANK__LIST.html">BANK_LIST</a> *pbl;
<a name="l02749"></a>02749    <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def;
<a name="l02750"></a>02750    <a class="code" href="structBANK.html">BANK</a> *pbk;
<a name="l02751"></a>02751    <a class="code" href="structBANK32.html">BANK32</a> *pbk32;
<a name="l02752"></a>02752    <span class="keywordtype">char</span> *pdata, *pdata_copy;
<a name="l02753"></a>02753    <span class="keywordtype">char</span> *pbuf;
<a name="l02754"></a>02754    <a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *pevent_copy;
<a name="l02755"></a>02755    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> bkname, bksize;
<a name="l02756"></a>02756    <a class="code" href="unionWORD.html">WORD</a> bktype;
<a name="l02757"></a>02757    <span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="fal_8c.html#a368f7094dc38acca20612bbb392552f4">buffer</a> = NULL;
<a name="l02758"></a>02758 
<a name="l02759"></a>02759    <span class="keywordflow">if</span> (buffer == NULL)
<a name="l02760"></a>02760       buffer = (<span class="keywordtype">char</span> *) malloc(<a class="code" href="mana_8cpp.html#a2cfad5b8da98c11be16500fc15dba5aa">EXT_EVENT_SIZE</a>);
<a name="l02761"></a>02761 
<a name="l02762"></a>02762    pevent_copy = (<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a> *) <a class="code" href="group__mmacroh.html#ga46bf3ace1698ee72389c30bc61d78686">ALIGN8</a>((<a class="code" href="group__midasincludecode.html#ga790216a8e71233fed28657b16a052e36">PTYPE</a>) buffer);
<a name="l02763"></a>02763 
<a name="l02764"></a>02764    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.filter) {
<a name="l02765"></a>02765       <span class="comment">/* use original event */</span>
<a name="l02766"></a>02766       size = pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l02767"></a>02767       memcpy(pevent_copy, pevent, size);
<a name="l02768"></a>02768    } <span class="keywordflow">else</span> {
<a name="l02769"></a>02769       <span class="comment">/* copy only banks which are turned on via /analyzer/bank switches */</span>
<a name="l02770"></a>02770 
<a name="l02771"></a>02771     <span class="comment">/*---- MIDAS format ----------------------------------------------*/</span>
<a name="l02772"></a>02772 
<a name="l02773"></a>02773       event_def = <a class="code" href="fal_8c.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a>(pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l02774"></a>02774       <span class="keywordflow">if</span> (event_def == NULL)
<a name="l02775"></a>02775          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l02776"></a>02776 
<a name="l02777"></a>02777       <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l02778"></a>02778          <span class="comment">/* copy event header */</span>
<a name="l02779"></a>02779          pbuf = (<span class="keywordtype">char</span> *) pevent_copy;
<a name="l02780"></a>02780          memcpy(pbuf, pevent, <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>));
<a name="l02781"></a>02781          pbuf += <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l02782"></a>02782 
<a name="l02783"></a>02783          pbh = (<a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *) (pevent + 1);
<a name="l02784"></a>02784 
<a name="l02785"></a>02785          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga75339a20fd35a8e8644f4a0fb77e96fe">bk_is32</a>(pbh))
<a name="l02786"></a>02786             <a class="code" href="group__msectionh.html#ga54b6fd483a10f6b7f134e5203e53a406">bk_init32</a>(pbuf);
<a name="l02787"></a>02787          <span class="keywordflow">else</span>
<a name="l02788"></a>02788             <a class="code" href="group__msectionh.html#ga6a2d6aced3ec658234d4c6ab0ba043fb">bk_init</a>(pbuf);
<a name="l02789"></a>02789 
<a name="l02790"></a>02790          pbk = NULL;
<a name="l02791"></a>02791          pbk32 = NULL;
<a name="l02792"></a>02792          pdata_copy = pbuf;
<a name="l02793"></a>02793          <span class="keywordflow">do</span> {
<a name="l02794"></a>02794             <span class="comment">/* scan all banks */</span>
<a name="l02795"></a>02795             <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga75339a20fd35a8e8644f4a0fb77e96fe">bk_is32</a>(pbh)) {
<a name="l02796"></a>02796                size = <a class="code" href="group__msectionh.html#ga6ef3064c432f60af815e109bbf6acbd3">bk_iterate32</a>(pbh, &amp;pbk32, &amp;pdata);
<a name="l02797"></a>02797                <span class="keywordflow">if</span> (pbk32 == NULL)
<a name="l02798"></a>02798                   <span class="keywordflow">break</span>;
<a name="l02799"></a>02799                bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk32-&gt;<a class="code" href="structBANK32.html#a048e3afc084c62bffb7af80f110c30c3">name</a>);
<a name="l02800"></a>02800                bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk32-&gt;<a class="code" href="group__midasincludecode.html#ga24b3068dc97237c8525e2188586a2c1b">type</a>;
<a name="l02801"></a>02801                bksize = pbk32-&gt;<a class="code" href="group__midasincludecode.html#ga211ae680238a01caef15677d73d2ee9f">data_size</a>;
<a name="l02802"></a>02802             } <span class="keywordflow">else</span> {
<a name="l02803"></a>02803                size = <a class="code" href="group__msectionh.html#gab47ee14db38356b8392632ba94b559d8">bk_iterate</a>(pbh, &amp;pbk, &amp;pdata);
<a name="l02804"></a>02804                <span class="keywordflow">if</span> (pbk == NULL)
<a name="l02805"></a>02805                   <span class="keywordflow">break</span>;
<a name="l02806"></a>02806                bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk-&gt;<a class="code" href="structBANK.html#a39a277bc7edde0d3e783ef0d93f44c1e">name</a>);
<a name="l02807"></a>02807                bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk-&gt;<a class="code" href="group__midasincludecode.html#ga91558478db8ed86d585715b8217ca72f">type</a>;
<a name="l02808"></a>02808                bksize = pbk-&gt;<a class="code" href="group__midasincludecode.html#ga95afeb25db8deb1ea4cffd6ba50a6dcf">data_size</a>;
<a name="l02809"></a>02809             }
<a name="l02810"></a>02810 
<a name="l02811"></a>02811             <span class="comment">/* look if bank is in exclude list */</span>
<a name="l02812"></a>02812             exclude = <a class="code" href="p30_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l02813"></a>02813             pbl = NULL;
<a name="l02814"></a>02814             <span class="keywordflow">if</span> (par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a> != NULL)
<a name="l02815"></a>02815                <span class="keywordflow">for</span> (<a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a> = 0; par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[<a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>].<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>[0]; <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>++)
<a name="l02816"></a>02816                   <span class="keywordflow">if</span> (*((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[<a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>].<a class="code" href="structBANK__LIST.html#a108f74b9ebdca9718cfd91de54899325">name</a>) == bkname) {
<a name="l02817"></a>02817                      pbl = &amp;par-&gt;<a class="code" href="group__midasincludecode.html#ga3130441b33d46c2072cd2c38d7a21497">bank_list</a>[<a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>];
<a name="l02818"></a>02818                      exclude = (pbl-&gt;<a class="code" href="group__midasincludecode.html#gae2fa2419da6dc57ec48d57da2b18b58a">output_flag</a> == 0);
<a name="l02819"></a>02819                      <span class="keywordflow">break</span>;
<a name="l02820"></a>02820                   }
<a name="l02821"></a>02821 
<a name="l02822"></a>02822             <span class="keywordflow">if</span> (!exclude) {
<a name="l02823"></a>02823                <span class="comment">/* copy bank */</span>
<a name="l02824"></a>02824                <a class="code" href="group__msectionh.html#ga5d60ec9f544f56ab8170380ebe195584">bk_create</a>(pbuf, (<span class="keywordtype">char</span> *) (&amp;bkname), bktype, &amp;pdata_copy);
<a name="l02825"></a>02825                memcpy(pdata_copy, pdata, bksize);
<a name="l02826"></a>02826                pdata_copy += bksize;
<a name="l02827"></a>02827                <a class="code" href="group__msectionh.html#gab0314f08910a3950815d265d090656b7">bk_close</a>(pbuf, pdata_copy);
<a name="l02828"></a>02828             }
<a name="l02829"></a>02829 
<a name="l02830"></a>02830          } <span class="keywordflow">while</span> (1);
<a name="l02831"></a>02831 
<a name="l02832"></a>02832          <span class="comment">/* set event size in header */</span>
<a name="l02833"></a>02833          size = <a class="code" href="group__msectionh.html#ga825db64c9ef9b4656698c890fca37c05">bk_size</a>(pbuf);
<a name="l02834"></a>02834          pevent_copy-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> = size;
<a name="l02835"></a>02835          size += <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l02836"></a>02836       }
<a name="l02837"></a>02837 
<a name="l02838"></a>02838     <span class="comment">/*---- FIXED format ----------------------------------------------*/</span>
<a name="l02839"></a>02839       <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a>) {
<a name="l02840"></a>02840          size = pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> + <span class="keyword">sizeof</span>(<a class="code" href="structEVENT__HEADER.html">EVENT_HEADER</a>);
<a name="l02841"></a>02841          memcpy(pevent_copy, pevent, size);
<a name="l02842"></a>02842       }
<a name="l02843"></a>02843 
<a name="l02844"></a>02844       <span class="keywordflow">if</span> (pevent_copy-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a> == 0)
<a name="l02845"></a>02845          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l02846"></a>02846    }
<a name="l02847"></a>02847 
<a name="l02848"></a>02848    <span class="comment">/* write record to device */</span>
<a name="l02849"></a>02849    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a>)
<a name="l02850"></a>02850       status = gzwrite(file, pevent_copy, size) == size ? <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l02851"></a>02851    <span class="keywordflow">else</span>
<a name="l02852"></a>02852       status =
<a name="l02853"></a>02853           fwrite(pevent_copy, 1, size, file) == (size_t) size ? <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a> : <a class="code" href="group__err24.html#ga25ab2ae4b1702824549b8e40a6e86718">SS_FILE_ERROR</a>;
<a name="l02854"></a>02854 
<a name="l02855"></a>02855    <span class="keywordflow">return</span> status;
<a name="l02856"></a>02856 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0b211773db8022bff4c277dc8bd8e90f"></a><!-- doxytag: member="mana.cpp::write_event_odb" ref="a0b211773db8022bff4c277dc8bd8e90f" args="(EVENT_HEADER *pevent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> write_event_odb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEVENT__HEADER.html">EVENT_HEADER</a> *&nbsp;</td>
          <td class="paramname"> <em>pevent</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03479">3479</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>References <a class="el" href="midas_8c_source.html#l12633">bk_is32()</a>, <a class="el" href="midas_8c_source.html#l13055">bk_iterate()</a>, <a class="el" href="midas_8c_source.html#l13078">bk_iterate32()</a>, <a class="el" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01195">EVENT_HEADER::data_size</a>, <a class="el" href="odb_8c_source.html#l03390">db_enum_key()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="fal_8c_source.html#l00769">db_get_event_definition()</a>, <a class="el" href="odb_8c_source.html#l03722">db_get_key()</a>, <a class="el" href="midas_8h_source.html#l01016">DB_NO_MORE_SUBKEYS</a>, <a class="el" href="odb_8c_source.html#l04503">db_set_data()</a>, <a class="el" href="odb_8c_source.html#l06874">db_set_record()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01191">EVENT_HEADER::event_id</a>, <a class="el" href="fal_8c_source.html#l00765">EVENT_DEF::format</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="fal_8c_source.html#l00766">EVENT_DEF::hDefKey</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="midas_8h_source.html#l01320">KEY::item_size</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="Mql_8h_source.html#l00007">MIN</a>, <a class="el" href="midas_8h_source.html#l01430">BANK::name</a>, <a class="el" href="midas_8h_source.html#l01436">BANK32::name</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00039">name</a>, <a class="el" href="midas_8h_source.html#l01316">KEY::num_values</a>, <a class="el" href="midas_8c_source.html#l08162">rpc_tid_size()</a>, <a class="el" href="system_8c_source.html#l00969">ss_get_struct_align()</a>, <a class="el" href="midas_8h_source.html#l01033">SS_SUCCESS</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="midas_8h_source.html#l00750">TID_LINK</a>, <a class="el" href="midas_8h_source.html#l00746">TID_STRING</a>, <a class="el" href="midas_8h_source.html#l00748">TID_STRUCT</a>, <a class="el" href="midas_8h_source.html#l01315">KEY::type</a>, <a class="el" href="midas_8h_source.html#l01431">BANK::type</a>, <a class="el" href="midas_8h_source.html#l01437">BANK32::type</a>, and <a class="el" href="midas_8h_source.html#l00908">VALIGN</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03480"></a>03480 {
<a name="l03481"></a>03481    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, n_data, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l03482"></a>03482    <a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *pbh;
<a name="l03483"></a>03483    <a class="code" href="structEVENT__DEF.html">EVENT_DEF</a> *event_def;
<a name="l03484"></a>03484    <a class="code" href="structBANK.html">BANK</a> *pbk;
<a name="l03485"></a>03485    <a class="code" href="structBANK32.html">BANK32</a> *pbk32;
<a name="l03486"></a>03486    <span class="keywordtype">void</span> *pdata;
<a name="l03487"></a>03487    <span class="keywordtype">char</span> <a class="code" href="examples_2macro_2midas__macro_8h.html#ab53d3e6e6144dcb27935cc71c57bc508">name</a>[5];
<a name="l03488"></a>03488    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> hKeyRoot, <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>;
<a name="l03489"></a>03489    <a class="code" href="structKEY.html">KEY</a> <a class="code" href="mdump_8c.html#a5cdb181553f9aa7bb182db5c195bb079">key</a>;
<a name="l03490"></a>03490    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> bkname;
<a name="l03491"></a>03491    <a class="code" href="unionWORD.html">WORD</a> bktype;
<a name="l03492"></a>03492 
<a name="l03493"></a>03493    event_def = <a class="code" href="fal_8c.html#ad5d6f1e4c99351c9278d6189b7e87b08">db_get_event_definition</a>(pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l03494"></a>03494    <span class="keywordflow">if</span> (event_def == NULL)
<a name="l03495"></a>03495       <span class="keywordflow">return</span> <a class="code" href="group__err24.html#ga0abac6c68d7a79ce83d1a25b2c800321">SS_SUCCESS</a>;
<a name="l03496"></a>03496 
<a name="l03497"></a>03497   <span class="comment">/*---- MIDAS format ----------------------------------------------*/</span>
<a name="l03498"></a>03498    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l03499"></a>03499       pbh = (<a class="code" href="structBANK__HEADER.html">BANK_HEADER</a> *) (pevent + 1);
<a name="l03500"></a>03500       pbk = NULL;
<a name="l03501"></a>03501       pbk32 = NULL;
<a name="l03502"></a>03502       <span class="keywordflow">do</span> {
<a name="l03503"></a>03503          <span class="comment">/* scan all banks */</span>
<a name="l03504"></a>03504          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga75339a20fd35a8e8644f4a0fb77e96fe">bk_is32</a>(pbh)) {
<a name="l03505"></a>03505             size = <a class="code" href="group__msectionh.html#ga6ef3064c432f60af815e109bbf6acbd3">bk_iterate32</a>(pbh, &amp;pbk32, &amp;pdata);
<a name="l03506"></a>03506             <span class="keywordflow">if</span> (pbk32 == NULL)
<a name="l03507"></a>03507                <span class="keywordflow">break</span>;
<a name="l03508"></a>03508             bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk32-&gt;<a class="code" href="structBANK32.html#a048e3afc084c62bffb7af80f110c30c3">name</a>);
<a name="l03509"></a>03509             bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk32-&gt;<a class="code" href="group__midasincludecode.html#ga24b3068dc97237c8525e2188586a2c1b">type</a>;
<a name="l03510"></a>03510          } <span class="keywordflow">else</span> {
<a name="l03511"></a>03511             size = <a class="code" href="group__msectionh.html#gab47ee14db38356b8392632ba94b559d8">bk_iterate</a>(pbh, &amp;pbk, &amp;pdata);
<a name="l03512"></a>03512             <span class="keywordflow">if</span> (pbk == NULL)
<a name="l03513"></a>03513                <span class="keywordflow">break</span>;
<a name="l03514"></a>03514             bkname = *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pbk-&gt;<a class="code" href="structBANK.html#a39a277bc7edde0d3e783ef0d93f44c1e">name</a>);
<a name="l03515"></a>03515             bktype = (<a class="code" href="unionWORD.html">WORD</a>) pbk-&gt;<a class="code" href="group__midasincludecode.html#ga91558478db8ed86d585715b8217ca72f">type</a>;
<a name="l03516"></a>03516          }
<a name="l03517"></a>03517 
<a name="l03518"></a>03518          n_data = size;
<a name="l03519"></a>03519          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#gaa0bf5cc257f83e9a7f3936738fe009f3">rpc_tid_size</a>(bktype &amp; 0xFF))
<a name="l03520"></a>03520             n_data /= <a class="code" href="group__msectionh.html#gaa0bf5cc257f83e9a7f3936738fe009f3">rpc_tid_size</a>(bktype &amp; 0xFF);
<a name="l03521"></a>03521 
<a name="l03522"></a>03522          <span class="comment">/* get bank key */</span>
<a name="l03523"></a>03523          *((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) name) = bkname;
<a name="l03524"></a>03524          name[4] = 0;
<a name="l03525"></a>03525 
<a name="l03526"></a>03526          status = <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, event_def-&gt;<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a>, name, &amp;hKeyRoot);
<a name="l03527"></a>03527          <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l03528"></a>03528             <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_odb&quot;</span>, <span class="stringliteral">&quot;received unknown bank %s&quot;</span>, name);
<a name="l03529"></a>03529             <span class="keywordflow">continue</span>;
<a name="l03530"></a>03530          }
<a name="l03531"></a>03531 
<a name="l03532"></a>03532          <span class="keywordflow">if</span> (bktype == <a class="code" href="group__mdefineh.html#ga8d82076a05b53876103e1c53d5878b75">TID_STRUCT</a>) {
<a name="l03533"></a>03533             <span class="comment">/* write structured bank */</span>
<a name="l03534"></a>03534             <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l03535"></a>03535                status = <a class="code" href="group__msectionh.html#ga5a2a739267f29b1b1d86c5f9b25ff487">db_enum_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, i, &amp;hKey);
<a name="l03536"></a>03536                <span class="keywordflow">if</span> (status == <a class="code" href="group__err23.html#gaf2249d36fd8ffb254cd33a3bbc899638">DB_NO_MORE_SUBKEYS</a>)
<a name="l03537"></a>03537                   <span class="keywordflow">break</span>;
<a name="l03538"></a>03538 
<a name="l03539"></a>03539                <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, &amp;key);
<a name="l03540"></a>03540 
<a name="l03541"></a>03541                <span class="comment">/* adjust for alignment */</span>
<a name="l03542"></a>03542                <span class="keywordflow">if</span> (key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a> != <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a> &amp;&amp; key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a> != <a class="code" href="group__mdefineh.html#gaa63f41f547c7f46f828aaf35073807ea">TID_LINK</a>)
<a name="l03543"></a>03543                   pdata =
<a name="l03544"></a>03544                       (<span class="keywordtype">void</span> *) <a class="code" href="group__mmacroh.html#ga03bfa072452094d4d31ce3d304438f14">VALIGN</a>(pdata, <a class="code" href="Mql_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="group__msystemincludecode.html#gabae408f8715e9063be5cdf650a699282">ss_get_struct_align</a>(), key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a>));
<a name="l03545"></a>03545 
<a name="l03546"></a>03546                status = <a class="code" href="group__msectionh.html#ga6b98aa5ac9036c49023c0cc9353922d4">db_set_data</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKey, pdata, key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a> * key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>,
<a name="l03547"></a>03547                                     key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l03548"></a>03548                <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l03549"></a>03549                   <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_odb&quot;</span>, <span class="stringliteral">&quot;cannot write %s to ODB&quot;</span>, name);
<a name="l03550"></a>03550                   <span class="keywordflow">continue</span>;
<a name="l03551"></a>03551                }
<a name="l03552"></a>03552 
<a name="l03553"></a>03553                <span class="comment">/* shift data pointer to next item */</span>
<a name="l03554"></a>03554                pdata = (<span class="keywordtype">char</span> *) pdata + key.<a class="code" href="group__midasincludecode.html#gacd1951fdb8bf0dec79ef833f6dec9276">item_size</a> * key.<a class="code" href="group__midasincludecode.html#ga2604fa0fc38ce19b011785f806185a02">num_values</a>;
<a name="l03555"></a>03555             }
<a name="l03556"></a>03556          } <span class="keywordflow">else</span> {
<a name="l03557"></a>03557             <a class="code" href="group__msectionh.html#gab97e8d856c8089519a59d3e44c0c4e65">db_get_key</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, &amp;key);
<a name="l03558"></a>03558 
<a name="l03559"></a>03559             <span class="comment">/* write variable length bank  */</span>
<a name="l03560"></a>03560             <span class="keywordflow">if</span> (n_data &gt; 0) {
<a name="l03561"></a>03561                status = <a class="code" href="group__msectionh.html#ga6b98aa5ac9036c49023c0cc9353922d4">db_set_data</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, hKeyRoot, pdata, size, n_data, key.<a class="code" href="structKEY.html#a3360f9082d5083ea144f093d0cd774e3">type</a>);
<a name="l03562"></a>03562                <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l03563"></a>03563                   <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_odb&quot;</span>, <span class="stringliteral">&quot;cannot write %s to ODB&quot;</span>, name);
<a name="l03564"></a>03564                   <span class="keywordflow">continue</span>;
<a name="l03565"></a>03565                }
<a name="l03566"></a>03566             }
<a name="l03567"></a>03567          }
<a name="l03568"></a>03568       } <span class="keywordflow">while</span> (1);
<a name="l03569"></a>03569    }
<a name="l03570"></a>03570 
<a name="l03571"></a>03571   <span class="comment">/*---- FIXED format ----------------------------------------------*/</span>
<a name="l03572"></a>03572    <span class="keywordflow">if</span> (event_def-&gt;<a class="code" href="structEVENT__DEF.html#a341f5361543139655a35bcb1cdedf265">format</a> == <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a> &amp;&amp; !<a class="code" href="mana_8cpp.html#a7484bad03a04a43d5913b7a44f9e8199">clp</a>.online) {
<a name="l03573"></a>03573       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(<a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, event_def-&gt;<a class="code" href="structEVENT__DEF.html#a3289593eed2e93a8e2dd758252095ff6">hDefKey</a>, (<span class="keywordtype">char</span> *) (pevent + 1),
<a name="l03574"></a>03574                         pevent-&gt;<a class="code" href="group__midasincludecode.html#ga194220c29419e01ef4cab6d3dd8daedb">data_size</a>, 0) != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l03575"></a>03575          <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;write_event_odb&quot;</span>, <span class="stringliteral">&quot;event #%d size mismatch&quot;</span>, pevent-&gt;<a class="code" href="structEVENT__HEADER.html#a107bbb0fbe21582dc0f0e78f60b997b3">event_id</a>);
<a name="l03576"></a>03576    }
<a name="l03577"></a>03577 
<a name="l03578"></a>03578    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l03579"></a>03579 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a3eb68b44171b0cd2d0c55c51a10188a4"></a><!-- doxytag: member="mana.cpp::_current_par" ref="a3eb68b44171b0cd2d0c55c51a10188a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a>* <a class="el" href="mana__orig_8c.html#a3eb68b44171b0cd2d0c55c51a10188a4">_current_par</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03588">3588</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab1be3d7f64edcbf386bfd220bc7bda9b"></a><!-- doxytag: member="mana.cpp::analyze_request" ref="ab1be3d7f64edcbf386bfd220bc7bda9b" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structANALYZE__REQUEST.html">ANALYZE_REQUEST</a> <a class="el" href="mana__orig_8c.html#ab1be3d7f64edcbf386bfd220bc7bda9b">analyze_request</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00092">92</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8fd380b49c2d273b54ec6a6fb077d760"></a><!-- doxytag: member="mana.cpp::analyzer_loop_period" ref="a8fd380b49c2d273b54ec6a6fb077d760" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a8fd380b49c2d273b54ec6a6fb077d760">analyzer_loop_period</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00046">46</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac0643332f28f071aea7b0bd6c8d49a0c"></a><!-- doxytag: member="mana.cpp::analyzer_name" ref="ac0643332f28f071aea7b0bd6c8d49a0c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="mana__orig_8c.html#ac0643332f28f071aea7b0bd6c8d49a0c">analyzer_name</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00043">43</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7fce5fc9af5702ff4cbc3f25bde32347"></a><!-- doxytag: member="mana.cpp::bstr" ref="a7fce5fc9af5702ff4cbc3f25bde32347" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="mana__orig_8c.html#a7fce5fc9af5702ff4cbc3f25bde32347">bstr</a> = &quot; &quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00591">591</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4439d57afe08d556f78e4b0ba490c79a"></a><!-- doxytag: member="mana.cpp::clear_histos" ref="a4439d57afe08d556f78e4b0ba490c79a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> clear_histos</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00755">755</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7484bad03a04a43d5913b7a44f9e8199"></a><!-- doxytag: member="mana.cpp::clp" ref="a7484bad03a04a43d5913b7a44f9e8199" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="mana__orig_8c.html#aeb935d439102dc7df712bb4dea675747">clp</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04544">analyze_run()</a>, <a class="el" href="mana_8cpp_source.html#l04206">bevid_2_mheader()</a>, <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>, <a class="el" href="mana_8cpp_source.html#l02332">eor()</a>, <a class="el" href="mana_8cpp_source.html#l04009">load_last_histos()</a>, <a class="el" href="mana_8cpp_source.html#l01069">load_parameters()</a>, <a class="el" href="mana_8cpp_source.html#l04802">loop_runs_offline()</a>, <a class="el" href="mana_8cpp_source.html#l05702">main()</a>, <a class="el" href="mana_8cpp_source.html#l01935">mana_init()</a>, <a class="el" href="mana_8cpp_source.html#l04234">odb_load()</a>, <a class="el" href="mana_8cpp_source.html#l03596">process_event()</a>, <a class="el" href="mana_8cpp_source.html#l03861">register_requests()</a>, <a class="el" href="mana_8cpp_source.html#l03831">update_request()</a>, <a class="el" href="mana_8cpp_source.html#l02743">write_event_midas()</a>, and <a class="el" href="mana_8cpp_source.html#l03479">write_event_odb()</a>.</p>

</div>
</div>
<a class="anchor" id="ab39aaaee5cd095effe8aca0c1c4e4245"></a><!-- doxytag: member="mana.cpp::clp_descrip" ref="ab39aaaee5cd095effe8aca0c1c4e4245" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="mana__orig_8c.html#aa1809eb488f67e457e449787315d7b06">clp_descrip</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>.</p>

</div>
</div>
<a class="anchor" id="a09aab23bbdc57f08685183469f2c34f6"></a><!-- doxytag: member="mana.cpp::config_file_name" ref="a09aab23bbdc57f08685183469f2c34f6" args="[10][256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a09aab23bbdc57f08685183469f2c34f6">config_file_name</a>[10][256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00656">656</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a115cf2b067a8ad1c02c6b700dcb19775"></a><!-- doxytag: member="mana.cpp::current_run_number" ref="a115cf2b067a8ad1c02c6b700dcb19775" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="el" href="mana__orig_8c.html#a115cf2b067a8ad1c02c6b700dcb19775">current_run_number</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00613">613</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a96203468e98720f55cbede5bb1f8cffe"></a><!-- doxytag: member="mana.cpp::daemon" ref="a96203468e98720f55cbede5bb1f8cffe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00665">665</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l02042">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a735984d41155bc1032e09bece8f8d66d"></a><!-- doxytag: member="mana.cpp::data" ref="a735984d41155bc1032e09bece8f8d66d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* <a class="el" href="odbedit_8c.html#a8c6d6f90e1d6932f65c6f43d2f9d49a7">data</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00674">674</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a81f0a890e023743f1b88d0cb7d4f74db"></a><!-- doxytag: member="mana.cpp::debug" ref="a81f0a890e023743f1b88d0cb7d4f74db" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mspeaker_8c.html#a81f0a890e023743f1b88d0cb7d4f74db">debug</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00661">661</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="abf0f2b4c0e71c91c7405885282eb2c04"></a><!-- doxytag: member="mana.cpp::description" ref="abf0f2b4c0e71c91c7405885282eb2c04" args="[1000]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#abf0f2b4c0e71c91c7405885282eb2c04">description</a>[1000]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00673">673</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>.</p>

</div>
</div>
<a class="anchor" id="aff774cc3164dec02768f4104c5466c61"></a><!-- doxytag: member="mana.cpp::event_id" ref="aff774cc3164dec02768f4104c5466c61" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short int <a class="el" href="mzdump_8c.html#ac6d03005c20c7feabe0b6be6902f0a5e">event_id</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03584">3584</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af68e872de565f722d84950f339b26cb9"></a><!-- doxytag: member="mana.cpp::events_to_odb" ref="af68e872de565f722d84950f339b26cb9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#af68e872de565f722d84950f339b26cb9">events_to_odb</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00757">757</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a11eee1a5e2cef985b90bdfe0bfc8cf76"></a><!-- doxytag: member="mana.cpp::exp_name" ref="a11eee1a5e2cef985b90bdfe0bfc8cf76" args="[NAME_LENGTH]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mhttpd_8c.html#a2f66ab590c0bf6aa5385f2c964eef5fe">exp_name</a>[NAME_LENGTH]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00647">647</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a258adbf16b88a7db88c7d8bce9708c50"></a><!-- doxytag: member="mana.cpp::filename" ref="a258adbf16b88a7db88c7d8bce9708c50" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a258adbf16b88a7db88c7d8bce9708c50">filename</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00751">751</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acd79c70e7b9dbde81f9a618bed1245e5"></a><!-- doxytag: member="mana.cpp::filter" ref="acd79c70e7b9dbde81f9a618bed1245e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#acd79c70e7b9dbde81f9a618bed1245e5">filter</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00654">654</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a01d765415b8b865701ba44d771870744"></a><!-- doxytag: member="mana.cpp::flag_char" ref="a01d765415b8b865701ba44d771870744" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a01d765415b8b865701ba44d771870744">flag_char</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00672">672</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>.</p>

</div>
</div>
<a class="anchor" id="a52bbe25f799ffa103a99650e3abd4e5e"></a><!-- doxytag: member="mana.cpp::global_memory_name" ref="a52bbe25f799ffa103a99650e3abd4e5e" args="[8]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a52bbe25f799ffa103a99650e3abd4e5e">global_memory_name</a>[8]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00758">758</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4c4543fab10c0a1dc56223711d62f023"></a><!-- doxytag: member="mana.cpp::graphics" ref="a4c4543fab10c0a1dc56223711d62f023" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana_8cpp.html#a4c4543fab10c0a1dc56223711d62f023">graphics</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00655">655</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a224d67b5dbc75c0db41de55f1869544f"></a><!-- doxytag: member="mana.cpp::hbook_types" ref="a224d67b5dbc75c0db41de55f1869544f" args="[][8]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a224d67b5dbc75c0db41de55f1869544f">hbook_types</a>[][8]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   <span class="stringliteral">&quot;&quot;</span>,
   <span class="stringliteral">&quot;:U:8&quot;</span>,                      
   <span class="stringliteral">&quot;:I:8&quot;</span>,                      
   <span class="stringliteral">&quot;:I:8&quot;</span>,                      
   <span class="stringliteral">&quot;:U:16&quot;</span>,                     
   <span class="stringliteral">&quot;:I:16&quot;</span>,                     
   <span class="stringliteral">&quot;:U*4&quot;</span>,                      
   <span class="stringliteral">&quot;:I*4&quot;</span>,                      
   <span class="stringliteral">&quot;:I*4&quot;</span>,                      
   <span class="stringliteral">&quot;:R*4&quot;</span>,                      
   <span class="stringliteral">&quot;:R*8&quot;</span>,                      
   <span class="stringliteral">&quot;:U:8&quot;</span>,                      
   <span class="stringliteral">&quot;:C:32&quot;</span>,                     
   <span class="stringliteral">&quot;&quot;</span>,                          
   <span class="stringliteral">&quot;&quot;</span>,                          
   <span class="stringliteral">&quot;&quot;</span>,                          
   <span class="stringliteral">&quot;&quot;</span>,                          
   <span class="stringliteral">&quot;&quot;</span>,                          

}
</pre></div>
<p>Definition at line <a class="el" href="mana_8cpp_source.html#l01132">1132</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab1f60c53f74e806a3b9f687af38d7421"></a><!-- doxytag: member="mana.cpp::hDB" ref="ab1f60c53f74e806a3b9f687af38d7421" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00610">610</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6cddf80902f55138cf944ed06cbcbd61"></a><!-- doxytag: member="mana.cpp::histo_dump" ref="a6cddf80902f55138cf944ed06cbcbd61" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#a6cddf80902f55138cf944ed06cbcbd61">histo_dump</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00753">753</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a81e1be5cc336f24597a82cfa087c1ac3"></a><!-- doxytag: member="mana.cpp::histo_dump_filename" ref="a81e1be5cc336f24597a82cfa087c1ac3" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a81e1be5cc336f24597a82cfa087c1ac3">histo_dump_filename</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00754">754</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af65cc3664520b7cd0817adc7106f9624"></a><!-- doxytag: member="mana.cpp::host_name" ref="af65cc3664520b7cd0817adc7106f9624" args="[HOST_NAME_LENGTH]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#af30d16605d5c80183cd199983a653081">host_name</a>[HOST_NAME_LENGTH]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00646">646</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a312c2cad451d6bb0536fb9ec2863be59"></a><!-- doxytag: member="mana.cpp::index" ref="a312c2cad451d6bb0536fb9ec2863be59" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a312c2cad451d6bb0536fb9ec2863be59">index</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00677">677</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="midas_8c_source.html#l15975">al_evaluate_condition()</a>, <a class="el" href="midas_8c_source.html#l07429">bm_check_buffers()</a>, <a class="el" href="midas_8c_source.html#l04611">bm_close_buffer()</a>, <a class="el" href="midas_8c_source.html#l07751">bm_empty_buffers()</a>, <a class="el" href="midas_8c_source.html#l07495">bm_mark_read_waiting()</a>, <a class="el" href="midas_8c_source.html#l04389">bm_open_buffer()</a>, <a class="el" href="midas_8c_source.html#l05852">bm_request_event()</a>, <a class="el" href="fal_8c_source.html#l02926">book_ntuples()</a>, <a class="el" href="caen170a_8c_source.html#l00309">caen170a()</a>, <a class="el" href="midas_8c_source.html#l01976">cm_set_client_info()</a>, <a class="el" href="midas_8c_source.html#l03000">cm_set_watchdog_params()</a>, <a class="el" href="midas_8c_source.html#l03579">cm_transition()</a>, <a class="el" href="lazylogger_8c_source.html#l01071">condition_test()</a>, <a class="el" href="mscbutil_8c_source.html#l00187">crc8()</a>, <a class="el" href="mscbutil_8c_source.html#l00217">crc8_add()</a>, <a class="el" href="odbedit_8c_source.html#l01099">create_experim_h()</a>, <a class="el" href="odb_8c_source.html#l01305">db_close_database()</a>, <a class="el" href="odb_8c_source.html#l01422">db_flush_database()</a>, <a class="el" href="fal_8c_source.html#l00769">db_get_event_definition()</a>, <a class="el" href="odb_8c_source.html#l00993">db_open_database()</a>, <a class="el" href="odb_8c_source.html#l07741">db_open_record()</a>, <a class="el" href="odb_8c_source.html#l07025">db_remove_open_record()</a>, <a class="el" href="odb_8c_source.html#l05772">db_save_tree_struct()</a>, <a class="el" href="odb_8c_source.html#l05976">db_save_xml_key()</a>, <a class="el" href="odb_8c_source.html#l01536">db_set_client_name()</a>, <a class="el" href="midas_8c_source.html#l15064">el_submit()</a>, <a class="el" href="ybos_8c_source.html#l00796">feodb_file_dump()</a>, <a class="el" href="mgd_8c_source.html#l02601">gdImageSetBrush()</a>, <a class="el" href="generic_8c_source.html#l00214">gen_init()</a>, <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>, <a class="el" href="midas_8c_source.html#l13463">hs_define_event()</a>, <a class="el" href="midas_8c_source.html#l14339">hs_read()</a>, <a class="el" href="midas_8c_source.html#l13688">hs_write_event()</a>, <a class="el" href="hv_8c_source.html#l00419">hv_init()</a>, <a class="el" href="mhttpd_8c_source.html#l09142">interprete()</a>, <a class="el" href="mana_8cpp_source.html#l01069">load_parameters()</a>, <a class="el" href="fal_8c_source.html#l01945">log_system_history()</a>, <a class="el" href="lrs2415_8c_source.html#l00149">lrs2415()</a>, <a class="el" href="lrs4032_8c_source.html#l00319">lrs4032()</a>, <a class="el" href="mhist_8c_source.html#l00455">main()</a>, <a class="el" href="MCaenCompProcessRaw_8cpp_source.html#l00211">MCaenCompProcessRaw()</a>, <a class="el" href="analyzer_2md5-lib_2md5_8c_source.html#l00164">MD5Final()</a>, <a class="el" href="analyzer_2md5-lib_2md5_8c_source.html#l00122">MD5Update()</a>, <a class="el" href="rpc_8c_source.html#l00756">mrpc_call()</a>, <a class="el" href="rpc_8c_source.html#l00487">mrpc_execute()</a>, <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>, <a class="el" href="odbhist_8c_source.html#l00087">odb_hist()</a>, <a class="el" href="fal_8c_source.html#l01573">open_history()</a>, <a class="el" href="stck__compress_8cpp_source.html#l00341">print_TPCstack_interval()</a>, <a class="el" href="mdump_8c_source.html#l00313">process_event()</a>, <a class="el" href="midas_8c_source.html#l10835">recv_event_check()</a>, <a class="el" href="midas_8c_source.html#l10624">recv_tcp_check()</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00554">register_equipment()</a>, <a class="el" href="fal_8c_source.html#l03837">register_requests()</a>, <a class="el" href="midas_8c_source.html#l09810">rpc_call()</a>, <a class="el" href="midas_8c_source.html#l12486">rpc_check_channels()</a>, <a class="el" href="midas_8c_source.html#l11860">rpc_client_accept()</a>, <a class="el" href="midas_8c_source.html#l09519">rpc_client_call()</a>, <a class="el" href="midas_8c_source.html#l08416">rpc_client_connect()</a>, <a class="el" href="midas_8c_source.html#l10990">rpc_execute()</a>, <a class="el" href="midas_8c_source.html#l11292">rpc_execute_ascii()</a>, <a class="el" href="midas_8c_source.html#l11616">rpc_server_accept()</a>, <a class="el" href="midas_8c_source.html#l11980">rpc_server_callback()</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l01446">scheduler()</a>, <a class="el" href="lcwp950_8c_source.html#l00128">scope_open()</a>, <a class="el" href="mhttpd_8c_source.html#l06375">show_alarm_page()</a>, <a class="el" href="mhttpd_8c_source.html#l05192">show_custom_page()</a>, <a class="el" href="mhttpd_8c_source.html#l04103">show_elog_page()</a>, <a class="el" href="mhttpd_8c_source.html#l03003">show_elog_submit_query()</a>, <a class="el" href="mhttpd_8c_source.html#l08158">show_hist_config_page()</a>, <a class="el" href="mhttpd_8c_source.html#l08606">show_hist_page()</a>, <a class="el" href="system_8c_source.html#l03549">ss_resume()</a>, <a class="el" href="system_8c_source.html#l03283">ss_suspend()</a>, <a class="el" href="system_8c_source.html#l03061">ss_suspend_get_index()</a>, <a class="el" href="system_8c_source.html#l03245">ss_suspend_get_port()</a>, <a class="el" href="mhttpd_8c_source.html#l03805">submit_elog()</a>, <a class="el" href="mtape_8c_source.html#l00068">tape_dir()</a>, <a class="el" href="mtape_8c_source.html#l00156">tape_restore()</a>, <a class="el" href="fal_8c_source.html#l02085">tr_start1()</a>, <a class="el" href="hvr__200_8c_source.html#l00251">user_write()</a>, and <a class="el" href="scs__900_8c_source.html#l00239">write_dac()</a>.</p>

</div>
</div>
<a class="anchor" id="a96deaa7886d0996592e850e04aea1795"></a><!-- doxytag: member="mana.cpp::input_file_name" ref="a96deaa7886d0996592e850e04aea1795" args="[10][256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a96deaa7886d0996592e850e04aea1795">input_file_name</a>[10][256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00648">648</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04802">loop_runs_offline()</a>.</p>

</div>
</div>
<a class="anchor" id="aa43b224cec5b9bf4a8feb7fd364b9a7f"></a><!-- doxytag: member="mana.cpp::last_histo_filename" ref="aa43b224cec5b9bf4a8feb7fd364b9a7f" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#aa43b224cec5b9bf4a8feb7fd364b9a7f">last_histo_filename</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00756">756</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5fecce64b1b883ada4ac0bc410fb3304"></a><!-- doxytag: member="mana.cpp::last_time" ref="a5fecce64b1b883ada4ac0bc410fb3304" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="el" href="mana__orig_8c.html#a5fecce64b1b883ada4ac0bc410fb3304">last_time</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l03585">3585</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aeba26f087848182d6f60b129fad82744"></a><!-- doxytag: member="mana.cpp::last_time_event" ref="aeba26f087848182d6f60b129fad82744" args="[50]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="mana__orig_8c.html#ae7c8e12484c09d557f8ee8f1395a2d6d">last_time_event</a>[50]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a32357ef75116a47e988625b8d78ecfc5"></a><!-- doxytag: member="mana.cpp::lock_list" ref="a32357ef75116a47e988625b8d78ecfc5" args="[10000]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a32357ef75116a47e988625b8d78ecfc5">lock_list</a>[10000]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00622">622</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a57f54b03009e95624f04afab052e6f2e"></a><!-- doxytag: member="mana.cpp::lrec" ref="a57f54b03009e95624f04afab052e6f2e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a57f54b03009e95624f04afab052e6f2e">lrec</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00660">660</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l02079">bor()</a>.</p>

</div>
</div>
<a class="anchor" id="a6eaf70ed949e0b77f861573ffb313975"></a><!-- doxytag: member="mana.cpp::mias_tree_output_file_name" ref="a6eaf70ed949e0b77f861573ffb313975" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana_8cpp.html#a6eaf70ed949e0b77f861573ffb313975">mias_tree_output_file_name</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00651">651</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a228a29e4d9ddfb6bc4994455a321bdc4"></a><!-- doxytag: member="mana.cpp::n" ref="a228a29e4d9ddfb6bc4994455a321bdc4" args="[4]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a228a29e4d9ddfb6bc4994455a321bdc4">n</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00653">653</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="abd4c58430e4e44ed3162b1beae228971"></a><!-- doxytag: member="mana.cpp::n_task" ref="abd4c58430e4e44ed3162b1beae228971" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#abd4c58430e4e44ed3162b1beae228971">n_task</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00666">666</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afc7da5af4f263536aae9ad609dea1a26"></a><!-- doxytag: member="mana.cpp::n_test" ref="afc7da5af4f263536aae9ad609dea1a26" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="mana__orig_8c.html#afc7da5af4f263536aae9ad609dea1a26">n_test</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00990">990</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afb9f83013556b16cc1f547e955188356"></a><!-- doxytag: member="mana.cpp::no_load" ref="afb9f83013556b16cc1f547e955188356" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#afb9f83013556b16cc1f547e955188356">no_load</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00664">664</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="addcec48ded248cb150b9ded486f01da8"></a><!-- doxytag: member="mana.cpp::now_stopping" ref="addcec48ded248cb150b9ded486f01da8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#addcec48ded248cb150b9ded486f01da8">now_stopping</a> = FALSE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00625">625</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acad1970d3f9313bf7782eb6ae587c9a7"></a><!-- doxytag: member="mana.cpp::ntuple_flag" ref="acad1970d3f9313bf7782eb6ae587c9a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#acad1970d3f9313bf7782eb6ae587c9a7">ntuple_flag</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00619">619</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7503268889a084b74a968787ffc025b7"></a><!-- doxytag: member="mana.cpp::odb_size" ref="a7503268889a084b74a968787ffc025b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a7503268889a084b74a968787ffc025b7">odb_size</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="analyzer_8cpp_source.html#l00049">49</a> of file <a class="el" href="analyzer_8cpp_source.html">analyzer.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7fd54785c88eccf892c6aa8d5f6e78d0"></a><!-- doxytag: member="mana.cpp::online" ref="a7fd54785c88eccf892c6aa8d5f6e78d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a7fd54785c88eccf892c6aa8d5f6e78d0">online</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00645">645</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="ces8210_8c_source.html#l00597">btb()</a>, <a class="el" href="ces8210_8c_source.html#l00589">car()</a>, and <a class="el" href="ces8210_8c_source.html#l00581">csr()</a>.</p>

</div>
</div>
<a class="anchor" id="abbc229a696029d540d0e1261e0fd6880"></a><!-- doxytag: member="mana.cpp::out_append" ref="abbc229a696029d540d0e1261e0fd6880" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#abbc229a696029d540d0e1261e0fd6880">out_append</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00764">764</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab297e8b6af734888d3dc2cfe335a9d44"></a><!-- doxytag: member="mana.cpp::out_file" ref="ab297e8b6af734888d3dc2cfe335a9d44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE* <a class="el" href="mana__orig_8c.html#ab297e8b6af734888d3dc2cfe335a9d44">out_file</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00761">761</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a57462a01b2494cba89ae18620110c130"></a><!-- doxytag: member="mana.cpp::out_format" ref="a57462a01b2494cba89ae18620110c130" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a57462a01b2494cba89ae18620110c130">out_format</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00763">763</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae6891eb430d9160a128f56a01e10f4dc"></a><!-- doxytag: member="mana.cpp::out_gzip" ref="ae6891eb430d9160a128f56a01e10f4dc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#ae6891eb430d9160a128f56a01e10f4dc">out_gzip</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00762">762</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af48fec10884611e9085a1d6e43362687"></a><!-- doxytag: member="mana.cpp::out_info" ref="af48fec10884611e9085a1d6e43362687" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="mana__orig_8c.html#a72916f84b085060f4e054fff89ff60db">out_info</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1be2956569ea7201e80da80d2517ae0f"></a><!-- doxytag: member="mana.cpp::output_file_name" ref="a1be2956569ea7201e80da80d2517ae0f" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a1be2956569ea7201e80da80d2517ae0f">output_file_name</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00649">649</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="mana_8cpp_source.html#l04802">loop_runs_offline()</a>.</p>

</div>
</div>
<a class="anchor" id="a6dadda9a6f1103026d1d128fe203aa9a"></a><!-- doxytag: member="mana.cpp::param" ref="a6dadda9a6f1103026d1d128fe203aa9a" args="[10][256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>[10][256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00657">657</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="msc_8c_source.html#l00462">cmd_loop()</a>, <a class="el" href="odbedit_8c_source.html#l01415">command_loop()</a>, <a class="el" href="rpc_8c_source.html#l00756">mrpc_call()</a>, <a class="el" href="rpc_8c_source.html#l00487">mrpc_execute()</a>, <a class="el" href="midas_8c_source.html#l09810">rpc_call()</a>, <a class="el" href="midas_8c_source.html#l09519">rpc_client_call()</a>, <a class="el" href="midas_8c_source.html#l10990">rpc_execute()</a>, and <a class="el" href="midas_8c_source.html#l11292">rpc_execute_ascii()</a>.</p>

</div>
</div>
<a class="anchor" id="a145953d65e4f33a2308075f26c13bfbe"></a><!-- doxytag: member="mana.cpp::pawc_size" ref="a145953d65e4f33a2308075f26c13bfbe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a145953d65e4f33a2308075f26c13bfbe">pawc_size</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7016f372863223b54ca53ae070701a94"></a><!-- doxytag: member="mana.cpp::protect" ref="a7016f372863223b54ca53ae070701a94" args="[10][256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a7016f372863223b54ca53ae070701a94">protect</a>[10][256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00658">658</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="odb_8c_source.html#l01585">db_lock_database()</a>, and <a class="el" href="odb_8c_source.html#l01635">db_unlock_database()</a>.</p>

</div>
</div>
<a class="anchor" id="a9c6222f0920e2024e2371df707389e55"></a><!-- doxytag: member="mana.cpp::pvm_buf_size" ref="a9c6222f0920e2024e2371df707389e55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a9c6222f0920e2024e2371df707389e55">pvm_buf_size</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00667">667</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa4ff6bc44b442b662f294b78a74d22ce"></a><!-- doxytag: member="mana.cpp::pvm_master" ref="aa4ff6bc44b442b662f294b78a74d22ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#aa4ff6bc44b442b662f294b78a74d22ce">pvm_master</a> = FALSE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00589">589</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af945b9fcaabbb88495c742e84a4d3d39"></a><!-- doxytag: member="mana.cpp::pvm_slave" ref="af945b9fcaabbb88495c742e84a4d3d39" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#af945b9fcaabbb88495c742e84a4d3d39">pvm_slave</a> = FALSE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00589">589</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a54e2499cfb7a66c138ef6c0e1b4714f4"></a><!-- doxytag: member="mana.cpp::QUEST" ref="a54e2499cfb7a66c138ef6c0e1b4714f4" args="[100]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="mana__orig_8c.html#a54e2499cfb7a66c138ef6c0e1b4714f4">QUEST</a>[100]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a34e0e7602d9696c3f499540a59d06a36"></a><!-- doxytag: member="mana.cpp::quiet" ref="a34e0e7602d9696c3f499540a59d06a36" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="odbhist_8c.html#add9f830fa0deed81135df2bae30c3166">quiet</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00663">663</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="odbhist_8c_source.html#l00223">load_pars_from_file()</a>, and <a class="el" href="odbhist_8c_source.html#l00376">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a92facc49fbf15b92029c0c7dac1a8d35"></a><!-- doxytag: member="mana.cpp::root_port" ref="a92facc49fbf15b92029c0c7dac1a8d35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a92facc49fbf15b92029c0c7dac1a8d35">root_port</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00668">668</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a172a606e5fbb7290c1e2a89d0f2d39d0"></a><!-- doxytag: member="mana.cpp::run_number" ref="a172a606e5fbb7290c1e2a89d0f2d39d0" args="[2]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mlogger_8c.html#a7515080fe161c8c4d6029c889f02564a">run_number</a>[2]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00652">652</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae9487d607449dedf95bca2636c33b5d3"></a><!-- doxytag: member="mana.cpp::rwnt" ref="ae9487d607449dedf95bca2636c33b5d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mana__orig_8c.html#ae9487d607449dedf95bca2636c33b5d3">rwnt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00659">659</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a24b25d290fef8bf6c0b21bfbbb4fefdd"></a><!-- doxytag: member="mana.cpp::secondary_output_file_name" ref="a24b25d290fef8bf6c0b21bfbbb4fefdd" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="mana__orig_8c.html#a24b25d290fef8bf6c0b21bfbbb4fefdd">secondary_output_file_name</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00650">650</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8d48fae6c3a349ad62641f44252fb21e"></a><!-- doxytag: member="mana.cpp::tl" ref="a8d48fae6c3a349ad62641f44252fb21e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structANA__TEST.html">ANA_TEST</a>** <a class="el" href="mana__orig_8c.html#a8d48fae6c3a349ad62641f44252fb21e">tl</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00989">989</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9a59b4d9fa62abe25a78cc38137ffd8e"></a><!-- doxytag: member="mana.cpp::type" ref="a9a59b4d9fa62abe25a78cc38137ffd8e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="ybos_8c.html#a9a59b4d9fa62abe25a78cc38137ffd8e">type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00675">675</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

<p>Referenced by <a class="el" href="ModulesReader_8cpp_source.html#l00131">modules::reader::AddModule()</a>, <a class="el" href="midas_8c_source.html#l13132">bk_swap()</a>, <a class="el" href="mana_8cpp_source.html#l00893">db_get_event_definition()</a>, <a class="el" href="mhist_8c_source.html#l00341">display_range_hist()</a>, <a class="el" href="mhist_8c_source.html#l00296">display_single_hist()</a>, <a class="el" href="slowcontrol_2epics__beamline__frontend_2epics__ca_8c_source.html#l00567">epics_ca_event_handler()</a>, <a class="el" href="slowcontrol_2epics__beamline__frontend_2epics__ca_8c_source.html#l00777">epics_ca_init()</a>, <a class="el" href="slowcontrol_2epics__beamline__frontend_2epics__ca_8c_source.html#l01936">epics_ca_set()</a>, <a class="el" href="mhttpd_8c_source.html#l07289">generate_hist_graph()</a>, <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>, <a class="el" href="midas_8c_source.html#l14695">hs_dump()</a>, <a class="el" href="mevb_8cpp_source.html#l00292">load_fragment()</a>, <a class="el" href="ybos_8c_source.html#l03139">midas_bank_display()</a>, <a class="el" href="ybos_8c_source.html#l03355">midas_bank_display32()</a>, <a class="el" href="mscb_8c_source.html#l01909">mscb_addr()</a>, <a class="el" href="mscb_8c_source.html#l03243">mscb_echo()</a>, <a class="el" href="mscb_8c_source.html#l01750">mscb_exit()</a>, <a class="el" href="mscb_8c_source.html#l02626">mscb_flash()</a>, <a class="el" href="mscb_8c_source.html#l01800">mscb_get_device()</a>, <a class="el" href="mscb_8c_source.html#l01027">mscb_in()</a>, <a class="el" href="mscb_8c_source.html#l02156">mscb_info()</a>, <a class="el" href="mscb_8c_source.html#l02221">mscb_info_variable()</a>, <a class="el" href="mscb_8c_source.html#l01593">mscb_init()</a>, <a class="el" href="mscb_8c_source.html#l00567">mscb_lock()</a>, <a class="el" href="mscb_8c_source.html#l00805">mscb_out()</a>, <a class="el" href="mscb_8c_source.html#l02116">mscb_ping()</a>, <a class="el" href="mscb_8c_source.html#l02939">mscb_read()</a>, <a class="el" href="mscb_8c_source.html#l03060">mscb_read_range()</a>, <a class="el" href="mscb_8c_source.html#l02021">mscb_reboot()</a>, <a class="el" href="mscb_8c_source.html#l00597">mscb_release()</a>, <a class="el" href="mscb_8c_source.html#l02068">mscb_reset()</a>, <a class="el" href="mscb_8c_source.html#l02286">mscb_set_addr()</a>, <a class="el" href="mscb_8c_source.html#l02345">mscb_set_name()</a>, <a class="el" href="mscb_8c_source.html#l02686">mscb_upload()</a>, <a class="el" href="mscb_8c_source.html#l03154">mscb_user()</a>, <a class="el" href="mscb_8c_source.html#l02461">mscb_write()</a>, <a class="el" href="mscb_8c_source.html#l02549">mscb_write_block()</a>, <a class="el" href="mscb_8c_source.html#l02401">mscb_write_group()</a>, <a class="el" href="mserver_8c_source.html#l00534">rpc_server_dispatch()</a>, <a class="el" href="mhttpd_8c_source.html#l06375">show_alarm_page()</a>, <a class="el" href="mhttpd_8c_source.html#l02506">show_elog_new()</a>, <a class="el" href="mhttpd_8c_source.html#l04103">show_elog_page()</a>, <a class="el" href="mhttpd_8c_source.html#l03003">show_elog_submit_query()</a>, <a class="el" href="mhttpd_8c_source.html#l01641">show_status_page()</a>, <a class="el" href="jorway73a_8c_source.html#l01280">sjy_getdev()</a>, <a class="el" href="fal_8c_source.html#l02355">tr_poststop()</a>, <a class="el" href="mlogger_8c_source.html#l03140">tr_start()</a>, <a class="el" href="fal_8c_source.html#l02085">tr_start1()</a>, <a class="el" href="mlogger_8c_source.html#l03482">tr_stop()</a>, and <a class="el" href="ybos_8c_source.html#l02457">ybos_event_swap()</a>.</p>

</div>
</div>
<a class="anchor" id="ad023bbf13e60f8caee82c26f70e0f0a5"></a><!-- doxytag: member="mana.cpp::verbose" ref="ad023bbf13e60f8caee82c26f70e0f0a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> <a class="el" href="mtape_8c.html#ad023bbf13e60f8caee82c26f70e0f0a5">verbose</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="mana_8cpp_source.html#l00662">662</a> of file <a class="el" href="mana_8cpp_source.html">mana.cpp</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
