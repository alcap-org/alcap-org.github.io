<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ:Rootana: midas/mscb/embedded/scs_300.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/mscb/embedded/scs_300.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="mscb_8h_source.html">mscb.h</a>&quot;</code><br/>

<p><a href="scs__300_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a>&nbsp;&nbsp;&nbsp;<a class="el" href="c8051F320_8h.html#a064e921a8b02f66fd1e90b6b36298773">P1</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#af2a1082815a5427b7d89df59681ceb91">user_write</a> (unsigned char <a class="el" href="lazylogger_8c.html#a7728c597c88e0bc9b73912265b2f7665">channel</a>) reentrant</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a293b7420a34a7b13d299833fa698e90e">user_init</a> (unsigned char init)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#ac7daae8fd6b3ddc2c0af7b870472088f">user_read</a> (unsigned char <a class="el" href="mana__orig_8c.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#abc36d6fb31981dbb1b5effcc762dd9f8">user_func</a> (unsigned char *data_in, unsigned char *data_out)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a44a1bacb4c1429ca87f81505dea70451">putchar</a> (char <a class="el" href="show__pulses_8cxx.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a2d49bb61156b93c0f3b7b472559dbfd2">getchar_nowait</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a7901a7b6894714276aae0dc0433d60de">gets_wait</a> (char *<a class="el" href="scs__310__ql355p_8c.html#a11ea5cf64ae27c357c5bd2f2eaaddf7f">str</a>, unsigned char <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, unsigned char <a class="el" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a9c9fec92b60b251c275870d900294a4a">user_loop</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char code&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#aae648e1cdd0859a1085a358a3e1138c8">node_name</a> [] = &quot;SCS-300&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char idata&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a7aa4e7d188b6702a7e5e361e85731948">_n_sub_addr</a> = 1</td></tr>
<tr><td class="memItemLeft" >struct {</td></tr>
<tr><td class="memItemLeft" >&nbsp;&nbsp;&nbsp;float&nbsp;&nbsp;&nbsp;<a class="el" href="scs__300_8c.html#a6b330af43261f372e7d0f540d1842871">value</a> [4]</td></tr>
<tr><td class="memItemLeft" valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a2aae1461214f1802779261dcd5e09d3a">user_data</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMSCB__INFO__VAR.html">MSCB_INFO_VAR</a> code&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a900ff3a8ccab65692c28b012e3824819">variables</a> []</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#abbb83f3515aae816313940922814a252">LPT_STROBE</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a9c4f3ce1e69a71faffd91ebf3530b74a">LPT_INIT</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a6398a7c34611b227331581e463246d5e">LPT_SELECT</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a5dc5637989f0d57598ea2c98922ce194">LPT_ACK</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 6</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sbit&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="scs__300_8c.html#a525c7d69d4a55d502b0d18c0603ebf29">LPT_BUSY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 7</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a6af65dc12cf6bc85ad69e35c8e2ac021"></a><!-- doxytag: member="scs_300.c::LPT_DATA" ref="a6af65dc12cf6bc85ad69e35c8e2ac021" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LPT_DATA&nbsp;&nbsp;&nbsp;<a class="el" href="c8051F320_8h.html#a064e921a8b02f66fd1e90b6b36298773">P1</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00086">86</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>Referenced by <a class="el" href="subm__300_8c_source.html#l00181">check_lpt()</a>, <a class="el" href="subm__300_8c_source.html#l00224">check_rs485()</a>, <a class="el" href="scs__300_8c_source.html#l00164">getchar_nowait()</a>, <a class="el" href="scs__300_8c_source.html#l00141">putchar()</a>, <a class="el" href="subm__300_8c_source.html#l00093">setup()</a>, and <a class="el" href="scs__300_8c_source.html#l00101">user_init()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2d49bb61156b93c0f3b7b472559dbfd2"></a><!-- doxytag: member="scs_300.c::getchar_nowait" ref="a2d49bb61156b93c0f3b7b472559dbfd2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char getchar_nowait </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00164">164</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="patch__mevb_8cpp_source.html#l00003">c</a>, <a class="el" href="mscb_8c_source.html#l00325">LPT_BUSY</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, and <a class="el" href="scs__300_8c_source.html#l00091">LPT_SELECT</a>.</p>

<p>Referenced by <a class="el" href="scs__300_8c_source.html#l00185">gets_wait()</a>, <a class="el" href="scs__210_8c_source.html#l00191">user_loop()</a>, and <a class="el" href="scs__210_8c_source.html#l00146">user_read()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00165"></a>00165 {
<a name="l00166"></a>00166    <span class="keywordtype">char</span> <a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168    <span class="comment">/* if busy signal high -&gt; no data */</span>
<a name="l00169"></a>00169    <span class="keywordflow">if</span> (<a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> == 1)
<a name="l00170"></a>00170       <span class="keywordflow">return</span> -1;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172    <span class="comment">/* read byte */</span>
<a name="l00173"></a>00173    c = <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a>;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175    <span class="comment">/* singal received data */</span>
<a name="l00176"></a>00176    <a class="code" href="scs__300_8c.html#a6398a7c34611b227331581e463246d5e">LPT_SELECT</a> = 0;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178    <span class="comment">/* wait for busy go high */</span>
<a name="l00179"></a>00179    <span class="keywordflow">while</span> (<a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> == 0);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181    <span class="comment">/* remove select */</span>
<a name="l00182"></a>00182    <a class="code" href="scs__300_8c.html#a6398a7c34611b227331581e463246d5e">LPT_SELECT</a> = 1;
<a name="l00183"></a>00183 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7901a7b6894714276aae0dc0433d60de"></a><!-- doxytag: member="scs_300.c::gets_wait" ref="a7901a7b6894714276aae0dc0433d60de" args="(char *str, unsigned char size, unsigned char timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char gets_wait </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00185">185</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="patch__mevb_8cpp_source.html#l00003">c</a>, <a class="el" href="scs__300_8c_source.html#l00164">getchar_nowait()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="CAET_8h_source.html#l00002">time</a>, and <a class="el" href="mscbmain_8c_source.html#l01361">yield()</a>.</p>

<p>Referenced by <a class="el" href="scs__210__tc600_8c_source.html#l00176">tc600_read()</a>, <a class="el" href="scs__210__tc600_8c_source.html#l00205">tc600_write()</a>, and <a class="el" href="scs__300_8c_source.html#l00214">user_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00186"></a>00186 {
<a name="l00187"></a>00187    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> idata start;
<a name="l00188"></a>00188    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00189"></a>00189    <span class="keywordtype">char</span> <a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    start = <a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>();
<a name="l00192"></a>00192    i = 0;
<a name="l00193"></a>00193    <span class="keywordflow">do</span> {
<a name="l00194"></a>00194       c = <a class="code" href="embedded_2mscb_8h.html#a068ffb5f8f5e993bc4a368007e73be38">getchar_nowait</a>();
<a name="l00195"></a>00195       <span class="keywordflow">if</span> (c != -1 &amp;&amp; c != <span class="charliteral">&apos;\n&apos;</span>) {
<a name="l00196"></a>00196          <span class="keywordflow">if</span> (c == <span class="charliteral">&apos;\r&apos;</span>) {
<a name="l00197"></a>00197             <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i] = 0;
<a name="l00198"></a>00198             <span class="keywordflow">return</span> i;
<a name="l00199"></a>00199          }
<a name="l00200"></a>00200          <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i++] = c;
<a name="l00201"></a>00201          <span class="keywordflow">if</span> (i == <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>)
<a name="l00202"></a>00202             <span class="keywordflow">return</span> i;
<a name="l00203"></a>00203       }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205       <a class="code" href="embedded_2mscb_8h.html#a7cb51f5c2b5cad3766f19eb69c92793b">yield</a>();
<a name="l00206"></a>00206 
<a name="l00207"></a>00207    } <span class="keywordflow">while</span> (<a class="code" href="CAET_8h.html#ab2d5aa7fce1a14d8bddfb2c333ea9679">time</a>() &lt; start + <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209    <span class="keywordflow">return</span> 0;
<a name="l00210"></a>00210 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a44a1bacb4c1429ca87f81505dea70451"></a><!-- doxytag: member="scs_300.c::putchar" ref="a44a1bacb4c1429ca87f81505dea70451" args="(char c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char putchar </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00141">141</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="mscb_8c_source.html#l00320">LPT_ACK</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, and <a class="el" href="mscb_8c_source.html#l00319">LPT_STROBE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00142"></a>00142 {
<a name="l00143"></a>00143    <span class="comment">/* wait for acknowledge to go low */</span>
<a name="l00144"></a>00144    <span class="keywordflow">while</span> (<a class="code" href="mscb_8c.html#abf3d598389a18a54466f7aa8ffed86fc">LPT_ACK</a>);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146    <span class="comment">/* output data */</span>
<a name="l00147"></a>00147    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = <a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a>;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149    <span class="comment">/* negative strobe */</span>
<a name="l00150"></a>00150    <a class="code" href="mscb_8c.html#aa7b693ad182550b835a69b0fbd6bd2db">LPT_STROBE</a> = 0;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152    <span class="comment">/* wati for acknowledge to go high */</span>
<a name="l00153"></a>00153    <span class="keywordflow">while</span> (!<a class="code" href="mscb_8c.html#abf3d598389a18a54466f7aa8ffed86fc">LPT_ACK</a>);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155    <span class="comment">/* remove strobe */</span>
<a name="l00156"></a>00156    <a class="code" href="mscb_8c.html#aa7b693ad182550b835a69b0fbd6bd2db">LPT_STROBE</a> = 1;
<a name="l00157"></a>00157 
<a name="l00158"></a>00158    <span class="comment">/* clear data for next input */</span>
<a name="l00159"></a>00159    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = 0xFF;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161    <span class="keywordflow">return</span> <a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a>;
<a name="l00162"></a>00162 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abc36d6fb31981dbb1b5effcc762dd9f8"></a><!-- doxytag: member="scs_300.c::user_func" ref="abc36d6fb31981dbb1b5effcc762dd9f8" args="(unsigned char *data_in, unsigned char *data_out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char user_func </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data_out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00131">131</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00132"></a>00132 {
<a name="l00133"></a>00133    <span class="comment">/* echo input data */</span>
<a name="l00134"></a>00134    data_out[0] = data_in[0];
<a name="l00135"></a>00135    data_out[1] = data_in[1];
<a name="l00136"></a>00136    <span class="keywordflow">return</span> 2;
<a name="l00137"></a>00137 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a293b7420a34a7b13d299833fa698e90e"></a><!-- doxytag: member="scs_300.c::user_init" ref="a293b7420a34a7b13d299833fa698e90e" args="(unsigned char init)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_init </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>init</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00101">101</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="mscb_8c_source.html#l00320">LPT_ACK</a>, <a class="el" href="mscb_8c_source.html#l00325">LPT_BUSY</a>, <a class="el" href="scs__300_8c_source.html#l00086">LPT_DATA</a>, <a class="el" href="scs__300_8c_source.html#l00090">LPT_INIT</a>, <a class="el" href="scs__300_8c_source.html#l00091">LPT_SELECT</a>, and <a class="el" href="mscb_8c_source.html#l00319">LPT_STROBE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00102"></a>00102 {
<a name="l00103"></a>00103    <span class="comment">/* set initial state of lines */</span>
<a name="l00104"></a>00104    <a class="code" href="scs__300_8c.html#a6af65dc12cf6bc85ad69e35c8e2ac021">LPT_DATA</a> = 0xFF;
<a name="l00105"></a>00105    <a class="code" href="mscb_8c.html#aa7b693ad182550b835a69b0fbd6bd2db">LPT_STROBE</a> = 1;
<a name="l00106"></a>00106    <a class="code" href="scs__300_8c.html#a9c4f3ce1e69a71faffd91ebf3530b74a">LPT_INIT</a> = 1;
<a name="l00107"></a>00107    <a class="code" href="scs__300_8c.html#a6398a7c34611b227331581e463246d5e">LPT_SELECT</a> = 1;
<a name="l00108"></a>00108    <a class="code" href="mscb_8c.html#abf3d598389a18a54466f7aa8ffed86fc">LPT_ACK</a> = 1;
<a name="l00109"></a>00109    <a class="code" href="mscb_8c.html#a9e6f01a3d42fa39fe5ce37f50beea147">LPT_BUSY</a> = 1;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111    <span class="keywordflow">if</span> (init);
<a name="l00112"></a>00112 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c9fec92b60b251c275870d900294a4a"></a><!-- doxytag: member="scs_300.c::user_loop" ref="a9c9fec92b60b251c275870d900294a4a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_loop </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00214">214</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="scs__300_8c_source.html#l00185">gets_wait()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="camac_8c_source.html#l00506">n</a>, and <a class="el" href="mscbmain_8c_source.html#l01361">yield()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00215"></a>00215 {
<a name="l00216"></a>00216    <span class="keywordtype">char</span> idata <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[32];
<a name="l00217"></a>00217    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219    <span class="keywordflow">return</span>;                      <span class="comment">// do not execute example code</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221    <span class="comment">/* this could be some example code to demonstrate a 4 chn readout */</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223    <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {
<a name="l00224"></a>00224       <span class="comment">/* send data request */</span>
<a name="l00225"></a>00225       printf(<span class="stringliteral">&quot;READ %d\r\n&quot;</span>, i); <span class="comment">// goes through putchar()</span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227       <span class="comment">/* wait for reply for 2 seconds */</span>
<a name="l00228"></a>00228       n = <a class="code" href="embedded_2mscb_8h.html#a7901a7b6894714276aae0dc0433d60de">gets_wait</a>(str, <span class="keyword">sizeof</span>(str), 200);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       <span class="comment">/* if correct response, interprete data */</span>
<a name="l00231"></a>00231  <span class="comment">//     if (n == 10)</span>
<a name="l00232"></a>00232  <span class="comment">//        user_data.value[i] = atof(str);</span>
<a name="l00233"></a>00233 
<a name="l00234"></a>00234       <a class="code" href="embedded_2mscb_8h.html#a7cb51f5c2b5cad3766f19eb69c92793b">yield</a>();
<a name="l00235"></a>00235    }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7daae8fd6b3ddc2c0af7b870472088f"></a><!-- doxytag: member="scs_300.c::user_read" ref="ac7daae8fd6b3ddc2c0af7b870472088f" args="(unsigned char index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char user_read </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>index</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00123">123</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00124"></a>00124 {
<a name="l00125"></a>00125    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>);
<a name="l00126"></a>00126    <span class="keywordflow">return</span> 0;
<a name="l00127"></a>00127 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af2a1082815a5427b7d89df59681ceb91"></a><!-- doxytag: member="scs_300.c::user_write" ref="af2a1082815a5427b7d89df59681ceb91" args="(unsigned char channel) reentrant" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void user_write </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>channel</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00116">116</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>References <a class="el" href="mana_8cpp_source.html#l00677">index</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00117"></a>00117 {
<a name="l00118"></a>00118    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>);
<a name="l00119"></a>00119 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a7aa4e7d188b6702a7e5e361e85731948"></a><!-- doxytag: member="scs_300.c::_n_sub_addr" ref="a7aa4e7d188b6702a7e5e361e85731948" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char idata <a class="el" href="scs__910_8c.html#a7aa4e7d188b6702a7e5e361e85731948">_n_sub_addr</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00061">61</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5dc5637989f0d57598ea2c98922ce194"></a><!-- doxytag: member="scs_300.c::LPT_ACK" ref="a5dc5637989f0d57598ea2c98922ce194" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="scs__300_8c.html#a5dc5637989f0d57598ea2c98922ce194">LPT_ACK</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 6</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00092">92</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a525c7d69d4a55d502b0d18c0603ebf29"></a><!-- doxytag: member="scs_300.c::LPT_BUSY" ref="a525c7d69d4a55d502b0d18c0603ebf29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="subm__300_8c.html#a525c7d69d4a55d502b0d18c0603ebf29">LPT_BUSY</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00093">93</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9c4f3ce1e69a71faffd91ebf3530b74a"></a><!-- doxytag: member="scs_300.c::LPT_INIT" ref="a9c4f3ce1e69a71faffd91ebf3530b74a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="scs__300_8c.html#a9c4f3ce1e69a71faffd91ebf3530b74a">LPT_INIT</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00090">90</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>Referenced by <a class="el" href="scs__300_8c_source.html#l00101">user_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a6398a7c34611b227331581e463246d5e"></a><!-- doxytag: member="scs_300.c::LPT_SELECT" ref="a6398a7c34611b227331581e463246d5e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="scs__300_8c.html#a6398a7c34611b227331581e463246d5e">LPT_SELECT</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00091">91</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

<p>Referenced by <a class="el" href="scs__300_8c_source.html#l00164">getchar_nowait()</a>, and <a class="el" href="scs__300_8c_source.html#l00101">user_init()</a>.</p>

</div>
</div>
<a class="anchor" id="abbb83f3515aae816313940922814a252"></a><!-- doxytag: member="scs_300.c::LPT_STROBE" ref="abbb83f3515aae816313940922814a252" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sbit <a class="el" href="scs__300_8c.html#abbb83f3515aae816313940922814a252">LPT_STROBE</a> = <a class="el" href="c8051F320_8h.html#a707a972d927f14b7bf9fcb88b9e32b4a">P2</a> ^ 3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00089">89</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="aae648e1cdd0859a1085a358a3e1138c8"></a><!-- doxytag: member="scs_300.c::node_name" ref="aae648e1cdd0859a1085a358a3e1138c8" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char code <a class="el" href="scs__demo_8c.html#aae648e1cdd0859a1085a358a3e1138c8">node_name</a>[] = &quot;SCS-300&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00058">58</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2aae1461214f1802779261dcd5e09d3a"></a><!-- doxytag: member="scs_300.c::user_data" ref="a2aae1461214f1802779261dcd5e09d3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }  <a class="el" href="scs__demo_8c.html#ae7828a5d6ff79996215952a4d51111dc">user_data</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6b330af43261f372e7d0f540d1842871"></a><!-- doxytag: member="scs_300.c::value" ref="a6b330af43261f372e7d0f540d1842871" args="[4]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="odbhist_8c.html#a401da9cc2f96d4efd127de7463b69208">value</a>[4]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00068">68</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
<a class="anchor" id="a900ff3a8ccab65692c28b012e3824819"></a><!-- doxytag: member="scs_300.c::variables" ref="a900ff3a8ccab65692c28b012e3824819" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMSCB__INFO__VAR.html">MSCB_INFO_VAR</a> code <a class="el" href="subm__300_8c.html#a900ff3a8ccab65692c28b012e3824819">variables</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
   4, <a class="code" href="embedded_2mscb_8h.html#a44695a188e739799029a2c943859ca8f">UNIT_UNDEFINED</a>, 0, 0, <a class="code" href="embedded_2mscb_8h.html#a1a29718f09b0ec823f66235753400b39">MSCBF_FLOAT</a>, <span class="stringliteral">&quot;Data0&quot;</span>, &amp;<a class="code" href="hvr__200_8c.html#ac561bcc6d992a061e5d30b629f9c5f30">user_data</a>.value[0],
   4, <a class="code" href="embedded_2mscb_8h.html#a44695a188e739799029a2c943859ca8f">UNIT_UNDEFINED</a>, 0, 0, MSCBF_FLOAT, <span class="stringliteral">&quot;Data1&quot;</span>, &amp;<a class="code" href="hvr__200_8c.html#ac561bcc6d992a061e5d30b629f9c5f30">user_data</a>.value[1],
   4, <a class="code" href="embedded_2mscb_8h.html#a44695a188e739799029a2c943859ca8f">UNIT_UNDEFINED</a>, 0, 0, MSCBF_FLOAT, <span class="stringliteral">&quot;Data2&quot;</span>, &amp;<a class="code" href="hvr__200_8c.html#ac561bcc6d992a061e5d30b629f9c5f30">user_data</a>.value[2],
   4, <a class="code" href="embedded_2mscb_8h.html#a44695a188e739799029a2c943859ca8f">UNIT_UNDEFINED</a>, 0, 0, MSCBF_FLOAT, <span class="stringliteral">&quot;Data3&quot;</span>, &amp;<a class="code" href="hvr__200_8c.html#ac561bcc6d992a061e5d30b629f9c5f30">user_data</a>.value[3],
   0
}
</pre></div>
<p>Definition at line <a class="el" href="scs__300_8c_source.html#l00071">71</a> of file <a class="el" href="scs__300_8c_source.html">scs_300.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ:Rootana by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
