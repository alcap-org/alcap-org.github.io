<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ:Rootana: midas/examples/lowlevel/rpc_srvr.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/examples/lowlevel/rpc_srvr.c File Reference</h1><code>#include &quot;<a class="el" href="midas_8h_source.html">midas.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>

<p><a href="rpc__srvr_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpc__srvr_8c.html#aa10ca54882c7a4b2bf6774c19159c0af">RPC_MYTEST</a>&nbsp;&nbsp;&nbsp;RPC_MIN_ID</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpc__srvr_8c.html#a1a52594987ade9a3ee9098384419e1b3">rpc_mytest</a> (<a class="el" href="usb_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> b, <a class="el" href="unionWORD.html">WORD</a> w, <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mzdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, float f, double <a class="el" href="hwtest_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, <a class="el" href="usb_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *<a class="el" href="scs__1000__scanner_8c.html#a22e56f7c84dc088d79c2bdeb01df0746">b1</a>, <a class="el" href="unionWORD.html">WORD</a> *w1, <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> *i1, float *f1, double *d1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpc__srvr_8c.html#a431793cb59785a34e0f64d1e1d1e957c">rpc_dispatch</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="mana__orig_8c.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, void *prpc_param[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpc__srvr_8c.html#a51af30a60f9f02777c6396b8247e356f">main</a> ()</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structRPC__LIST.html">RPC_LIST</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="rpc__srvr_8c.html#a4defa2be69416de20c5e49014806bd59">rpc_list</a> []</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa10ca54882c7a4b2bf6774c19159c0af"></a><!-- doxytag: member="rpc_srvr.c::RPC_MYTEST" ref="aa10ca54882c7a4b2bf6774c19159c0af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RPC_MYTEST&nbsp;&nbsp;&nbsp;RPC_MIN_ID</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="rpc__srvr_8c_source.html#l00031">31</a> of file <a class="el" href="rpc__srvr_8c_source.html">rpc_srvr.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a51af30a60f9f02777c6396b8247e356f"></a><!-- doxytag: member="rpc_srvr.c::main" ref="a51af30a60f9f02777c6396b8247e356f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">main </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="rpc__srvr_8c_source.html#l00100">100</a> of file <a class="el" href="rpc__srvr_8c_source.html">rpc_srvr.c</a>.</p>

<p>References <a class="el" href="midas_8c_source.html#l04166">cm_yield()</a>, <a class="el" href="camacsrv_8c_source.html#l00131">rpc_dispatch()</a>, <a class="el" href="midas_8c_source.html#l08217">rpc_register_functions()</a>, <a class="el" href="midas_8c_source.html#l10866">rpc_register_server()</a>, <a class="el" href="midas_8c_source.html#l12424">rpc_server_shutdown()</a>, <a class="el" href="midas_8c_source.html#l09420">rpc_set_debug()</a>, <a class="el" href="midas_8h_source.html#l01075">RPC_SHUTDOWN</a>, <a class="el" href="midas_8h_source.html#l01066">RPC_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01795">ST_REMOTE</a>, and <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00101"></a>00101 {
<a name="l00102"></a>00102    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, port;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104    <span class="comment">/* register RPC server under port 1750 */</span>
<a name="l00105"></a>00105    port = 1750;
<a name="l00106"></a>00106    status = <a class="code" href="group__msectionh.html#gac428a89411d42990fd01b1344f67465a">rpc_register_server</a>(<a class="code" href="group__msectionh.html#ga9c6b34250ccc696d64a6a0a572947be5">ST_REMOTE</a>, <span class="stringliteral">&quot;&quot;</span>, &amp;port, NULL);
<a name="l00107"></a>00107    <span class="keywordflow">if</span> (status != <a class="code" href="group__err25.html#ga19b06966ce058cda8e5dca8d682b2bd3">RPC_SUCCESS</a>) {
<a name="l00108"></a>00108       printf(<span class="stringliteral">&quot;Cannot start server&quot;</span>);
<a name="l00109"></a>00109       <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110    }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112    <span class="comment">/* Register function list. Calls get forwarded to rpc_dispatch */</span>
<a name="l00113"></a>00113    <a class="code" href="group__msectionh.html#gace7386854fda7aedbf0bcb25c2191dc5">rpc_register_functions</a>(<a class="code" href="rpc__clnt_8c.html#a4defa2be69416de20c5e49014806bd59">rpc_list</a>, <a class="code" href="camacsrv_8c.html#a431793cb59785a34e0f64d1e1d1e957c">rpc_dispatch</a>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115    <span class="comment">/* Print debugging messages */</span>
<a name="l00116"></a>00116    <a class="code" href="group__msectionh.html#gace4f55535524757cfb1a0ace8ed264e6">rpc_set_debug</a>((<span class="keywordtype">void</span> (*)(<span class="keywordtype">char</span> *)) puts, 0);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118    <span class="comment">/* Server loop */</span>
<a name="l00119"></a>00119    <span class="keywordflow">while</span> (<a class="code" href="group__msectionh.html#gae234f64a7143ed2be1019e53613a6e85">cm_yield</a>(1000) != <a class="code" href="group__err25.html#ga0406ee07e8c5afbf8e46cb0eed698bcd">RPC_SHUTDOWN</a>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121    <span class="comment">/* Shutdown server */</span>
<a name="l00122"></a>00122    <a class="code" href="group__msectionh.html#gaa86de5637b6d3f535bfe2d751fe1bd34">rpc_server_shutdown</a>();
<a name="l00123"></a>00123 
<a name="l00124"></a>00124    <span class="keywordflow">return</span> 1;
<a name="l00125"></a>00125 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a431793cb59785a34e0f64d1e1d1e957c"></a><!-- doxytag: member="rpc_srvr.c::rpc_dispatch" ref="a431793cb59785a34e0f64d1e1d1e957c" args="(INT index, void *prpc_param[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> rpc_dispatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>prpc_param</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="rpc__srvr_8c_source.html#l00081">81</a> of file <a class="el" href="rpc__srvr_8c_source.html">rpc_srvr.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01857">CBYTE</a>, <a class="el" href="midas_8h_source.html#l01884">CDOUBLE</a>, <a class="el" href="midas_8h_source.html#l01881">CFLOAT</a>, <a class="el" href="midas_8h_source.html#l01863">CINT</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01858">CPBYTE</a>, <a class="el" href="midas_8h_source.html#l01885">CPDOUBLE</a>, <a class="el" href="midas_8h_source.html#l01882">CPFLOAT</a>, <a class="el" href="midas_8h_source.html#l01864">CPINT</a>, <a class="el" href="midas_8h_source.html#l01867">CPWORD</a>, <a class="el" href="midas_8h_source.html#l01866">CWORD</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="rpc__srvr_8c_source.html#l00068">rpc_mytest()</a>, <a class="el" href="rpc__clnt_8c_source.html#l00032">RPC_MYTEST</a>, and <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00082"></a>00082 {
<a name="l00083"></a>00083    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085    <span class="keywordflow">switch</span> (<a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>) {
<a name="l00086"></a>00086    <span class="keywordflow">case</span> <a class="code" href="rpc__clnt_8c.html#aa10ca54882c7a4b2bf6774c19159c0af">RPC_MYTEST</a>:
<a name="l00087"></a>00087       status = <a class="code" href="rpc__srvr_8c.html#a1a52594987ade9a3ee9098384419e1b3">rpc_mytest</a>(<a class="code" href="group__msectionh.html#gac474bc71cdbc17abcc6fef87c7270b7e">CBYTE</a>(0), <a class="code" href="group__msectionh.html#ga94a92016dc66b32a6c75df667df20866">CWORD</a>(1), <a class="code" href="group__msectionh.html#ga187949f830579556334ed017deea814c">CINT</a>(2), <a class="code" href="group__msectionh.html#ga010a021df10d5c4741f1697ede034703">CFLOAT</a>(3), <a class="code" href="group__msectionh.html#ga2dd79a558506d2550d1683f654ef0c86">CDOUBLE</a>(4),
<a name="l00088"></a>00088                           <a class="code" href="group__msectionh.html#gaf9748dba944fbcce1b23a04a7536f429">CPBYTE</a>(5), <a class="code" href="group__msectionh.html#ga68a6343add951d2d9ca99197eac42fd2">CPWORD</a>(6), <a class="code" href="group__msectionh.html#ga6f5372871739a94e9a75f248daf21318">CPINT</a>(7), <a class="code" href="group__msectionh.html#gaef98b3ad3de189b2503754d66b17b148">CPFLOAT</a>(8), <a class="code" href="group__msectionh.html#gafd437523c43788bd9f4a31226211c61d">CPDOUBLE</a>(9));
<a name="l00089"></a>00089       <span class="keywordflow">break</span>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091    <span class="keywordflow">default</span>:
<a name="l00092"></a>00092       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;rpc_dispatch&quot;</span>, <span class="stringliteral">&quot;received unrecognized command&quot;</span>);
<a name="l00093"></a>00093    }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095    <span class="keywordflow">return</span> status;
<a name="l00096"></a>00096 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1a52594987ade9a3ee9098384419e1b3"></a><!-- doxytag: member="rpc_srvr.c::rpc_mytest" ref="a1a52594987ade9a3ee9098384419e1b3" args="(BYTE b, WORD w, INT i, float f, double d, BYTE *b1, WORD *w1, INT *i1, float *f1, double *d1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> rpc_mytest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="usb_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&nbsp;</td>
          <td class="paramname"> <em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="unionWORD.html">WORD</a>&nbsp;</td>
          <td class="paramname"> <em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="usb_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&nbsp;</td>
          <td class="paramname"> <em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="unionWORD.html">WORD</a> *&nbsp;</td>
          <td class="paramname"> <em>w1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> *&nbsp;</td>
          <td class="paramname"> <em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&nbsp;</td>
          <td class="paramname"> <em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>d1</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="rpc__srvr_8c_source.html#l00068">68</a> of file <a class="el" href="rpc__srvr_8c_source.html">rpc_srvr.c</a>.</p>

<p>Referenced by <a class="el" href="rpc__srvr_8c_source.html#l00081">rpc_dispatch()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00070"></a>00070 {
<a name="l00071"></a>00071    *<a class="code" href="lcd__menu_8c.html#a22e56f7c84dc088d79c2bdeb01df0746">b1</a> = b * 2;
<a name="l00072"></a>00072    *w1 = w * 2;
<a name="l00073"></a>00073    *i1 = <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a> * 2;
<a name="l00074"></a>00074    *f1 = f * 2;
<a name="l00075"></a>00075    *d1 = <a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> * 2;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077    <span class="keywordflow">return</span> 1;
<a name="l00078"></a>00078 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a4defa2be69416de20c5e49014806bd59"></a><!-- doxytag: member="rpc_srvr.c::rpc_list" ref="a4defa2be69416de20c5e49014806bd59" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structRPC__LIST.html">RPC_LIST</a> <a class="el" href="group__rpcfunctionc.html#ga9938652e216f0f66f1eab2f26228089b">rpc_list</a>[]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="rpc__srvr_8c_source.html#l00033">33</a> of file <a class="el" href="rpc__srvr_8c_source.html">rpc_srvr.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ:Rootana by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
