<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ:Rootana: midas/drivers/class/multi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/drivers/class/multi.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="midas_8h_source.html">midas.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ybos_8h_source.html">ybos.h</a>&quot;</code><br/>

<p><a href="multi_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMULTI__INFO.html">MULTI_INFO</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(_i)&nbsp;&nbsp;&nbsp;((<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> (*)(<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>, ...))(m_info-&gt;driver_input[_i]))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(_i)&nbsp;&nbsp;&nbsp;((<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> (*)(<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>, ...))(m_info-&gt;driver_output[_i]))</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a50f62fef60ae692657115cf15280f9da">free_mem</a> (<a class="el" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a6d7601caf3c73f01d85c4c91ae024a9d">multi_read</a> (<a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment, int <a class="el" href="lazylogger_8c.html#a7728c597c88e0bc9b73912265b2f7665">channel</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a45daac7102a21d6e94f565a9d7e8d89c">multi_read_output</a> (<a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment, int <a class="el" href="lazylogger_8c.html#a7728c597c88e0bc9b73912265b2f7665">channel</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#afd1b271d67ec26c8d5e403ae63fab244">multi_output</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, void *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a450382feec02560369f48b99a40824dd">multi_update_label</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="slowcontrol_2vacuum__sensor_2frontend_8c.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, void *info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a5a46f4665c958d4bc2b5d021705e5166">multi_init</a> (<a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a0dc6f2b63e251538e20eb81ac9d79159">multi_exit</a> (<a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#ac2ea0df7dbe425b39a71df811de946d2">multi_idle</a> (<a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a12cd9d031a8ec56dcb99d3e830eff45f">cd_multi_read</a> (char *pevent, int <a class="el" href="mgd_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi_8c.html#a58a1786899d745b75da09db6a1040de3">cd_multi</a> (<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>, <a class="el" href="structeqpmnt.html">EQUIPMENT</a> *pequipment)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a10afc22a09702b4c6be6a44ed1bfe844"></a><!-- doxytag: member="multi.c::DRIVER_INPUT" ref="a10afc22a09702b4c6be6a44ed1bfe844" args="(_i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DRIVER_INPUT</td>
          <td>(</td>
          <td class="paramtype">_i&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> (*)(<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>, ...))(m_info-&gt;driver_input[_i]))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00091">91</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>, <a class="el" href="multi_8c_source.html#l00133">multi_read()</a>, and <a class="el" href="multi_8c_source.html#l00241">multi_update_label()</a>.</p>

</div>
</div>
<a class="anchor" id="af9a77e5b2b43b4d855433735a0ee6c8e"></a><!-- doxytag: member="multi.c::DRIVER_OUTPUT" ref="af9a77e5b2b43b4d855433735a0ee6c8e" args="(_i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DRIVER_OUTPUT</td>
          <td>(</td>
          <td class="paramtype">_i&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;((<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> (*)(<a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> <a class="el" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>, ...))(m_info-&gt;driver_output[_i]))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00092">92</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>, <a class="el" href="multi_8c_source.html#l00212">multi_output()</a>, <a class="el" href="multi_8c_source.html#l00184">multi_read_output()</a>, and <a class="el" href="multi_8c_source.html#l00241">multi_update_label()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a58a1786899d745b75da09db6a1040de3"></a><!-- doxytag: member="multi.c::cd_multi" ref="a58a1786899d745b75da09db6a1040de3" args="(INT cmd, EQUIPMENT *pequipment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> cd_multi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00693">693</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01127">CMD_EXIT</a>, <a class="el" href="midas_8h_source.html#l01128">CMD_IDLE</a>, <a class="el" href="midas_8h_source.html#l01126">CMD_INIT</a>, <a class="el" href="midas_8h_source.html#l01088">FE_ERR_DRIVER</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="multi_8c_source.html#l00572">multi_exit()</a>, <a class="el" href="multi_8c_source.html#l00587">multi_idle()</a>, <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>, and <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00694"></a>00694 {
<a name="l00695"></a>00695    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697    <span class="keywordflow">switch</span> (<a class="code" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>) {
<a name="l00698"></a>00698    <span class="keywordflow">case</span> <a class="code" href="group__err26.html#ga2677fc43f8393bcf3bafc8bbface003f">CMD_INIT</a>:
<a name="l00699"></a>00699       status = <a class="code" href="multi_8c.html#a5a46f4665c958d4bc2b5d021705e5166">multi_init</a>(pequipment);
<a name="l00700"></a>00700       <span class="keywordflow">break</span>;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702    <span class="keywordflow">case</span> <a class="code" href="group__err26.html#gacfa1d482ab47b3ceebb9717007111649">CMD_EXIT</a>:
<a name="l00703"></a>00703       status = <a class="code" href="multi_8c.html#a0dc6f2b63e251538e20eb81ac9d79159">multi_exit</a>(pequipment);
<a name="l00704"></a>00704       <span class="keywordflow">break</span>;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 
<a name="l00707"></a>00707    <span class="keywordflow">case</span> <a class="code" href="group__err26.html#ga433697a25587c6ffe8a14f02e5be9066">CMD_IDLE</a>:
<a name="l00708"></a>00708       status = <a class="code" href="multi_8c.html#ac2ea0df7dbe425b39a71df811de946d2">multi_idle</a>(pequipment);
<a name="l00709"></a>00709       <span class="keywordflow">break</span>;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711    <span class="keywordflow">default</span>:
<a name="l00712"></a>00712       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;Multimeter class driver&quot;</span>, <span class="stringliteral">&quot;Received unknown command %d&quot;</span>, <a class="code" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>);
<a name="l00713"></a>00713       status = <a class="code" href="group__err26.html#gac4221d7e494c798f57552f502e2459ef">FE_ERR_DRIVER</a>;
<a name="l00714"></a>00714       <span class="keywordflow">break</span>;
<a name="l00715"></a>00715    }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717    <span class="keywordflow">return</span> status;
<a name="l00718"></a>00718 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a12cd9d031a8ec56dcb99d3e830eff45f"></a><!-- doxytag: member="multi.c::cd_multi_read" ref="a12cd9d031a8ec56dcb99d3e830eff45f" args="(char *pevent, int offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> cd_multi_read </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pevent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>offset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00629">629</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8c_source.html#l12826">bk_close()</a>, <a class="el" href="midas_8c_source.html#l12705">bk_create()</a>, <a class="el" href="midas_8c_source.html#l12623">bk_init()</a>, <a class="el" href="midas_8c_source.html#l12678">bk_size()</a>, <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="midas_8h_source.html#l01210">EVENT_ID</a>, <a class="el" href="ybos_8h_source.html#l00348">F4_BKTYPE</a>, <a class="el" href="multi_8c_source.html#l00066">MULTI_INFO::format</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="ybos_8h_source.html#l00347">I4_BKTYPE</a>, <a class="el" href="generate-MODULES_8h_source.html#l00003">if</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_input</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>, <a class="el" href="midas_8h_source.html#l01217">SERIAL_NUMBER</a>, <a class="el" href="midas_8h_source.html#l00743">TID_FLOAT</a>, <a class="el" href="midas_8h_source.html#l01224">TIME_STAMP</a>, <a class="el" href="multi_8c_source.html#l00072">MULTI_INFO::var_input</a>, <a class="el" href="multi_8c_source.html#l00073">MULTI_INFO::var_output</a>, <a class="el" href="ybos_8c_source.html#l00549">ybk_close()</a>, <a class="el" href="ybos_8c_source.html#l00438">ybk_create()</a>, <a class="el" href="ybos_8c_source.html#l00408">ybk_init()</a>, and <a class="el" href="ybos_8c_source.html#l00579">ybk_size()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00630"></a>00630 {
<a name="l00631"></a>00631    <span class="keywordtype">float</span> *pdata;
<a name="l00632"></a>00632    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *pdw;
<a name="l00633"></a>00633    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00634"></a>00634    <a class="code" href="structeqpmnt.html">EQUIPMENT</a> *pequipment;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636    pequipment = *((<a class="code" href="structeqpmnt.html">EQUIPMENT</a> **) pevent);
<a name="l00637"></a>00637    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639    <a class="code" href="generate-MODULES_8h.html#aaac43492f2954cc70dd9a286b2b3ab02">if</a> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> == <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a>) {
<a name="l00640"></a>00640       memcpy(pevent, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>);
<a name="l00641"></a>00641       pevent += <span class="keyword">sizeof</span>(float) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643       memcpy(pevent, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>);
<a name="l00644"></a>00644       pevent += <span class="keyword">sizeof</span>(float) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646       <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * (m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> + m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>);
<a name="l00647"></a>00647    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> == <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>) {
<a name="l00648"></a>00648       <a class="code" href="group__msectionh.html#ga6a2d6aced3ec658234d4c6ab0ba043fb">bk_init</a>(pevent);
<a name="l00649"></a>00649 
<a name="l00650"></a>00650       <span class="comment">/* create INPT bank */</span>
<a name="l00651"></a>00651       <a class="code" href="group__msectionh.html#ga5d60ec9f544f56ab8170380ebe195584">bk_create</a>(pevent, <span class="stringliteral">&quot;INPT&quot;</span>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>, &amp;pdata);
<a name="l00652"></a>00652       memcpy(pdata, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>);
<a name="l00653"></a>00653       pdata += m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>;
<a name="l00654"></a>00654       <a class="code" href="group__msectionh.html#gab0314f08910a3950815d265d090656b7">bk_close</a>(pevent, pdata);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656       <span class="comment">/* create OUTP bank */</span>
<a name="l00657"></a>00657       <a class="code" href="group__msectionh.html#ga5d60ec9f544f56ab8170380ebe195584">bk_create</a>(pevent, <span class="stringliteral">&quot;OUTP&quot;</span>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>, &amp;pdata);
<a name="l00658"></a>00658       memcpy(pdata, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>);
<a name="l00659"></a>00659       pdata += m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>;
<a name="l00660"></a>00660       <a class="code" href="group__msectionh.html#gab0314f08910a3950815d265d090656b7">bk_close</a>(pevent, pdata);
<a name="l00661"></a>00661 
<a name="l00662"></a>00662       <span class="keywordflow">return</span> <a class="code" href="group__msectionh.html#ga825db64c9ef9b4656698c890fca37c05">bk_size</a>(pevent);
<a name="l00663"></a>00663    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> == <a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>) {
<a name="l00664"></a>00664       <a class="code" href="group__ybosincludecode.html#ga6ed49f74e7fd8e2105433bc664891d08">ybk_init</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent);
<a name="l00665"></a>00665 
<a name="l00666"></a>00666       <span class="comment">/* create EVID bank */</span>
<a name="l00667"></a>00667       <a class="code" href="group__ybosincludecode.html#gadbdf677c59a4be61da9286b807a5b2e2">ybk_create</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, <span class="stringliteral">&quot;EVID&quot;</span>, <a class="code" href="group__ybosdefineh.html#gac78b656213d4a1fb1fd9bf9bd8c46f09">I4_BKTYPE</a>, (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) (&amp;pdw));
<a name="l00668"></a>00668       *(pdw)++ = <a class="code" href="group__mbufferh.html#gaf42c9a1ac33cf459bfd366673f6a4d70">EVENT_ID</a>(pevent);      <span class="comment">/* Event_ID + Mask */</span>
<a name="l00669"></a>00669       *(pdw)++ = <a class="code" href="group__mbufferh.html#gadbb75a9d81e264e357bc5fc73dd4ebb8">SERIAL_NUMBER</a>(pevent); <span class="comment">/* Serial number */</span>
<a name="l00670"></a>00670       *(pdw)++ = <a class="code" href="group__mbufferh.html#gae8d2f03c283637c81cdcfd3fda065d53">TIME_STAMP</a>(pevent);    <span class="comment">/* Time Stamp */</span>
<a name="l00671"></a>00671       <a class="code" href="group__ybosincludecode.html#gadfb143a50f37e70483da7e18cbc463ea">ybk_close</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, pdw);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673       <span class="comment">/* create INPT bank */</span>
<a name="l00674"></a>00674       <a class="code" href="group__ybosincludecode.html#gadbdf677c59a4be61da9286b807a5b2e2">ybk_create</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, <span class="stringliteral">&quot;INPT&quot;</span>, <a class="code" href="group__ybosdefineh.html#ga07c32fd205319ee4bd3b6adde65058d6">F4_BKTYPE</a>, (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) &amp; pdata);
<a name="l00675"></a>00675       memcpy(pdata, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>);
<a name="l00676"></a>00676       pdata += m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>;
<a name="l00677"></a>00677       <a class="code" href="group__ybosincludecode.html#gadfb143a50f37e70483da7e18cbc463ea">ybk_close</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, pdata);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679       <span class="comment">/* create OUTP bank */</span>
<a name="l00680"></a>00680       <a class="code" href="group__ybosincludecode.html#gadbdf677c59a4be61da9286b807a5b2e2">ybk_create</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, <span class="stringliteral">&quot;OUTP&quot;</span>, <a class="code" href="group__ybosdefineh.html#ga07c32fd205319ee4bd3b6adde65058d6">F4_BKTYPE</a>, (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) &amp; pdata);
<a name="l00681"></a>00681       memcpy(pdata, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>);
<a name="l00682"></a>00682       pdata += m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>;
<a name="l00683"></a>00683       <a class="code" href="group__ybosincludecode.html#gadfb143a50f37e70483da7e18cbc463ea">ybk_close</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent, pdata);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685       <span class="keywordflow">return</span> <a class="code" href="group__ybosincludecode.html#gab97b7d0d9ea164c791c36374826d19fe">ybk_size</a>((<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) pevent);
<a name="l00686"></a>00686    }
<a name="l00687"></a>00687 
<a name="l00688"></a>00688    <span class="keywordflow">return</span> 0;
<a name="l00689"></a>00689 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a50f62fef60ae692657115cf15280f9da"></a><!-- doxytag: member="multi.c::free_mem" ref="a50f62fef60ae692657115cf15280f9da" args="(MULTI_INFO *m_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void free_mem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMULTI__INFO.html">MULTI_INFO</a> *&nbsp;</td>
          <td class="paramname"> <em>m_info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00100">100</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_input</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_output</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_input</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_output</a>, <a class="el" href="multi_8c_source.html#l00084">MULTI_INFO::driver_input</a>, <a class="el" href="multi_8c_source.html#l00084">MULTI_INFO::driver_output</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_input</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_output</a>, <a class="el" href="multi_8c_source.html#l00087">MULTI_INFO::flags_input</a>, <a class="el" href="multi_8c_source.html#l00087">MULTI_INFO::flags_output</a>, <a class="el" href="multi_8c_source.html#l00081">MULTI_INFO::input_mirror</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_input</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_output</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_input</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_output</a>, <a class="el" href="multi_8c_source.html#l00082">MULTI_INFO::output_mirror</a>, <a class="el" href="multi_8c_source.html#l00076">MULTI_INFO::update_threshold</a>, <a class="el" href="multi_8c_source.html#l00072">MULTI_INFO::var_input</a>, and <a class="el" href="multi_8c_source.html#l00073">MULTI_INFO::var_output</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00572">multi_exit()</a>, and <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00101"></a>00101 {
<a name="l00102"></a>00102    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a>);
<a name="l00103"></a>00103    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a>);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>);
<a name="l00106"></a>00106    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a>);
<a name="l00109"></a>00109    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>);
<a name="l00110"></a>00110    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>);
<a name="l00111"></a>00111    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>);
<a name="l00112"></a>00112    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6309e5146b05bc3b935b1f966bc8c203">input_mirror</a>);
<a name="l00115"></a>00115    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>);
<a name="l00118"></a>00118    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>);
<a name="l00119"></a>00119    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>);
<a name="l00120"></a>00120    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a97604043bca220b87f1bfbc982143328">driver_input</a>);
<a name="l00123"></a>00123    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#aebe278274ba2e945ad0c94338804ab7d">driver_output</a>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a0fb1840756e9f8699a79afb74bf66805">flags_input</a>);
<a name="l00126"></a>00126    free(m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa801a04d0f7a197f9e7583f4d0b2235c">flags_output</a>);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128    free(m_info);
<a name="l00129"></a>00129 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0dc6f2b63e251538e20eb81ac9d79159"></a><!-- doxytag: member="multi.c::multi_exit" ref="a0dc6f2b63e251538e20eb81ac9d79159" args="(EQUIPMENT *pequipment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> multi_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00572">572</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="midas_8h_source.html#l01127">CMD_EXIT</a>, <a class="el" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">DEVICE_DRIVER::dd</a>, <a class="el" href="midas_8h_source.html#l01360">DEVICE_DRIVER::dd_info</a>, <a class="el" href="midas_8h_source.html#l01394">eqpmnt::driver</a>, <a class="el" href="midas_8h_source.html#l01084">FE_SUCCESS</a>, <a class="el" href="multi_8c_source.html#l00100">free_mem()</a>, and <a class="el" href="mdump_8c_source.html#l00115">i</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00693">cd_multi()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00573"></a>00573 {
<a name="l00574"></a>00574    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576    <a class="code" href="multi_8c.html#a50f62fef60ae692657115cf15280f9da">free_mem</a>((<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>);
<a name="l00577"></a>00577 
<a name="l00578"></a>00578    <span class="comment">/* call exit method of device drivers */</span>
<a name="l00579"></a>00579    <span class="keywordflow">for</span> (i = 0; pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">dd</a> != NULL; i++)
<a name="l00580"></a>00580       pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">dd</a>(<a class="code" href="group__err26.html#gacfa1d482ab47b3ceebb9717007111649">CMD_EXIT</a>, pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga334e4f80981fd4d70bb6ebea2fe3e911">dd_info</a>);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582    <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga23395a243c74edd61ed4ce0df1256419">FE_SUCCESS</a>;
<a name="l00583"></a>00583 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac2ea0df7dbe425b39a71df811de946d2"></a><!-- doxytag: member="multi.c::multi_idle" ref="ac2ea0df7dbe425b39a71df811de946d2" args="(EQUIPMENT *pequipment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> multi_idle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00587">587</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="midas_8h_source.html#l01345">DF_PRIO_DEVICE</a>, <a class="el" href="midas_8h_source.html#l01084">FE_SUCCESS</a>, <a class="el" href="multi_8c_source.html#l00087">MULTI_INFO::flags_output</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="generate-MODULES_8h_source.html#l00003">if</a>, <a class="el" href="multi_8c_source.html#l00067">MULTI_INFO::last_channel</a>, <a class="el" href="multi_8c_source.html#l00133">multi_read()</a>, <a class="el" href="multi_8c_source.html#l00184">multi_read_output()</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_input</a>, and <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00693">cd_multi()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00588"></a>00588 {
<a name="l00589"></a>00589    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00590"></a>00590    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00591"></a>00591 
<a name="l00592"></a>00592    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00593"></a>00593 
<a name="l00594"></a>00594    <a class="code" href="generate-MODULES_8h.html#aaac43492f2954cc70dd9a286b2b3ab02">if</a> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>) {
<a name="l00595"></a>00595       <span class="comment">/* read input channel */</span>
<a name="l00596"></a>00596       <a class="code" href="multi_8c.html#a6d7601caf3c73f01d85c4c91ae024a9d">multi_read</a>(pequipment, m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a>);
<a name="l00597"></a>00597       m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a>++;
<a name="l00598"></a>00598    } <span class="keywordflow">else</span> {
<a name="l00599"></a>00599       <span class="keywordflow">if</span> (!m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>) {
<a name="l00600"></a>00600          m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> = 0;
<a name="l00601"></a>00601       } <span class="keywordflow">else</span> {
<a name="l00602"></a>00602          <span class="comment">/* search output channel with DF_PRIO_DEV */</span>
<a name="l00603"></a>00603          <span class="keywordflow">for</span> (i = m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>;
<a name="l00604"></a>00604               i &lt; m_info-&gt;num_channels_output; i++)
<a name="l00605"></a>00605             <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa801a04d0f7a197f9e7583f4d0b2235c">flags_output</a>[i] &amp; <a class="code" href="group__mequipment.html#ga14cf699d29a6edd2088b83e17cda6744">DF_PRIO_DEVICE</a>)
<a name="l00606"></a>00606                <span class="keywordflow">break</span>;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608          <span class="keywordflow">if</span> (i &lt; m_info-&gt;num_channels_output) {
<a name="l00609"></a>00609             <span class="comment">/* read output channel */</span>
<a name="l00610"></a>00610             <a class="code" href="multi_8c.html#a45daac7102a21d6e94f565a9d7e8d89c">multi_read_output</a>(pequipment, i);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612             m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> = i + m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>;
<a name="l00613"></a>00613             <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> &lt;
<a name="l00614"></a>00614                 m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> + m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> - 1)
<a name="l00615"></a>00615                m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a>++;
<a name="l00616"></a>00616             <span class="keywordflow">else</span>
<a name="l00617"></a>00617                m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> = 0;
<a name="l00618"></a>00618          } <span class="keywordflow">else</span>
<a name="l00619"></a>00619             m_info-&gt;<a class="code" href="structMULTI__INFO.html#af7bf0928aa8c2515679ec586d982bd77">last_channel</a> = 0;
<a name="l00620"></a>00620       }
<a name="l00621"></a>00621    }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 
<a name="l00624"></a>00624    <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga23395a243c74edd61ed4ce0df1256419">FE_SUCCESS</a>;
<a name="l00625"></a>00625 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5a46f4665c958d4bc2b5d021705e5166"></a><!-- doxytag: member="multi.c::multi_init" ref="a5a46f4665c958d4bc2b5d021705e5166" args="(EQUIPMENT *pequipment)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> multi_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00264">264</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="group__midasincludecode.html#ga885e46846e92facb6222f6a430127772">DEVICE_DRIVER::bd</a>, <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_input</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_output</a>, <a class="el" href="midas_8h_source.html#l01357">DEVICE_DRIVER::channels</a>, <a class="el" href="midas_8c_source.html#l02913">cm_get_experiment_database()</a>, <a class="el" href="lrs1821_8h_source.html#l00218">cm_msg</a>, <a class="el" href="midas_8h_source.html#l01131">CMD_GET</a>, <a class="el" href="midas_8h_source.html#l01138">CMD_GET_DEFAULT_NAME</a>, <a class="el" href="midas_8h_source.html#l01126">CMD_INIT</a>, <a class="el" href="midas_8h_source.html#l01129">CMD_SET</a>, <a class="el" href="midas_8h_source.html#l01140">CMD_SET_LABEL</a>, <a class="el" href="odb_8c_source.html#l01721">db_create_key()</a>, <a class="el" href="odb_8c_source.html#l02193">db_find_key()</a>, <a class="el" href="odb_8c_source.html#l03261">db_get_value()</a>, <a class="el" href="odb_8c_source.html#l04971">db_merge_data()</a>, <a class="el" href="odb_8c_source.html#l07741">db_open_record()</a>, <a class="el" href="odb_8c_source.html#l04727">db_set_data_index()</a>, <a class="el" href="odb_8c_source.html#l06874">db_set_record()</a>, <a class="el" href="midas_8h_source.html#l01001">DB_SUCCESS</a>, <a class="el" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">DEVICE_DRIVER::dd</a>, <a class="el" href="midas_8h_source.html#l01360">DEVICE_DRIVER::dd_info</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_input</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_output</a>, <a class="el" href="midas_8h_source.html#l01343">DF_INPUT</a>, <a class="el" href="midas_8h_source.html#l01344">DF_OUTPUT</a>, <a class="el" href="midas_8h_source.html#l01345">DF_PRIO_DEVICE</a>, <a class="el" href="midas_8h_source.html#l01394">eqpmnt::driver</a>, <a class="el" href="multi_8c_source.html#l00091">DRIVER_INPUT</a>, <a class="el" href="multi_8c_source.html#l00084">MULTI_INFO::driver_input</a>, <a class="el" href="multi_8c_source.html#l00092">DRIVER_OUTPUT</a>, <a class="el" href="multi_8c_source.html#l00084">MULTI_INFO::driver_output</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_input</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_output</a>, <a class="el" href="midas_8h_source.html#l01085">FE_ERR_ODB</a>, <a class="el" href="midas_8h_source.html#l01084">FE_SUCCESS</a>, <a class="el" href="midas_8h_source.html#l01359">DEVICE_DRIVER::flags</a>, <a class="el" href="multi_8c_source.html#l00087">MULTI_INFO::flags_input</a>, <a class="el" href="multi_8c_source.html#l00087">MULTI_INFO::flags_output</a>, <a class="el" href="multi_8c_source.html#l00066">MULTI_INFO::format</a>, <a class="el" href="midas_8h_source.html#l00721">FORMAT_FIXED</a>, <a class="el" href="midas_8h_source.html#l00718">FORMAT_MIDAS</a>, <a class="el" href="midas_8h_source.html#l00719">FORMAT_YBOS</a>, <a class="el" href="multi_8c_source.html#l00100">free_mem()</a>, <a class="el" href="mucap__compress_8cpp_source.html#l00011">hDB</a>, <a class="el" href="mevb_8cpp_source.html#l00100">hKey</a>, <a class="el" href="multi_8c_source.html#l00062">MULTI_INFO::hKeyInput</a>, <a class="el" href="multi_8c_source.html#l00062">MULTI_INFO::hKeyOutput</a>, <a class="el" href="multi_8c_source.html#l00061">MULTI_INFO::hKeyRoot</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="generate-MODULES_8h_source.html#l00003">if</a>, <a class="el" href="mana_8cpp_source.html#l00677">index</a>, <a class="el" href="multi_8c_source.html#l00081">MULTI_INFO::input_mirror</a>, <a class="el" href="odbhist_8c_source.html#l00058">j</a>, <a class="el" href="lrs1821_8h_source.html#l00220">MERROR</a>, <a class="el" href="midas_8h_source.html#l00760">MODE_READ</a>, <a class="el" href="multi_8c_source.html#l00212">multi_output()</a>, <a class="el" href="multi_8c_source.html#l00133">multi_read()</a>, <a class="el" href="multi_8c_source.html#l00241">multi_update_label()</a>, <a class="el" href="midas_8h_source.html#l01355">DEVICE_DRIVER::name</a>, <a class="el" href="midas_8h_source.html#l01390">eqpmnt::name</a>, <a class="el" href="midas_8h_source.html#l00681">NAME_LENGTH</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_input</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_output</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_input</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_input</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_output</a>, <a class="el" href="multi_8c_source.html#l00082">MULTI_INFO::output_mirror</a>, <a class="el" href="ybos_8c_source.html#l00373">size</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="midas_8h_source.html#l00743">TID_FLOAT</a>, <a class="el" href="midas_8h_source.html#l00749">TID_KEY</a>, <a class="el" href="midas_8h_source.html#l00746">TID_STRING</a>, <a class="el" href="p30_8h_source.html#l00043">TRUE</a>, <a class="el" href="multi_8c_source.html#l00076">MULTI_INFO::update_threshold</a>, <a class="el" href="multi_8c_source.html#l00072">MULTI_INFO::var_input</a>, and <a class="el" href="multi_8c_source.html#l00073">MULTI_INFO::var_output</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00693">cd_multi()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00265"></a>00265 {
<a name="l00266"></a>00266    <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="ybos_8c.html#adfdd3a80d1d8ea7918a6d1ebee518102">size</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>, ch_offset;
<a name="l00267"></a>00267    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l00268"></a>00268    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>, <a class="code" href="mevb_8cpp.html#a8cd567d23219ba7fc83280cf20caf1c2">hKey</a>, hNamesIn, hNamesOut;
<a name="l00269"></a>00269    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271    <span class="comment">/* allocate private data */</span>
<a name="l00272"></a>00272    pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a> = calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a>));
<a name="l00273"></a>00273    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275    <span class="comment">/* get class driver root key */</span>
<a name="l00276"></a>00276    <a class="code" href="group__msectionh.html#ga1932e7947b0a024a845c5b8c19c3dda0">cm_get_experiment_database</a>(&amp;hDB, NULL);
<a name="l00277"></a>00277    sprintf(str, <span class="stringliteral">&quot;/Equipment/%s&quot;</span>, pequipment-&gt;<a class="code" href="structeqpmnt.html#a80db04cadcc657d17e5ba6f742d6fbc6">name</a>);
<a name="l00278"></a>00278    <a class="code" href="group__msectionh.html#ga1441e5b7ca1923cf8611f920cf2c31b4">db_create_key</a>(hDB, 0, str, <a class="code" href="group__mdefineh.html#ga15ae151ae0b7588b3327bd8451d9bcb8">TID_KEY</a>);
<a name="l00279"></a>00279    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, 0, str, &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281    <span class="comment">/* save event format */</span>
<a name="l00282"></a>00282    size = <span class="keyword">sizeof</span>(str);
<a name="l00283"></a>00283    <a class="code" href="group__msectionh.html#ga9fc43f58a995c9f2cf9f734076ddedc2">db_get_value</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Common/Format&quot;</span>, str, &amp;size, <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>, <a class="code" href="p30_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;Fixed&quot;</span>))
<a name="l00286"></a>00286       m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> = <a class="code" href="group__mdefineh.html#ga44835dd4c169e13e0fedf8c01a54dc2b">FORMAT_FIXED</a>;
<a name="l00287"></a>00287    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;MIDAS&quot;</span>))
<a name="l00288"></a>00288       m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> = <a class="code" href="group__mdefineh.html#gac7ef5b0cbb1fc1d26c3bfd4cc4a191a9">FORMAT_MIDAS</a>;
<a name="l00289"></a>00289    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;YBOS&quot;</span>))
<a name="l00290"></a>00290       m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae1d73e317f8d6fde02c18accbae2cb54">format</a> = <a class="code" href="group__mdefineh.html#gaab9657af955d54be6cd05e0a726ad964">FORMAT_YBOS</a>;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292    <span class="comment">/* count total number of channels */</span>
<a name="l00293"></a>00293    <span class="keywordflow">for</span> (i = m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> = m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> = 0;
<a name="l00294"></a>00294         pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="structDEVICE__DRIVER.html#a3c47bfe572999fec51df9c6072d6c6d7">name</a>[0]; i++) {
<a name="l00295"></a>00295       <span class="keywordflow">if</span> (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a> &amp; <a class="code" href="group__mequipment.html#gace7257be62c3d56a883e4ad1dff6fdda">DF_INPUT</a>)
<a name="l00296"></a>00296          m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> += pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga1451258cb714852eef78ec04e7970f65">channels</a>;
<a name="l00297"></a>00297       <span class="keywordflow">if</span> (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a> &amp; <a class="code" href="group__mequipment.html#ga9a302762256e89a266256dcadd31b90b">DF_OUTPUT</a>)
<a name="l00298"></a>00298          m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> += pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga1451258cb714852eef78ec04e7970f65">channels</a>;
<a name="l00299"></a>00299    }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> == 0 &amp;&amp; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> == 0) {
<a name="l00302"></a>00302       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;multi_init&quot;</span>, <span class="stringliteral">&quot;No channels found in device driver list&quot;</span>);
<a name="l00303"></a>00303       <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga8a0cc5de6ea758c61231a11b6a076e1f">FE_ERR_ODB</a>;
<a name="l00304"></a>00304    }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306    <span class="comment">/* Allocate memory for buffers */</span>
<a name="l00307"></a>00307    m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> = (<span class="keywordtype">char</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>);
<a name="l00308"></a>00308    m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> = (<span class="keywordtype">char</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00311"></a>00311    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00312"></a>00312 
<a name="l00313"></a>00313    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00314"></a>00314    m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00315"></a>00315    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00316"></a>00316    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00317"></a>00317    m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00318"></a>00318 
<a name="l00319"></a>00319    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6309e5146b05bc3b935b1f966bc8c203">input_mirror</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00320"></a>00320    m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a> = (<span class="keywordtype">float</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00321"></a>00321 
<a name="l00322"></a>00322    m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a> = (<span class="keywordtype">void</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));
<a name="l00323"></a>00323    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a> = (<span class="keywordtype">void</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));
<a name="l00324"></a>00324    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a> = (<a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a>));
<a name="l00325"></a>00325    m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a> =
<a name="l00326"></a>00326        (<a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>));
<a name="l00327"></a>00327 
<a name="l00328"></a>00328    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a97604043bca220b87f1bfbc982143328">driver_input</a> = (<span class="keywordtype">void</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));
<a name="l00329"></a>00329    m_info-&gt;<a class="code" href="structMULTI__INFO.html#aebe278274ba2e945ad0c94338804ab7d">driver_output</a> = (<span class="keywordtype">void</span> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *));
<a name="l00330"></a>00330 
<a name="l00331"></a>00331    m_info-&gt;<a class="code" href="structMULTI__INFO.html#a0fb1840756e9f8699a79afb74bf66805">flags_input</a> = (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>));
<a name="l00332"></a>00332    m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa801a04d0f7a197f9e7583f4d0b2235c">flags_output</a> = (<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> *) calloc(m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <span class="keyword">sizeof</span>(<a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a>));
<a name="l00333"></a>00333 
<a name="l00334"></a>00334    <span class="keywordflow">if</span> (!m_info-&gt;<a class="code" href="structMULTI__INFO.html#aebe278274ba2e945ad0c94338804ab7d">driver_output</a>) {
<a name="l00335"></a>00335       <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;multi_init&quot;</span>, <span class="stringliteral">&quot;Not enough memory&quot;</span>);
<a name="l00336"></a>00336       <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga8a0cc5de6ea758c61231a11b6a076e1f">FE_ERR_ODB</a>;
<a name="l00337"></a>00337    }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339   <span class="comment">/*---- Create/Read settings ----*/</span>
<a name="l00340"></a>00340 
<a name="l00341"></a>00341    <span class="comment">/* Names */</span>
<a name="l00342"></a>00342    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00343"></a>00343       sprintf(m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i, <span class="stringliteral">&quot;Input Channel %d&quot;</span>, i);
<a name="l00344"></a>00344    <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Input&quot;</span>,
<a name="l00345"></a>00345                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>,
<a name="l00346"></a>00346                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>);
<a name="l00347"></a>00347    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++)
<a name="l00348"></a>00348       sprintf(m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i, <span class="stringliteral">&quot;Output Channel %d&quot;</span>, i);
<a name="l00349"></a>00349    <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Output&quot;</span>,
<a name="l00350"></a>00350                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a>,
<a name="l00351"></a>00351                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>);
<a name="l00352"></a>00352 
<a name="l00353"></a>00353    <span class="comment">/* Update threshold */</span>
<a name="l00354"></a>00354    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00355"></a>00355       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a>[i] = 0.1f;       <span class="comment">/* default 0.1 */</span>
<a name="l00356"></a>00356    <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Update Threshold&quot;</span>,
<a name="l00357"></a>00357                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00358"></a>00358                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00359"></a>00359    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Update Threshold&quot;</span>, &amp;hKey);
<a name="l00360"></a>00360    <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a>,
<a name="l00361"></a>00361                   m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363    <span class="comment">/* Offset */</span>
<a name="l00364"></a>00364    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00365"></a>00365       m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>[i] = 0.f;    <span class="comment">/* default 0 */</span>
<a name="l00366"></a>00366    <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Input Offset&quot;</span>,
<a name="l00367"></a>00367                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00368"></a>00368                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00369"></a>00369    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Input Offset&quot;</span>, &amp;hKey);
<a name="l00370"></a>00370    <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>,
<a name="l00371"></a>00371                   m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++)
<a name="l00374"></a>00374       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>[i] = 0.f;
<a name="l00375"></a>00375 
<a name="l00376"></a>00376    <a class="code" href="generate-MODULES_8h.html#aaac43492f2954cc70dd9a286b2b3ab02">if</a> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>) {
<a name="l00377"></a>00377       <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Output Offset&quot;</span>,
<a name="l00378"></a>00378                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00379"></a>00379                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00380"></a>00380       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Output Offset&quot;</span>, &amp;hKey);
<a name="l00381"></a>00381       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>,
<a name="l00382"></a>00382                      m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l00383"></a>00383    }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385    <span class="comment">/* Factor */</span>
<a name="l00386"></a>00386    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00387"></a>00387       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>[i] = 1.f;    <span class="comment">/* default 1 */</span>
<a name="l00388"></a>00388 
<a name="l00389"></a>00389    <a class="code" href="generate-MODULES_8h.html#aaac43492f2954cc70dd9a286b2b3ab02">if</a> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>) {
<a name="l00390"></a>00390       <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Input Factor&quot;</span>,
<a name="l00391"></a>00391                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00392"></a>00392                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00393"></a>00393       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Input factor&quot;</span>, &amp;hKey);
<a name="l00394"></a>00394       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>,
<a name="l00395"></a>00395                      m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l00396"></a>00396    }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>) {
<a name="l00399"></a>00399       <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++)
<a name="l00400"></a>00400          m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>[i] = 1.f;
<a name="l00401"></a>00401       <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Output Factor&quot;</span>,
<a name="l00402"></a>00402                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00403"></a>00403                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00404"></a>00404       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Output factor&quot;</span>, &amp;hKey);
<a name="l00405"></a>00405       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>,
<a name="l00406"></a>00406                      m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, NULL, NULL);
<a name="l00407"></a>00407    }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409   <span class="comment">/*---- Create/Read variables ----*/</span>
<a name="l00410"></a>00410 
<a name="l00411"></a>00411    <span class="comment">/* Input */</span>
<a name="l00412"></a>00412    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>) {
<a name="l00413"></a>00413       <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Variables/Input&quot;</span>,
<a name="l00414"></a>00414                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00415"></a>00415                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00416"></a>00416       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Variables/Input&quot;</span>, &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#a3e5965282f266764a416d87d510d1e60">hKeyInput</a>);
<a name="l00417"></a>00417       memcpy(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6309e5146b05bc3b935b1f966bc8c203">input_mirror</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>,
<a name="l00418"></a>00418              m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00419"></a>00419    }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421    <span class="comment">/* Output */</span>
<a name="l00422"></a>00422    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>) {
<a name="l00423"></a>00423       <a class="code" href="group__msectionh.html#ga7f9e910e062dad9ac20ab6c8bebfaab0">db_merge_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Variables/Output&quot;</span>,
<a name="l00424"></a>00424                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00425"></a>00425                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00426"></a>00426       <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Variables/Output&quot;</span>, &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7bbc9c947f32907a6e4354ba41f71c99">hKeyOutput</a>);
<a name="l00427"></a>00427    }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <span class="comment">/*---- Initialize device drivers ----*/</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431    <span class="comment">/* call init method */</span>
<a name="l00432"></a>00432    <span class="keywordflow">for</span> (i = 0; pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="structDEVICE__DRIVER.html#a3c47bfe572999fec51df9c6072d6c6d7">name</a>[0]; i++) {
<a name="l00433"></a>00433       sprintf(str, <span class="stringliteral">&quot;Settings/Devices/%s&quot;</span>, pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="structDEVICE__DRIVER.html#a3c47bfe572999fec51df9c6072d6c6d7">name</a>);
<a name="l00434"></a>00434       status = <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, str, &amp;hKey);
<a name="l00435"></a>00435       <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l00436"></a>00436          <a class="code" href="group__msectionh.html#ga1441e5b7ca1923cf8611f920cf2c31b4">db_create_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, str, <a class="code" href="group__mdefineh.html#ga15ae151ae0b7588b3327bd8451d9bcb8">TID_KEY</a>);
<a name="l00437"></a>00437          status = <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, str, &amp;hKey);
<a name="l00438"></a>00438          <span class="keywordflow">if</span> (status != <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>) {
<a name="l00439"></a>00439             <a class="code" href="lrs1821_8h.html#aa6f8a5999f0a072ce20ab87bae8a9eb5">cm_msg</a>(<a class="code" href="lrs1821_8h.html#ac2d967025ca0f84f611d568f4ede934a">MERROR</a>, <span class="stringliteral">&quot;multi_init&quot;</span>, <span class="stringliteral">&quot;Cannot create %s entry in online database&quot;</span>,
<a name="l00440"></a>00440                    str);
<a name="l00441"></a>00441             <a class="code" href="multi_8c.html#a50f62fef60ae692657115cf15280f9da">free_mem</a>(m_info);
<a name="l00442"></a>00442             <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga8a0cc5de6ea758c61231a11b6a076e1f">FE_ERR_ODB</a>;
<a name="l00443"></a>00443          }
<a name="l00444"></a>00444       }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       status = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">dd</a>(<a class="code" href="group__err26.html#ga2677fc43f8393bcf3bafc8bbface003f">CMD_INIT</a>, hKey, &amp;pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga334e4f80981fd4d70bb6ebea2fe3e911">dd_info</a>,
<a name="l00447"></a>00447                                         pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga1451258cb714852eef78ec04e7970f65">channels</a>,
<a name="l00448"></a>00448                                         pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a>,
<a name="l00449"></a>00449                                         pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[i].<a class="code" href="group__midasincludecode.html#ga885e46846e92facb6222f6a430127772">bd</a>);
<a name="l00450"></a>00450       <span class="keywordflow">if</span> (status != <a class="code" href="group__err26.html#ga23395a243c74edd61ed4ce0df1256419">FE_SUCCESS</a>) {
<a name="l00451"></a>00451          <a class="code" href="multi_8c.html#a50f62fef60ae692657115cf15280f9da">free_mem</a>(m_info);
<a name="l00452"></a>00452          <span class="keywordflow">return</span> status;
<a name="l00453"></a>00453       }
<a name="l00454"></a>00454    }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456    <span class="comment">/* compose device driver channel assignment */</span>
<a name="l00457"></a>00457    <span class="keywordflow">for</span> (i = 0, j = 0, index = 0, ch_offset = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++, j++) {
<a name="l00458"></a>00458       <span class="keywordflow">while</span> (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="structDEVICE__DRIVER.html#a3c47bfe572999fec51df9c6072d6c6d7">name</a>[0] &amp;&amp;
<a name="l00459"></a>00459              (j &gt;= pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#ga1451258cb714852eef78ec04e7970f65">channels</a> ||
<a name="l00460"></a>00460               (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a> &amp; DF_INPUT) == 0)) {
<a name="l00461"></a>00461          ch_offset += j;
<a name="l00462"></a>00462          index++;
<a name="l00463"></a>00463          j = 0;
<a name="l00464"></a>00464       }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a0fb1840756e9f8699a79afb74bf66805">flags_input</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a>;
<a name="l00467"></a>00467       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a97604043bca220b87f1bfbc982143328">driver_input</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">dd</a>;
<a name="l00468"></a>00468       m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#ga334e4f80981fd4d70bb6ebea2fe3e911">dd_info</a>;
<a name="l00469"></a>00469       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[i] = ch_offset;
<a name="l00470"></a>00470    }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472    <span class="keywordflow">for</span> (i = 0, j = 0, index = 0, ch_offset = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++, j++) {
<a name="l00473"></a>00473       <span class="keywordflow">while</span> (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="structDEVICE__DRIVER.html#a3c47bfe572999fec51df9c6072d6c6d7">name</a>[0] &amp;&amp;
<a name="l00474"></a>00474              (j &gt;= pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#ga1451258cb714852eef78ec04e7970f65">channels</a> ||
<a name="l00475"></a>00475               (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a> &amp; <a class="code" href="group__mequipment.html#ga9a302762256e89a266256dcadd31b90b">DF_OUTPUT</a>) == 0)) {
<a name="l00476"></a>00476          ch_offset += j;
<a name="l00477"></a>00477          index++;
<a name="l00478"></a>00478          j = 0;
<a name="l00479"></a>00479       }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481       m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa801a04d0f7a197f9e7583f4d0b2235c">flags_output</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a>;
<a name="l00482"></a>00482       m_info-&gt;<a class="code" href="structMULTI__INFO.html#aebe278274ba2e945ad0c94338804ab7d">driver_output</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gadfdb7ee99dd506e35f65d3f8d4b41a4b">dd</a>;
<a name="l00483"></a>00483       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i] = pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#ga334e4f80981fd4d70bb6ebea2fe3e911">dd_info</a>;
<a name="l00484"></a>00484       m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i] = ch_offset;
<a name="l00485"></a>00485    }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487   <span class="comment">/*---- get default names from device driver ----*/</span>
<a name="l00488"></a>00488    size = <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * <span class="keyword">sizeof</span>(char);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Input&quot;</span>, &amp;hKey);
<a name="l00491"></a>00491    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++) {
<a name="l00492"></a>00492       <a class="code" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(i) (<a class="code" href="group__err26.html#gafebed11ff37f0ca00bc522f88bb22eab">CMD_GET_DEFAULT_NAME</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[i],
<a name="l00493"></a>00493                        i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[i],
<a name="l00494"></a>00494                        m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00495"></a>00495       <a class="code" href="group__msectionh.html#ga18f5e7743545b06fca4f3d5ce9889034">db_set_data_index</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i, size, i,
<a name="l00496"></a>00496                         <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>);
<a name="l00497"></a>00497    }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499    <a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Output&quot;</span>, &amp;hKey);
<a name="l00500"></a>00500    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++) {
<a name="l00501"></a>00501       <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#gafebed11ff37f0ca00bc522f88bb22eab">CMD_GET_DEFAULT_NAME</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00502"></a>00502                         i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00503"></a>00503                         m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00504"></a>00504       <a class="code" href="group__msectionh.html#ga18f5e7743545b06fca4f3d5ce9889034">db_set_data_index</a>(hDB, hKey, m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i, size, i,
<a name="l00505"></a>00505                         <a class="code" href="group__mdefineh.html#gab81af1d9631a5c29500d506f0c3470cd">TID_STRING</a>);
<a name="l00506"></a>00506    }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   <span class="comment">/*---- set labels form midas SC names ----*/</span>
<a name="l00509"></a>00509    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++) {
<a name="l00510"></a>00510       <a class="code" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(i) (<a class="code" href="group__err26.html#gaa0706cd66be2ae6e198adc217c2ad9bf">CMD_SET_LABEL</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[i],
<a name="l00511"></a>00511                        i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[i],
<a name="l00512"></a>00512                        m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00513"></a>00513    }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515    <span class="comment">/* open hotlink on input channel names */</span>
<a name="l00516"></a>00516    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Input&quot;</span>, &amp;hNamesIn) ==
<a name="l00517"></a>00517        <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00518"></a>00518       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hNamesIn, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a>,
<a name="l00519"></a>00519                      <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>,
<a name="l00520"></a>00520                      <a class="code" href="multi_8c.html#a450382feec02560369f48b99a40824dd">multi_update_label</a>, pequipment);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++) {
<a name="l00523"></a>00523       <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#gaa0706cd66be2ae6e198adc217c2ad9bf">CMD_SET_LABEL</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00524"></a>00524                         i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00525"></a>00525                         m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00526"></a>00526    }
<a name="l00527"></a>00527 
<a name="l00528"></a>00528    <span class="comment">/* open hotlink on output channel names */</span>
<a name="l00529"></a>00529    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>) {
<a name="l00530"></a>00530       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga2c6408e2f225703c9a666a2ab23d7680">db_find_key</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6e541e5cc16a1d24c42be1916873b639">hKeyRoot</a>, <span class="stringliteral">&quot;Settings/Names Output&quot;</span>, &amp;hNamesOut) ==
<a name="l00531"></a>00531           <a class="code" href="group__err23.html#ga4d6ab4d32144d851ddeb7931b81a63e3">DB_SUCCESS</a>)
<a name="l00532"></a>00532          <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, hNamesOut, m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a>,
<a name="l00533"></a>00533                         <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>, <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>,
<a name="l00534"></a>00534                         <a class="code" href="multi_8c.html#a450382feec02560369f48b99a40824dd">multi_update_label</a>, pequipment);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536       <span class="comment">/* open hot link to output record */</span>
<a name="l00537"></a>00537       <a class="code" href="group__msectionh.html#ga3495173a9725dc8c44167b71560aa290">db_open_record</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7bbc9c947f32907a6e4354ba41f71c99">hKeyOutput</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>,
<a name="l00538"></a>00538                      m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),
<a name="l00539"></a>00539                      <a class="code" href="group__mdefineh.html#gac4d1baf108e9ce6414088db508d7c182">MODE_READ</a>, <a class="code" href="multi_8c.html#afd1b271d67ec26c8d5e403ae63fab244">multi_output</a>, pequipment);
<a name="l00540"></a>00540    }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542    <span class="comment">/* set initial demand values */</span>
<a name="l00543"></a>00543    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++) {
<a name="l00544"></a>00544       <span class="keywordflow">if</span> (pequipment-&gt;<a class="code" href="group__midasincludecode.html#gaf19c464fc7092048c9418328ca4e4afc">driver</a>[index].<a class="code" href="group__midasincludecode.html#gac40f8fcceded9b51b8a772a66f874087">flags</a> &amp; <a class="code" href="group__mequipment.html#ga14cf699d29a6edd2088b83e17cda6744">DF_PRIO_DEVICE</a>) {
<a name="l00545"></a>00545          <span class="comment">/* read default value from device */</span>
<a name="l00546"></a>00546          <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#ga39f82f93564bba7925fd849ce7967a2b">CMD_GET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00547"></a>00547                            i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00548"></a>00548                            &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i]);
<a name="l00549"></a>00549       } <span class="keywordflow">else</span> {
<a name="l00550"></a>00550          <span class="comment">/* use default value from ODB */</span>
<a name="l00551"></a>00551          m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i] = m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>[i] * m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>[i] -
<a name="l00552"></a>00552              m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>[i];
<a name="l00553"></a>00553 
<a name="l00554"></a>00554          <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#gabb268d264836b9443ef23350814c0f68">CMD_SET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00555"></a>00555                            i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00556"></a>00556                            m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i]);
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558    }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560    <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>)
<a name="l00561"></a>00561       <a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7bbc9c947f32907a6e4354ba41f71c99">hKeyOutput</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>,
<a name="l00562"></a>00562                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), 0);
<a name="l00563"></a>00563 
<a name="l00564"></a>00564    <span class="comment">/* initially read all channels */</span>
<a name="l00565"></a>00565    <a class="code" href="multi_8c.html#a6d7601caf3c73f01d85c4c91ae024a9d">multi_read</a>(pequipment, -1);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567    <span class="keywordflow">return</span> <a class="code" href="group__err26.html#ga23395a243c74edd61ed4ce0df1256419">FE_SUCCESS</a>;
<a name="l00568"></a>00568 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afd1b271d67ec26c8d5e403ae63fab244"></a><!-- doxytag: member="multi.c::multi_output" ref="afd1b271d67ec26c8d5e403ae63fab244" args="(INT hDB, INT hKey, void *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multi_output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00212">212</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_output</a>, <a class="el" href="midas_8h_source.html#l01129">CMD_SET</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_output</a>, <a class="el" href="multi_8c_source.html#l00092">DRIVER_OUTPUT</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_output</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>, <a class="el" href="midas_8h_source.html#l01407">eqpmnt::odb_in</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_output</a>, <a class="el" href="multi_8c_source.html#l00082">MULTI_INFO::output_mirror</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, and <a class="el" href="multi_8c_source.html#l00073">MULTI_INFO::var_output</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00213"></a>00213 {
<a name="l00214"></a>00214    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00215"></a>00215    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> act_time;
<a name="l00216"></a>00216    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00217"></a>00217    <a class="code" href="structeqpmnt.html">EQUIPMENT</a> *pequipment;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219    pequipment = (<a class="code" href="structeqpmnt.html">EQUIPMENT</a> *) info;
<a name="l00220"></a>00220    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222    act_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l00223"></a>00223 
<a name="l00224"></a>00224    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++) {
<a name="l00225"></a>00225       <span class="comment">/* only set channel if demand value differs */</span>
<a name="l00226"></a>00226       <span class="keywordflow">if</span> (m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>[i] != m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i]) {
<a name="l00227"></a>00227          m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i] =
<a name="l00228"></a>00228              m_info-&gt;<a class="code" href="structMULTI__INFO.html#a1016764a8579793d9bd4e259fb60148b">var_output</a>[i] * m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>[i] - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>[i];
<a name="l00229"></a>00229 
<a name="l00230"></a>00230          <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#gabb268d264836b9443ef23350814c0f68">CMD_SET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00231"></a>00231                            i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00232"></a>00232                            m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[i]);
<a name="l00233"></a>00233       }
<a name="l00234"></a>00234    }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    pequipment-&gt;<a class="code" href="group__midasincludecode.html#gab487ff66b0ceb7677a3e664717158c51">odb_in</a>++;
<a name="l00237"></a>00237 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d7601caf3c73f01d85c4c91ae024a9d"></a><!-- doxytag: member="multi.c::multi_read" ref="a6d7601caf3c73f01d85c4c91ae024a9d" args="(EQUIPMENT *pequipment, int channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multi_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>channel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00133">133</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="generic_8c_source.html#l00091">abs</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00324">actual_time</a>, <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_input</a>, <a class="el" href="midas_8c_source.html#l02913">cm_get_experiment_database()</a>, <a class="el" href="midas_8h_source.html#l01131">CMD_GET</a>, <a class="el" href="odb_8c_source.html#l04503">db_set_data()</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_input</a>, <a class="el" href="multi_8c_source.html#l00091">DRIVER_INPUT</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_input</a>, <a class="el" href="mucap__compress_8cpp_source.html#l00011">hDB</a>, <a class="el" href="multi_8c_source.html#l00062">MULTI_INFO::hKeyInput</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="multi_8c_source.html#l00081">MULTI_INFO::input_mirror</a>, <a class="el" href="multi_8c_source.html#l00068">MULTI_INFO::last_update</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_input</a>, <a class="el" href="midas_8h_source.html#l01406">eqpmnt::odb_out</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_input</a>, <a class="el" href="system_8c_source.html#l02265">ss_millitime()</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="midas_8h_source.html#l00743">TID_FLOAT</a>, <a class="el" href="multi_8c_source.html#l00076">MULTI_INFO::update_threshold</a>, and <a class="el" href="multi_8c_source.html#l00072">MULTI_INFO::var_input</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00587">multi_idle()</a>, and <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00134"></a>00134 {
<a name="l00135"></a>00135    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l00136"></a>00136    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#a6431147bd66aebfe3ca728d244da1253">actual_time</a>;
<a name="l00137"></a>00137    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00138"></a>00138    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00141"></a>00141    <a class="code" href="group__msectionh.html#ga1932e7947b0a024a845c5b8c19c3dda0">cm_get_experiment_database</a>(&amp;hDB, NULL);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143    <span class="keywordflow">if</span> (<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a> == -1)
<a name="l00144"></a>00144       <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++) {
<a name="l00145"></a>00145          status = <a class="code" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(i) (<a class="code" href="group__err26.html#ga39f82f93564bba7925fd849ce7967a2b">CMD_GET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[i],
<a name="l00146"></a>00146                                    i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[i],
<a name="l00147"></a>00147                                    &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[i]);
<a name="l00148"></a>00148          m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[i] = m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[i] * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>[i] -
<a name="l00149"></a>00149              m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>[i];
<a name="l00150"></a>00150    } <span class="keywordflow">else</span> {
<a name="l00151"></a>00151       status = <a class="code" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>) (<a class="code" href="group__err26.html#ga39f82f93564bba7925fd849ce7967a2b">CMD_GET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>],
<a name="l00152"></a>00152                                       <a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a> - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>],
<a name="l00153"></a>00153                                       &amp;m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>]);
<a name="l00154"></a>00154       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>] =
<a name="l00155"></a>00155           m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>] * m_info-&gt;<a class="code" href="structMULTI__INFO.html#a95e64a001093a553ffcc2a0930233694">factor_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>] -
<a name="l00156"></a>00156           m_info-&gt;<a class="code" href="structMULTI__INFO.html#abcc115f42ea2f9a22384795e85f1500e">offset_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>];
<a name="l00157"></a>00157    }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159    <span class="comment">/* check if significant change since last ODB update */</span>
<a name="l00160"></a>00160    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00161"></a>00161       <span class="keywordflow">if</span> (<a class="code" href="generic_8c.html#a6a010865b10e541735fa2da8f3cd062d">abs</a>(m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[i] - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6309e5146b05bc3b935b1f966bc8c203">input_mirror</a>[i]) &gt;
<a name="l00162"></a>00162           m_info-&gt;<a class="code" href="structMULTI__INFO.html#a61e8abf84b1a0e5338dd2764a546927d">update_threshold</a>[i])
<a name="l00163"></a>00163          <span class="keywordflow">break</span>;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165    <span class="comment">/* update if change is more than update_sensitivity or last update more</span>
<a name="l00166"></a>00166 <span class="comment">      than a minute ago */</span>
<a name="l00167"></a>00167    actual_time = <a class="code" href="group__msectionh.html#gaeb8fc912d50c2360588c50782b9c916d">ss_millitime</a>();
<a name="l00168"></a>00168    <span class="keywordflow">if</span> (i &lt; m_info-&gt;num_channels_input || actual_time - m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa72fec0bc97346aeb25ccfe66d91e273">last_update</a> &gt; 60000) {
<a name="l00169"></a>00169       m_info-&gt;<a class="code" href="structMULTI__INFO.html#aa72fec0bc97346aeb25ccfe66d91e273">last_update</a> = actual_time;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171       <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00172"></a>00172          m_info-&gt;<a class="code" href="structMULTI__INFO.html#a6309e5146b05bc3b935b1f966bc8c203">input_mirror</a>[i] = m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[i];
<a name="l00173"></a>00173 
<a name="l00174"></a>00174       <a class="code" href="group__msectionh.html#ga6b98aa5ac9036c49023c0cc9353922d4">db_set_data</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a3e5965282f266764a416d87d510d1e60">hKeyInput</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>,
<a name="l00175"></a>00175                   m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>,
<a name="l00176"></a>00176                   <a class="code" href="group__mdefineh.html#gae932ec1b283f6c4b9c30a6d489beea7f">TID_FLOAT</a>);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       pequipment-&gt;<a class="code" href="group__midasincludecode.html#ga2ba622da82fc7a02605e5f630464b13f">odb_out</a>++;
<a name="l00179"></a>00179    }
<a name="l00180"></a>00180 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a45daac7102a21d6e94f565a9d7e8d89c"></a><!-- doxytag: member="multi.c::multi_read_output" ref="a45daac7102a21d6e94f565a9d7e8d89c" args="(EQUIPMENT *pequipment, int channel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multi_read_output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structeqpmnt.html">EQUIPMENT</a> *&nbsp;</td>
          <td class="paramname"> <em>pequipment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>channel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00184">184</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_output</a>, <a class="el" href="midas_8c_source.html#l02913">cm_get_experiment_database()</a>, <a class="el" href="midas_8h_source.html#l01131">CMD_GET</a>, <a class="el" href="odb_8c_source.html#l06874">db_set_record()</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_output</a>, <a class="el" href="multi_8c_source.html#l00092">DRIVER_OUTPUT</a>, <a class="el" href="multi_8c_source.html#l00077">MULTI_INFO::factor_output</a>, <a class="el" href="mucap__compress_8cpp_source.html#l00011">hDB</a>, <a class="el" href="multi_8c_source.html#l00062">MULTI_INFO::hKeyOutput</a>, <a class="el" href="generate-MODULES_8h_source.html#l00003">if</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>, <a class="el" href="midas_8h_source.html#l01406">eqpmnt::odb_out</a>, <a class="el" href="multi_8c_source.html#l00078">MULTI_INFO::offset_output</a>, <a class="el" href="multi_8c_source.html#l00082">MULTI_INFO::output_mirror</a>, <a class="el" href="ADCS_8h_source.html#l00004">value</a>, and <a class="el" href="multi_8c_source.html#l00072">MULTI_INFO::var_input</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00587">multi_idle()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00185"></a>00185 {
<a name="l00186"></a>00186    <span class="keywordtype">float</span> <a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;
<a name="l00187"></a>00187    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00188"></a>00188    <a class="code" href="group__midasincludecode.html#ga0e1bcf128ad8422667adffd1dea59791">HNDLE</a> <a class="code" href="mucap__compress_8cpp.html#ab1f60c53f74e806a3b9f687af38d7421">hDB</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00191"></a>00191    <a class="code" href="group__msectionh.html#ga1932e7947b0a024a845c5b8c19c3dda0">cm_get_experiment_database</a>(&amp;hDB, NULL);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193    <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>) (<a class="code" href="group__err26.html#ga39f82f93564bba7925fd849ce7967a2b">CMD_GET</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>],
<a name="l00194"></a>00194                            <a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a> - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>], &amp;value);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196    value = (value + m_info-&gt;<a class="code" href="structMULTI__INFO.html#a2ca3555dcf87222b791d8b29b512d14d">offset_output</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>]) / m_info-&gt;<a class="code" href="structMULTI__INFO.html#ab389a0b5cde23036f24d776090cc3001">factor_output</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>];
<a name="l00197"></a>00197 
<a name="l00198"></a>00198    <a class="code" href="generate-MODULES_8h.html#aaac43492f2954cc70dd9a286b2b3ab02">if</a> (value != m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>]) {
<a name="l00199"></a>00199       m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>] = value;
<a name="l00200"></a>00200       m_info-&gt;<a class="code" href="structMULTI__INFO.html#a8a4932970190ffacb2db84f2494e29ea">var_input</a>[<a class="code" href="ADCS_8h.html#adf7dff2c57c0da9a4a2b70e3e815be31">channel</a>] = value;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202       <a class="code" href="group__msectionh.html#ga793daffa9cdc43b03465a1f2e82e58fc">db_set_record</a>(hDB, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7bbc9c947f32907a6e4354ba41f71c99">hKeyOutput</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#adcfcafc24b0b8a503321914a2a15a8ea">output_mirror</a>,
<a name="l00203"></a>00203                     m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), 0);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205       pequipment-&gt;<a class="code" href="group__midasincludecode.html#ga2ba622da82fc7a02605e5f630464b13f">odb_out</a>++;
<a name="l00206"></a>00206    }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a450382feec02560369f48b99a40824dd"></a><!-- doxytag: member="multi.c::multi_update_label" ref="a450382feec02560369f48b99a40824dd" args="(INT hDB, INT hKey, void *info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void multi_update_label </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="odbhist_8c.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&nbsp;</td>
          <td class="paramname"> <em>hKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="multi_8c_source.html#l00241">241</a> of file <a class="el" href="multi_8c_source.html">multi.c</a>.</p>

<p>References <a class="el" href="midas_8h_source.html#l01396">eqpmnt::cd_info</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_input</a>, <a class="el" href="multi_8c_source.html#l00085">MULTI_INFO::channel_offset_output</a>, <a class="el" href="midas_8h_source.html#l01140">CMD_SET_LABEL</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_input</a>, <a class="el" href="multi_8c_source.html#l00086">MULTI_INFO::dd_info_output</a>, <a class="el" href="multi_8c_source.html#l00091">DRIVER_INPUT</a>, <a class="el" href="multi_8c_source.html#l00092">DRIVER_OUTPUT</a>, <a class="el" href="patch__mevb_8cpp.html#acf1ade676fe2e98c5ee44131e9f23abb">for()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="midas_8h_source.html#l00681">NAME_LENGTH</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_input</a>, <a class="el" href="multi_8c_source.html#l00071">MULTI_INFO::names_output</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_input</a>, <a class="el" href="multi_8c_source.html#l00065">MULTI_INFO::num_channels_output</a>, and <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>.</p>

<p>Referenced by <a class="el" href="multi_8c_source.html#l00264">multi_init()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00242"></a>00242 {
<a name="l00243"></a>00243    <a class="code" href="lrs1190_8c.html#a6877c9d7ac317ac3415ee1a1f92302a0">INT</a> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l00244"></a>00244    <a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *m_info;
<a name="l00245"></a>00245    <a class="code" href="structeqpmnt.html">EQUIPMENT</a> *pequipment;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247    pequipment = (<a class="code" href="structeqpmnt.html">EQUIPMENT</a> *) info;
<a name="l00248"></a>00248    m_info = (<a class="code" href="structMULTI__INFO.html">MULTI_INFO</a> *) pequipment-&gt;<a class="code" href="group__midasincludecode.html#gac88537c1672f32d13a99ce6822fc4d46">cd_info</a>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250    <span class="comment">/* update channel labels based on the midas channel names */</span>
<a name="l00251"></a>00251    <a class="code" href="patch__mevb_8cpp.html#acf1ade676fe2e98c5ee44131e9f23abb">for</a> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#a605ccf623ff9fea770a5c51cc67f3c03">num_channels_input</a>; i++)
<a name="l00252"></a>00252       status = <a class="code" href="multi_8c.html#a10afc22a09702b4c6be6a44ed1bfe844">DRIVER_INPUT</a>(i) (<a class="code" href="group__err26.html#gaa0706cd66be2ae6e198adc217c2ad9bf">CMD_SET_LABEL</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#ae2df1aebbcc734b2e800fe37fb0736bb">dd_info_input</a>[i],
<a name="l00253"></a>00253                                 i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#a7f5db4bc187aaf6e79b1c763d657c74f">channel_offset_input</a>[i],
<a name="l00254"></a>00254                                 m_info-&gt;<a class="code" href="structMULTI__INFO.html#ac2f49c304e9cf615cd8bb81ffbc2ef47">names_input</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256    <span class="keywordflow">for</span> (i = 0; i &lt; m_info-&gt;<a class="code" href="structMULTI__INFO.html#acd3698a1c4455d2900af32336daf0bd3">num_channels_output</a>; i++)
<a name="l00257"></a>00257       status = <a class="code" href="multi_8c.html#af9a77e5b2b43b4d855433735a0ee6c8e">DRIVER_OUTPUT</a>(i) (<a class="code" href="group__err26.html#gaa0706cd66be2ae6e198adc217c2ad9bf">CMD_SET_LABEL</a>, m_info-&gt;<a class="code" href="structMULTI__INFO.html#a902c45ee77346d469f1653f436d1d445">dd_info_output</a>[i],
<a name="l00258"></a>00258                                  i - m_info-&gt;<a class="code" href="structMULTI__INFO.html#af53aa58515ad99ac692b141efec1ee42">channel_offset_output</a>[i],
<a name="l00259"></a>00259                                  m_info-&gt;<a class="code" href="structMULTI__INFO.html#af4f756be20a2dd22d2280f32a4aed191">names_output</a> + <a class="code" href="group__midasincludecode.html#gaf71324c57f05ff9e24bd384925dd6b17">NAME_LENGTH</a> * i);
<a name="l00260"></a>00260 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ:Rootana by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
