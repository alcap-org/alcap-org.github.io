<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ:Rootana: midas/drivers/bus/sis3100/sis3100.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/drivers/bus/sis3100/sis3100.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="midas_2include_2mvmestd_8h_source.html">mvmestd.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="PlxApi_8h_source.html">PlxApi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sis1100w_8h_source.html">sis1100w.h</a>&quot;</code><br/>

<p><a href="sis3100_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSIS3100__DEVICE.html">SIS3100_DEVICE</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#aa1d3ee9f4f650af45b61b0033d1766a2">MAX_SIS3100_DEVICES</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#af0c3d5e1b345b262ea20e9884b05155b">mvme_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#a470a421d1da403c690199015c16b6949">mvme_exit</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#a4682e27c236787a30148c6cb5ffc05e9">mvme_write</a> (<a class="el" href="midas_2include_2mvmestd_8h.html#ae815b2a8f51a3c2f1f285928e715b5e0">mvme_addr_t</a> vme_addr, void *src, <a class="el" href="midas_2include_2mvmestd_8h.html#abf7034f28d8136316e777f74d46167d9">mvme_size_t</a> n_bytes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#a9c413a01104a0a13a60f1b6e29165add">mvme_read</a> (void *dst, <a class="el" href="midas_2include_2mvmestd_8h.html#ae815b2a8f51a3c2f1f285928e715b5e0">mvme_addr_t</a> vme_addr, <a class="el" href="midas_2include_2mvmestd_8h.html#abf7034f28d8136316e777f74d46167d9">mvme_size_t</a> n_bytes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#a39e80decf554cb3651adb087b81ceb74">mvme_ioctl</a> (int req, int *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSIS3100__DEVICE.html">SIS3100_DEVICE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a> [MAX_SIS3100_DEVICES]</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa1d3ee9f4f650af45b61b0033d1766a2"></a><!-- doxytag: member="sis3100.c::MAX_SIS3100_DEVICES" ref="aa1d3ee9f4f650af45b61b0033d1766a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SIS3100_DEVICES&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00030">30</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a470a421d1da403c690199015c16b6949"></a><!-- doxytag: member="sis3100.c::mvme_exit" ref="a470a421d1da403c690199015c16b6949" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mvme_exit </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00077">77</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00061">MVME_SUCCESS</a>, <a class="el" href="sis3100_8c_source.html#l00032">n_sis3100</a>, and <a class="el" href="sis1100w_8h.html#af94722f1b38d6405510112a73fb695f2">sis1100w_Close()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00078"></a>00078 {
<a name="l00079"></a>00079    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081    <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a> ; i++)
<a name="l00082"></a>00082       <a class="code" href="sis1100w_8h.html#af94722f1b38d6405510112a73fb695f2">sis1100w_Close</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].sis1100_dev);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga1671785ba0bbf639935547e7b1d3f641">MVME_SUCCESS</a>;
<a name="l00085"></a>00085 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af0c3d5e1b345b262ea20e9884b05155b"></a><!-- doxytag: member="sis3100.c::mvme_init" ref="af0c3d5e1b345b262ea20e9884b05155b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mvme_init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00045">45</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>References <a class="el" href="sis3100_8c_source.html#l00036">SIS3100_DEVICE::amod</a>, <a class="el" href="sis3100_8c_source.html#l00037">SIS3100_DEVICE::dma</a>, <a class="el" href="sis3100_8c_source.html#l00038">SIS3100_DEVICE::fifo_mode</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="sis3100_8c_source.html#l00032">i_sis3100</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00114">MVME_AMOD_A32</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00063">MVME_NO_CRATE</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00062">MVME_NO_INTERFACE</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00061">MVME_SUCCESS</a>, <a class="el" href="sis3100_8c_source.html#l00032">n_sis3100</a>, <a class="el" href="sis1100w_8h.html#a90448ade4c473070fe2f73692e9c819a">sis1100w_Find_No_Of_sis1100()</a>, <a class="el" href="sis1100w_8h.html#a8ad165831386e9473880874c3493c361">sis1100w_Get_Handle_And_Open()</a>, <a class="el" href="sis1100w_8h.html#ab021c35e2e2de3f57d16dcf72c147c49">sis1100w_Init()</a>, and <a class="el" href="sis1100w_8h.html#a59de828323c8c659d85c457eff825778">sis1100w_Init_sis3100()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00046"></a>00046 {
<a name="l00047"></a>00047    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049         <a class="code" href="sis1100w_8h.html#a90448ade4c473070fe2f73692e9c819a">sis1100w_Find_No_Of_sis1100</a>(&amp;<a class="code" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a>);
<a name="l00050"></a>00050    <span class="keywordflow">if</span> (<a class="code" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a> == 0)
<a name="l00051"></a>00051       <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga2d9377a6c82702226dbcebf66f30d636">MVME_NO_INTERFACE</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053    <span class="keywordflow">for</span> (i=0 ; i &lt; <a class="code" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a>; i++) {
<a name="l00054"></a>00054       <span class="keywordflow">if</span> (<a class="code" href="sis1100w_8h.html#a8ad165831386e9473880874c3493c361">sis1100w_Get_Handle_And_Open</a>(i+1, &amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].sis1100_dev) != 0) 
<a name="l00055"></a>00055          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga2d9377a6c82702226dbcebf66f30d636">MVME_NO_INTERFACE</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057       <span class="keywordflow">if</span> (<a class="code" href="sis1100w_8h.html#ab021c35e2e2de3f57d16dcf72c147c49">sis1100w_Init</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].sis1100_dev, 0) != 0)
<a name="l00058"></a>00058          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga2d9377a6c82702226dbcebf66f30d636">MVME_NO_INTERFACE</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060       <span class="keywordflow">if</span> (<a class="code" href="sis1100w_8h.html#a59de828323c8c659d85c457eff825778">sis1100w_Init_sis3100</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].sis1100_dev, 0) != 0)
<a name="l00061"></a>00061          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaaec0f6d5a127f40010a889f7da83ae98">MVME_NO_CRATE</a>; 
<a name="l00062"></a>00062 
<a name="l00063"></a>00063       <span class="comment">/* default values */</span>
<a name="l00064"></a>00064       <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].<a class="code" href="structSIS3100__DEVICE.html#a585ad48477f4f84e5b8f6b926ab5b2ea">amod</a>      = <a class="code" href="midas_2include_2mvmestd_8h.html#abce37d0807521d8cdb467bbe33d88d27">MVME_AMOD_A32</a>;
<a name="l00065"></a>00065       <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].<a class="code" href="structSIS3100__DEVICE.html#a88e49c21863b135750a75df902eb5a8a">dma</a>       = 0;
<a name="l00066"></a>00066       <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[i].<a class="code" href="structSIS3100__DEVICE.html#a7e07d3f03d0c25ed3fe9587cb2d8058f">fifo_mode</a> = 0;
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069    <span class="comment">/* use first device by default */</span>
<a name="l00070"></a>00070    <a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a> = 0;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga1671785ba0bbf639935547e7b1d3f641">MVME_SUCCESS</a>;
<a name="l00073"></a>00073 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a39e80decf554cb3651adb087b81ceb74"></a><!-- doxytag: member="sis3100.c::mvme_ioctl" ref="a39e80decf554cb3651adb087b81ceb74" args="(int req, int *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mvme_ioctl </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00144">144</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>References <a class="el" href="sis3100_8c_source.html#l00036">SIS3100_DEVICE::amod</a>, <a class="el" href="sis3100_8c_source.html#l00038">SIS3100_DEVICE::fifo_mode</a>, <a class="el" href="sis3100_8c_source.html#l00032">i_sis3100</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00098">MVME_IOCTL_AMOD_GET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00097">MVME_IOCTL_AMOD_SET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00096">MVME_IOCTL_CRATE_GET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00095">MVME_IOCTL_CRATE_SET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00100">MVME_IOCTL_DMA_GET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00099">MVME_IOCTL_DMA_SET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00102">MVME_IOCTL_FIFO_GET</a>, <a class="el" href="midas_2include_2mvmestd_8h_source.html#l00101">MVME_IOCTL_FIFO_SET</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00063">MVME_NO_CRATE</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00061">MVME_SUCCESS</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00064">MVME_UNSUPPORTED</a>, and <a class="el" href="sis3100_8c_source.html#l00032">n_sis3100</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00145"></a>00145 {
<a name="l00146"></a>00146    <span class="keywordflow">switch</span> (req) {
<a name="l00147"></a>00147       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a04947723fc8011a13b0b439b9d1fc7f1">MVME_IOCTL_CRATE_SET</a>:
<a name="l00148"></a>00148          *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a> = <a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>;
<a name="l00149"></a>00149          <span class="keywordflow">break</span>;
<a name="l00150"></a>00150       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a063b9517ad925f0732d965e2ac9c982c">MVME_IOCTL_CRATE_GET</a>:
<a name="l00151"></a>00151          <span class="keywordflow">if</span> (*<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a> &lt; <a class="code" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a>)
<a name="l00152"></a>00152             <a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a> = *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>;
<a name="l00153"></a>00153          <span class="keywordflow">else</span>
<a name="l00154"></a>00154             <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaaec0f6d5a127f40010a889f7da83ae98">MVME_NO_CRATE</a>;
<a name="l00155"></a>00155          <span class="keywordflow">break</span>;
<a name="l00156"></a>00156       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a3ea57fbb93a19ef5a68193a05c55491a">MVME_IOCTL_AMOD_SET</a>:
<a name="l00157"></a>00157          <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].<a class="code" href="structSIS3100__DEVICE.html#a585ad48477f4f84e5b8f6b926ab5b2ea">amod</a> = *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>;
<a name="l00158"></a>00158          <span class="keywordflow">break</span>;
<a name="l00159"></a>00159       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a253af636e2cfff9c58d98af5260ad1bc">MVME_IOCTL_AMOD_GET</a>:
<a name="l00160"></a>00160          *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a> = <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].<a class="code" href="structSIS3100__DEVICE.html#a585ad48477f4f84e5b8f6b926ab5b2ea">amod</a>;
<a name="l00161"></a>00161          <span class="keywordflow">break</span>;
<a name="l00162"></a>00162       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a081317b6168312d5cebb25b1b271c91b">MVME_IOCTL_FIFO_SET</a>:
<a name="l00163"></a>00163          <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].<a class="code" href="structSIS3100__DEVICE.html#a7e07d3f03d0c25ed3fe9587cb2d8058f">fifo_mode</a> = *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>;
<a name="l00164"></a>00164          <span class="keywordflow">break</span>;
<a name="l00165"></a>00165       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#a910b61d186cfb9b38deb29f5f506e687">MVME_IOCTL_FIFO_GET</a>:
<a name="l00166"></a>00166          *<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a> = <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].<a class="code" href="structSIS3100__DEVICE.html#a7e07d3f03d0c25ed3fe9587cb2d8058f">fifo_mode</a>;
<a name="l00167"></a>00167          <span class="keywordflow">break</span>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#afe6510ba84e1d048cfd671cfe5f2cf66">MVME_IOCTL_DMA_SET</a>:
<a name="l00170"></a>00170          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaea48d85f04ab842c42d90d0d370dcaa1">MVME_UNSUPPORTED</a>;
<a name="l00171"></a>00171       <span class="keywordflow">case</span> <a class="code" href="midas_2include_2mvmestd_8h.html#ac7591320c3fee5c0d50373f5f8e7945b">MVME_IOCTL_DMA_GET</a>:
<a name="l00172"></a>00172          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaea48d85f04ab842c42d90d0d370dcaa1">MVME_UNSUPPORTED</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174    }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#ga1671785ba0bbf639935547e7b1d3f641">MVME_SUCCESS</a>;
<a name="l00177"></a>00177 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c413a01104a0a13a60f1b6e29165add"></a><!-- doxytag: member="sis3100.c::mvme_read" ref="a9c413a01104a0a13a60f1b6e29165add" args="(void *dst, mvme_addr_t vme_addr, mvme_size_t n_bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mvme_read </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="midas_2include_2mvmestd_8h.html#ae815b2a8f51a3c2f1f285928e715b5e0">mvme_addr_t</a>&nbsp;</td>
          <td class="paramname"> <em>vme_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="midas_2include_2mvmestd_8h.html#abf7034f28d8136316e777f74d46167d9">mvme_size_t</a>&nbsp;</td>
          <td class="paramname"> <em>n_bytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00118">118</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>References <a class="el" href="lrs1821_8c_source.html#l00038">data</a>, <a class="el" href="sis3100_8c_source.html#l00032">i_sis3100</a>, <a class="el" href="camac_8c_source.html#l00506">n</a>, <a class="el" href="sis1100w_8h.html#a65ee4d29fc156b5729864f6502a02b3e">sis1100w_Vme_Dma_Read()</a>, and <a class="el" href="sis1100w_8h.html#a4d0771124c464760feeb65903e296d83">sis1100w_Vme_Single_Read()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00119"></a>00119 {
<a name="l00120"></a>00120    <a class="code" href="group__mvmestdinclude.html#ga01d0cfb7d3dd7f89dee14b82d6cd4c3b">mvme_size_t</a> <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
<a name="l00121"></a>00121    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123    data = 0;
<a name="l00124"></a>00124    <span class="keywordflow">if</span> (n_bytes &lt;= 4) {
<a name="l00125"></a>00125       data = 0;
<a name="l00126"></a>00126       n = <a class="code" href="sis1100w_8h.html#a4d0771124c464760feeb65903e296d83">sis1100w_Vme_Single_Read</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].sis1100_dev, 
<a name="l00127"></a>00127          vme_addr, <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].amod, n_bytes, &amp;data);
<a name="l00128"></a>00128       memcpy(dst, &amp;data, n_bytes);
<a name="l00129"></a>00129    } <span class="keywordflow">else</span> {
<a name="l00130"></a>00130 
<a name="l00131"></a>00131       <a class="code" href="sis1100w_8h.html#a65ee4d29fc156b5729864f6502a02b3e">sis1100w_Vme_Dma_Read</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].sis1100_dev, 
<a name="l00132"></a>00132          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) vme_addr, 
<a name="l00133"></a>00133          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].amod, 
<a name="l00134"></a>00134          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) n_bytes, 
<a name="l00135"></a>00135          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].fifo_mode,
<a name="l00136"></a>00136                         (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>*) dst, (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) n_bytes/4, (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>*) &amp;n);
<a name="l00137"></a>00137    }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139    <span class="keywordflow">return</span> n;
<a name="l00140"></a>00140 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4682e27c236787a30148c6cb5ffc05e9"></a><!-- doxytag: member="sis3100.c::mvme_write" ref="a4682e27c236787a30148c6cb5ffc05e9" args="(mvme_addr_t vme_addr, void *src, mvme_size_t n_bytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mvme_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="midas_2include_2mvmestd_8h.html#ae815b2a8f51a3c2f1f285928e715b5e0">mvme_addr_t</a>&nbsp;</td>
          <td class="paramname"> <em>vme_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="midas_2include_2mvmestd_8h.html#abf7034f28d8136316e777f74d46167d9">mvme_size_t</a>&nbsp;</td>
          <td class="paramname"> <em>n_bytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00089">89</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>References <a class="el" href="lrs1821_8c_source.html#l00038">data</a>, <a class="el" href="sis3100_8c_source.html#l00032">i_sis3100</a>, <a class="el" href="camac_8c_source.html#l00506">n</a>, <a class="el" href="sis1100w_8h.html#a4123fd1a746eec90ea0660e5ae0d538b">sis1100w_Vme_Dma_Write()</a>, <a class="el" href="sis1100w_8h.html#ad56fa243e31274dc3b05b7fba0412dfe">sis1100w_Vme_Single_Write()</a>, and <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00090"></a>00090 {
<a name="l00091"></a>00091    <a class="code" href="group__mvmestdinclude.html#ga01d0cfb7d3dd7f89dee14b82d6cd4c3b">mvme_size_t</a> <a class="code" href="camac_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>;
<a name="l00092"></a>00092    <a class="code" href="group__mvmestdinclude.html#ga798af1e30bc65f319c1a246cecf59e39">DWORD</a> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="lrs1821_8c.html#a7c3d85e54927f04c38e110e849168bb9">data</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094    <span class="keywordflow">if</span> (n_bytes &lt;= 4) {
<a name="l00095"></a>00095       data = 0;
<a name="l00096"></a>00096       memcpy(&amp;data, src, n_bytes);
<a name="l00097"></a>00097       status = <a class="code" href="sis1100w_8h.html#ad56fa243e31274dc3b05b7fba0412dfe">sis1100w_Vme_Single_Write</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].sis1100_dev, 
<a name="l00098"></a>00098          vme_addr, <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].amod, n_bytes, data);
<a name="l00099"></a>00099       <span class="keywordflow">if</span> (status == 0)
<a name="l00100"></a>00100          n = n_bytes;
<a name="l00101"></a>00101       <span class="keywordflow">else</span>
<a name="l00102"></a>00102          n = 0;
<a name="l00103"></a>00103    } <span class="keywordflow">else</span> {
<a name="l00104"></a>00104 
<a name="l00105"></a>00105       status = <a class="code" href="sis1100w_8h.html#a4123fd1a746eec90ea0660e5ae0d538b">sis1100w_Vme_Dma_Write</a>(&amp;<a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].sis1100_dev, 
<a name="l00106"></a>00106          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) vme_addr, 
<a name="l00107"></a>00107          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].amod, 
<a name="l00108"></a>00108          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) 4, 
<a name="l00109"></a>00109          (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) <a class="code" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[<a class="code" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a>].fifo_mode,
<a name="l00110"></a>00110                         (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>*) src, (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>) n_bytes/4, (<a class="code" href="PciTypes_8h.html#a811024d35b9b8a41095b1f583b649e56">U32</a>*) &amp;n);
<a name="l00111"></a>00111    }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113    <span class="keywordflow">return</span> n;
<a name="l00114"></a>00114 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afbef9f06f07aac16f2fa4996b4183e9e"></a><!-- doxytag: member="sis3100.c::i_sis3100" ref="afbef9f06f07aac16f2fa4996b4183e9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="sis3100_8c.html#afbef9f06f07aac16f2fa4996b4183e9e">i_sis3100</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00032">32</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>Referenced by <a class="el" href="sis3100_8c_source.html#l00045">mvme_init()</a>, <a class="el" href="sis3100_8c_source.html#l00144">mvme_ioctl()</a>, <a class="el" href="sis3100_8c_source.html#l00118">mvme_read()</a>, and <a class="el" href="sis3100_8c_source.html#l00089">mvme_write()</a>.</p>

</div>
</div>
<a class="anchor" id="ac99895e9a0072f781ac2b015f89ad409"></a><!-- doxytag: member="sis3100.c::n_sis3100" ref="ac99895e9a0072f781ac2b015f89ad409" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="sis3100_8c.html#ac99895e9a0072f781ac2b015f89ad409">n_sis3100</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00032">32</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

<p>Referenced by <a class="el" href="sis3100_8c_source.html#l00077">mvme_exit()</a>, <a class="el" href="sis3100_8c_source.html#l00045">mvme_init()</a>, and <a class="el" href="sis3100_8c_source.html#l00144">mvme_ioctl()</a>.</p>

</div>
</div>
<a class="anchor" id="a1e6c7d1d5f3f3ac50e1580cae866c046"></a><!-- doxytag: member="sis3100.c::sis3100_device" ref="a1e6c7d1d5f3f3ac50e1580cae866c046" args="[MAX_SIS3100_DEVICES]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSIS3100__DEVICE.html">SIS3100_DEVICE</a> <a class="el" href="sis3100_8c.html#a1e6c7d1d5f3f3ac50e1580cae866c046">sis3100_device</a>[MAX_SIS3100_DEVICES]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="sis3100_8c_source.html#l00041">41</a> of file <a class="el" href="sis3100_8c_source.html">sis3100.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ:Rootana by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
