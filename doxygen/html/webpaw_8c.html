<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AlcapDAQ:Rootana: midas/utils/webpaw.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>midas/utils/webpaw.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;netdb.h&gt;</code><br/>
<code>#include &lt;netinet/in.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;sys/time.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;pty.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>

<p><a href="webpaw_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a5a3eb971b466278ada4f7f87399a537c">closesocket</a>(s)&nbsp;&nbsp;&nbsp;close(s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>&nbsp;&nbsp;&nbsp;&quot;1.0.10&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a14692e25de0bb96f53774bcc08c39480">WEB_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;100000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a7109febe139a7277e20652049ec9a1e1">VALUE_SIZE</a>&nbsp;&nbsp;&nbsp;256</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a8c2db22aa4cb56dced490e456bb9a91b">PARAM_LENGTH</a>&nbsp;&nbsp;&nbsp;256</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#aa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a3b61478edd7c1b25c8facd2907cf6c33">SHUTDOWN</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#aedcf61ffa26ceba66e9995937de74d64">ERR_TIMEOUT</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a3144b48f181067b67fe3f036e24ba3a0">ERR_PIPE</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a88be4aafa327218fbd41f7e1132f75ca">debug_message</a> (char *<a class="el" href="scs__310__ql355p_8c.html#a11ea5cf64ae27c357c5bd2f2eaaddf7f">str</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#aa258f4f0f01c467a164ee216a3b2c6d4">rsputs</a> (const char *<a class="el" href="scs__310__ql355p_8c.html#a11ea5cf64ae27c357c5bd2f2eaaddf7f">str</a>,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a> (const char *format,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a> (char *str1, char *str2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a6113855b8e5965f1e91ee407b4026ab7">format</a> (char *<a class="el" href="scs__310__ql355p_8c.html#a11ea5cf64ae27c357c5bd2f2eaaddf7f">str</a>, char *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a7c5fce9a07b3d1a6afe002ec744b6442">format1</a> (char *<a class="el" href="scs__310__ql355p_8c.html#a11ea5cf64ae27c357c5bd2f2eaaddf7f">str</a>, char *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a> (char *group, char *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, char *<a class="el" href="odbhist_8c.html#a401da9cc2f96d4efd127de7463b69208">value</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a> (char *group, char *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, char *<a class="el" href="odbhist_8c.html#a401da9cc2f96d4efd127de7463b69208">value</a>, int <a class="el" href="mana__orig_8c.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a5c7f0ac1136d675f0150d443df5912ac">initparam</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a2956fb85032748af9fb7f544a4fb6c93">setparam</a> (char *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, char *<a class="el" href="odbhist_8c.html#a401da9cc2f96d4efd127de7463b69208">value</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a4372f772dfe8227a1033c1cf0baceb2b">getparam</a> (char *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#aebe37a88c8359d0591711e1782d2c997">isparam</a> (char *<a class="el" href="mana__orig_8c.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a> (char *<a class="el" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a477e33c685ba6ebcb9d429fb057c2760">urlEncode</a> (char *ps)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a> (int pipe, char *delim, char *result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#afbc34c39e5863988ff8d15f9afb4ddd2">submit_paw</a> (char *kumac, char *result, int save_gif)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a7f987784cebfcad4573529be512d7561">display_kumac</a> (char *display_name, char *kumac_name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a54d0d7ae8022f809e37b7dc98bc958f7">interprete</a> (char *path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a1fbaea967c3648cda0448b1a548e7fe0">decode</a> (char *<a class="el" href="scs__310__ql355p_8c.html#a2fcb7c4c10b2f35fc53f00938f78dcc1">string</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a8e518de089e3561081e2467925073550">sighup</a> (int sig)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a3223221f74dd4f66ac1ce9c34ed02b54">cind</a> (char <a class="el" href="show__pulses_8cxx.html#a63b96401309cc0c66ce6c88f1783d7c2">c</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#adb270245a5b87ffdc02d2bdabd3b8406">base64_decode</a> (char *s, char *<a class="el" href="hwtest_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#ad2d0890b22d51fd03fbff402b8da4c9b">base64_encode</a> (char *s, char *<a class="el" href="hwtest_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#aaec1e477913a7881360f575a62816ca8">server_loop</a> (int <a class="el" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a>, int <a class="el" href="mana__orig_8c.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a81b18a7e5d11bb7c85792bc6c117e8fe">create_password</a> (char *<a class="el" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a> [WEB_BUFFER_SIZE]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a> [256]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a8d769c1a97fec55473c5f591221dea4c">_param</a> [MAX_PARAM][PARAM_LENGTH]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a> [MAX_PARAM][VALUE_SIZE]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#af30d16605d5c80183cd199983a653081">host_name</a> [256]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a164f953412b79c2cc62833971433db7c">remote_host_name</a> [256]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a> [256]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a275776e6df5d25b1778564974ea48485">_sock</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a47cb71fd25faecb24fa8360f407e4cc0">_quit</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a> [80]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a> = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="webpaw_8c.html#a203be81bafae956e5d4d101154c3528e">net_buffer</a> [WEB_BUFFER_SIZE]</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5a3eb971b466278ada4f7f87399a537c"></a><!-- doxytag: member="webpaw.c::closesocket" ref="a5a3eb971b466278ada4f7f87399a537c" args="(s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define closesocket</td>
          <td>(</td>
          <td class="paramtype">s&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;close(s)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00165">165</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3144b48f181067b67fe3f036e24ba3a0"></a><!-- doxytag: member="webpaw.c::ERR_PIPE" ref="a3144b48f181067b67fe3f036e24ba3a0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERR_PIPE&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00179">179</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00602">read_paw()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="aedcf61ffa26ceba66e9995937de74d64"></a><!-- doxytag: member="webpaw.c::ERR_TIMEOUT" ref="aedcf61ffa26ceba66e9995937de74d64" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ERR_TIMEOUT&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00178">178</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00602">read_paw()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="a5732be69f55a5dbbfa3df82d31314cb1"></a><!-- doxytag: member="webpaw.c::MAX_PARAM" ref="a5732be69f55a5dbbfa3df82d31314cb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PARAM&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00172">172</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8c2db22aa4cb56dced490e456bb9a91b"></a><!-- doxytag: member="webpaw.c::PARAM_LENGTH" ref="a8c2db22aa4cb56dced490e456bb9a91b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PARAM_LENGTH&nbsp;&nbsp;&nbsp;256</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00174">174</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3b61478edd7c1b25c8facd2907cf6c33"></a><!-- doxytag: member="webpaw.c::SHUTDOWN" ref="a3b61478edd7c1b25c8facd2907cf6c33" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHUTDOWN&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00177">177</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, and <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>.</p>

</div>
</div>
<a class="anchor" id="aa90cac659d18e8ef6294c7ae337f6b58"></a><!-- doxytag: member="webpaw.c::SUCCESS" ref="aa90cac659d18e8ef6294c7ae337f6b58" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SUCCESS&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00176">176</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7109febe139a7277e20652049ec9a1e1"></a><!-- doxytag: member="webpaw.c::VALUE_SIZE" ref="a7109febe139a7277e20652049ec9a1e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALUE_SIZE&nbsp;&nbsp;&nbsp;256</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00173">173</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1c6d5de492ac61ad29aec7aa9a436bbf"></a><!-- doxytag: member="webpaw.c::VERSION" ref="a1c6d5de492ac61ad29aec7aa9a436bbf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VERSION&nbsp;&nbsp;&nbsp;&quot;1.0.10&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00169">169</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a14692e25de0bb96f53774bcc08c39480"></a><!-- doxytag: member="webpaw.c::WEB_BUFFER_SIZE" ref="a14692e25de0bb96f53774bcc08c39480" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WEB_BUFFER_SIZE&nbsp;&nbsp;&nbsp;100000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00171">171</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="adb270245a5b87ffdc02d2bdabd3b8406"></a><!-- doxytag: member="webpaw.c::base64_decode" ref="adb270245a5b87ffdc02d2bdabd3b8406" args="(char *s, char *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void base64_decode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01329">1329</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l01315">cind()</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01330"></a>01330 {
<a name="l01331"></a>01331    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t;
<a name="l01332"></a>01332 
<a name="l01333"></a>01333    <span class="keywordflow">while</span> (*s) {
<a name="l01334"></a>01334       t = <a class="code" href="webpaw_8c.html#a3223221f74dd4f66ac1ce9c34ed02b54">cind</a>(*s++) &lt;&lt; 18;
<a name="l01335"></a>01335       t |= <a class="code" href="webpaw_8c.html#a3223221f74dd4f66ac1ce9c34ed02b54">cind</a>(*s++) &lt;&lt; 12;
<a name="l01336"></a>01336       t |= <a class="code" href="webpaw_8c.html#a3223221f74dd4f66ac1ce9c34ed02b54">cind</a>(*s++) &lt;&lt; 6;
<a name="l01337"></a>01337       t |= <a class="code" href="webpaw_8c.html#a3223221f74dd4f66ac1ce9c34ed02b54">cind</a>(*s++) &lt;&lt; 0;
<a name="l01338"></a>01338 
<a name="l01339"></a>01339       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 2) = (<span class="keywordtype">char</span>) (t &amp; 0xFF);
<a name="l01340"></a>01340       t &gt;&gt;= 8;
<a name="l01341"></a>01341       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 1) = (<span class="keywordtype">char</span>) (t &amp; 0xFF);
<a name="l01342"></a>01342       t &gt;&gt;= 8;
<a name="l01343"></a>01343       *<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (char) (t &amp; 0xFF);
<a name="l01344"></a>01344 
<a name="l01345"></a>01345       <a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> += 3;
<a name="l01346"></a>01346    }
<a name="l01347"></a>01347    *<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0;
<a name="l01348"></a>01348 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad2d0890b22d51fd03fbff402b8da4c9b"></a><!-- doxytag: member="webpaw.c::base64_encode" ref="ad2d0890b22d51fd03fbff402b8da4c9b" args="(char *s, char *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void base64_encode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01350">1350</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="melog_8c_source.html#l00101">map</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01351"></a>01351 {
<a name="l01352"></a>01352    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t, pad;
<a name="l01353"></a>01353 
<a name="l01354"></a>01354    pad = 3 - strlen(s) % 3;
<a name="l01355"></a>01355    <span class="keywordflow">while</span> (*s) {
<a name="l01356"></a>01356       t = (*s++) &lt;&lt; 16;
<a name="l01357"></a>01357       <span class="keywordflow">if</span> (*s)
<a name="l01358"></a>01358          t |= (*s++) &lt;&lt; 8;
<a name="l01359"></a>01359       <span class="keywordflow">if</span> (*s)
<a name="l01360"></a>01360          t |= (*s++) &lt;&lt; 0;
<a name="l01361"></a>01361 
<a name="l01362"></a>01362       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 3) = <a class="code" href="melog_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a>[t &amp; 63];
<a name="l01363"></a>01363       t &gt;&gt;= 6;
<a name="l01364"></a>01364       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 2) = <a class="code" href="melog_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a>[t &amp; 63];
<a name="l01365"></a>01365       t &gt;&gt;= 6;
<a name="l01366"></a>01366       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 1) = <a class="code" href="melog_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a>[t &amp; 63];
<a name="l01367"></a>01367       t &gt;&gt;= 6;
<a name="l01368"></a>01368       *(<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> + 0) = <a class="code" href="melog_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a>[t &amp; 63];
<a name="l01369"></a>01369 
<a name="l01370"></a>01370       <a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> += 4;
<a name="l01371"></a>01371    }
<a name="l01372"></a>01372    *<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0;
<a name="l01373"></a>01373    <span class="keywordflow">while</span> (pad--)
<a name="l01374"></a>01374       *(--<a class="code" href="system_8c.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) = <span class="charliteral">&apos;=&apos;</span>;
<a name="l01375"></a>01375 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3223221f74dd4f66ac1ce9c34ed02b54"></a><!-- doxytag: member="webpaw.c::cind" ref="a3223221f74dd4f66ac1ce9c34ed02b54" args="(char c)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cind </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>c</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01315">1315</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="melog_8c_source.html#l00101">map</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01329">base64_decode()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01316"></a>01316 {
<a name="l01317"></a>01317    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01318"></a>01318 
<a name="l01319"></a>01319    <span class="keywordflow">if</span> (<a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a> == <span class="charliteral">&apos;=&apos;</span>)
<a name="l01320"></a>01320       <span class="keywordflow">return</span> 0;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322    <span class="keywordflow">for</span> (i = 0; i &lt; 64; i++)
<a name="l01323"></a>01323       <span class="keywordflow">if</span> (<a class="code" href="melog_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a>[i] == <a class="code" href="patch__mevb_8cpp.html#adce6024c3a1b29c5fcede88815f9b152">c</a>)
<a name="l01324"></a>01324          <span class="keywordflow">return</span> i;
<a name="l01325"></a>01325 
<a name="l01326"></a>01326    <span class="keywordflow">return</span> -1;
<a name="l01327"></a>01327 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81b18a7e5d11bb7c85792bc6c117e8fe"></a><!-- doxytag: member="webpaw.c::create_password" ref="a81b18a7e5d11bb7c85792bc6c117e8fe" args="(char *pwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void create_password </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pwd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01692">1692</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00331">cfgbuffer</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="FDCR_8h_source.html#l00008">length</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00256">read</a>, and <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00259">write</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01764">main()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01693"></a>01693 {
<a name="l01694"></a>01694    <span class="keywordtype">int</span> fh, <a class="code" href="FDCR_8h.html#a9f59b34b1f25fe00023291b678246bcc">length</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01695"></a>01695    <span class="keywordtype">char</span> *<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>, <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l01696"></a>01696 
<a name="l01697"></a>01697    fh = open(<span class="stringliteral">&quot;webpaw.cfg&quot;</span>, O_RDONLY);
<a name="l01698"></a>01698    <span class="keywordflow">if</span> (fh &lt; 0) {
<a name="l01699"></a>01699       <span class="comment">/* create new file */</span>
<a name="l01700"></a>01700       fh = open(<span class="stringliteral">&quot;webpaw.cfg&quot;</span>, O_CREAT | O_WRONLY, 0640);
<a name="l01701"></a>01701       <span class="keywordflow">if</span> (fh &lt; 0) {
<a name="l01702"></a>01702          printf(<span class="stringliteral">&quot;Cannot create \&quot;webpaw.cfg\&quot;.\n&quot;</span>);
<a name="l01703"></a>01703          <span class="keywordflow">return</span>;
<a name="l01704"></a>01704       }
<a name="l01705"></a>01705       sprintf(str, <span class="stringliteral">&quot;[Global]\nPassword=%s\n&quot;</span>, <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>);
<a name="l01706"></a>01706       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, str, strlen(str));
<a name="l01707"></a>01707       close(fh);
<a name="l01708"></a>01708       printf(<span class="stringliteral">&quot;File \&quot;webpaw.cfg\&quot; created with password.\n&quot;</span>);
<a name="l01709"></a>01709       <span class="keywordflow">return</span>;
<a name="l01710"></a>01710    }
<a name="l01711"></a>01711 
<a name="l01712"></a>01712    <span class="comment">/* read existing file and add password */</span>
<a name="l01713"></a>01713    length = lseek(fh, 0, SEEK_END);
<a name="l01714"></a>01714    lseek(fh, 0, SEEK_SET);
<a name="l01715"></a>01715    cfgbuffer = malloc(length + 1);
<a name="l01716"></a>01716    <span class="keywordflow">if</span> (cfgbuffer == NULL) {
<a name="l01717"></a>01717       close(fh);
<a name="l01718"></a>01718       <span class="keywordflow">return</span>;
<a name="l01719"></a>01719    }
<a name="l01720"></a>01720    length = <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(fh, cfgbuffer, length);
<a name="l01721"></a>01721    cfgbuffer[length] = 0;
<a name="l01722"></a>01722    close(fh);
<a name="l01723"></a>01723 
<a name="l01724"></a>01724    fh = open(<span class="stringliteral">&quot;webpaw.cfg&quot;</span>, O_TRUNC | O_WRONLY, 0640);
<a name="l01725"></a>01725 
<a name="l01726"></a>01726    <span class="keywordflow">if</span> (strstr(cfgbuffer, <span class="stringliteral">&quot;Password&quot;</span>)) {
<a name="l01727"></a>01727       <span class="comment">/* replace existing password */</span>
<a name="l01728"></a>01728       p = strstr(cfgbuffer, <span class="stringliteral">&quot;Password&quot;</span>);
<a name="l01729"></a>01729       i = (int) p - (<span class="keywordtype">int</span>) cfgbuffer;
<a name="l01730"></a>01730       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, cfgbuffer, i);
<a name="l01731"></a>01731       sprintf(str, <span class="stringliteral">&quot;Password=%s\n&quot;</span>, <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>);
<a name="l01732"></a>01732       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, str, strlen(str));
<a name="l01733"></a>01733 
<a name="l01734"></a>01734       <span class="comment">/* write remainder of file */</span>
<a name="l01735"></a>01735       <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span>)
<a name="l01736"></a>01736          p++;
<a name="l01737"></a>01737       <span class="keywordflow">if</span> (*p &amp;&amp; *p == <span class="charliteral">&apos;\n&apos;</span>)
<a name="l01738"></a>01738          p++;
<a name="l01739"></a>01739       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, p, strlen(p));
<a name="l01740"></a>01740    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strstr(cfgbuffer, <span class="stringliteral">&quot;[Global]&quot;</span>)) {
<a name="l01741"></a>01741       <span class="comment">/* add password to [Global] section */</span>
<a name="l01742"></a>01742       p = strstr(cfgbuffer, <span class="stringliteral">&quot;[Global]&quot;</span>) + 9;
<a name="l01743"></a>01743       <span class="keywordflow">while</span> (*p &amp;&amp; (*p == <span class="charliteral">&apos;\r&apos;</span> || *p == <span class="charliteral">&apos;\n&apos;</span>))
<a name="l01744"></a>01744          p++;
<a name="l01745"></a>01745       i = (int) p - (<span class="keywordtype">int</span>) cfgbuffer;
<a name="l01746"></a>01746       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, cfgbuffer, i);
<a name="l01747"></a>01747       sprintf(str, <span class="stringliteral">&quot;Password=%s\n&quot;</span>, <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>);
<a name="l01748"></a>01748       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, str, strlen(str));
<a name="l01749"></a>01749 
<a name="l01750"></a>01750       <span class="comment">/* write remainder of file */</span>
<a name="l01751"></a>01751       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, p, strlen(p));
<a name="l01752"></a>01752    } <span class="keywordflow">else</span> {
<a name="l01753"></a>01753       sprintf(str, <span class="stringliteral">&quot;[Global]\nPassword=%s\n\n&quot;</span>, <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>);
<a name="l01754"></a>01754       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, str, strlen(str));
<a name="l01755"></a>01755       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(fh, cfgbuffer, length);
<a name="l01756"></a>01756    }
<a name="l01757"></a>01757 
<a name="l01758"></a>01758    free(cfgbuffer);
<a name="l01759"></a>01759    close(fh);
<a name="l01760"></a>01760 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a88be4aafa327218fbd41f7e1132f75ca"></a><!-- doxytag: member="webpaw.c::debug_message" ref="a88be4aafa327218fbd41f7e1132f75ca" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void debug_message </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00201">201</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00189">_debug</a>, and <a class="el" href="webpaw_8c_source.html#l00190">debug_file</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00602">read_paw()</a>, and <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00202"></a>00202 {
<a name="l00203"></a>00203    FILE *f;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205    <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a>)
<a name="l00206"></a>00206       <span class="keywordflow">return</span>;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208    <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a>[0]) {
<a name="l00209"></a>00209       f = fopen(<a class="code" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a>, <span class="stringliteral">&quot;a&quot;</span>);
<a name="l00210"></a>00210       <span class="keywordflow">if</span> (f) {
<a name="l00211"></a>00211          fprintf(f, <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>);
<a name="l00212"></a>00212          fclose(f);
<a name="l00213"></a>00213       }
<a name="l00214"></a>00214    } <span class="keywordflow">else</span> {
<a name="l00215"></a>00215       printf(<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>);
<a name="l00216"></a>00216       fflush(stdout);
<a name="l00217"></a>00217    }
<a name="l00218"></a>00218 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1fbaea967c3648cda0448b1a548e7fe0"></a><!-- doxytag: member="webpaw.c::decode" ref="a1fbaea967c3648cda0448b1a548e7fe0" args="(char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void decode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>string</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01259">1259</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mhttpd_8c_source.html#l01035">initparam()</a>, <a class="el" href="mscbmain_8c_source.html#l00704">interprete()</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, <a class="el" href="mhttpd_8c_source.html#l01042">setparam()</a>, and <a class="el" href="mhttpd_8c_source.html#l01119">urlDecode()</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01260"></a>01260 {
<a name="l01261"></a>01261    <span class="keywordtype">char</span> path[256];
<a name="l01262"></a>01262    <span class="keywordtype">char</span> *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, *pitem;
<a name="l01263"></a>01263 
<a name="l01264"></a>01264    <a class="code" href="mhttpd_8c.html#a5c7f0ac1136d675f0150d443df5912ac">initparam</a>();
<a name="l01265"></a>01265 
<a name="l01266"></a>01266    strncpy(path, <span class="keywordtype">string</span> + 1, <span class="keyword">sizeof</span>(path));     <span class="comment">/* strip leading &apos;/&apos; */</span>
<a name="l01267"></a>01267    path[255] = 0;
<a name="l01268"></a>01268    <span class="keywordflow">if</span> (strchr(path, <span class="charliteral">&apos;?&apos;</span>))
<a name="l01269"></a>01269       *strchr(path, <span class="charliteral">&apos;?&apos;</span>) = 0;
<a name="l01270"></a>01270    <a class="code" href="mhttpd_8c.html#a2956fb85032748af9fb7f544a4fb6c93">setparam</a>(<span class="stringliteral">&quot;path&quot;</span>, path);
<a name="l01271"></a>01271 
<a name="l01272"></a>01272    <span class="keywordflow">if</span> (strchr(<span class="keywordtype">string</span>, <span class="charliteral">&apos;?&apos;</span>)) {
<a name="l01273"></a>01273       p = strchr(<span class="keywordtype">string</span>, <span class="charliteral">&apos;?&apos;</span>) + 1;
<a name="l01274"></a>01274 
<a name="l01275"></a>01275       <span class="comment">/* cut trailing &quot;/&quot; from netscape */</span>
<a name="l01276"></a>01276       <span class="keywordflow">if</span> (p[strlen(p) - 1] == <span class="charliteral">&apos;/&apos;</span>)
<a name="l01277"></a>01277          p[strlen(p) - 1] = 0;
<a name="l01278"></a>01278 
<a name="l01279"></a>01279       p = strtok(p, <span class="stringliteral">&quot;&amp;&quot;</span>);
<a name="l01280"></a>01280       <span class="keywordflow">while</span> (p != NULL) {
<a name="l01281"></a>01281          pitem = p;
<a name="l01282"></a>01282          p = strchr(p, <span class="charliteral">&apos;=&apos;</span>);
<a name="l01283"></a>01283          <span class="keywordflow">if</span> (p != NULL) {
<a name="l01284"></a>01284             *p++ = 0;
<a name="l01285"></a>01285             <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(pitem);
<a name="l01286"></a>01286             <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(p);
<a name="l01287"></a>01287 
<a name="l01288"></a>01288             <a class="code" href="mhttpd_8c.html#a2956fb85032748af9fb7f544a4fb6c93">setparam</a>(pitem, p);
<a name="l01289"></a>01289 
<a name="l01290"></a>01290             p = strtok(NULL, <span class="stringliteral">&quot;&amp;&quot;</span>);
<a name="l01291"></a>01291          }
<a name="l01292"></a>01292       }
<a name="l01293"></a>01293    }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295    <a class="code" href="mscbmain_8c.html#a2331a26017e5f759388bb66d56bf065b">interprete</a>(path);
<a name="l01296"></a>01296 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f987784cebfcad4573529be512d7561"></a><!-- doxytag: member="webpaw.c::display_kumac" ref="a7f987784cebfcad4573529be512d7561" args="(char *display_name, char *kumac_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void display_kumac </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>display_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>kumac_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00765">765</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00266">format()</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, <a class="el" href="mhttpd_8c_source.html#l01014">rsprintf()</a>, and <a class="el" href="mhttpd_8c_source.html#l01153">urlEncode()</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00766"></a>00766 {
<a name="l00767"></a>00767    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], comment_name[256], param_name[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769    <span class="comment">/* single kumac found */</span>
<a name="l00770"></a>00770    comment_name[0] = 0;
<a name="l00771"></a>00771    param_name[0] = 0;
<a name="l00772"></a>00772    <span class="keywordflow">if</span> (strchr(kumac_name, <span class="charliteral">&apos;?&apos;</span>)) {
<a name="l00773"></a>00773       <span class="comment">/* extract comment, trim leading blanks */</span>
<a name="l00774"></a>00774       p = strchr(kumac_name, <span class="charliteral">&apos;?&apos;</span>) + 1;
<a name="l00775"></a>00775       <span class="keywordflow">while</span> (*p &amp;&amp; *p == <span class="charliteral">&apos; &apos;</span>)
<a name="l00776"></a>00776          p++;
<a name="l00777"></a>00777       strcpy(comment_name, p);
<a name="l00778"></a>00778       <span class="comment">/* trim trailing blanks */</span>
<a name="l00779"></a>00779       p = comment_name;
<a name="l00780"></a>00780       <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos; &apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span>)
<a name="l00781"></a>00781          p++;
<a name="l00782"></a>00782       *p = 0;
<a name="l00783"></a>00783    }
<a name="l00784"></a>00784    <span class="keywordflow">if</span> (strchr(kumac_name, <span class="charliteral">&apos;&amp;&apos;</span>)) {
<a name="l00785"></a>00785       <span class="comment">/* extract param, trim leading blanks */</span>
<a name="l00786"></a>00786       p = strchr(kumac_name, <span class="charliteral">&apos;&amp;&apos;</span>) + 1;
<a name="l00787"></a>00787       <span class="keywordflow">while</span> (*p &amp;&amp; *p == <span class="charliteral">&apos; &apos;</span>)
<a name="l00788"></a>00788          p++;
<a name="l00789"></a>00789       strcpy(param_name, p);
<a name="l00790"></a>00790       <span class="comment">/* trim trailing blanks */</span>
<a name="l00791"></a>00791       p = param_name;
<a name="l00792"></a>00792       <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos; &apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span>)
<a name="l00793"></a>00793          p++;
<a name="l00794"></a>00794       *p = 0;
<a name="l00795"></a>00795    }
<a name="l00796"></a>00796 
<a name="l00797"></a>00797    <span class="keywordflow">if</span> (strchr(kumac_name, <span class="charliteral">&apos;?&apos;</span>))
<a name="l00798"></a>00798       *strchr(kumac_name, <span class="charliteral">&apos;?&apos;</span>) = 0;
<a name="l00799"></a>00799    <span class="keywordflow">if</span> (strchr(kumac_name, <span class="charliteral">&apos;&amp;&apos;</span>))
<a name="l00800"></a>00800       *strchr(kumac_name, <span class="charliteral">&apos;&amp;&apos;</span>) = 0;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802    <a class="code" href="mhttpd_8c.html#a477e33c685ba6ebcb9d429fb057c2760">urlEncode</a>(kumac_name);
<a name="l00803"></a>00803    <a class="code" href="webpaw_8c.html#a6113855b8e5965f1e91ee407b4026ab7">format</a>(<a class="code" href="lcd__menu_8c.html#a54ae02d5ad96a91d28477b21166eb5a6">display_name</a>, str);
<a name="l00804"></a>00804 
<a name="l00805"></a>00805    <span class="keywordflow">if</span> (param_name[0]) {
<a name="l00806"></a>00806       <span class="keywordflow">if</span> (comment_name[0])
<a name="l00807"></a>00807          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00808"></a>00808              (<span class="stringliteral">&quot;&lt;li&gt;&lt;a href=\&quot;/%s.html?comment=%s&amp;param=%s\&quot; target=_blank&gt;%s&lt;/a&gt;&lt;/li&gt;\r\n&quot;</span>,
<a name="l00809"></a>00809               kumac_name, comment_name, param_name, str);
<a name="l00810"></a>00810       <span class="keywordflow">else</span>
<a name="l00811"></a>00811          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;li&gt;&lt;a href=\&quot;/%s.html?param=%s\&quot; target=_blank&gt;%s&lt;/a&gt;&lt;/li&gt;\r\n&quot;</span>,
<a name="l00812"></a>00812                   kumac_name, param_name, str);
<a name="l00813"></a>00813    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (comment_name[0])
<a name="l00814"></a>00814       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;li&gt;&lt;a href=\&quot;/%s.html?comment=%s\&quot; target=contents&gt;%s&lt;/a&gt;&lt;/li&gt;\r\n&quot;</span>,
<a name="l00815"></a>00815                kumac_name, comment_name, str);
<a name="l00816"></a>00816    <span class="keywordflow">else</span>
<a name="l00817"></a>00817       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;li&gt;&lt;a href=\&quot;/%s.html\&quot; target=contents&gt;%s&lt;/a&gt;&lt;/li&gt;\r\n&quot;</span>,
<a name="l00818"></a>00818                kumac_name, str);
<a name="l00819"></a>00819 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab55c0539c5eb56bd09c452c482080ed4"></a><!-- doxytag: member="webpaw.c::enumcfg" ref="ab55c0539c5eb56bd09c452c482080ed4" args="(char *group, char *param, char *value, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enumcfg </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00414">414</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00331">cfgbuffer</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="webpaw_8c_source.html#l00333">getcfg()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="sis3803_8c_source.html#l00925">p</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00415"></a>00415 {
<a name="l00416"></a>00416    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, *pstr;
<a name="l00417"></a>00417    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419    <span class="comment">/* open configuration file */</span>
<a name="l00420"></a>00420    <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>)
<a name="l00421"></a>00421       <a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;dummy&quot;</span>, <span class="stringliteral">&quot;dummy&quot;</span>, str);
<a name="l00422"></a>00422    <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>)
<a name="l00423"></a>00423       <span class="keywordflow">return</span> 0;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425    <span class="comment">/* search group */</span>
<a name="l00426"></a>00426    p = <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>;
<a name="l00427"></a>00427    <span class="keywordflow">do</span> {
<a name="l00428"></a>00428       <span class="keywordflow">if</span> (*p == <span class="charliteral">&apos;[&apos;</span>) {
<a name="l00429"></a>00429          p++;
<a name="l00430"></a>00430          pstr = str;
<a name="l00431"></a>00431          <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;]&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00432"></a>00432             *pstr++ = *p++;
<a name="l00433"></a>00433          *pstr = 0;
<a name="l00434"></a>00434          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, group)) {
<a name="l00435"></a>00435             <span class="comment">/* enumerate parameters */</span>
<a name="l00436"></a>00436             i = 0;
<a name="l00437"></a>00437             p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00438"></a>00438             <span class="keywordflow">if</span> (p)
<a name="l00439"></a>00439                p++;
<a name="l00440"></a>00440             <span class="keywordflow">while</span> (p &amp;&amp; *p &amp;&amp; *p != <span class="charliteral">&apos;[&apos;</span>) {
<a name="l00441"></a>00441                pstr = str;
<a name="l00442"></a>00442                <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;=&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00443"></a>00443                   *pstr++ = *p++;
<a name="l00444"></a>00444                *pstr-- = 0;
<a name="l00445"></a>00445                <span class="keywordflow">while</span> (pstr &gt; str &amp;&amp; (*pstr == <span class="charliteral">&apos; &apos;</span> || *pstr == <span class="charliteral">&apos;=&apos;</span>))
<a name="l00446"></a>00446                   *pstr-- = 0;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448                <span class="keywordflow">if</span> (i == <a class="code" href="mana_8cpp.html#a312c2cad451d6bb0536fb9ec2863be59">index</a>) {
<a name="l00449"></a>00449                   strcpy(<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, str);
<a name="l00450"></a>00450                   <span class="keywordflow">if</span> (*p == <span class="charliteral">&apos;=&apos;</span>) {
<a name="l00451"></a>00451                      p++;
<a name="l00452"></a>00452                      <span class="keywordflow">while</span> (*p == <span class="charliteral">&apos; &apos;</span>)
<a name="l00453"></a>00453                         p++;
<a name="l00454"></a>00454                      pstr = str;
<a name="l00455"></a>00455                      <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00456"></a>00456                         *pstr++ = *p++;
<a name="l00457"></a>00457                      *pstr-- = 0;
<a name="l00458"></a>00458                      <span class="keywordflow">while</span> (*pstr == <span class="charliteral">&apos; &apos;</span>)
<a name="l00459"></a>00459                         *pstr-- = 0;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461                      strcpy(<a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, str);
<a name="l00462"></a>00462                      <span class="keywordflow">return</span> 1;
<a name="l00463"></a>00463                   }
<a name="l00464"></a>00464                }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466                <span class="keywordflow">if</span> (p)
<a name="l00467"></a>00467                   p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00468"></a>00468                <span class="keywordflow">if</span> (p)
<a name="l00469"></a>00469                   p++;
<a name="l00470"></a>00470                i++;
<a name="l00471"></a>00471             }
<a name="l00472"></a>00472          }
<a name="l00473"></a>00473       }
<a name="l00474"></a>00474       <span class="keywordflow">if</span> (p)
<a name="l00475"></a>00475          p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00476"></a>00476       <span class="keywordflow">if</span> (p)
<a name="l00477"></a>00477          p++;
<a name="l00478"></a>00478    } <span class="keywordflow">while</span> (p);
<a name="l00479"></a>00479 
<a name="l00480"></a>00480    <span class="keywordflow">return</span> 0;
<a name="l00481"></a>00481 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6113855b8e5965f1e91ee407b4026ab7"></a><!-- doxytag: member="webpaw.c::format" ref="a6113855b8e5965f1e91ee407b4026ab7" args="(char *str, char *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void format </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00266">266</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="sis3803_8c_source.html#l00925">p</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00765">display_kumac()</a>, <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, <a class="el" href="mevb_8cpp_source.html#l00292">load_fragment()</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00554">register_equipment()</a>, <a class="el" href="mevb_8cpp_source.html#l00370">scan_fragment()</a>, and <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l01003">send_event()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00267"></a>00267 {
<a name="l00268"></a>00268    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00269"></a>00269    <span class="keywordtype">char</span> *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271    p = result;
<a name="l00272"></a>00272    <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>); i++) {
<a name="l00273"></a>00273       <span class="keywordflow">switch</span> (<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i]) {
<a name="l00274"></a>00274       <span class="keywordflow">case</span> <span class="charliteral">&apos;\n&apos;</span>:
<a name="l00275"></a>00275          sprintf(p, <span class="stringliteral">&quot;&lt;br&gt;\n&quot;</span>);
<a name="l00276"></a>00276          <span class="keywordflow">break</span>;
<a name="l00277"></a>00277       <span class="keywordflow">case</span> <span class="charliteral">&apos;&lt;&apos;</span>:
<a name="l00278"></a>00278          sprintf(p, <span class="stringliteral">&quot;&amp;lt;&quot;</span>);
<a name="l00279"></a>00279          <span class="keywordflow">break</span>;
<a name="l00280"></a>00280       <span class="keywordflow">case</span> <span class="charliteral">&apos;&gt;&apos;</span>:
<a name="l00281"></a>00281          sprintf(p, <span class="stringliteral">&quot;&amp;gt;&quot;</span>);
<a name="l00282"></a>00282          <span class="keywordflow">break</span>;
<a name="l00283"></a>00283       <span class="keywordflow">case</span> <span class="charliteral">&apos;&amp;&apos;</span>:
<a name="l00284"></a>00284          sprintf(p, <span class="stringliteral">&quot;&amp;amp;&quot;</span>);
<a name="l00285"></a>00285          <span class="keywordflow">break</span>;
<a name="l00286"></a>00286       <span class="keywordflow">case</span> <span class="charliteral">&apos;\&quot;&apos;</span>:
<a name="l00287"></a>00287          sprintf(p, <span class="stringliteral">&quot;&amp;quot;&quot;</span>);
<a name="l00288"></a>00288          <span class="keywordflow">break</span>;
<a name="l00289"></a>00289       <span class="keywordflow">default</span>:
<a name="l00290"></a>00290          *p = <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i];
<a name="l00291"></a>00291          *(p + 1) = 0;
<a name="l00292"></a>00292       }
<a name="l00293"></a>00293       p += strlen(p);
<a name="l00294"></a>00294    }
<a name="l00295"></a>00295    *p = 0;
<a name="l00296"></a>00296 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7c5fce9a07b3d1a6afe002ec744b6442"></a><!-- doxytag: member="webpaw.c::format1" ref="a7c5fce9a07b3d1a6afe002ec744b6442" args="(char *str, char *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void format1 </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00298">298</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="sis3803_8c_source.html#l00925">p</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00299"></a>00299 {
<a name="l00300"></a>00300    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00301"></a>00301    <span class="keywordtype">char</span> *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303    p = result;
<a name="l00304"></a>00304    <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>); i++) {
<a name="l00305"></a>00305       <span class="keywordflow">switch</span> (<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i]) {
<a name="l00306"></a>00306       <span class="keywordflow">case</span> <span class="charliteral">&apos;&lt;&apos;</span>:
<a name="l00307"></a>00307          sprintf(p, <span class="stringliteral">&quot;&amp;lt;&quot;</span>);
<a name="l00308"></a>00308          <span class="keywordflow">break</span>;
<a name="l00309"></a>00309       <span class="keywordflow">case</span> <span class="charliteral">&apos;&gt;&apos;</span>:
<a name="l00310"></a>00310          sprintf(p, <span class="stringliteral">&quot;&amp;gt;&quot;</span>);
<a name="l00311"></a>00311          <span class="keywordflow">break</span>;
<a name="l00312"></a>00312       <span class="keywordflow">case</span> <span class="charliteral">&apos;&amp;&apos;</span>:
<a name="l00313"></a>00313          sprintf(p, <span class="stringliteral">&quot;&amp;amp;&quot;</span>);
<a name="l00314"></a>00314          <span class="keywordflow">break</span>;
<a name="l00315"></a>00315       <span class="keywordflow">case</span> <span class="charliteral">&apos;\&quot;&apos;</span>:
<a name="l00316"></a>00316          sprintf(p, <span class="stringliteral">&quot;&amp;quot;&quot;</span>);
<a name="l00317"></a>00317          <span class="keywordflow">break</span>;
<a name="l00318"></a>00318       <span class="keywordflow">default</span>:
<a name="l00319"></a>00319          *p = <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[i];
<a name="l00320"></a>00320          *(p + 1) = 0;
<a name="l00321"></a>00321       }
<a name="l00322"></a>00322       p += strlen(p);
<a name="l00323"></a>00323    }
<a name="l00324"></a>00324    *p = 0;
<a name="l00325"></a>00325 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24bb1a7884637180a6b3e789dc6a6767"></a><!-- doxytag: member="webpaw.c::getcfg" ref="a24bb1a7884637180a6b3e789dc6a6767" args="(char *group, char *param, char *value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getcfg </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00333">333</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00331">cfgbuffer</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="FDCR_8h_source.html#l00008">length</a>, <a class="el" href="msystem_8h_source.html#l00351">O_BINARY</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, and <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00256">read</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00414">enumcfg()</a>, <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00334"></a>00334 {
<a name="l00335"></a>00335    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, *pstr;
<a name="l00336"></a>00336    <span class="keywordtype">int</span> <a class="code" href="FDCR_8h.html#a9f59b34b1f25fe00023291b678246bcc">length</a>;
<a name="l00337"></a>00337    <span class="keywordtype">int</span> fh;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339    <span class="comment">/* read configuration file on init */</span>
<a name="l00340"></a>00340    <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>) {
<a name="l00341"></a>00341       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>)
<a name="l00342"></a>00342          free(<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>);
<a name="l00343"></a>00343 
<a name="l00344"></a>00344       fh = open(<span class="stringliteral">&quot;webpaw.cfg&quot;</span>, O_RDONLY | <a class="code" href="group__msystemincludecode.html#ga36fa9b2e726512bc17a7a6d3e39002be">O_BINARY</a>);
<a name="l00345"></a>00345       <span class="keywordflow">if</span> (fh &lt; 0)
<a name="l00346"></a>00346          <span class="keywordflow">return</span> 0;
<a name="l00347"></a>00347       length = lseek(fh, 0, SEEK_END);
<a name="l00348"></a>00348       lseek(fh, 0, SEEK_SET);
<a name="l00349"></a>00349       <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a> = malloc(length + 1);
<a name="l00350"></a>00350       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a> == NULL) {
<a name="l00351"></a>00351          close(fh);
<a name="l00352"></a>00352          <span class="keywordflow">return</span> 0;
<a name="l00353"></a>00353       }
<a name="l00354"></a>00354       <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(fh, <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>, length);
<a name="l00355"></a>00355       <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>[length] = 0;
<a name="l00356"></a>00356       close(fh);
<a name="l00357"></a>00357    }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359    <span class="comment">/* search group */</span>
<a name="l00360"></a>00360    p = <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>;
<a name="l00361"></a>00361    <span class="keywordflow">do</span> {
<a name="l00362"></a>00362       <span class="keywordflow">if</span> (*p == <span class="charliteral">&apos;[&apos;</span>) {
<a name="l00363"></a>00363          p++;
<a name="l00364"></a>00364          pstr = str;
<a name="l00365"></a>00365          <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;]&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00366"></a>00366             *pstr++ = *p++;
<a name="l00367"></a>00367          *pstr = 0;
<a name="l00368"></a>00368          <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, group)) {
<a name="l00369"></a>00369             <span class="comment">/* search parameter */</span>
<a name="l00370"></a>00370             p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00371"></a>00371             <span class="keywordflow">if</span> (p)
<a name="l00372"></a>00372                p++;
<a name="l00373"></a>00373             <span class="keywordflow">while</span> (p &amp;&amp; *p &amp;&amp; *p != <span class="charliteral">&apos;[&apos;</span>) {
<a name="l00374"></a>00374                pstr = str;
<a name="l00375"></a>00375                <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;=&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00376"></a>00376                   *pstr++ = *p++;
<a name="l00377"></a>00377                *pstr-- = 0;
<a name="l00378"></a>00378                <span class="keywordflow">while</span> (pstr &gt; str &amp;&amp; (*pstr == <span class="charliteral">&apos; &apos;</span> || *pstr == <span class="charliteral">&apos;=&apos;</span>))
<a name="l00379"></a>00379                   *pstr-- = 0;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381                <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>)) {
<a name="l00382"></a>00382                   <span class="keywordflow">if</span> (*p == <span class="charliteral">&apos;=&apos;</span>) {
<a name="l00383"></a>00383                      p++;
<a name="l00384"></a>00384                      <span class="keywordflow">while</span> (*p == <span class="charliteral">&apos; &apos;</span>)
<a name="l00385"></a>00385                         p++;
<a name="l00386"></a>00386                      pstr = str;
<a name="l00387"></a>00387                      <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;\n&apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l00388"></a>00388                         *pstr++ = *p++;
<a name="l00389"></a>00389                      *pstr-- = 0;
<a name="l00390"></a>00390                      <span class="keywordflow">while</span> (*pstr == <span class="charliteral">&apos; &apos;</span>)
<a name="l00391"></a>00391                         *pstr-- = 0;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393                      strcpy(<a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, str);
<a name="l00394"></a>00394                      <span class="keywordflow">return</span> 1;
<a name="l00395"></a>00395                   }
<a name="l00396"></a>00396                }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398                <span class="keywordflow">if</span> (p)
<a name="l00399"></a>00399                   p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00400"></a>00400                <span class="keywordflow">if</span> (p)
<a name="l00401"></a>00401                   p++;
<a name="l00402"></a>00402             }
<a name="l00403"></a>00403          }
<a name="l00404"></a>00404       }
<a name="l00405"></a>00405       <span class="keywordflow">if</span> (p)
<a name="l00406"></a>00406          p = strchr(p, <span class="charliteral">&apos;\n&apos;</span>);
<a name="l00407"></a>00407       <span class="keywordflow">if</span> (p)
<a name="l00408"></a>00408          p++;
<a name="l00409"></a>00409    } <span class="keywordflow">while</span> (p);
<a name="l00410"></a>00410 
<a name="l00411"></a>00411    <span class="keywordflow">return</span> 0;
<a name="l00412"></a>00412 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4372f772dfe8227a1033c1cf0baceb2b"></a><!-- doxytag: member="webpaw.c::getparam" ref="a4372f772dfe8227a1033c1cf0baceb2b" args="(char *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* getparam </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00514">514</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="experiment_2template_8c_source.html#l00070">_param</a>, <a class="el" href="mhttpd_8c_source.html#l00885">_value</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="mhttpd_8c_source.html#l00879">MAX_PARAM</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00515"></a>00515 {
<a name="l00516"></a>00516    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="mhttpd_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a> &amp;&amp; <a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>[i][0]; i++)
<a name="l00519"></a>00519       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, _param[i]))
<a name="l00520"></a>00520          <span class="keywordflow">break</span>;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522    <span class="keywordflow">if</span> (i &lt; <a class="code" href="mhttpd_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a> &amp;&amp; _param[i][0])
<a name="l00523"></a>00523       <span class="keywordflow">return</span> <a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>[i];
<a name="l00524"></a>00524 
<a name="l00525"></a>00525    <span class="keywordflow">return</span> NULL;
<a name="l00526"></a>00526 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c7f0ac1136d675f0150d443df5912ac"></a><!-- doxytag: member="webpaw.c::initparam" ref="a5c7f0ac1136d675f0150d443df5912ac" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initparam </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00487">487</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="experiment_2template_8c_source.html#l00070">_param</a>, and <a class="el" href="mhttpd_8c_source.html#l00885">_value</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00488"></a>00488 {
<a name="l00489"></a>00489    memset(<a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>));
<a name="l00490"></a>00490    memset(<a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>));
<a name="l00491"></a>00491 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a54d0d7ae8022f809e37b7dc98bc958f7"></a><!-- doxytag: member="webpaw.c::interprete" ref="a54d0d7ae8022f809e37b7dc98bc958f7" args="(char *path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void interprete </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>path</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00823">823</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00191">_quit</a>, <a class="el" href="jorway73a_8c_source.html#l00628">cmd</a>, <a class="el" href="webpaw_8c_source.html#l00765">display_kumac()</a>, <a class="el" href="lcd__menu_8c_source.html#l00262">display_name()</a>, <a class="el" href="webpaw_8c_source.html#l00414">enumcfg()</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="webpaw_8c_source.html#l00266">format()</a>, <a class="el" href="webpaw_8c_source.html#l00298">format1()</a>, <a class="el" href="webpaw_8c_source.html#l00333">getcfg()</a>, <a class="el" href="mana_8cpp_source.html#l00800">getparam()</a>, <a class="el" href="mainWindow_8cpp_source.html#l00033">height</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00327">host_name</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="odbhist_8c_source.html#l00058">j</a>, <a class="el" href="FDCR_8h_source.html#l00008">length</a>, <a class="el" href="msystem_8h_source.html#l00351">O_BINARY</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00256">read</a>, <a class="el" href="mhttpd_8c_source.html#l00870">return_buffer</a>, <a class="el" href="mhttpd_8c_source.html#l00872">return_length</a>, <a class="el" href="mhttpd_8c_source.html#l01014">rsprintf()</a>, <a class="el" href="webpaw_8c_source.html#l00177">SHUTDOWN</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, <a class="el" href="mhist_8c_source.html#l00078">tmp()</a>, <a class="el" href="mhttpd_8c_source.html#l01119">urlDecode()</a>, <a class="el" href="mhttpd_8c_source.html#l01153">urlEncode()</a>, <a class="el" href="CAENBridgeUpgrade_2config_8h_source.html#l00075">VERSION</a>, and <a class="el" href="webpaw_8c_source.html#l00183">webpaw_url</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00826"></a>00826          : <a class="code" href="mscbmain_8c.html#a2331a26017e5f759388bb66d56bf065b">interprete</a>
<a name="l00827"></a>00827 
<a name="l00828"></a>00828   Purpose: Interprete parameters <a class="code" href="examples_2macro_2midas__macro_8h.html#aa3d7d535cf450b91b9cb6d9cee2edbb9">and</a> generate HTML <a class="code" href="scs__210_8c.html#a859e9f68c1c035565d6729c59fd894ae">output</a>
<a name="l00829"></a>00829 
<a name="l00830"></a>00830   Input:
<a name="l00831"></a>00831     <span class="keywordtype">char</span> *kumac             Kumac to <a class="code" href="subm__250_8c.html#a61af3e60b94ae3e748f6fbac1e794af7">execute</a>
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   &lt;implicit&gt;
<a name="l00834"></a>00834     <a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>/<a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a> array accessible via <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>()
<a name="l00835"></a>00835 
<a name="l00836"></a>00836 \********************************************************************/
<a name="l00837"></a>00837 {
<a name="l00838"></a>00838    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[100000], str2[100000], group_name[256], <a class="code" href="lcd__menu_8c.html#a54ae02d5ad96a91d28477b21166eb5a6">display_name</a>[256], kumac_name[256];
<a name="l00839"></a>00839    <span class="keywordtype">char</span> <a class="code" href="jorway73a_8c.html#a11d3b696651733f98e58d14ad8fa7a1d">cmd</a>[256], param_name[256], param_opt[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, *ps;
<a name="l00840"></a>00840    <span class="keywordtype">char</span> cur_group[256], <a class="code" href="mhist_8c.html#a1c4effcb9a2b3357fbfa63a6edfa0cc6">tmp</a>[256], elog[256];
<a name="l00841"></a>00841    <span class="keywordtype">int</span> fh, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, <a class="code" href="odbhist_8c.html#a2df6784bd380a288cf2c3e7e2c43a6b8">j</a>, <a class="code" href="FDCR_8h.html#a9f59b34b1f25fe00023291b678246bcc">length</a>, <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="mainWindow_8cpp.html#ad12fc34ce789bce6c8a05d8a17138534">height</a>;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843    <span class="keywordflow">if</span> (!path[0] &amp;&amp; !<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;submit&quot;</span>) &amp;&amp; !<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;cmd&quot;</span>)) {
<a name="l00844"></a>00844       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l00845"></a>00845       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l00846"></a>00846       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l00847"></a>00847 
<a name="l00848"></a>00848       <span class="comment">/* return frameset if no path is given */</span>
<a name="l00849"></a>00849       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;\r\n&quot;</span>);
<a name="l00850"></a>00850       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;head&gt;&lt;title&gt;WebPAW V%s on %s&lt;/title&gt;&lt;/head&gt;\r\n\r\n&quot;</span>, <a class="code" href="CAENBridgeUpgrade_2config_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>,
<a name="l00851"></a>00851                <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Logo height&quot;</span>, str))
<a name="l00854"></a>00854          height = atoi(str);
<a name="l00855"></a>00855       <span class="keywordflow">else</span>
<a name="l00856"></a>00856          height = 25;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;frameset cols=\&quot;300,*\&quot;&gt;\r\n&quot;</span>);
<a name="l00859"></a>00859       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00860"></a>00860           (<span class="stringliteral">&quot;  &lt;frame name=kumacs src=kumacs.html marginwidth=1 marginheight=1 scrollling=auto&gt;\r\n&quot;</span>);
<a name="l00861"></a>00861       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;  &lt;frameset rows=\&quot;%d,*\&quot; frameborder=no&gt;\r\n&quot;</span>, height + 10);
<a name="l00862"></a>00862       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00863"></a>00863           (<span class="stringliteral">&quot;    &lt;frame name=banner src=banner.html marginwidth=10 marginheight=1 scrolling=no&gt;\r\n&quot;</span>);
<a name="l00864"></a>00864       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00865"></a>00865           (<span class="stringliteral">&quot;    &lt;frame name=contents src=contents.html marginwidth=10 marginheight=5 scrolling=auto&gt;\r\n&quot;</span>);
<a name="l00866"></a>00866       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;  &lt;/frameset&gt;\r\n&quot;</span>);
<a name="l00867"></a>00867       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/frameset&gt;\r\n\r\n&quot;</span>);
<a name="l00868"></a>00868 
<a name="l00869"></a>00869       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;noframes&gt;\r\n&quot;</span>);
<a name="l00870"></a>00870       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;To view this page, your browser must support frames.\r\n&quot;</span>);
<a name="l00871"></a>00871       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00872"></a>00872           (<span class="stringliteral">&quot;&lt;AHREF=\&quot;http://home.netscape.com/comprod/mirror/index.html\&quot;&gt;Download&lt;/A&gt;\r\n&quot;</span>);
<a name="l00873"></a>00873       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Netscape Navigator 2.0 or later for frames support.\r\n&quot;</span>);
<a name="l00874"></a>00874       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/noframes&gt;\r\n\r\n&quot;</span>);
<a name="l00875"></a>00875 
<a name="l00876"></a>00876       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/html&gt;\r\n&quot;</span>);
<a name="l00877"></a>00877       <span class="keywordflow">return</span>;
<a name="l00878"></a>00878    }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880    <span class="comment">/* display banner */</span>
<a name="l00881"></a>00881    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(path, <span class="stringliteral">&quot;banner.html&quot;</span>)) {
<a name="l00882"></a>00882       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l00883"></a>00883       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l00884"></a>00884       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l00885"></a>00885 
<a name="l00886"></a>00886       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Body2&quot;</span>, str))
<a name="l00887"></a>00887          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body %s&gt;\r\n&quot;</span>, str);
<a name="l00888"></a>00888       <span class="keywordflow">else</span>
<a name="l00889"></a>00889          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body&gt;\r\n&quot;</span>);
<a name="l00890"></a>00890 
<a name="l00891"></a>00891       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Logo&quot;</span>, str)) {
<a name="l00892"></a>00892          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;a target=_top href=\&quot;http://midas.psi.ch/webpaw/\&quot;&gt;\r\n&quot;</span>);
<a name="l00893"></a>00893          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;img src=banner.gif alt=banner.gif border=0&gt;&lt;/a&gt;\r\n&quot;</span>);
<a name="l00894"></a>00894       } <span class="keywordflow">else</span> {
<a name="l00895"></a>00895          <span class="comment">/* title row */</span>
<a name="l00896"></a>00896          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00897"></a>00897              (<span class="stringliteral">&quot;&lt;b&gt;&lt;a target=_top href=\&quot;http://midas.psi.ch/webpaw/\&quot;&gt;WebPAW&lt;/a&gt; V%s on %s&lt;/b&gt;\r\n&quot;</span>,
<a name="l00898"></a>00898               <a class="code" href="CAENBridgeUpgrade_2config_8h.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>);
<a name="l00899"></a>00899       }
<a name="l00900"></a>00900 
<a name="l00901"></a>00901       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l00902"></a>00902       <span class="keywordflow">return</span>;
<a name="l00903"></a>00903    }
<a name="l00904"></a>00904 
<a name="l00905"></a>00905    <span class="comment">/* display banner */</span>
<a name="l00906"></a>00906    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(path, <span class="stringliteral">&quot;banner.gif&quot;</span>)) {
<a name="l00907"></a>00907       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Logo&quot;</span>, str)) {
<a name="l00908"></a>00908          fh = open(str, O_RDONLY | <a class="code" href="group__msystemincludecode.html#ga36fa9b2e726512bc17a7a6d3e39002be">O_BINARY</a>);
<a name="l00909"></a>00909          <span class="keywordflow">if</span> (fh &gt; 0) {
<a name="l00910"></a>00910             length = lseek(fh, 0, SEEK_END);
<a name="l00911"></a>00911             lseek(fh, 0, SEEK_SET);
<a name="l00912"></a>00912 
<a name="l00913"></a>00913             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l00914"></a>00914             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l00915"></a>00915             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Accept-Ranges: bytes\r\n&quot;</span>);
<a name="l00916"></a>00916             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: image/gif\r\n&quot;</span>);
<a name="l00917"></a>00917             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Length: %d\r\n\r\n&quot;</span>, length);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919             <span class="comment">/* return if file too big */</span>
<a name="l00920"></a>00920             <span class="keywordflow">if</span> (length &gt; (<span class="keywordtype">int</span>) (<span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) - strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>))) {
<a name="l00921"></a>00921                printf(<span class="stringliteral">&quot;return buffer too small\n&quot;</span>);
<a name="l00922"></a>00922                close(fh);
<a name="l00923"></a>00923                <span class="keywordflow">return</span>;
<a name="l00924"></a>00924             }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926             <a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> = strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + length;
<a name="l00927"></a>00927             <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(fh, <a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a> + strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>), length);
<a name="l00928"></a>00928 
<a name="l00929"></a>00929             close(fh);
<a name="l00930"></a>00930          }
<a name="l00931"></a>00931       }
<a name="l00932"></a>00932       <span class="keywordflow">return</span>;
<a name="l00933"></a>00933    }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935    <span class="comment">/* display kumacs */</span>
<a name="l00936"></a>00936    <span class="keywordflow">if</span> (strstr(path, <span class="stringliteral">&quot;kumacs.html&quot;</span>)) {
<a name="l00937"></a>00937       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l00938"></a>00938       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l00939"></a>00939       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l00940"></a>00940       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Body1&quot;</span>, str))
<a name="l00941"></a>00941          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body %s&gt;\r\n&quot;</span>, str);
<a name="l00942"></a>00942       <span class="keywordflow">else</span>
<a name="l00943"></a>00943          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body&gt;\r\n&quot;</span>);
<a name="l00944"></a>00944 
<a name="l00945"></a>00945       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;form method=GET action=\&quot;%s\&quot; target=contents&gt;\r\n&quot;</span>, <a class="code" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a>);
<a name="l00946"></a>00946 
<a name="l00947"></a>00947       <span class="comment">/* display input field */</span>
<a name="l00948"></a>00948       status = <a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Allow submit&quot;</span>, str);
<a name="l00949"></a>00949       <span class="keywordflow">if</span> (status == 0 || str[0] == <span class="charliteral">&apos;y&apos;</span>) {
<a name="l00950"></a>00950          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;center&gt;&lt;table border=0 cellpadding=1&gt;\r\n&quot;</span>);
<a name="l00951"></a>00951          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00952"></a>00952              (<span class="stringliteral">&quot;&lt;tr&gt;&lt;td colspan=2 align=center&gt;&lt;input type=text name=cmd size=30 maxlength=256&gt;&lt;/tr&gt;\r\n&quot;</span>);
<a name="l00953"></a>00953          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00954"></a>00954              (<span class="stringliteral">&quot;&lt;tr&gt;&lt;td align=center&gt;&lt;input type=submit name=submit value=\&quot; Execute! \&quot;&gt;\r\n&quot;</span>);
<a name="l00955"></a>00955          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00956"></a>00956              (<span class="stringliteral">&quot;&lt;td align=center&gt;&lt;input type=submit name=restart value=\&quot;Restart PAW!\&quot;&gt;\r\n&quot;</span>);
<a name="l00957"></a>00957          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/tr&gt;&lt;/table&gt;&lt;hr&gt;\r\n&quot;</span>);
<a name="l00958"></a>00958       }
<a name="l00959"></a>00959 
<a name="l00960"></a>00960       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(<span class="stringliteral">&quot;Links&quot;</span>, display_name, kumac_name, 0)) {
<a name="l00961"></a>00961          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;h3&gt;Links&lt;/h3&gt;&lt;/center&gt;\r\n&quot;</span>);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;ul&gt;\r\n&quot;</span>);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965          <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l00966"></a>00966             <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(<span class="stringliteral">&quot;Links&quot;</span>, display_name, kumac_name, i))
<a name="l00967"></a>00967                <span class="keywordflow">break</span>;
<a name="l00968"></a>00968 
<a name="l00969"></a>00969             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;li&gt;&lt;a target=_blank href=\&quot;%s\&quot;&gt;%s&lt;/a&gt;\n&quot;</span>, kumac_name,
<a name="l00970"></a>00970                      display_name);
<a name="l00971"></a>00971          }
<a name="l00972"></a>00972 
<a name="l00973"></a>00973          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/ul&gt;\r\n&quot;</span>);
<a name="l00974"></a>00974       }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 
<a name="l00977"></a>00977       <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(<span class="stringliteral">&quot;Kumacs&quot;</span>, display_name, kumac_name, 0)) {
<a name="l00978"></a>00978          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l00979"></a>00979              (<span class="stringliteral">&quot;&lt;center&gt;No macros defined in &lt;i&gt;webpaw.cfg&lt;/i&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l00980"></a>00980          <span class="keywordflow">return</span>;
<a name="l00981"></a>00981       } <span class="keywordflow">else</span>
<a name="l00982"></a>00982          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;h3&gt;Macros&lt;/h3&gt;&lt;/center&gt;\r\n&quot;</span>);
<a name="l00983"></a>00983 
<a name="l00984"></a>00984 
<a name="l00985"></a>00985       <span class="keywordflow">if</span> (strchr(path, <span class="charliteral">&apos;/&apos;</span>)) {
<a name="l00986"></a>00986          strcpy(cur_group, path);
<a name="l00987"></a>00987          *strchr(cur_group, <span class="charliteral">&apos;/&apos;</span>) = 0;
<a name="l00988"></a>00988          <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(cur_group);
<a name="l00989"></a>00989       } <span class="keywordflow">else</span>
<a name="l00990"></a>00990          cur_group[0] = 0;
<a name="l00991"></a>00991 
<a name="l00992"></a>00992       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;ul&gt;\r\n&quot;</span>);
<a name="l00993"></a>00993 
<a name="l00994"></a>00994       <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l00995"></a>00995          <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(<span class="stringliteral">&quot;Kumacs&quot;</span>, display_name, kumac_name, i))
<a name="l00996"></a>00996             <span class="keywordflow">break</span>;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998          <span class="keywordflow">if</span> (strncmp(display_name, <span class="stringliteral">&quot;Group&quot;</span>, 5) == 0) {
<a name="l00999"></a>00999             <span class="comment">/* whole group found */</span>
<a name="l01000"></a>01000             strcpy(group_name, kumac_name);
<a name="l01001"></a>01001             <a class="code" href="webpaw_8c.html#a6113855b8e5965f1e91ee407b4026ab7">format</a>(group_name, str);
<a name="l01002"></a>01002             strcpy(str2, group_name);
<a name="l01003"></a>01003             <a class="code" href="mhttpd_8c.html#a477e33c685ba6ebcb9d429fb057c2760">urlEncode</a>(str2);
<a name="l01004"></a>01004 
<a name="l01005"></a>01005             <span class="comment">/* display group */</span>
<a name="l01006"></a>01006             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l01007"></a>01007                 (<span class="stringliteral">&quot;&lt;li&gt;&lt;b&gt;&lt;a href=\&quot;/%s/kumacs.html\&quot; target=kumacs&gt;%s&lt;/a&gt;&lt;/b&gt;&lt;/li&gt;\r\n&quot;</span>,
<a name="l01008"></a>01008                  str2, str);
<a name="l01009"></a>01009 
<a name="l01010"></a>01010             <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(group_name, cur_group)) {
<a name="l01011"></a>01011                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;ul&gt;\r\n&quot;</span>);
<a name="l01012"></a>01012 
<a name="l01013"></a>01013                <span class="keywordflow">for</span> (j = 0;; j++) {
<a name="l01014"></a>01014                   <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(group_name, display_name, kumac_name, j))
<a name="l01015"></a>01015                      <span class="keywordflow">break</span>;
<a name="l01016"></a>01016 
<a name="l01017"></a>01017                   <a class="code" href="webpaw_8c.html#a7f987784cebfcad4573529be512d7561">display_kumac</a>(display_name, kumac_name);
<a name="l01018"></a>01018                }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/ul&gt;\r\n&quot;</span>);
<a name="l01021"></a>01021             }
<a name="l01022"></a>01022          } <span class="keywordflow">else</span>
<a name="l01023"></a>01023             <a class="code" href="webpaw_8c.html#a7f987784cebfcad4573529be512d7561">display_kumac</a>(display_name, kumac_name);
<a name="l01024"></a>01024       }
<a name="l01025"></a>01025 
<a name="l01026"></a>01026       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/ul&gt;\r\n&quot;</span>);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l01029"></a>01029       <span class="keywordflow">return</span>;
<a name="l01030"></a>01030    }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032    <span class="comment">/* display parameter page */</span>
<a name="l01033"></a>01033    <span class="keywordflow">if</span> (strstr(path, <span class="stringliteral">&quot;.html&quot;</span>) &amp;&amp; <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;param&quot;</span>)) {
<a name="l01034"></a>01034       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l01035"></a>01035       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l01036"></a>01036 
<a name="l01037"></a>01037       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;head&gt;&lt;title&gt;Please enter parameters&lt;/title&gt;\r\n&quot;</span>);
<a name="l01040"></a>01040       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/head&gt;\r\n&quot;</span>);
<a name="l01041"></a>01041 
<a name="l01042"></a>01042       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Body3&quot;</span>, str))
<a name="l01043"></a>01043          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body %s&gt;\r\n&quot;</span>, str);
<a name="l01044"></a>01044       <span class="keywordflow">else</span>
<a name="l01045"></a>01045          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body&gt;\r\n&quot;</span>);
<a name="l01046"></a>01046 
<a name="l01047"></a>01047       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;form method=GET action=\&quot;%s\&quot; target=contents&gt;\r\n&quot;</span>, <a class="code" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a>);
<a name="l01048"></a>01048 
<a name="l01049"></a>01049       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;center&gt;&lt;h2&gt;Please enter parameters&lt;/h2&gt;\r\n&quot;</span>);
<a name="l01050"></a>01050       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;for function&lt;p&gt;\r\n&quot;</span>);
<a name="l01051"></a>01051 
<a name="l01052"></a>01052       strcpy(cmd, path);
<a name="l01053"></a>01053       *strstr(cmd, <span class="stringliteral">&quot;.html&quot;</span>) = 0;
<a name="l01054"></a>01054       <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(cmd);
<a name="l01055"></a>01055 
<a name="l01056"></a>01056       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;code&gt;%s&lt;/code&gt;&lt;p&gt;\r\n\r\n&quot;</span>, cmd);
<a name="l01057"></a>01057       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;input type=\&quot;hidden\&quot; name=\&quot;cmd\&quot; value=\&quot;%s\&quot;&gt;\r\n&quot;</span>, cmd);
<a name="l01058"></a>01058 
<a name="l01059"></a>01059       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;table border=0 cellpadding=5&gt;\r\n&quot;</span>);
<a name="l01060"></a>01060       <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l01061"></a>01061          <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#ab55c0539c5eb56bd09c452c482080ed4">enumcfg</a>(<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;param&quot;</span>), param_name, param_opt, i))
<a name="l01062"></a>01062             <span class="keywordflow">break</span>;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;tr&gt;&lt;td align=right&gt;%s&lt;/td&gt;&lt;td&gt;&quot;</span>, param_name);
<a name="l01065"></a>01065 
<a name="l01066"></a>01066          <span class="keywordflow">if</span> (strchr(param_opt, <span class="charliteral">&apos;;&apos;</span>) == NULL)
<a name="l01067"></a>01067             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;input type=text name=\&quot;p%d\&quot; value=\&quot;%s\&quot;&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>, i,
<a name="l01068"></a>01068                      param_opt);
<a name="l01069"></a>01069          <span class="keywordflow">else</span> {
<a name="l01070"></a>01070             <span class="comment">/* display individual options in drop down box */</span>
<a name="l01071"></a>01071             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;select size=1 name=\&quot;p%d\&quot;&gt;\r\n&quot;</span>, i);
<a name="l01072"></a>01072             p = param_opt;
<a name="l01073"></a>01073             <span class="keywordflow">for</span> (j = 0; *p; j++) {
<a name="l01074"></a>01074                <span class="keywordflow">while</span> (*p &amp;&amp; *p == <span class="charliteral">&apos; &apos;</span>)
<a name="l01075"></a>01075                   p++;
<a name="l01076"></a>01076                ps = str;
<a name="l01077"></a>01077                <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos;;&apos;</span>)
<a name="l01078"></a>01078                   *ps++ = *p++;
<a name="l01079"></a>01079                *ps = 0;
<a name="l01080"></a>01080                <span class="keywordflow">if</span> (*p)
<a name="l01081"></a>01081                   p++;
<a name="l01082"></a>01082                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;option&gt;%s\r\n&quot;</span>, str);
<a name="l01083"></a>01083             }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/select&gt;\r\n&quot;</span>);
<a name="l01086"></a>01086          }
<a name="l01087"></a>01087       }
<a name="l01088"></a>01088       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/table&gt;&lt;P&gt;&quot;</span>);
<a name="l01089"></a>01089 
<a name="l01090"></a>01090       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;input type=submit value=\&quot;Submit\&quot;&gt;\r\n&quot;</span>);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l01093"></a>01093       <span class="keywordflow">return</span>;
<a name="l01094"></a>01094    }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096    <span class="comment">/* display contents */</span>
<a name="l01097"></a>01097    <span class="keywordflow">if</span> (strstr(path, <span class="stringliteral">&quot;.html&quot;</span>) || <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;submit&quot;</span>) || <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;cmd&quot;</span>)) {
<a name="l01098"></a>01098       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l01099"></a>01099       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l01100"></a>01100 
<a name="l01101"></a>01101       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l01102"></a>01102 
<a name="l01103"></a>01103       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;head&gt;\r\n&quot;</span>);
<a name="l01104"></a>01104       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Refresh&quot;</span>, str))
<a name="l01105"></a>01105          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;meta http-equiv=REFRESH content=%s&gt;&quot;</span>, str);
<a name="l01106"></a>01106       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/head&gt;\r\n&quot;</span>);
<a name="l01107"></a>01107 
<a name="l01108"></a>01108       <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Body3&quot;</span>, str))
<a name="l01109"></a>01109          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body %s&gt;\r\n&quot;</span>, str);
<a name="l01110"></a>01110       <span class="keywordflow">else</span>
<a name="l01111"></a>01111          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;html&gt;&lt;body&gt;\r\n&quot;</span>);
<a name="l01112"></a>01112 
<a name="l01113"></a>01113       <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;restart&quot;</span>))
<a name="l01114"></a>01114          strcpy(cmd, <span class="stringliteral">&quot;restart&quot;</span>);
<a name="l01115"></a>01115       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;cmd&quot;</span>)) {
<a name="l01116"></a>01116          strcpy(cmd, <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;cmd&quot;</span>));
<a name="l01117"></a>01117          <a class="code" href="mhttpd_8c.html#a477e33c685ba6ebcb9d429fb057c2760">urlEncode</a>(cmd);
<a name="l01118"></a>01118       } <span class="keywordflow">else</span>
<a name="l01119"></a>01119          strcpy(cmd, path);
<a name="l01120"></a>01120 
<a name="l01121"></a>01121       <span class="comment">/* add parameters if present */</span>
<a name="l01122"></a>01122       param_opt[0] = 0;
<a name="l01123"></a>01123       <span class="keywordflow">for</span> (i = 0;; i++) {
<a name="l01124"></a>01124          sprintf(str, <span class="stringliteral">&quot;p%d&quot;</span>, i);
<a name="l01125"></a>01125          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(str)) {
<a name="l01126"></a>01126             strcat(param_opt, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01127"></a>01127             strcat(param_opt, <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(str));
<a name="l01128"></a>01128          } <span class="keywordflow">else</span>
<a name="l01129"></a>01129             <span class="keywordflow">break</span>;
<a name="l01130"></a>01130       }
<a name="l01131"></a>01131       <span class="keywordflow">if</span> (param_opt[0]) {
<a name="l01132"></a>01132          <a class="code" href="mhttpd_8c.html#a477e33c685ba6ebcb9d429fb057c2760">urlEncode</a>(param_opt);
<a name="l01133"></a>01133          strcat(cmd, param_opt);
<a name="l01134"></a>01134       }
<a name="l01135"></a>01135 
<a name="l01136"></a>01136       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(str, <span class="stringliteral">&quot;quit&quot;</span>)) {
<a name="l01137"></a>01137          status = <a class="code" href="webpaw_8c.html#afbc34c39e5863988ff8d15f9afb4ddd2">submit_paw</a>(<span class="stringliteral">&quot;quit&quot;</span>, str, 0);
<a name="l01138"></a>01138          <span class="keywordflow">if</span> (status == <a class="code" href="webpaw_8c.html#a3b61478edd7c1b25c8facd2907cf6c33">SHUTDOWN</a>)
<a name="l01139"></a>01139             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;h1&gt;WebPAW shut down successfully&lt;/h1&gt;\r\n&quot;</span>);
<a name="l01140"></a>01140          <span class="keywordflow">else</span>
<a name="l01141"></a>01141             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l01142"></a>01142                 (<span class="stringliteral">&quot;&lt;h1&gt;Error talking to PAW, return string :&lt;/h1&gt;\r\n&lt;pre&gt;%s&lt;/pre&gt;\r\n&quot;</span>,
<a name="l01143"></a>01143                  str);
<a name="l01144"></a>01144 
<a name="l01145"></a>01145          <a class="code" href="webpaw_8c.html#a47cb71fd25faecb24fa8360f407e4cc0">_quit</a> = 1;
<a name="l01146"></a>01146       } <span class="keywordflow">else</span> {
<a name="l01147"></a>01147          <span class="keywordflow">if</span> (strstr(cmd, <span class="stringliteral">&quot;.html&quot;</span>))
<a name="l01148"></a>01148             *strstr(cmd, <span class="stringliteral">&quot;.html&quot;</span>) = 0;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150          <span class="comment">/* display optional comment */</span>
<a name="l01151"></a>01151          <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;comment&quot;</span>)) {
<a name="l01152"></a>01152             fh = open(<a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;comment&quot;</span>), O_RDONLY);
<a name="l01153"></a>01153             <span class="keywordflow">if</span> (fh &gt; 0) {
<a name="l01154"></a>01154                length = lseek(fh, 0, SEEK_END);
<a name="l01155"></a>01155                lseek(fh, 0, SEEK_SET);
<a name="l01156"></a>01156 
<a name="l01157"></a>01157                <span class="comment">/* return if file too big */</span>
<a name="l01158"></a>01158                <span class="keywordflow">if</span> (length &lt; (<span class="keywordtype">int</span>) (<span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) - strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>))) {
<a name="l01159"></a>01159                   *(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a> + strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + length) = 0;
<a name="l01160"></a>01160                   <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(fh, <a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a> + strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>), length);
<a name="l01161"></a>01161                   close(fh);
<a name="l01162"></a>01162                }
<a name="l01163"></a>01163             }
<a name="l01164"></a>01164          }
<a name="l01165"></a>01165 
<a name="l01166"></a>01166          <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Elog&quot;</span>, elog)) {
<a name="l01167"></a>01167             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l01168"></a>01168                 (<span class="stringliteral">&quot;&lt;p&gt;&lt;a target=_blank href=\&quot;%s\&quot;&gt;Create ELog with this picture&lt;/a&gt;&lt;br&gt;\r\n&quot;</span>,
<a name="l01169"></a>01169                  elog);
<a name="l01170"></a>01170          }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172          <span class="comment">/* put reference to image */</span>
<a name="l01173"></a>01173          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;img src=\&quot;/%s.gif\&quot; alt=contents.gif&gt;&lt;/a&gt;\r\n&quot;</span>, cmd);
<a name="l01174"></a>01174 
<a name="l01175"></a>01175          <span class="comment">/* display optional PAW text output */</span>
<a name="l01176"></a>01176          <span class="keywordflow">if</span> (!<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(cmd, <span class="stringliteral">&quot;contents&quot;</span>))
<a name="l01177"></a>01177             <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Text&quot;</span>, str) &amp;&amp; str[0] == <span class="charliteral">&apos;y&apos;</span>) {
<a name="l01178"></a>01178                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;p&gt;&lt;pre&gt;\r\n&quot;</span>);
<a name="l01179"></a>01179 
<a name="l01180"></a>01180                <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(cmd);
<a name="l01181"></a>01181                status = <a class="code" href="webpaw_8c.html#afbc34c39e5863988ff8d15f9afb4ddd2">submit_paw</a>(cmd, str, 0);
<a name="l01182"></a>01182 
<a name="l01183"></a>01183                <a class="code" href="webpaw_8c.html#a7c5fce9a07b3d1a6afe002ec744b6442">format1</a>(str, str2);
<a name="l01184"></a>01184                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(str2);
<a name="l01185"></a>01185 
<a name="l01186"></a>01186                <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/pre&gt;\r\n&quot;</span>);
<a name="l01187"></a>01187             }
<a name="l01188"></a>01188       }
<a name="l01189"></a>01189 
<a name="l01190"></a>01190       <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l01191"></a>01191       <span class="keywordflow">return</span>;
<a name="l01192"></a>01192    }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194    <span class="comment">/* forward command to paw and display result */</span>
<a name="l01195"></a>01195    <span class="keywordflow">if</span> (strstr(path, <span class="stringliteral">&quot;.gif&quot;</span>) || <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;submit&quot;</span>) || <a class="code" href="mana_8cpp.html#ac965acb06ece6889fd3b68d82ca916c5">getparam</a>(<span class="stringliteral">&quot;cmd&quot;</span>)) {
<a name="l01196"></a>01196       strcpy(str, path);
<a name="l01197"></a>01197       <a class="code" href="mhttpd_8c.html#a314e523b7d95b4a434216200167e5e0a">urlDecode</a>(str);
<a name="l01198"></a>01198       <span class="keywordflow">if</span> (strstr(path, <span class="stringliteral">&quot;.gif&quot;</span>))
<a name="l01199"></a>01199          *strstr(str, <span class="stringliteral">&quot;.gif&quot;</span>) = 0;
<a name="l01200"></a>01200 
<a name="l01201"></a>01201       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(path, <span class="stringliteral">&quot;contents.gif&quot;</span>))
<a name="l01202"></a>01202          str[0] = 0;
<a name="l01203"></a>01203 
<a name="l01204"></a>01204       <span class="comment">/* disable $shell command */</span>
<a name="l01205"></a>01205       <span class="keywordflow">for</span> (i = 0; i &lt; (int) strlen(str); i++)
<a name="l01206"></a>01206          tmp[i] = toupper(str[i]);
<a name="l01207"></a>01207       tmp[i] = 0;
<a name="l01208"></a>01208       <span class="keywordflow">if</span> (strstr(tmp, <span class="stringliteral">&quot;$SHELL&quot;</span>))
<a name="l01209"></a>01209          str[0] = 0;
<a name="l01210"></a>01210 
<a name="l01211"></a>01211 <span class="preprocessor">#ifndef _MSC_VER</span>
<a name="l01212"></a>01212 <span class="preprocessor"></span>      status = <a class="code" href="webpaw_8c.html#afbc34c39e5863988ff8d15f9afb4ddd2">submit_paw</a>(str, str, 1);
<a name="l01213"></a>01213       <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>) {
<a name="l01214"></a>01214          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l01215"></a>01215          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l01216"></a>01216          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l01217"></a>01217          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>
<a name="l01218"></a>01218              (<span class="stringliteral">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Error talking to PAW, return string :&lt;/h1&gt;\r\n&lt;pre&gt;%s&lt;/pre&gt;\r\n&quot;</span>,
<a name="l01219"></a>01219               str);
<a name="l01220"></a>01220          <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);
<a name="l01221"></a>01221       } <span class="keywordflow">else</span>
<a name="l01222"></a>01222 <span class="preprocessor">#endif</span>
<a name="l01223"></a>01223 <span class="preprocessor"></span>      {
<a name="l01224"></a>01224          fh = open(<span class="stringliteral">&quot;webpaw.gif&quot;</span>, O_RDONLY | <a class="code" href="group__msystemincludecode.html#ga36fa9b2e726512bc17a7a6d3e39002be">O_BINARY</a>);
<a name="l01225"></a>01225          <span class="keywordflow">if</span> (fh &gt; 0) {
<a name="l01226"></a>01226             length = lseek(fh, 0, SEEK_END);
<a name="l01227"></a>01227             lseek(fh, 0, SEEK_SET);
<a name="l01228"></a>01228 
<a name="l01229"></a>01229             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.0 200 Document follows\r\n&quot;</span>);
<a name="l01230"></a>01230             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l01231"></a>01231             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Accept-Ranges: bytes\r\n&quot;</span>);
<a name="l01232"></a>01232 
<a name="l01233"></a>01233             <span class="comment">/* return proper header for file type */</span>
<a name="l01234"></a>01234             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: image/gif\r\n&quot;</span>);
<a name="l01235"></a>01235             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Length: %d\r\n&quot;</span>, length);
<a name="l01236"></a>01236             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Pragma: no-cache\r\n&quot;</span>);
<a name="l01237"></a>01237             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Expires: Fri, 01 Jan 1983 00:00:00 GMT\r\n\r\n&quot;</span>);
<a name="l01238"></a>01238 
<a name="l01239"></a>01239             <span class="comment">/* return if file too big */</span>
<a name="l01240"></a>01240             <span class="keywordflow">if</span> (length &gt; (<span class="keywordtype">int</span>) (<span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) - strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>))) {
<a name="l01241"></a>01241                printf(<span class="stringliteral">&quot;return buffer too small\n&quot;</span>);
<a name="l01242"></a>01242                close(fh);
<a name="l01243"></a>01243                <span class="keywordflow">return</span>;
<a name="l01244"></a>01244             }
<a name="l01245"></a>01245 
<a name="l01246"></a>01246             <a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> = strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + length;
<a name="l01247"></a>01247             <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(fh, <a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a> + strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>), length);
<a name="l01248"></a>01248 
<a name="l01249"></a>01249             close(fh);
<a name="l01250"></a>01250          }
<a name="l01251"></a>01251       }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253       <span class="keywordflow">return</span>;
<a name="l01254"></a>01254    }
<a name="l01255"></a>01255 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aebe37a88c8359d0591711e1782d2c997"></a><!-- doxytag: member="webpaw.c::isparam" ref="aebe37a88c8359d0591711e1782d2c997" args="(char *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int isparam </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00528">528</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="experiment_2template_8c_source.html#l00070">_param</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, and <a class="el" href="mhttpd_8c_source.html#l00879">MAX_PARAM</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00529"></a>00529 {
<a name="l00530"></a>00530    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00531"></a>00531 
<a name="l00532"></a>00532    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="mhttpd_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a> &amp;&amp; <a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>[i][0]; i++)
<a name="l00533"></a>00533       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(<a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>, _param[i]))
<a name="l00534"></a>00534          <span class="keywordflow">break</span>;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536    <span class="keywordflow">if</span> (i &lt; <a class="code" href="mhttpd_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a> &amp;&amp; _param[i][0])
<a name="l00537"></a>00537       <span class="keywordflow">return</span> 1;
<a name="l00538"></a>00538 
<a name="l00539"></a>00539    <span class="keywordflow">return</span> 0;
<a name="l00540"></a>00540 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a><!-- doxytag: member="webpaw.c::main" ref="a0ddf1224851353fc92bfbff6f499fa97" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>argv</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01764">1764</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00189">_debug</a>, <a class="el" href="melog_8c_source.html#l00103">base64_encode()</a>, <a class="el" href="webpaw_8c_source.html#l01692">create_password()</a>, <a class="el" href="mana_8cpp_source.html#l00665">daemon</a>, <a class="el" href="webpaw_8c_source.html#l00190">debug_file</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="webpaw_8c_source.html#l00193">paw_prompt</a>, <a class="el" href="odbedit_8c_source.html#l00251">pwd</a>, <a class="el" href="mhttpd_8c_source.html#l09964">server_loop()</a>, <a class="el" href="mhttpd_8c_source.html#l00876">tcp_port</a>, and <a class="el" href="odb__check_8cc_source.html#l00011">usage()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01765"></a>01765 {
<a name="l01766"></a>01766    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l01767"></a>01767    <span class="keywordtype">int</span> <a class="code" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a> = 80, <a class="code" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a> = 0;
<a name="l01768"></a>01768    <span class="keywordtype">char</span> <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>[256], <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l01769"></a>01769 
<a name="l01770"></a>01770    <span class="comment">/* parse command line parameters */</span>
<a name="l01771"></a>01771    <a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a> = 0;
<a name="l01772"></a>01772    pwd[0] = 0;
<a name="l01773"></a>01773    strcpy(<a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, <span class="stringliteral">&quot;PAW &gt; &quot;</span>);
<a name="l01774"></a>01774    <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++) {
<a name="l01775"></a>01775       <span class="keywordflow">if</span> (argv[i][0] == <span class="charliteral">&apos;-&apos;</span> &amp;&amp; argv[i][1] == <span class="charliteral">&apos;D&apos;</span>)
<a name="l01776"></a>01776          <a class="code" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a> = 1;
<a name="l01777"></a>01777       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argv[i][0] == <span class="charliteral">&apos;-&apos;</span> &amp;&amp; argv[i][1] == <span class="charliteral">&apos;d&apos;</span>) {
<a name="l01778"></a>01778          <a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a> = 1;
<a name="l01779"></a>01779          <span class="keywordflow">if</span> (argv[i + 1] &amp;&amp; argv[i + 1][0] != <span class="charliteral">&apos;-&apos;</span>)
<a name="l01780"></a>01780             strcpy(<a class="code" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a>, argv[++i]);
<a name="l01781"></a>01781       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argv[i][0] == <span class="charliteral">&apos;-&apos;</span>) {
<a name="l01782"></a>01782          <span class="keywordflow">if</span> (i + 1 &gt;= argc || argv[i + 1][0] == <span class="charliteral">&apos;-&apos;</span>)
<a name="l01783"></a>01783             <span class="keywordflow">goto</span> <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>;
<a name="l01784"></a>01784          <span class="keywordflow">if</span> (argv[i][1] == <span class="charliteral">&apos;p&apos;</span>)
<a name="l01785"></a>01785             tcp_port = atoi(argv[++i]);
<a name="l01786"></a>01786          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argv[i][1] == <span class="charliteral">&apos;s&apos;</span>)
<a name="l01787"></a>01787             strcpy(<a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, argv[++i]);
<a name="l01788"></a>01788          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argv[i][1] == <span class="charliteral">&apos;w&apos;</span>)
<a name="l01789"></a>01789             strcpy(pwd, argv[++i]);
<a name="l01790"></a>01790          <span class="keywordflow">else</span> {
<a name="l01791"></a>01791           <a class="code" href="odb__check_8cc.html#a2ef30c42cbc289d899a8be5d2d8f77d0">usage</a>:
<a name="l01792"></a>01792             printf(<span class="stringliteral">&quot;usage: %s [-p port] [-s prompt] [-d [file]] [-D] [-w password]\n\n&quot;</span>,
<a name="l01793"></a>01793                    argv[0]);
<a name="l01794"></a>01794             printf(<span class="stringliteral">&quot;       -p set port under which webpaw runs (default: 80)\n&quot;</span>);
<a name="l01795"></a>01795             printf(<span class="stringliteral">&quot;       -s use alternative PAW prompt (instead \&quot;PAW &gt; \&quot;)\n&quot;</span>);
<a name="l01796"></a>01796             printf
<a name="l01797"></a>01797                 (<span class="stringliteral">&quot;       -d [file] display debug messages, optionally put them into file\n&quot;</span>);
<a name="l01798"></a>01798             printf(<span class="stringliteral">&quot;       -D become a daemon\n&quot;</span>);
<a name="l01799"></a>01799             printf(<span class="stringliteral">&quot;       -w create/overwrite password in webpaw.cfg\n\n&quot;</span>);
<a name="l01800"></a>01800             <span class="keywordflow">return</span> 1;
<a name="l01801"></a>01801          }
<a name="l01802"></a>01802       }
<a name="l01803"></a>01803    }
<a name="l01804"></a>01804 
<a name="l01805"></a>01805    <span class="keywordflow">if</span> (pwd[0]) {
<a name="l01806"></a>01806       <a class="code" href="melog_8c.html#ad2d0890b22d51fd03fbff402b8da4c9b">base64_encode</a>(pwd, str);
<a name="l01807"></a>01807       <a class="code" href="webpaw_8c.html#a81b18a7e5d11bb7c85792bc6c117e8fe">create_password</a>(str);
<a name="l01808"></a>01808       <span class="keywordflow">return</span> 0;
<a name="l01809"></a>01809    }
<a name="l01810"></a>01810 
<a name="l01811"></a>01811    <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a> &amp;&amp; <a class="code" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a> &amp;&amp; !<a class="code" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a>[0]) {
<a name="l01812"></a>01812       printf(<span class="stringliteral">&quot;Error: when -D flag is given, -d must contain a filename.\n&quot;</span>);
<a name="l01813"></a>01813       <span class="keywordflow">return</span> 1;
<a name="l01814"></a>01814    }
<a name="l01815"></a>01815 
<a name="l01816"></a>01816    <a class="code" href="mhttpd_8c.html#a2d0768b06b700bb79b874bd19ba4ec6f">server_loop</a>(tcp_port, <a class="code" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a>);
<a name="l01817"></a>01817 
<a name="l01818"></a>01818    <span class="keywordflow">return</span> 0;
<a name="l01819"></a>01819 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6e6f2ca1e65467495acfae0757040d37"></a><!-- doxytag: member="webpaw.c::read_paw" ref="a6e6f2ca1e65467495acfae0757040d37" args="(int pipe, char *delim, char *result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_paw </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>delim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00602">602</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00201">debug_message()</a>, <a class="el" href="webpaw_8c_source.html#l00179">ERR_PIPE</a>, <a class="el" href="webpaw_8c_source.html#l00178">ERR_TIMEOUT</a>, <a class="el" href="msystem_8h_source.html#l00336">FD_SETSIZE</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00256">read</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="mhist_8c_source.html#l00078">tmp()</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00603"></a>00603 {
<a name="l00604"></a>00604    fd_set readfds;
<a name="l00605"></a>00605    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[100000], <a class="code" href="mhist_8c.html#a1c4effcb9a2b3357fbfa63a6edfa0cc6">tmp</a>[100000];
<a name="l00606"></a>00606    <span class="keyword">struct </span>timeval <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>;
<a name="l00607"></a>00607    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609    sprintf(str, <span class="stringliteral">&quot;\n##WAIT FOR: \&quot;%s\&quot;\n&quot;</span>, delim);
<a name="l00610"></a>00610    <a class="code" href="webpaw_8c.html#a88be4aafa327218fbd41f7e1132f75ca">debug_message</a>(str);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612    memset(str, 0, <span class="keyword">sizeof</span>(str));
<a name="l00613"></a>00613 
<a name="l00614"></a>00614    <span class="keywordflow">do</span> {
<a name="l00615"></a>00615       FD_ZERO(&amp;readfds);
<a name="l00616"></a>00616       FD_SET(pipe, &amp;readfds);
<a name="l00617"></a>00617 
<a name="l00618"></a>00618       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_sec = 15;
<a name="l00619"></a>00619       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_usec = 0;
<a name="l00620"></a>00620       select(<a class="code" href="group__msystemincludecode.html#ga86c5dbf5a99358e288f573d6a1e0873f">FD_SETSIZE</a>, (<span class="keywordtype">void</span> *) &amp;readfds, NULL, NULL, (<span class="keywordtype">void</span> *) &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l00621"></a>00621 
<a name="l00622"></a>00622       <span class="keywordflow">if</span> (FD_ISSET(pipe, &amp;readfds)) {
<a name="l00623"></a>00623          memset(tmp, 0, <span class="keyword">sizeof</span>(tmp));
<a name="l00624"></a>00624          i = <a class="code" href="examples_2macro_2midas__macro_8h.html#a5b55880ce7d302ae13576e90584a63bb">read</a>(pipe, tmp, <span class="keyword">sizeof</span>(tmp) - 1);
<a name="l00625"></a>00625          <span class="keywordflow">if</span> (i &lt;= 0)
<a name="l00626"></a>00626             <span class="keywordflow">break</span>;
<a name="l00627"></a>00627 
<a name="l00628"></a>00628          <a class="code" href="webpaw_8c.html#a88be4aafa327218fbd41f7e1132f75ca">debug_message</a>(tmp);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630          <span class="keywordflow">if</span> (strlen(tmp) + strlen(str) &lt; <span class="keyword">sizeof</span>(str))
<a name="l00631"></a>00631             strcat(str, tmp);
<a name="l00632"></a>00632       } <span class="keywordflow">else</span> {
<a name="l00633"></a>00633          <span class="keywordflow">if</span> (result)
<a name="l00634"></a>00634             strcpy(result, str);
<a name="l00635"></a>00635 
<a name="l00636"></a>00636          <span class="keywordflow">return</span> <a class="code" href="webpaw_8c.html#aedcf61ffa26ceba66e9995937de74d64">ERR_TIMEOUT</a>;
<a name="l00637"></a>00637       }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639       <span class="comment">/*</span>
<a name="l00640"></a>00640 <span class="comment">         if (strlen(str) &gt;= strlen(delim))</span>
<a name="l00641"></a>00641 <span class="comment">         printf(&quot;compare1:%s\ncompare2:%s\ncompare3:%s\n&quot;, delim, str, str+strlen(str)-strlen(delim));</span>
<a name="l00642"></a>00642 <span class="comment">       */</span>
<a name="l00643"></a>00643 
<a name="l00644"></a>00644       <span class="keywordflow">if</span> (strlen(str) &gt;= strlen(delim) &amp;&amp;
<a name="l00645"></a>00645           strcmp(str + strlen(str) - strlen(delim), delim) == 0)
<a name="l00646"></a>00646          <span class="keywordflow">break</span>;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648    } <span class="keywordflow">while</span> (1);
<a name="l00649"></a>00649 
<a name="l00650"></a>00650    <span class="keywordflow">if</span> (result)
<a name="l00651"></a>00651       strcpy(result, str);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653    <span class="keywordflow">if</span> (i &lt;= 0)
<a name="l00654"></a>00654       <span class="keywordflow">return</span> <a class="code" href="webpaw_8c.html#a3144b48f181067b67fe3f036e24ba3a0">ERR_PIPE</a>;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656    <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00657"></a>00657 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af3273cdaacb7a8ea6ad26e4dc8389f42"></a><!-- doxytag: member="webpaw.c::rsprintf" ref="af3273cdaacb7a8ea6ad26e4dc8389f42" args="(const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsprintf </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00232">232</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mhttpd_8c_source.html#l00870">return_buffer</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00233"></a>00233 {
<a name="l00234"></a>00234    va_list argptr;
<a name="l00235"></a>00235    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[10000];
<a name="l00236"></a>00236 
<a name="l00237"></a>00237    va_start(argptr, <a class="code" href="webpaw_8c.html#a6113855b8e5965f1e91ee407b4026ab7">format</a>);
<a name="l00238"></a>00238    vsprintf(str, (<span class="keywordtype">char</span> *) <a class="code" href="webpaw_8c.html#a6113855b8e5965f1e91ee407b4026ab7">format</a>, argptr);
<a name="l00239"></a>00239    va_end(argptr);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241    <span class="keywordflow">if</span> (strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + strlen(str) &gt; <span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>))
<a name="l00242"></a>00242       strcpy(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, <span class="stringliteral">&quot;&lt;H1&gt;Error: return buffer too small&lt;/H1&gt;&quot;</span>);
<a name="l00243"></a>00243    <span class="keywordflow">else</span>
<a name="l00244"></a>00244       strcat(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, str);
<a name="l00245"></a>00245 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa258f4f0f01c467a164ee216a3b2c6d4"></a><!-- doxytag: member="webpaw.c::rsputs" ref="aa258f4f0f01c467a164ee216a3b2c6d4" args="(const char *str,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsputs </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00222">222</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mhttpd_8c_source.html#l00870">return_buffer</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00223"></a>00223 {
<a name="l00224"></a>00224    <span class="keywordflow">if</span> (strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + strlen(<a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>) &gt; <span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>))
<a name="l00225"></a>00225       strcpy(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, <span class="stringliteral">&quot;&lt;H1&gt;Error: return buffer too small&lt;/H1&gt;&quot;</span>);
<a name="l00226"></a>00226    <span class="keywordflow">else</span>
<a name="l00227"></a>00227       strcat(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>);
<a name="l00228"></a>00228 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaec1e477913a7881360f575a62816ca8"></a><!-- doxytag: member="webpaw.c::server_loop" ref="aaec1e477913a7881360f575a62816ca8" args="(int tcp_port, int daemon)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void server_loop </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>tcp_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>daemon</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01382">1382</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00189">_debug</a>, <a class="el" href="webpaw_8c_source.html#l00191">_quit</a>, <a class="el" href="mhttpd_8c_source.html#l00890">_sock</a>, <a class="el" href="webpaw_8c_source.html#l01329">base64_decode()</a>, <a class="el" href="melog_8c_source.html#l00103">base64_encode()</a>, <a class="el" href="melog_8c_source.html#l00085">closesocket</a>, <a class="el" href="webpaw_8c_source.html#l01259">decode()</a>, <a class="el" href="webpaw_8c_source.html#l00179">ERR_PIPE</a>, <a class="el" href="webpaw_8c_source.html#l00178">ERR_TIMEOUT</a>, <a class="el" href="msystem_8h_source.html#l00336">FD_SETSIZE</a>, <a class="el" href="scs__310__ql355p_8c_source.html#l00055">flag</a>, <a class="el" href="webpaw_8c_source.html#l00333">getcfg()</a>, <a class="el" href="crate6__CAEN__TDC_2mfe__mucap_8c_source.html#l00327">host_name</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="rpc_8c_source.html#l00293">net_buffer</a>, <a class="el" href="sis3803_8c_source.html#l00925">p</a>, <a class="el" href="odbedit_8c_source.html#l00251">pwd</a>, <a class="el" href="webpaw_8c_source.html#l00188">remote_host_name</a>, <a class="el" href="mhttpd_8c_source.html#l00870">return_buffer</a>, <a class="el" href="mhttpd_8c_source.html#l00872">return_length</a>, <a class="el" href="mhttpd_8c_source.html#l01014">rsprintf()</a>, <a class="el" href="scs__310_8c_source.html#l00266">send()</a>, <a class="el" href="webpaw_8c_source.html#l01300">sighup()</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>, and <a class="el" href="webpaw_8c_source.html#l00183">webpaw_url</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01383"></a>01383 {
<a name="l01384"></a>01384    <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>, <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>, n_error;
<a name="l01385"></a>01385    <span class="keyword">struct </span>sockaddr_in bind_addr, acc_addr;
<a name="l01386"></a>01386    <span class="keywordtype">int</span> lsock, len, <a class="code" href="scs__310__ql355p_8c.html#a11764cc96bb263d1f257bcc01205a787">flag</a>, header_length, authorized;
<a name="l01387"></a>01387    <span class="keyword">struct </span>hostent *phe;
<a name="l01388"></a>01388    <span class="keyword">struct </span>linger ling;
<a name="l01389"></a>01389    fd_set readfds;
<a name="l01390"></a>01390    <span class="keyword">struct </span>timeval <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>;
<a name="l01391"></a>01391    <span class="keywordtype">char</span> <a class="code" href="odbedit_8c.html#a95ee0b00ff452e20c7fd1df9073e916b">pwd</a>[256], cl_pwd[256], <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256], *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l01392"></a>01392 
<a name="l01393"></a>01393    <a class="code" href="webpaw_8c.html#a47cb71fd25faecb24fa8360f407e4cc0">_quit</a> = 0;
<a name="l01394"></a>01394 
<a name="l01395"></a>01395 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l01396"></a>01396 <span class="preprocessor"></span>   {
<a name="l01397"></a>01397       WSADATA WSAData;
<a name="l01398"></a>01398 
<a name="l01399"></a>01399       <span class="comment">/* Start windows sockets */</span>
<a name="l01400"></a>01400       <span class="keywordflow">if</span> (WSAStartup(MAKEWORD(1, 1), &amp;WSAData) != 0)
<a name="l01401"></a>01401          <span class="keywordflow">return</span>;
<a name="l01402"></a>01402    }
<a name="l01403"></a>01403 <span class="preprocessor">#else</span>
<a name="l01404"></a>01404 <span class="preprocessor"></span>
<a name="l01405"></a>01405    <span class="comment">/* set signal handler for HUP signal */</span>
<a name="l01406"></a>01406    signal(SIGHUP, <a class="code" href="webpaw_8c.html#a8e518de089e3561081e2467925073550">sighup</a>);
<a name="l01407"></a>01407 
<a name="l01408"></a>01408    <span class="comment">/* check DISPLAY variable */</span>
<a name="l01409"></a>01409    <span class="keywordflow">if</span> (!getenv(<span class="stringliteral">&quot;DISPLAY&quot;</span>)) {
<a name="l01410"></a>01410       printf(<span class="stringliteral">&quot;Please define DISPLAY variable so that PAW can open its HIGZ window.\n&quot;</span>);
<a name="l01411"></a>01411       <span class="keywordflow">return</span>;
<a name="l01412"></a>01412    }
<a name="l01413"></a>01413 <span class="preprocessor">#endif</span>
<a name="l01414"></a>01414 <span class="preprocessor"></span>
<a name="l01415"></a>01415    <span class="comment">/* create a new socket */</span>
<a name="l01416"></a>01416    lsock = socket(AF_INET, SOCK_STREAM, 0);
<a name="l01417"></a>01417 
<a name="l01418"></a>01418    <span class="keywordflow">if</span> (lsock == -1) {
<a name="l01419"></a>01419       printf(<span class="stringliteral">&quot;Cannot create socket\n&quot;</span>);
<a name="l01420"></a>01420       <span class="keywordflow">return</span>;
<a name="l01421"></a>01421    }
<a name="l01422"></a>01422 
<a name="l01423"></a>01423    <span class="comment">/* bind local node name and port to socket */</span>
<a name="l01424"></a>01424    memset(&amp;bind_addr, 0, <span class="keyword">sizeof</span>(bind_addr));
<a name="l01425"></a>01425    bind_addr.sin_family = AF_INET;
<a name="l01426"></a>01426    bind_addr.sin_addr.s_addr = 0;
<a name="l01427"></a>01427    bind_addr.sin_port = htons((<span class="keywordtype">short</span>) <a class="code" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a>);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429    gethostname(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>, <span class="keyword">sizeof</span>(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>));
<a name="l01430"></a>01430 
<a name="l01431"></a>01431    phe = gethostbyname(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>);
<a name="l01432"></a>01432    <span class="keywordflow">if</span> (phe == NULL) {
<a name="l01433"></a>01433       printf(<span class="stringliteral">&quot;Cannot retrieve host name\n&quot;</span>);
<a name="l01434"></a>01434       <span class="keywordflow">return</span>;
<a name="l01435"></a>01435    }
<a name="l01436"></a>01436    phe = gethostbyaddr(phe-&gt;h_addr, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), AF_INET);
<a name="l01437"></a>01437    <span class="keywordflow">if</span> (phe == NULL) {
<a name="l01438"></a>01438       printf(<span class="stringliteral">&quot;Cannot retrieve host name\n&quot;</span>);
<a name="l01439"></a>01439       <span class="keywordflow">return</span>;
<a name="l01440"></a>01440    }
<a name="l01441"></a>01441 
<a name="l01442"></a>01442    <span class="comment">/* if domain name is not in host name, hope to get it from phe */</span>
<a name="l01443"></a>01443    <span class="keywordflow">if</span> (strchr(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>, <span class="charliteral">&apos;.&apos;</span>) == NULL)
<a name="l01444"></a>01444       strcpy(<a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>, phe-&gt;h_name);
<a name="l01445"></a>01445 
<a name="l01446"></a>01446    memcpy((<span class="keywordtype">char</span> *) &amp;(bind_addr.sin_addr), phe-&gt;h_addr, phe-&gt;h_length);
<a name="l01447"></a>01447 
<a name="l01448"></a>01448    <span class="comment">/* try reusing address */</span>
<a name="l01449"></a>01449    flag = 1;
<a name="l01450"></a>01450    setsockopt(lsock, SOL_SOCKET, SO_REUSEADDR, (<span class="keywordtype">char</span> *) &amp;flag, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01451"></a>01451 
<a name="l01452"></a>01452    status = bind(lsock, (<span class="keyword">struct</span> sockaddr *) &amp;bind_addr, <span class="keyword">sizeof</span>(bind_addr));
<a name="l01453"></a>01453    <span class="keywordflow">if</span> (status &lt; 0) {
<a name="l01454"></a>01454       printf
<a name="l01455"></a>01455           (<span class="stringliteral">&quot;Cannot bind to port %d.\nPlease try later or use the \&quot;-p\&quot; flag to specify a different port\n&quot;</span>,
<a name="l01456"></a>01456            <a class="code" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a>);
<a name="l01457"></a>01457       <span class="keywordflow">return</span>;
<a name="l01458"></a>01458    }
<a name="l01459"></a>01459 <span class="preprocessor">#ifndef _MSC_VER</span>
<a name="l01460"></a>01460 <span class="preprocessor"></span>   <span class="comment">/* give up root privilege */</span>
<a name="l01461"></a>01461    setuid(getuid());
<a name="l01462"></a>01462    setgid(getgid());
<a name="l01463"></a>01463 
<a name="l01464"></a>01464    <span class="comment">/* start paw */</span>
<a name="l01465"></a>01465    status = <a class="code" href="webpaw_8c.html#afbc34c39e5863988ff8d15f9afb4ddd2">submit_paw</a>(<span class="stringliteral">&quot;restart&quot;</span>, NULL, 1);
<a name="l01466"></a>01466    <span class="keywordflow">if</span> (status != 1) {
<a name="l01467"></a>01467       printf(<span class="stringliteral">&quot;Error starting PAW: &quot;</span>);
<a name="l01468"></a>01468       <span class="keywordflow">if</span> (status == <a class="code" href="webpaw_8c.html#aedcf61ffa26ceba66e9995937de74d64">ERR_TIMEOUT</a>)
<a name="l01469"></a>01469          printf(<span class="stringliteral">&quot;Timeout\n&quot;</span>);
<a name="l01470"></a>01470       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (status == <a class="code" href="webpaw_8c.html#a3144b48f181067b67fe3f036e24ba3a0">ERR_PIPE</a>)
<a name="l01471"></a>01471          printf(<span class="stringliteral">&quot;PAW stopped unexpectedly\n&quot;</span>);
<a name="l01472"></a>01472       <span class="keywordflow">else</span>
<a name="l01473"></a>01473          printf(<span class="stringliteral">&quot;Unknown error %d\n&quot;</span>, status);
<a name="l01474"></a>01474 
<a name="l01475"></a>01475       <span class="keywordflow">return</span>;
<a name="l01476"></a>01476    }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478    <span class="keywordflow">if</span> (<a class="code" href="mana_8cpp.html#a96203468e98720f55cbede5bb1f8cffe">daemon</a>) {
<a name="l01479"></a>01479       <span class="keywordtype">int</span> i, fd, pid;
<a name="l01480"></a>01480 
<a name="l01481"></a>01481       printf(<span class="stringliteral">&quot;Becoming a daemon...\n&quot;</span>);
<a name="l01482"></a>01482 
<a name="l01483"></a>01483       <span class="keywordflow">if</span> ((pid = fork()) &lt; 0)
<a name="l01484"></a>01484          <span class="keywordflow">return</span>;
<a name="l01485"></a>01485       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid != 0)
<a name="l01486"></a>01486          exit(0);               <span class="comment">/* parent finished */</span>
<a name="l01487"></a>01487 
<a name="l01488"></a>01488       <span class="comment">/* child continues here */</span>
<a name="l01489"></a>01489 
<a name="l01490"></a>01490       <span class="comment">/* try and use up stdin, stdout and stderr, so other</span>
<a name="l01491"></a>01491 <span class="comment">         routines writing to stdout etc won&apos;t cause havoc. Copied from smbd */</span>
<a name="l01492"></a>01492       <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {
<a name="l01493"></a>01493          close(i);
<a name="l01494"></a>01494          fd = open(<span class="stringliteral">&quot;/dev/null&quot;</span>, O_RDWR, 0);
<a name="l01495"></a>01495          <span class="keywordflow">if</span> (fd &lt; 0)
<a name="l01496"></a>01496             fd = open(<span class="stringliteral">&quot;/dev/null&quot;</span>, O_WRONLY, 0);
<a name="l01497"></a>01497          <span class="keywordflow">if</span> (fd &lt; 0)
<a name="l01498"></a>01498             <span class="keywordflow">return</span>;
<a name="l01499"></a>01499          <span class="keywordflow">if</span> (fd != i)
<a name="l01500"></a>01500             <span class="keywordflow">return</span>;
<a name="l01501"></a>01501       }
<a name="l01502"></a>01502 
<a name="l01503"></a>01503       setsid();                 <span class="comment">/* become session leader */</span>
<a name="l01504"></a>01504       umask(0);                 <span class="comment">/* clear our file mode createion mask */</span>
<a name="l01505"></a>01505    }
<a name="l01506"></a>01506 <span class="preprocessor">#endif</span>
<a name="l01507"></a>01507 <span class="preprocessor"></span>
<a name="l01508"></a>01508    <span class="comment">/* listen for connection */</span>
<a name="l01509"></a>01509    status = listen(lsock, SOMAXCONN);
<a name="l01510"></a>01510    <span class="keywordflow">if</span> (status &lt; 0) {
<a name="l01511"></a>01511       printf(<span class="stringliteral">&quot;Cannot listen\n&quot;</span>);
<a name="l01512"></a>01512       <span class="keywordflow">return</span>;
<a name="l01513"></a>01513    }
<a name="l01514"></a>01514 
<a name="l01515"></a>01515    <span class="comment">/* set my own URL */</span>
<a name="l01516"></a>01516    <span class="keywordflow">if</span> (<a class="code" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a> == 80)
<a name="l01517"></a>01517       sprintf(<a class="code" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a>, <span class="stringliteral">&quot;http://%s/&quot;</span>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>);
<a name="l01518"></a>01518    <span class="keywordflow">else</span>
<a name="l01519"></a>01519       sprintf(<a class="code" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a>, <span class="stringliteral">&quot;http://%s:%d/&quot;</span>, <a class="code" href="crate6__CAEN__TDC_2mfe__mucap_8c.html#af65cc3664520b7cd0817adc7106f9624">host_name</a>, <a class="code" href="mhttpd_8c.html#aa9edbe9dd2977e5cc56138a3a05f7a98">tcp_port</a>);
<a name="l01520"></a>01520 
<a name="l01521"></a>01521    <span class="keywordflow">if</span> (!<a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a>)
<a name="l01522"></a>01522       printf(<span class="stringliteral">&quot;Server listening...\n&quot;</span>);
<a name="l01523"></a>01523 
<a name="l01524"></a>01524    <span class="keywordflow">do</span> {
<a name="l01525"></a>01525       FD_ZERO(&amp;readfds);
<a name="l01526"></a>01526       FD_SET(lsock, &amp;readfds);
<a name="l01527"></a>01527 
<a name="l01528"></a>01528       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_sec = 0;
<a name="l01529"></a>01529       <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_usec = 100000;
<a name="l01530"></a>01530 
<a name="l01531"></a>01531 <span class="preprocessor">#ifdef OS_UNIX</span>
<a name="l01532"></a>01532 <span class="preprocessor"></span>      <span class="keywordflow">do</span> {
<a name="l01533"></a>01533          status = select(<a class="code" href="group__msystemincludecode.html#ga86c5dbf5a99358e288f573d6a1e0873f">FD_SETSIZE</a>, (<span class="keywordtype">void</span> *) &amp;readfds, NULL, NULL, (<span class="keywordtype">void</span> *) &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l01534"></a>01534          <span class="comment">/* if an alarm signal was cought, restart with reduced timeout */</span>
<a name="l01535"></a>01535       } <span class="keywordflow">while</span> (status == -1 &amp;&amp; errno == EINTR);
<a name="l01536"></a>01536 <span class="preprocessor">#else</span>
<a name="l01537"></a>01537 <span class="preprocessor"></span>      status = select(<a class="code" href="group__msystemincludecode.html#ga86c5dbf5a99358e288f573d6a1e0873f">FD_SETSIZE</a>, (<span class="keywordtype">void</span> *) &amp;readfds, NULL, NULL, (<span class="keywordtype">void</span> *) &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l01538"></a>01538 <span class="preprocessor">#endif</span>
<a name="l01539"></a>01539 <span class="preprocessor"></span>
<a name="l01540"></a>01540       <span class="keywordflow">if</span> (FD_ISSET(lsock, &amp;readfds)) {
<a name="l01541"></a>01541          len = <span class="keyword">sizeof</span>(acc_addr);
<a name="l01542"></a>01542          <a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a> = accept(lsock, (<span class="keyword">struct</span> sockaddr *) &amp;acc_addr, &amp;len);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544          <span class="comment">/* turn on lingering (borrowed from NCSA httpd code) */</span>
<a name="l01545"></a>01545          ling.l_onoff = 1;
<a name="l01546"></a>01546          ling.l_linger = 600;
<a name="l01547"></a>01547          setsockopt(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>, SOL_SOCKET, SO_LINGER, (<span class="keywordtype">char</span> *) &amp;ling, <span class="keyword">sizeof</span>(ling));
<a name="l01548"></a>01548 
<a name="l01549"></a>01549          <span class="comment">/* ret remote host name */</span>
<a name="l01550"></a>01550          phe = gethostbyaddr((<span class="keywordtype">char</span> *) &amp;acc_addr.sin_addr, 4, PF_INET);
<a name="l01551"></a>01551          <span class="keywordflow">if</span> (phe == NULL) {
<a name="l01552"></a>01552             <span class="comment">/* use IP number instead */</span>
<a name="l01553"></a>01553             strcpy(<a class="code" href="webpaw_8c.html#a164f953412b79c2cc62833971433db7c">remote_host_name</a>, (<span class="keywordtype">char</span> *) inet_ntoa(acc_addr.sin_addr));
<a name="l01554"></a>01554          } <span class="keywordflow">else</span>
<a name="l01555"></a>01555             strcpy(<a class="code" href="webpaw_8c.html#a164f953412b79c2cc62833971433db7c">remote_host_name</a>, phe-&gt;h_name);
<a name="l01556"></a>01556 
<a name="l01557"></a>01557          memset(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>));
<a name="l01558"></a>01558          len = 0;
<a name="l01559"></a>01559          header_length = 0;
<a name="l01560"></a>01560          n_error = 0;
<a name="l01561"></a>01561          <span class="keywordflow">do</span> {
<a name="l01562"></a>01562             FD_ZERO(&amp;readfds);
<a name="l01563"></a>01563             FD_SET(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>, &amp;readfds);
<a name="l01564"></a>01564 
<a name="l01565"></a>01565             <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_sec = 6;
<a name="l01566"></a>01566             <a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>.tv_usec = 0;
<a name="l01567"></a>01567 
<a name="l01568"></a>01568 <span class="preprocessor">#ifdef OS_UNIX</span>
<a name="l01569"></a>01569 <span class="preprocessor"></span>            <span class="keywordflow">do</span> {
<a name="l01570"></a>01570                status =
<a name="l01571"></a>01571                    select(<a class="code" href="group__msystemincludecode.html#ga86c5dbf5a99358e288f573d6a1e0873f">FD_SETSIZE</a>, (<span class="keywordtype">void</span> *) &amp;readfds, NULL, NULL, (<span class="keywordtype">void</span> *) &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l01572"></a>01572                <span class="comment">/* if an alarm signal was cought, restart with reduced timeout */</span>
<a name="l01573"></a>01573             } <span class="keywordflow">while</span> (status == -1 &amp;&amp; errno == EINTR);
<a name="l01574"></a>01574 <span class="preprocessor">#else</span>
<a name="l01575"></a>01575 <span class="preprocessor"></span>            status = select(<a class="code" href="group__msystemincludecode.html#ga86c5dbf5a99358e288f573d6a1e0873f">FD_SETSIZE</a>, (<span class="keywordtype">void</span> *) &amp;readfds, NULL, NULL, (<span class="keywordtype">void</span> *) &amp;<a class="code" href="getHist_8cpp.html#a654210ae605a61110cf5a8a0c9f2d72c">timeout</a>);
<a name="l01576"></a>01576 <span class="preprocessor">#endif</span>
<a name="l01577"></a>01577 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>, &amp;readfds))
<a name="l01578"></a>01578                i = recv(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>, <a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a> + len, <span class="keyword">sizeof</span>(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>) - len, 0);
<a name="l01579"></a>01579             <span class="keywordflow">else</span>
<a name="l01580"></a>01580                <span class="keywordflow">goto</span> error;
<a name="l01581"></a>01581 
<a name="l01582"></a>01582             <span class="comment">/* abort if connection got broken */</span>
<a name="l01583"></a>01583             <span class="keywordflow">if</span> (i &lt; 0)
<a name="l01584"></a>01584                <span class="keywordflow">goto</span> error;
<a name="l01585"></a>01585 
<a name="l01586"></a>01586             <span class="keywordflow">if</span> (i &gt; 0)
<a name="l01587"></a>01587                len += i;
<a name="l01588"></a>01588 
<a name="l01589"></a>01589             <span class="keywordflow">if</span> (i == 0) {
<a name="l01590"></a>01590                n_error++;
<a name="l01591"></a>01591                <span class="keywordflow">if</span> (n_error == 100)
<a name="l01592"></a>01592                   <span class="keywordflow">goto</span> error;
<a name="l01593"></a>01593             }
<a name="l01594"></a>01594 
<a name="l01595"></a>01595             <span class="comment">/* finish when empty line received */</span>
<a name="l01596"></a>01596             <span class="keywordflow">if</span> (strstr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="stringliteral">&quot;GET&quot;</span>) != NULL) {
<a name="l01597"></a>01597                <span class="keywordflow">if</span> (len &gt; 4 &amp;&amp; strcmp(&amp;<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>[len - 4], <span class="stringliteral">&quot;\r\n\r\n&quot;</span>) == 0)
<a name="l01598"></a>01598                   <span class="keywordflow">break</span>;
<a name="l01599"></a>01599                <span class="keywordflow">if</span> (len &gt; 6 &amp;&amp; strcmp(&amp;<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>[len - 6], <span class="stringliteral">&quot;\r\r\n\r\r\n&quot;</span>) == 0)
<a name="l01600"></a>01600                   <span class="keywordflow">break</span>;
<a name="l01601"></a>01601             } <span class="keywordflow">else</span> {
<a name="l01602"></a>01602                printf(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>);
<a name="l01603"></a>01603                <span class="keywordflow">goto</span> error;
<a name="l01604"></a>01604             }
<a name="l01605"></a>01605 
<a name="l01606"></a>01606          } <span class="keywordflow">while</span> (1);
<a name="l01607"></a>01607 
<a name="l01608"></a>01608          <span class="keywordflow">if</span> (!strchr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="charliteral">&apos;\r&apos;</span>))
<a name="l01609"></a>01609             <span class="keywordflow">goto</span> error;
<a name="l01610"></a>01610 
<a name="l01611"></a>01611          memset(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>));
<a name="l01612"></a>01612          <a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> = 0;
<a name="l01613"></a>01613 
<a name="l01614"></a>01614          <span class="comment">/* ask for password if configured */</span>
<a name="l01615"></a>01615          authorized = 1;
<a name="l01616"></a>01616          <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a24bb1a7884637180a6b3e789dc6a6767">getcfg</a>(<span class="stringliteral">&quot;Global&quot;</span>, <span class="stringliteral">&quot;Password&quot;</span>, pwd)) {
<a name="l01617"></a>01617             authorized = 0;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619             <span class="comment">/* decode authorization */</span>
<a name="l01620"></a>01620             <span class="keywordflow">if</span> (strstr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="stringliteral">&quot;Authorization:&quot;</span>)) {
<a name="l01621"></a>01621                p = strstr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="stringliteral">&quot;Authorization:&quot;</span>) + 14;
<a name="l01622"></a>01622                <span class="keywordflow">if</span> (strstr(p, <span class="stringliteral">&quot;Basic&quot;</span>)) {
<a name="l01623"></a>01623                   p = strstr(p, <span class="stringliteral">&quot;Basic&quot;</span>) + 6;
<a name="l01624"></a>01624                   <span class="keywordflow">while</span> (*p == <span class="charliteral">&apos; &apos;</span>)
<a name="l01625"></a>01625                      p++;
<a name="l01626"></a>01626                   i = 0;
<a name="l01627"></a>01627                   <span class="keywordflow">while</span> (*p &amp;&amp; *p != <span class="charliteral">&apos; &apos;</span> &amp;&amp; *p != <span class="charliteral">&apos;\r&apos;</span>)
<a name="l01628"></a>01628                      str[i++] = *p++;
<a name="l01629"></a>01629                   str[i] = 0;
<a name="l01630"></a>01630                }
<a name="l01631"></a>01631                <a class="code" href="webpaw_8c.html#adb270245a5b87ffdc02d2bdabd3b8406">base64_decode</a>(str, cl_pwd);
<a name="l01632"></a>01632                <span class="keywordflow">if</span> (strchr(cl_pwd, <span class="charliteral">&apos;:&apos;</span>)) {
<a name="l01633"></a>01633                   p = strchr(cl_pwd, <span class="charliteral">&apos;:&apos;</span>) + 1;
<a name="l01634"></a>01634                   <a class="code" href="melog_8c.html#ad2d0890b22d51fd03fbff402b8da4c9b">base64_encode</a>(p, str);
<a name="l01635"></a>01635                   strcpy(cl_pwd, str);
<a name="l01636"></a>01636 
<a name="l01637"></a>01637                   <span class="comment">/* check authorization */</span>
<a name="l01638"></a>01638                   <span class="keywordflow">if</span> (strcmp(str, pwd) == 0)
<a name="l01639"></a>01639                      authorized = 1;
<a name="l01640"></a>01640                }
<a name="l01641"></a>01641             }
<a name="l01642"></a>01642          }
<a name="l01643"></a>01643 
<a name="l01644"></a>01644          <span class="keywordflow">if</span> (!authorized) {
<a name="l01645"></a>01645             <span class="comment">/* return request for authorization */</span>
<a name="l01646"></a>01646             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;HTTP/1.1 401 Authorization Required\r\n&quot;</span>);
<a name="l01647"></a>01647             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Server: WebPAW\r\n&quot;</span>);
<a name="l01648"></a>01648             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;WWW-Authenticate: Basic realm=\&quot;WebPAW\&quot;\r\n&quot;</span>);
<a name="l01649"></a>01649             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Connection: close\r\n&quot;</span>);
<a name="l01650"></a>01650             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;Content-Type: text/html\r\n\r\n&quot;</span>);
<a name="l01651"></a>01651 
<a name="l01652"></a>01652             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;HTML&gt;&lt;HEAD&gt;\r\n&quot;</span>);
<a name="l01653"></a>01653             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;TITLE&gt;401 Authorization Required&lt;/TITLE&gt;\r\n&quot;</span>);
<a name="l01654"></a>01654             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/HEAD&gt;&lt;BODY&gt;\r\n&quot;</span>);
<a name="l01655"></a>01655             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;H1&gt;Authorization Required&lt;/H1&gt;\r\n&quot;</span>);
<a name="l01656"></a>01656             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;This server could not verify that you\r\n&quot;</span>);
<a name="l01657"></a>01657             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;are authorized to access the document\r\n&quot;</span>);
<a name="l01658"></a>01658             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;requested.  Either you supplied the wrong\r\n&quot;</span>);
<a name="l01659"></a>01659             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;credentials (e.g., bad password), or your\r\n&quot;</span>);
<a name="l01660"></a>01660             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;browser doesn&apos;t understand how to supply\r\n&quot;</span>);
<a name="l01661"></a>01661             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;the credentials required.&lt;P&gt;\r\n&quot;</span>);
<a name="l01662"></a>01662             <a class="code" href="mhttpd_8c.html#af3273cdaacb7a8ea6ad26e4dc8389f42">rsprintf</a>(<span class="stringliteral">&quot;&lt;/BODY&gt;&lt;/HTML&gt;\r\n&quot;</span>);
<a name="l01663"></a>01663          } <span class="keywordflow">else</span> {
<a name="l01664"></a>01664             <span class="comment">/* extract path and commands */</span>
<a name="l01665"></a>01665             *strchr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="charliteral">&apos;\r&apos;</span>) = 0;
<a name="l01666"></a>01666 
<a name="l01667"></a>01667             <span class="keywordflow">if</span> (!strstr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="stringliteral">&quot;HTTP&quot;</span>))
<a name="l01668"></a>01668                <span class="keywordflow">goto</span> error;
<a name="l01669"></a>01669             *(strstr(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a>, <span class="stringliteral">&quot;HTTP&quot;</span>) - 1) = 0;
<a name="l01670"></a>01670 
<a name="l01671"></a>01671             <span class="comment">/* decode command and return answer */</span>
<a name="l01672"></a>01672             <a class="code" href="webpaw_8c.html#a1fbaea967c3648cda0448b1a548e7fe0">decode</a>(<a class="code" href="rpc_8c.html#ae6ae865fae68267535e16f3a36033155">net_buffer</a> + 4);
<a name="l01673"></a>01673          }
<a name="l01674"></a>01674 
<a name="l01675"></a>01675          <span class="keywordflow">if</span> (<a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> != -1) {
<a name="l01676"></a>01676             <span class="keywordflow">if</span> (<a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> == 0)
<a name="l01677"></a>01677                <a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a> = strlen(<a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>) + 1;
<a name="l01678"></a>01678 
<a name="l01679"></a>01679             <a class="code" href="scs__310_8c.html#a99ab5360db3bfaf51fa24c1a44ad6436">send</a>(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>, <a class="code" href="mhttpd_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>, <a class="code" href="mhttpd_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a>, 0);
<a name="l01680"></a>01680 
<a name="l01681"></a>01681           error:
<a name="l01682"></a>01682 
<a name="l01683"></a>01683             <a class="code" href="melog_8c.html#a5a3eb971b466278ada4f7f87399a537c">closesocket</a>(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>);
<a name="l01684"></a>01684          }
<a name="l01685"></a>01685       }
<a name="l01686"></a>01686 
<a name="l01687"></a>01687    } <span class="keywordflow">while</span> (!<a class="code" href="webpaw_8c.html#a47cb71fd25faecb24fa8360f407e4cc0">_quit</a>);
<a name="l01688"></a>01688 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2956fb85032748af9fb7f544a4fb6c93"></a><!-- doxytag: member="webpaw.c::setparam" ref="a2956fb85032748af9fb7f544a4fb6c93" args="(char *param, char *value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setparam </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00493">493</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="experiment_2template_8c_source.html#l00070">_param</a>, <a class="el" href="mhttpd_8c_source.html#l00885">_value</a>, <a class="el" href="mdump_8c_source.html#l00115">i</a>, <a class="el" href="mhttpd_8c_source.html#l00879">MAX_PARAM</a>, and <a class="el" href="mhttpd_8c_source.html#l00880">VALUE_SIZE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00494"></a>00494 {
<a name="l00495"></a>00495    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="mhttpd_8c.html#a5732be69f55a5dbbfa3df82d31314cb1">MAX_PARAM</a>; i++)
<a name="l00498"></a>00498       <span class="keywordflow">if</span> (<a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>[i][0] == 0)
<a name="l00499"></a>00499          <span class="keywordflow">break</span>;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501    <span class="keywordflow">if</span> (i &lt; MAX_PARAM) {
<a name="l00502"></a>00502       strcpy(<a class="code" href="experiment_2template_8c.html#afb3a768ad8339a2cefa693559a115d80">_param</a>[i], <a class="code" href="mana_8cpp.html#a6dadda9a6f1103026d1d128fe203aa9a">param</a>);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504       <span class="keywordflow">if</span> (strlen(<a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>) &gt;= <a class="code" href="mhttpd_8c.html#a7109febe139a7277e20652049ec9a1e1">VALUE_SIZE</a>)
<a name="l00505"></a>00505          printf(<span class="stringliteral">&quot;Error: parameter value too big\n&quot;</span>);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507       strncpy(<a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>[i], <a class="code" href="ADCS_8h.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <a class="code" href="mhttpd_8c.html#a7109febe139a7277e20652049ec9a1e1">VALUE_SIZE</a>);
<a name="l00508"></a>00508       <a class="code" href="mhttpd_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>[i][<a class="code" href="mhttpd_8c.html#a7109febe139a7277e20652049ec9a1e1">VALUE_SIZE</a> - 1] = 0;
<a name="l00509"></a>00509    } <span class="keywordflow">else</span> {
<a name="l00510"></a>00510       printf(<span class="stringliteral">&quot;Error: parameter array too small\n&quot;</span>);
<a name="l00511"></a>00511    }
<a name="l00512"></a>00512 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e518de089e3561081e2467925073550"></a><!-- doxytag: member="webpaw.c::sighup" ref="a8e518de089e3561081e2467925073550" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sighup </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01300">1300</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="webpaw_8c_source.html#l00189">_debug</a>, and <a class="el" href="webpaw_8c_source.html#l00331">cfgbuffer</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01301"></a>01301 {
<a name="l01302"></a>01302    <span class="comment">/* reread configuration file */</span>
<a name="l01303"></a>01303    <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a>)
<a name="l01304"></a>01304       printf(<span class="stringliteral">&quot;Reread configuration file.\n&quot;</span>);
<a name="l01305"></a>01305 
<a name="l01306"></a>01306    <span class="keywordflow">if</span> (<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>)
<a name="l01307"></a>01307       free(<a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a>);
<a name="l01308"></a>01308    <a class="code" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a> = 0;
<a name="l01309"></a>01309 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afbc34c39e5863988ff8d15f9afb4ddd2"></a><!-- doxytag: member="webpaw.c::submit_paw" ref="afbc34c39e5863988ff8d15f9afb4ddd2" args="(char *kumac, char *result, int save_gif)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int submit_paw </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>kumac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>save_gif</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00660">660</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mhttpd_8c_source.html#l00890">_sock</a>, <a class="el" href="melog_8c_source.html#l00085">closesocket</a>, <a class="el" href="webpaw_8c_source.html#l00201">debug_message()</a>, <a class="el" href="odb_8c_source.html#l01693">equal_ustring()</a>, <a class="el" href="webpaw_8c_source.html#l00193">paw_prompt</a>, <a class="el" href="webpaw_8c_source.html#l00602">read_paw()</a>, <a class="el" href="webpaw_8c_source.html#l00177">SHUTDOWN</a>, <a class="el" href="patch__mevb_8cpp_source.html#l00079">status</a>, <a class="el" href="bit3__mvme_2mvmestd_8h_source.html#l00045">SUCCESS</a>, and <a class="el" href="examples_2macro_2midas__macro_8h_source.html#l00259">write</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00661"></a>00661 {
<a name="l00662"></a>00662 <span class="preprocessor">#ifndef _MSC_VER</span>
<a name="l00663"></a>00663 <span class="preprocessor"></span>   <span class="keyword">static</span> <span class="keywordtype">int</span> pid = 0, pipe;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665    <span class="keywordtype">char</span> <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[100000];
<a name="l00666"></a>00666    <span class="keywordtype">int</span> <a class="code" href="patch__mevb_8cpp.html#a015eb90e0de9f16e87bd149d4b9ce959">status</a>;
<a name="l00667"></a>00667 
<a name="l00668"></a>00668    <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(kumac, <span class="stringliteral">&quot;restart&quot;</span>) &amp;&amp; pid) {
<a name="l00669"></a>00669       kill(pid, SIGKILL);
<a name="l00670"></a>00670       close(pipe);
<a name="l00671"></a>00671       pid = pipe = 0;
<a name="l00672"></a>00672    }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674    <span class="keywordflow">if</span> (pid == 0) {
<a name="l00675"></a>00675       <span class="keywordflow">if</span> ((pid = forkpty(&amp;pipe, str, NULL, NULL)) &lt; 0)
<a name="l00676"></a>00676          <span class="keywordflow">return</span> 0;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678       <span class="keywordflow">if</span> (pid &gt; 0) {
<a name="l00679"></a>00679          <span class="comment">/* wait for workstation question */</span>
<a name="l00680"></a>00680          memset(str, 0, <span class="keyword">sizeof</span>(str));
<a name="l00681"></a>00681          status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <span class="stringliteral">&quot;&lt;CR&gt;=1 : &quot;</span>, str);
<a name="l00682"></a>00682          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l00683"></a>00683             <span class="keywordflow">return</span> status;
<a name="l00684"></a>00684 
<a name="l00685"></a>00685          <span class="comment">/* select default workstation */</span>
<a name="l00686"></a>00686          sprintf(str, <span class="stringliteral">&quot;1\n&quot;</span>);
<a name="l00687"></a>00687          <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, 2);
<a name="l00688"></a>00688 
<a name="l00689"></a>00689          <span class="comment">/* wait for prompt */</span>
<a name="l00690"></a>00690          status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, str);
<a name="l00691"></a>00691          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l00692"></a>00692             <span class="keywordflow">return</span> status;
<a name="l00693"></a>00693 
<a name="l00694"></a>00694          <span class="comment">/* disable shell command */</span>
<a name="l00695"></a>00695          sprintf(str, <span class="stringliteral">&quot;vis shell off; vis vis off;\n&quot;</span>);
<a name="l00696"></a>00696          <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, strlen(str));
<a name="l00697"></a>00697          status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, str);
<a name="l00698"></a>00698          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l00699"></a>00699             <span class="keywordflow">return</span> status;
<a name="l00700"></a>00700       }
<a name="l00701"></a>00701    }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703    <span class="keywordflow">if</span> (pid &gt; 0) {
<a name="l00704"></a>00704       <span class="comment">/* parent */</span>
<a name="l00705"></a>00705       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(kumac, <span class="stringliteral">&quot;quit&quot;</span>)) {
<a name="l00706"></a>00706          strcpy(str, kumac);
<a name="l00707"></a>00707          strcat(str, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00708"></a>00708          <a class="code" href="webpaw_8c.html#a88be4aafa327218fbd41f7e1132f75ca">debug_message</a>(str);
<a name="l00709"></a>00709          <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, strlen(str));
<a name="l00710"></a>00710          close(pipe);
<a name="l00711"></a>00711          <span class="keywordflow">return</span> <a class="code" href="webpaw_8c.html#a3b61478edd7c1b25c8facd2907cf6c33">SHUTDOWN</a>;
<a name="l00712"></a>00712       }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714       <span class="keywordflow">if</span> (<a class="code" href="group__msectionh.html#ga394539b87025a42608497b31260142c8">equal_ustring</a>(kumac, <span class="stringliteral">&quot;restart&quot;</span>)) {
<a name="l00715"></a>00715          strcpy(str, <span class="stringliteral">&quot;pict/print webpaw.gif\n&quot;</span>);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717          <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, strlen(str));
<a name="l00718"></a>00718 
<a name="l00719"></a>00719          status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, str);
<a name="l00720"></a>00720          <span class="keywordflow">return</span> status;
<a name="l00721"></a>00721       }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723       <span class="comment">/* submit PAW command */</span>
<a name="l00724"></a>00724       strcpy(str, kumac);
<a name="l00725"></a>00725       strcat(str, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00726"></a>00726 
<a name="l00727"></a>00727       <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, strlen(str));
<a name="l00728"></a>00728 
<a name="l00729"></a>00729       <span class="comment">/* wait for prompt */</span>
<a name="l00730"></a>00730       status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, result);
<a name="l00731"></a>00731       <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l00732"></a>00732          <span class="keywordflow">return</span> status;
<a name="l00733"></a>00733 
<a name="l00734"></a>00734       <span class="keywordflow">if</span> (save_gif) {
<a name="l00735"></a>00735          <span class="comment">/* send print command */</span>
<a name="l00736"></a>00736          strcpy(str, <span class="stringliteral">&quot;pict/print webpaw.gif\n&quot;</span>);
<a name="l00737"></a>00737          <a class="code" href="examples_2macro_2midas__macro_8h.html#a6fbb683090a733152e51639d58b90cd6">write</a>(pipe, str, strlen(str));
<a name="l00738"></a>00738 
<a name="l00739"></a>00739          <span class="comment">/* wait for prompt */</span>
<a name="l00740"></a>00740          status = <a class="code" href="webpaw_8c.html#a6e6f2ca1e65467495acfae0757040d37">read_paw</a>(pipe, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>, str);
<a name="l00741"></a>00741          <span class="keywordflow">if</span> (status != <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>)
<a name="l00742"></a>00742             <span class="keywordflow">return</span> status;
<a name="l00743"></a>00743       }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745       <span class="keywordflow">if</span> (strstr(str, <a class="code" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>) &amp;&amp; result) {
<a name="l00746"></a>00746          strcpy(result, str);
<a name="l00747"></a>00747          <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00748"></a>00748       } <span class="keywordflow">else</span>
<a name="l00749"></a>00749          <span class="keywordflow">return</span> 0;
<a name="l00750"></a>00750    } <span class="keywordflow">else</span> {
<a name="l00751"></a>00751       <span class="comment">/* close inherited network socket */</span>
<a name="l00752"></a>00752       <span class="keywordflow">if</span> (<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>)
<a name="l00753"></a>00753          <a class="code" href="melog_8c.html#a5a3eb971b466278ada4f7f87399a537c">closesocket</a>(<a class="code" href="mhttpd_8c.html#a22283e600d5dd8c6c363cccd5adc2529">_sock</a>);
<a name="l00754"></a>00754 
<a name="l00755"></a>00755       <span class="comment">/* start PAW */</span>
<a name="l00756"></a>00756       execlp(<span class="stringliteral">&quot;paw&quot;</span>, <span class="stringliteral">&quot;paw&quot;</span>, NULL);
<a name="l00757"></a>00757    }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 <span class="preprocessor">#endif</span>
<a name="l00760"></a>00760 <span class="preprocessor"></span>   <span class="keywordflow">return</span> <a class="code" href="group__mvmestdinclude.html#gaa90cac659d18e8ef6294c7ae337f6b58">SUCCESS</a>;
<a name="l00761"></a>00761 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a314e523b7d95b4a434216200167e5e0a"></a><!-- doxytag: member="webpaw.c::urlDecode" ref="a314e523b7d95b4a434216200167e5e0a" args="(char *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void urlDecode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00544">544</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="mdump_8c_source.html#l00115">i</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00548"></a>00548 {
<a name="l00549"></a>00549    <span class="keywordtype">char</span> *pD, <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[3];
<a name="l00550"></a>00550    <span class="keywordtype">int</span> <a class="code" href="mdump_8c.html#a65a8886d814fb9bf73f9d4f0fd64d162">i</a>;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552    pD = <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>;
<a name="l00553"></a>00553    <span class="keywordflow">while</span> (*<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>) {
<a name="l00554"></a>00554       <span class="keywordflow">if</span> (*<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a> == <span class="charliteral">&apos;%&apos;</span>) {
<a name="l00555"></a>00555          <span class="comment">/* Escape: next 2 chars are hex representation of the actual character */</span>
<a name="l00556"></a>00556          <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>++;
<a name="l00557"></a>00557          <span class="keywordflow">if</span> (isxdigit(<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>[0]) &amp;&amp; isxdigit(<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>[1])) {
<a name="l00558"></a>00558             str[0] = <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>[0];
<a name="l00559"></a>00559             str[1] = <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>[1];
<a name="l00560"></a>00560             str[2] = 0;
<a name="l00561"></a>00561             sscanf(<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, <span class="stringliteral">&quot;%02X&quot;</span>, &amp;i);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563             *pD++ = (char) i;
<a name="l00564"></a>00564             <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a> += 2;
<a name="l00565"></a>00565          } <span class="keywordflow">else</span>
<a name="l00566"></a>00566             *pD++ = <span class="charliteral">&apos;%&apos;</span>;
<a name="l00567"></a>00567       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a> == <span class="charliteral">&apos;+&apos;</span>) {
<a name="l00568"></a>00568          <span class="comment">/* convert &apos;+&apos; to &apos; &apos; */</span>
<a name="l00569"></a>00569          *pD++ = <span class="charliteral">&apos; &apos;</span>;
<a name="l00570"></a>00570          <a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>++;
<a name="l00571"></a>00571       } <span class="keywordflow">else</span> {
<a name="l00572"></a>00572          *pD++ = *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>++;
<a name="l00573"></a>00573       }
<a name="l00574"></a>00574    }
<a name="l00575"></a>00575    *pD = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00576"></a>00576 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a477e33c685ba6ebcb9d429fb057c2760"></a><!-- doxytag: member="webpaw.c::urlEncode" ref="a477e33c685ba6ebcb9d429fb057c2760" args="(char *ps)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void urlEncode </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ps</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00578">578</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>References <a class="el" href="sis3803_8c_source.html#l00925">p</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00582"></a>00582 {
<a name="l00583"></a>00583    <span class="keywordtype">char</span> *pd, *<a class="code" href="sis3803_8c.html#afcb0609a0beab248bb3994a3368bd9ff">p</a>, <a class="code" href="odbhist_8c.html#a45bb529d5408fcb730eeccb339110d3f">str</a>[256];
<a name="l00584"></a>00584 
<a name="l00585"></a>00585    pd = str;
<a name="l00586"></a>00586    p = ps;
<a name="l00587"></a>00587    <span class="keywordflow">while</span> (*p) {
<a name="l00588"></a>00588       <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot; %&amp;=#+/\\&quot;</span>, *p)) {
<a name="l00589"></a>00589          sprintf(pd, <span class="stringliteral">&quot;%%%02X&quot;</span>, *p);
<a name="l00590"></a>00590          pd += 3;
<a name="l00591"></a>00591          p++;
<a name="l00592"></a>00592       } <span class="keywordflow">else</span> {
<a name="l00593"></a>00593          *pd++ = *p++;
<a name="l00594"></a>00594       }
<a name="l00595"></a>00595    }
<a name="l00596"></a>00596    *pd = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00597"></a>00597    strcpy(ps, str);
<a name="l00598"></a>00598 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a4859ebf3de3eada7338899d0f24d3c23"></a><!-- doxytag: member="webpaw.c::_debug" ref="a4859ebf3de3eada7338899d0f24d3c23" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="webpaw_8c.html#a4859ebf3de3eada7338899d0f24d3c23">_debug</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00189">189</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00201">debug_message()</a>, <a class="el" href="webpaw_8c_source.html#l01764">main()</a>, <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>, and <a class="el" href="webpaw_8c_source.html#l01300">sighup()</a>.</p>

</div>
</div>
<a class="anchor" id="a8d769c1a97fec55473c5f591221dea4c"></a><!-- doxytag: member="webpaw.c::_param" ref="a8d769c1a97fec55473c5f591221dea4c" args="[MAX_PARAM][PARAM_LENGTH]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a8d769c1a97fec55473c5f591221dea4c">_param</a>[MAX_PARAM][PARAM_LENGTH]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00185">185</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a47cb71fd25faecb24fa8360f407e4cc0"></a><!-- doxytag: member="webpaw.c::_quit" ref="a47cb71fd25faecb24fa8360f407e4cc0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="webpaw_8c.html#a47cb71fd25faecb24fa8360f407e4cc0">_quit</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00191">191</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="a275776e6df5d25b1778564974ea48485"></a><!-- doxytag: member="webpaw.c::_sock" ref="a275776e6df5d25b1778564974ea48485" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="webpaw_8c.html#a275776e6df5d25b1778564974ea48485">_sock</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00191">191</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="abcd78d8c212e69ce3b664c10cfabf5f6"></a><!-- doxytag: member="webpaw.c::_value" ref="abcd78d8c212e69ce3b664c10cfabf5f6" args="[MAX_PARAM][VALUE_SIZE]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#abcd78d8c212e69ce3b664c10cfabf5f6">_value</a>[MAX_PARAM][VALUE_SIZE]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00186">186</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7d2030aaf175cd6d81557da380f62c02"></a><!-- doxytag: member="webpaw.c::cfgbuffer" ref="a7d2030aaf175cd6d81557da380f62c02" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="webpaw_8c.html#a7d2030aaf175cd6d81557da380f62c02">cfgbuffer</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00331">331</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01692">create_password()</a>, <a class="el" href="webpaw_8c_source.html#l00414">enumcfg()</a>, <a class="el" href="webpaw_8c_source.html#l00333">getcfg()</a>, and <a class="el" href="webpaw_8c_source.html#l01300">sighup()</a>.</p>

</div>
</div>
<a class="anchor" id="a9f228f066ad5c881241a2bf77186bd6e"></a><!-- doxytag: member="webpaw.c::debug_file" ref="a9f228f066ad5c881241a2bf77186bd6e" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a9f228f066ad5c881241a2bf77186bd6e">debug_file</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00190">190</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00201">debug_message()</a>, and <a class="el" href="webpaw_8c_source.html#l01764">main()</a>.</p>

</div>
</div>
<a class="anchor" id="af30d16605d5c80183cd199983a653081"></a><!-- doxytag: member="webpaw.c::host_name" ref="af30d16605d5c80183cd199983a653081" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#af30d16605d5c80183cd199983a653081">host_name</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00187">187</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7b00b1bfd666e26484471bd17a74eaa9"></a><!-- doxytag: member="webpaw.c::map" ref="a7b00b1bfd666e26484471bd17a74eaa9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="webpaw_8c.html#a7b00b1bfd666e26484471bd17a74eaa9">map</a> = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01313">1313</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a203be81bafae956e5d4d101154c3528e"></a><!-- doxytag: member="webpaw.c::net_buffer" ref="a203be81bafae956e5d4d101154c3528e" args="[WEB_BUFFER_SIZE]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a203be81bafae956e5d4d101154c3528e">net_buffer</a>[WEB_BUFFER_SIZE]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l01380">1380</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0bb0ff2d2cb2d18956a06e3fbb095a7e"></a><!-- doxytag: member="webpaw.c::paw_prompt" ref="a0bb0ff2d2cb2d18956a06e3fbb095a7e" args="[80]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a0bb0ff2d2cb2d18956a06e3fbb095a7e">paw_prompt</a>[80]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00193">193</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01764">main()</a>, and <a class="el" href="webpaw_8c_source.html#l00660">submit_paw()</a>.</p>

</div>
</div>
<a class="anchor" id="a164f953412b79c2cc62833971433db7c"></a><!-- doxytag: member="webpaw.c::remote_host_name" ref="a164f953412b79c2cc62833971433db7c" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a164f953412b79c2cc62833971433db7c">remote_host_name</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00188">188</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="a156f86e47f22882eb9855d44e63a464b"></a><!-- doxytag: member="webpaw.c::return_buffer" ref="a156f86e47f22882eb9855d44e63a464b" args="[WEB_BUFFER_SIZE]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a156f86e47f22882eb9855d44e63a464b">return_buffer</a>[WEB_BUFFER_SIZE]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00181">181</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a518fedf43db3f1313f9c88b2009380b5"></a><!-- doxytag: member="webpaw.c::return_length" ref="a518fedf43db3f1313f9c88b2009380b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="webpaw_8c.html#a518fedf43db3f1313f9c88b2009380b5">return_length</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00182">182</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

</div>
</div>
<a class="anchor" id="a77af7be4f329c3d6f7cd415c46ae09e4"></a><!-- doxytag: member="webpaw.c::webpaw_url" ref="a77af7be4f329c3d6f7cd415c46ae09e4" args="[256]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char <a class="el" href="webpaw_8c.html#a77af7be4f329c3d6f7cd415c46ae09e4">webpaw_url</a>[256]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="webpaw_8c_source.html#l00183">183</a> of file <a class="el" href="webpaw_8c_source.html">webpaw.c</a>.</p>

<p>Referenced by <a class="el" href="webpaw_8c_source.html#l00823">interprete()</a>, and <a class="el" href="webpaw_8c_source.html#l01382">server_loop()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 6 Jun 2014 for AlcapDAQ:Rootana by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
